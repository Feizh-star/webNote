(self.webpackChunk=self.webpackChunk||[]).push([[2433],{2433:function(e,a,n){"use strict";n.r(a),n.d(a,{default:function(){return k}}),n(7378);var t=n(5318);function p(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function s(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?p(Object(n),!0).forEach((function(a){o(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function o(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}var l=("Badge",function(e){return console.warn("Component Badge was not imported, exported, or provided by MDXProvider as global scope"),(0,t.kt)("div",s({},e))}),i={};function k(e){var a=e.components,n=function(e,a){if(null==e)return{};var n,t,p=function(e,a){if(null==e)return{};var n,t,p={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||(p[n]=e[n]);return p}(e,a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(p[n]=e[n])}return p}(e,["components"]);return(0,t.kt)("wrapper",s(s(s({},i),n),{},{components:a,mdxType:"MDXLayout"}),(0,t.kt)("hr",null),(0,t.kt)("p",null,"title: compilation 钩子\ngroup: Plugins\nsort: 10\ncontributors:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"byzyk"),(0,t.kt)("li",{parentName:"ul"},"madhavarshney"),(0,t.kt)("li",{parentName:"ul"},"misterdev"),(0,t.kt)("li",{parentName:"ul"},"wizardofhogwarts"),(0,t.kt)("li",{parentName:"ul"},"EugeneHlushko"),(0,t.kt)("li",{parentName:"ul"},"chenxsan")),(0,t.kt)("hr",null),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"Compilation")," 模块会被 ",(0,t.kt)("inlineCode",{parentName:"p"},"Compiler")," 用来创建新的 compilation 对象（或新的 build 对象）。\n",(0,t.kt)("inlineCode",{parentName:"p"},"compilation")," 实例能够访问所有的模块和它们的依赖（大部分是循环依赖）。\n它会对应用程序的依赖图中所有模块，\n进行字面上的编译(literal compilation)。\n在编译阶段，模块会被加载(load)、封存(seal)、优化(optimize)、\n分块(chunk)、哈希(hash)和重新创建(restore)。"),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"Compilation")," 类扩展(extend)自 ",(0,t.kt)("inlineCode",{parentName:"p"},"Tapable"),"，并提供了以下生命周期钩子。\n可以按照 compiler 钩子的相同方式来调用 tap："),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"hljs language-js"}),"compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"someHook",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"tap"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token comment"}),"/* ... */"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"))),(0,t.kt)("p",null,"和 ",(0,t.kt)("inlineCode",{parentName:"p"},"compiler")," 用法相同，取决于不同的钩子类型，\n所以也可以在某些钩子上访问 ",(0,t.kt)("inlineCode",{parentName:"p"},"tapAsync")," 和 ",(0,t.kt)("inlineCode",{parentName:"p"},"tapPromise"),"。"),(0,t.kt)("h3",s({},{id:"buildmodule"}),(0,t.kt)("inlineCode",{parentName:"h3"},"buildModule")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#buildmodule","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在模块构建开始之前触发，可以用来修改模块。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"module"))),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"hljs language-js"}),"compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"buildModule",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"tap"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'SourceMapDevToolModuleOptionsPlugin'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"module")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    module",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"useSourceMap ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token boolean"}),"true"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"))),(0,t.kt)("h3",s({},{id:"rebuildmodule"}),(0,t.kt)("inlineCode",{parentName:"h3"},"rebuildModule")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#rebuildmodule","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在重新构建一个模块之前触发。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"module"))),(0,t.kt)("h3",s({},{id:"failedmodule"}),(0,t.kt)("inlineCode",{parentName:"h3"},"failedModule")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#failedmodule","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"模块构建失败时执行。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"module")," ",(0,t.kt)("inlineCode",{parentName:"li"},"error"))),(0,t.kt)("h3",s({},{id:"succeedmodule"}),(0,t.kt)("inlineCode",{parentName:"h3"},"succeedModule")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#succeedmodule","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"模块构建成功时执行。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"module"))),(0,t.kt)("h3",s({},{id:"finishmodules"}),(0,t.kt)("inlineCode",{parentName:"h3"},"finishModules")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#finishmodules","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"AsyncSeriesHook")),(0,t.kt)("p",null,"所有模块都完成构建并且没有错误时执行。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"finishrebuildingmodule"}),(0,t.kt)("inlineCode",{parentName:"h3"},"finishRebuildingModule")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#finishrebuildingmodule","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"一个模块完成重新构建时执行，在都成功或有错误的情况下。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"module"))),(0,t.kt)("h3",s({},{id:"seal"}),(0,t.kt)("inlineCode",{parentName:"h3"},"seal")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#seal","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"compilation 对象停止接收新的模块时触发。"),(0,t.kt)("h3",s({},{id:"unseal"}),(0,t.kt)("inlineCode",{parentName:"h3"},"unseal")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#unseal","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"compilation 对象开始接收新模块时触发。"),(0,t.kt)("h3",s({},{id:"optimizedependencies"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimizeDependencies")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimizedependencies","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncBailHook")),(0,t.kt)("p",null,"依赖优化开始时触发。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"afteroptimizedependencies"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterOptimizeDependencies")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afteroptimizedependencies","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"依赖优化之后触发。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"optimize"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimize")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimize","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"优化阶段开始时触发。"),(0,t.kt)("h3",s({},{id:"optimizemodules"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimizeModules")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimizemodules","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncBailHook")),(0,t.kt)("p",null,"在模块优化阶段开始时调用。插件可以 tap 此钩子对模块进行优化。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"afteroptimizemodules"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterOptimizeModules")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afteroptimizemodules","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在模块优化完成之后调用。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"optimizechunks"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimizeChunks")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimizechunks","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncBailHook")),(0,t.kt)("p",null,"在 chunk 优化阶段开始时调用。插件可以 tap 此钩子对 chunk 执行优化。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks"))),(0,t.kt)("h3",s({},{id:"afteroptimizechunks"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterOptimizeChunks")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afteroptimizechunks","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"chunk 优化完成之后触发。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks"))),(0,t.kt)("h3",s({},{id:"optimizetree"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimizeTree")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimizetree","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"AsyncSeriesHook")),(0,t.kt)("p",null,"在优化依赖树之前调用。插件可以 tap 此钩子执行依赖树优化。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks")," ",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"afteroptimizetree"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterOptimizeTree")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afteroptimizetree","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在依赖树优化成功完成之后调用。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks")," ",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"optimizechunkmodules"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimizeChunkModules")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimizechunkmodules","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncBailHook")),(0,t.kt)("p",null,"在树优化之后，chunk 模块优化开始时调用。插件可以 tap 此钩子来执行 chunk 模块的优化。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks")," ",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"afteroptimizechunkmodules"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterOptimizeChunkModules")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afteroptimizechunkmodules","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在 chunk 模块优化成功完成之后调用。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks")," ",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"shouldrecord"}),(0,t.kt)("inlineCode",{parentName:"h3"},"shouldRecord")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#shouldrecord","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncBailHook")),(0,t.kt)("p",null,"调用来决定是否存储 record。返回任何内容 ",(0,t.kt)("inlineCode",{parentName:"p"},"!== false"),' 将阻止执行所有其他 "record" 钩子（',(0,t.kt)("a",s({parentName:"p"},{href:"#record"}),(0,t.kt)("inlineCode",{parentName:"a"},"record")),", ",(0,t.kt)("a",s({parentName:"p"},{href:"#recordmodules"}),(0,t.kt)("inlineCode",{parentName:"a"},"recordModules")),", ",(0,t.kt)("a",s({parentName:"p"},{href:"#recordchunks"}),(0,t.kt)("inlineCode",{parentName:"a"},"recordChunks"))," 和 ",(0,t.kt)("a",s({parentName:"p"},{href:"#recordhash"}),(0,t.kt)("inlineCode",{parentName:"a"},"recordHash")),"）。"),(0,t.kt)("h3",s({},{id:"revivemodules"}),(0,t.kt)("inlineCode",{parentName:"h3"},"reviveModules")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#revivemodules","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"从 record 中恢复模块信息。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules")," ",(0,t.kt)("inlineCode",{parentName:"li"},"records"))),(0,t.kt)("h3",s({},{id:"beforemoduleids"}),(0,t.kt)("inlineCode",{parentName:"h3"},"beforeModuleIds")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#beforemoduleids","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在为每个模块分配 ",(0,t.kt)("inlineCode",{parentName:"p"},"id")," 之前执行。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"moduleids"}),(0,t.kt)("inlineCode",{parentName:"h3"},"moduleIds")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#moduleids","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"调用来每个模块分配一个 ",(0,t.kt)("inlineCode",{parentName:"p"},"id"),"。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"optimizemoduleids"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimizeModuleIds")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimizemoduleids","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在模块 ",(0,t.kt)("inlineCode",{parentName:"p"},"id")," 优化开始时调用。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"afteroptimizemoduleids"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterOptimizeModuleIds")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afteroptimizemoduleids","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在模块 ",(0,t.kt)("inlineCode",{parentName:"p"},"id")," 优化完成时调用。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules"))),(0,t.kt)("h3",s({},{id:"revivechunks"}),(0,t.kt)("inlineCode",{parentName:"h3"},"reviveChunks")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#revivechunks","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"从 record 中恢复 chunk 信息。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks")," ",(0,t.kt)("inlineCode",{parentName:"li"},"records"))),(0,t.kt)("h3",s({},{id:"beforechunkids"}),(0,t.kt)("inlineCode",{parentName:"h3"},"beforeChunkIds")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#beforechunkids","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在为每个 chunk 分配 ",(0,t.kt)("inlineCode",{parentName:"p"},"id")," 之前执行。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks"))),(0,t.kt)("h3",s({},{id:"chunkids"}),(0,t.kt)("inlineCode",{parentName:"h3"},"chunkIds")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#chunkids","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"调用时，会为每个 chunk 分配一个 ",(0,t.kt)("inlineCode",{parentName:"p"},"id"),"。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调函数的参数为：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks"))),(0,t.kt)("h3",s({},{id:"optimizechunkids"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimizeChunkIds")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimizechunkids","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在 chunk ",(0,t.kt)("inlineCode",{parentName:"p"},"id")," 优化阶段开始时调用。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks"))),(0,t.kt)("h3",s({},{id:"afteroptimizechunkids"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterOptimizeChunkIds")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afteroptimizechunkids","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"chunk ",(0,t.kt)("inlineCode",{parentName:"p"},"id")," 优化结束之后触发。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks"))),(0,t.kt)("h3",s({},{id:"recordmodules"}),(0,t.kt)("inlineCode",{parentName:"h3"},"recordModules")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#recordmodules","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"将模块信息存储到 record 中。",(0,t.kt)("a",s({parentName:"p"},{href:"#shouldrecord"}),(0,t.kt)("inlineCode",{parentName:"a"},"shouldRecord"))," 返回 truthy 值时触发。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"modules")," ",(0,t.kt)("inlineCode",{parentName:"li"},"records"))),(0,t.kt)("h3",s({},{id:"recordchunks"}),(0,t.kt)("inlineCode",{parentName:"h3"},"recordChunks")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#recordchunks","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"将 chunk 存储到 record 中。",(0,t.kt)("a",s({parentName:"p"},{href:"#shouldrecord"}),(0,t.kt)("inlineCode",{parentName:"a"},"shouldRecord"))," 返回 truthy 值时触发。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks")," ",(0,t.kt)("inlineCode",{parentName:"li"},"records"))),(0,t.kt)("h3",s({},{id:"beforehash"}),(0,t.kt)("inlineCode",{parentName:"h3"},"beforeHash")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#beforehash","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在 compilation 添加哈希(hash)之前。"),(0,t.kt)("h3",s({},{id:"afterhash"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterHash")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afterhash","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在 compilation 添加哈希(hash)之后。"),(0,t.kt)("h3",s({},{id:"recordhash"}),(0,t.kt)("inlineCode",{parentName:"h3"},"recordHash")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#recordhash","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"将有关 record 的信息存储到 ",(0,t.kt)("inlineCode",{parentName:"p"},"records")," 中。仅在 ",(0,t.kt)("a",s({parentName:"p"},{href:"#shouldrecord"}),(0,t.kt)("inlineCode",{parentName:"a"},"shouldRecord"))," 返回 truthy 值时触发。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"records"))),(0,t.kt)("h3",s({},{id:"record"}),(0,t.kt)("inlineCode",{parentName:"h3"},"record")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#record","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"将 ",(0,t.kt)("inlineCode",{parentName:"p"},"compilation")," 相关信息存储到 ",(0,t.kt)("inlineCode",{parentName:"p"},"record")," 中。仅在 ",(0,t.kt)("a",s({parentName:"p"},{href:"#shouldrecord"}),(0,t.kt)("inlineCode",{parentName:"a"},"shouldRecord"))," 返回 truthy 值时触发。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"compilation")," ",(0,t.kt)("inlineCode",{parentName:"li"},"records"))),(0,t.kt)("h3",s({},{id:"beforemoduleassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"beforeModuleAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#beforemoduleassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在创建模块 asset 之前执行。"),(0,t.kt)("h3",s({},{id:"additionalchunkassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"additionalChunkAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#additionalchunkassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("blockquote",s({},{className:"warning"}),(0,t.kt)("p",{parentName:"blockquote"},"",(0,t.kt)("inlineCode",{parentName:"p"},"additionalChunkAssets")," 已弃用（可使用 ",(0,t.kt)("a",s({parentName:"p"},{href:"#processassets"}),"Compilation.hook.processAssets")," 来代替，并且可使用 Compilation.PROCESS",(0,t.kt)("em",{parentName:"p"},"ASSETS_STAGE"),"* 作为其选项参数。）")),(0,t.kt)("p",null,"为这些 chunk 创建其他 asset。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks"))),(0,t.kt)("h3",s({},{id:"shouldgeneratechunkassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"shouldGenerateChunkAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#shouldgeneratechunkassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncBailHook")),(0,t.kt)("p",null,"调用以确定是否生成 chunk asset。返回任何 ",(0,t.kt)("inlineCode",{parentName:"p"},"!== false")," 将允许生成 chunk asset。"),(0,t.kt)("h3",s({},{id:"beforechunkassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"beforeChunkAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#beforechunkassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"在创建 chunk asset 之前。"),(0,t.kt)("h3",s({},{id:"additionalassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"additionalAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#additionalassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"AsyncSeriesHook")),(0,t.kt)("p",null,"为 compilation 创建额外 asset。\n这个钩子可以用来下载图像，例如："),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"hljs language-js"}),"compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"additionalAssets",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"tapAsync"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'MyPlugin'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),",")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"callback")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"download"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'https://img.shields.io/npm/v/webpack.svg'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),",")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token keyword"}),"function"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"resp"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token keyword"}),"if"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"resp",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"status ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"===")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token number"}),"200"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n      compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"assets",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"["),(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'https://webpack.docschina.org/webpack-version.svg'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"]")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"toAsset"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"resp",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n      ",(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"callback"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token keyword"}),"else")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"callback"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token keyword"}),"new")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token class-name"}),"Error"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'[webpack-example-plugin] Unable to download the image'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"))),(0,t.kt)("h3",s({},{id:"optimizechunkassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimizeChunkAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimizechunkassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"AsyncSeriesHook")),(0,t.kt)("blockquote",s({},{className:"warning"}),(0,t.kt)("p",{parentName:"blockquote"},"",(0,t.kt)("inlineCode",{parentName:"p"},"optimizeChunkAssets")," 已弃用。（可使用 ",(0,t.kt)("a",s({parentName:"p"},{href:"#processassets"}),"Compilation.hook.processAssets")," 来代替，并且可使用 Compilation.PROCESS",(0,t.kt)("em",{parentName:"p"},"ASSETS_STAGE"),"* 作为其选项参数。")),(0,t.kt)("p",null,"优化所有 chunk asset。asset 存储在 ",(0,t.kt)("inlineCode",{parentName:"p"},"compilation.assets")," 中。\n每个 ",(0,t.kt)("inlineCode",{parentName:"p"},"Chunk")," 都具有一个 ",(0,t.kt)("inlineCode",{parentName:"p"},"files")," 属性，其指向由一个 chunk 创建的所有文件。\n任何额外 chunk asset 都存储在 ",(0,t.kt)("inlineCode",{parentName:"p"},"compilation.additionalChunkAssets")," 中。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks"))),(0,t.kt)("p",null,"Here's an example that simply adds a banner to each chunk."),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"hljs language-js"}),"compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"optimizeChunkAssets\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"tapAsync"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'MyPlugin'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),",")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"chunks",(0,t.kt)("span",s({parentName:"span"},{className:"token punctuation"}),",")," callback"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    chunks",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"forEach"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"chunk")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n      chunk",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"files",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"forEach"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"file")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n        compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"assets",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"["),"file",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"]")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token keyword"}),"new")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token class-name"}),"ConcatSource"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"\n          ",(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'\\/**Sweet Banner**\\/'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n          ",(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'\\n'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n          compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"assets",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"["),"file",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"]"),"\n        ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n      ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"callback"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"))),(0,t.kt)("h3",s({},{id:"afteroptimizechunkassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterOptimizeChunkAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afteroptimizechunkassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("blockquote",s({},{className:"warning"}),(0,t.kt)("p",{parentName:"blockquote"},"",(0,t.kt)("inlineCode",{parentName:"p"},"afterOptimizeChunkAssets")," 已弃用。（可使用 ",(0,t.kt)("a",s({parentName:"p"},{href:"#processassets"}),"Compilation.hook.processAssets")," 来代替，并且可使用 Compilation.PROCESS",(0,t.kt)("em",{parentName:"p"},"ASSETS_STAGE"),"* 作为其选项参数。")),(0,t.kt)("p",null,"chunk asset 已经被优化。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunks"))),(0,t.kt)("p",null,"这里是一个来自 ",(0,t.kt)("a",s({parentName:"p"},{href:"https://github.com/boopathi"}),"@boopathi")," 的示例插件，详细地输出每个 chunk 里有什么。"),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"hljs language-js"}),"compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"afterOptimizeChunkAssets",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"tap"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'MyPlugin'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),",")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"chunks")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n  chunks",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"forEach"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"chunk")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    console",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"log"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n      id",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," chunk",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"id",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n      name",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," chunk",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"name",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n      includes",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," chunk",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"getModules"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"map"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"module")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," module",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"request",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"),"\n",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"))),(0,t.kt)("h3",s({},{id:"optimizeassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"optimizeAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#optimizeassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"AsyncSeriesHook")),(0,t.kt)("p",null,"优化存储在 ",(0,t.kt)("inlineCode",{parentName:"p"},"compilation.assets")," 中的所有 asset。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"assets"))),(0,t.kt)("h3",s({},{id:"afteroptimizeassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterOptimizeAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afteroptimizeassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"asset 已经优化。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"assets"))),(0,t.kt)("h3",s({},{id:"processassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"processAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#processassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"AsyncSeriesHook")),(0,t.kt)("p",null,"Asset processing."),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Callback Parameters: ",(0,t.kt)("inlineCode",{parentName:"li"},"assets"))),(0,t.kt)("p",null,"Here's an example:"),(0,t.kt)("pre",null,(0,t.kt)("code",s({parentName:"pre"},{className:"hljs language-js"}),"compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"processAssets",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"tap"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    name",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'MyPlugin'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n    stage",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," Compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token constant"}),"PROCESS_ASSETS_STAGE_ADDITIONS"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),",")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token comment"}),"// see below for more stages"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"assets"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token comment"}),"// code here"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"))),(0,t.kt)("p",null,"In addition to ",(0,t.kt)("inlineCode",{parentName:"p"},"name")," and ",(0,t.kt)("inlineCode",{parentName:"p"},"stage"),", you can pass a ",(0,t.kt)("inlineCode",{parentName:"p"},"additionalAssets")," ",(0,t.kt)(l,{text:"5.8.0+",mdxType:"Badge"})," option which accepts either a value of ",(0,t.kt)("inlineCode",{parentName:"p"},"true")," or a function with ",(0,t.kt)("inlineCode",{parentName:"p"},"assets")," as parameter:"),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"true")," - Run callback against assets added later by plugins."),(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",s({parentName:"pre"},{className:"hljs language-js"}),"compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"processAssets",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"tap"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    name",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'MyPlugin'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n    stage",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," Compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token constant"}),"PROCESS_ASSETS_STAGE_DEV_TOOLING"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n    additionalAssets",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token boolean"}),"true"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"assets"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token comment"}),"// this callback will run against assets added later by plugins."),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";")))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("p",{parentName:"li"},(0,t.kt)("inlineCode",{parentName:"p"},"(assets) => {}")," - Run this specified callback against assets added later by plugins."),(0,t.kt)("pre",{parentName:"li"},(0,t.kt)("code",s({parentName:"pre"},{className:"hljs language-js"}),"compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"hooks",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),"processAssets",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token function"}),"tap"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    name",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token string"}),"'MyPlugin'"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n    stage",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," Compilation",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"."),(0,t.kt)("span",s({parentName:"code"},{className:"token constant"}),"PROCESS_ASSETS_STAGE_DEV_TOOLING"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token function-variable function"}),"additionalAssets"),(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),":")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"assets"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n      ",(0,t.kt)("span",s({parentName:"code"},{className:"token comment"}),"// this callback will run against assets added later by plugins."),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),","),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"("),(0,t.kt)("span",s({parentName:"code"},{className:"token parameter"}),"assets"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token operator"}),"=>")," ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,t.kt)("span",s({parentName:"code"},{className:"token comment"}),"// code"),"\n  ",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),"}"),"\n",(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),")"),(0,t.kt)("span",s({parentName:"code"},{className:"token punctuation"}),";"))))),(0,t.kt)("p",null,"Here's a list of stages we can use:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_ADDITIONAL")," - Add additional assets to the compilation."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_PRE_PROCESS")," - Basic preprocessing of the assets."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_DERIVED")," - Derive new assets from the existing assets."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_ADDITIONS")," - Add additional sections to the existing assets e.g. banner or initialization code."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_OPTIMIZE")," - Optimize existing assets in a general way."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_OPTIMIZE_COUNT")," - Optimize the count of existing assets, e.g. by merging them."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_OPTIMIZE_COMPATIBILITY")," - Optimize the compatibility of existing assets, e.g. add polyfills or vendor prefixes."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_OPTIMIZE_SIZE")," - Optimize the size of existing assets, e.g. by minimizing or omitting whitespace."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_DEV_TOOLING")," - Add development tooling to the assets, e.g. by extracting a source map."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_OPTIMIZE_INLINE")," ",(0,t.kt)(l,{text:"5.8.0+",mdxType:"Badge"})," - Optimize the numbers of existing assets, e.g. by inlining assets into other assets."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_SUMMARIZE")," - Summarize the list of existing assets."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_OPTIMIZE_HASH")," - Optimize the hashes of the assets, e.g. by generating real hashes of the asset content."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_OPTIMIZE_TRANSFER")," - Optimize the transfer of existing assets, e.g. by preparing a compressed (gzip) file as separate asset."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_ANALYSE")," - Analyze the existing assets."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"PROCESS_ASSETS_STAGE_REPORT")," - Creating assets for the reporting purposes.")),(0,t.kt)("h3",s({},{id:"afterprocessassets"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterProcessAssets")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afterprocessassets","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"Called after the ",(0,t.kt)("a",s({parentName:"p"},{href:"#processassets"}),(0,t.kt)("inlineCode",{parentName:"a"},"processAssets"))," hook had finished without error."),(0,t.kt)("h3",s({},{id:"needadditionalseal"}),(0,t.kt)("inlineCode",{parentName:"h3"},"needAdditionalSeal")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#needadditionalseal","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncBailHook")),(0,t.kt)("p",null,"调用来决定 compilation 是否需要解除 seal 以引入其他文件。"),(0,t.kt)("h3",s({},{id:"afterseal"}),(0,t.kt)("inlineCode",{parentName:"h3"},"afterSeal")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#afterseal","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"AsyncSeriesHook")),(0,t.kt)("p",null,"在 ",(0,t.kt)("inlineCode",{parentName:"p"},"needAdditionalSeal")," 之后立即执行。"),(0,t.kt)("h3",s({},{id:"chunkhash"}),(0,t.kt)("inlineCode",{parentName:"h3"},"chunkHash")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#chunkhash","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"触发来为每个 chunk 生成 hash。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunk")," ",(0,t.kt)("inlineCode",{parentName:"li"},"chunkHash"))),(0,t.kt)("h3",s({},{id:"moduleasset"}),(0,t.kt)("inlineCode",{parentName:"h3"},"moduleAsset")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#moduleasset","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"一个模块中的一个 asset 被添加到 compilation 时调用。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"module")," ",(0,t.kt)("inlineCode",{parentName:"li"},"filename"))),(0,t.kt)("h3",s({},{id:"chunkasset"}),(0,t.kt)("inlineCode",{parentName:"h3"},"chunkAsset")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#chunkasset","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"一个 chunk 中的一个 asset 被添加到 compilation 时调用。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"chunk")," ",(0,t.kt)("inlineCode",{parentName:"li"},"filename"))),(0,t.kt)("h3",s({},{id:"assetpath"}),(0,t.kt)("inlineCode",{parentName:"h3"},"assetPath")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#assetpath","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncWaterfallHook")),(0,t.kt)("p",null,"调用以决定 asset 的路径。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"path")," ",(0,t.kt)("inlineCode",{parentName:"li"},"options"))),(0,t.kt)("h3",s({},{id:"needadditionalpass"}),(0,t.kt)("inlineCode",{parentName:"h3"},"needAdditionalPass")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#needadditionalpass","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncBailHook")),(0,t.kt)("p",null,"调用以决定 asset 在输出后是否需要进一步处理。"),(0,t.kt)("h3",s({},{id:"childcompiler"}),(0,t.kt)("inlineCode",{parentName:"h3"},"childCompiler")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#childcompiler","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,(0,t.kt)("inlineCode",{parentName:"p"},"SyncHook")),(0,t.kt)("p",null,"子 compiler 设置之后执行。"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"回调参数：",(0,t.kt)("inlineCode",{parentName:"li"},"childCompiler")," ",(0,t.kt)("inlineCode",{parentName:"li"},"compilerName")," ",(0,t.kt)("inlineCode",{parentName:"li"},"compilerIndex"))),(0,t.kt)("h3",s({},{id:"normalmoduleloader"}),(0,t.kt)("inlineCode",{parentName:"h3"},"normalModuleLoader")," ",(0,t.kt)("a",s({parentName:"h3"},{href:"#normalmoduleloader","aria-hidden":"true",tabIndex:-1}),(0,t.kt)("span",s({parentName:"a"},{className:"header-link"})))),(0,t.kt)("p",null,"从 webpack v5 开始，",(0,t.kt)("inlineCode",{parentName:"p"},"normalModuleLoader")," 钩子已经删除。现在要访问loader 请改用 ",(0,t.kt)("inlineCode",{parentName:"p"},"NormalModule.getCompilationHooks(compilation).loader"),"。"))}k.isMDXComponent=!0}}]);