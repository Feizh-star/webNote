(self.webpackChunk=self.webpackChunk||[]).push([[1126],{1126:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return k}}),t(7378);var n=t(5318);function s(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,n)}return t}function o(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?s(Object(t),!0).forEach((function(e){p(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function p(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}var c={};function k(a){var e=a.components,t=function(a,e){if(null==a)return{};var t,n,s=function(a,e){if(null==a)return{};var t,n,s={},o=Object.keys(a);for(n=0;n<o.length;n++)t=o[n],e.indexOf(t)>=0||(s[t]=a[t]);return s}(a,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(n=0;n<o.length;n++)t=o[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(s[t]=a[t])}return s}(a,["components"]);return(0,n.kt)("wrapper",o(o(o({},c),t),{},{components:e,mdxType:"MDXLayout"}),(0,n.kt)("hr",null),(0,n.kt)("p",null,"title: Node 接口\nsort: 2\ncontributors:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"sallar"),(0,n.kt)("li",{parentName:"ul"},"rynclark"),(0,n.kt)("li",{parentName:"ul"},"byzyk"),(0,n.kt)("li",{parentName:"ul"},"wizardofhogwarts"),(0,n.kt)("li",{parentName:"ul"},"EugeneHlushko"),(0,n.kt)("li",{parentName:"ul"},"lukasgeiter"),(0,n.kt)("li",{parentName:"ul"},"toshihidetagami"),(0,n.kt)("li",{parentName:"ul"},"chenxsan"),(0,n.kt)("li",{parentName:"ul"},"jamesgeorge007"),(0,n.kt)("li",{parentName:"ul"},"textbook")),(0,n.kt)("hr",null),(0,n.kt)("p",null,"webpack 提供了 Node.js API，可以在 Node.js 运行时下直接使用。"),(0,n.kt)("p",null,"当你需要自定义构建或开发流程时，Node.js API 非常有用，因为此时所有的报告和错误处理都必须自行实现，webpack 仅仅负责编译的部分。所以 ",(0,n.kt)("a",o({parentName:"p"},{href:"/configuration/stats"}),(0,n.kt)("inlineCode",{parentName:"a"},"stats"))," 配置选项不会在 ",(0,n.kt)("inlineCode",{parentName:"p"},"webpack()")," 调用中生效。"),(0,n.kt)("h2",o({},{id:"installation"}),"安装(Installation) ",(0,n.kt)("a",o({parentName:"h2"},{href:"#installation","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"开始使用 webpack 的 Node.js API 之前，首先你需要安装 webpack："),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-bash"}),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"npm")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"install")," --save-dev webpack")),(0,n.kt)("p",null,"在 Node.js 文件中，引入 webpack 模块:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js"}),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," webpack ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"require"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'webpack'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("p",null,"或者如果你更喜欢 ES2015:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js"}),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"import")," webpack ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"from")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'webpack'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("h2",o({},{id:"webpack"}),(0,n.kt)("inlineCode",{parentName:"h2"},"webpack()")," ",(0,n.kt)("a",o({parentName:"h2"},{href:"#webpack","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"导入的 ",(0,n.kt)("inlineCode",{parentName:"p"},"webpack")," 函数会将 ",(0,n.kt)("a",o({parentName:"p"},{href:"/configuration/"}),"配置对象")," 传给 webpack，如果同时传入回调函数会在 webpack compiler 运行时被执行:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js-with-links"}),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," webpack ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"require"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'webpack'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"webpack"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [配置对象](/configuration/)"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),",")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token parameter"}),"err",(0,n.kt)("span",o({parentName:"span"},{className:"token punctuation"}),",")," stats"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=>")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [Stats Object](#stats-object)"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"if")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"err ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"||")," stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"hasErrors"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n    ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [在这里处理错误](#error-handling)"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// 处理完成"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("blockquote",o({},{className:"tip"}),(0,n.kt)("p",{parentName:"blockquote"},"",(0,n.kt)("inlineCode",{parentName:"p"},"err"),"对象 ",(0,n.kt)("strong",{parentName:"p"},"不包含")," 编译错误，必须使用 ",(0,n.kt)("inlineCode",{parentName:"p"},"stats.hasErrors()")," 单独处理，文档的 ",(0,n.kt)("a",o({parentName:"p"},{href:"#error-handling"}),"错误处理")," 将对这部分将对此进行详细介绍。",(0,n.kt)("inlineCode",{parentName:"p"},"err")," 对象只包含 webpack 相关的问题，例如配置错误等。")),(0,n.kt)("blockquote",o({},{className:"tip"}),(0,n.kt)("p",{parentName:"blockquote"},"你也可以为 ",(0,n.kt)("inlineCode",{parentName:"p"},"webpack")," 函数提供一个配置数组。更多详细信息，请查看 ",(0,n.kt)("a",o({parentName:"p"},{href:"#multicompiler"}),"MultiCompiler")," 章节。")),(0,n.kt)("h2",o({},{id:"compiler-instance"}),"Compiler 实例（Compiler Instance） ",(0,n.kt)("a",o({parentName:"h2"},{href:"#compiler-instance","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"如果你不向 ",(0,n.kt)("inlineCode",{parentName:"p"},"webpack")," 传入可执行的回调函数，\n它会返回一个 webpack ",(0,n.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例。\n你可以通过手动执行它或者为它的构建时添加一个监听器，\n就像 ",(0,n.kt)("a",o({parentName:"p"},{href:"/api/cli/"}),"CLI")," 类似。",(0,n.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例提供了以下方法:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},".run(callback)")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("inlineCode",{parentName:"li"},".watch(watchOptions, handler)"))),(0,n.kt)("p",null,"通常情况下，仅会创建一个主要 ",(0,n.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例，\n虽然可以创建一些子 compiler 来代理到特定任务。\n",(0,n.kt)("inlineCode",{parentName:"p"},"Compiler")," 基本上只是执行最低限度的功能，以维持生命周期运行的功能。\n它将所有的加载、打包和写入工作，\n都委托到注册过的插件上。"),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例上的 ",(0,n.kt)("inlineCode",{parentName:"p"},"hooks")," 属性，用于将一个插件注册\n到 ",(0,n.kt)("inlineCode",{parentName:"p"},"Compiler")," 的生命周期中的所有钩子事件上。\n",(0,n.kt)("inlineCode",{parentName:"p"},"webpack")," 使用\n",(0,n.kt)("a",o({parentName:"p"},{href:"https://github.com/webpack/webpack/blob/master/lib/WebpackOptionsDefaulter.js"}),(0,n.kt)("inlineCode",{parentName:"a"},"WebpackOptionsDefaulter")),"\n和 ",(0,n.kt)("a",o({parentName:"p"},{href:"https://github.com/webpack/webpack/blob/master/lib/WebpackOptionsApply.js"}),(0,n.kt)("inlineCode",{parentName:"a"},"WebpackOptionsApply")),"\n来配置 ",(0,n.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例以及所有内置插件。"),(0,n.kt)("p",null,"使用 ",(0,n.kt)("inlineCode",{parentName:"p"},"run")," 方法启动所有编译工作。\n完成之后，执行传入的的 ",(0,n.kt)("inlineCode",{parentName:"p"},"callback")," 函数。\n最终记录下来的概括信息（stats）和错误（errors），都应在这个 callback 函数中获取。"),(0,n.kt)("blockquote",o({},{className:"warning"}),(0,n.kt)("p",{parentName:"blockquote"},"这个 API 一次仅支持一个编译。当使用 ",(0,n.kt)("inlineCode",{parentName:"p"},"run")," 时，\n再次调用 ",(0,n.kt)("inlineCode",{parentName:"p"},"run")," 或 ",(0,n.kt)("inlineCode",{parentName:"p"},"watch")," 之前需等待它完成。\n当使用 ",(0,n.kt)("inlineCode",{parentName:"p"},"watch")," 时，调用 ",(0,n.kt)("inlineCode",{parentName:"p"},"close"),"，并等待它完成后，\n然后才能再次调用 ",(0,n.kt)("inlineCode",{parentName:"p"},"run")," 或 ",(0,n.kt)("inlineCode",{parentName:"p"},"watch"),"。并发编译将破坏输出文件。")),(0,n.kt)("h2",o({},{id:"run"}),"执行（Run） ",(0,n.kt)("a",o({parentName:"h2"},{href:"#run","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"调用 ",(0,n.kt)("inlineCode",{parentName:"p"},"Compiler")," 实例的 ",(0,n.kt)("inlineCode",{parentName:"p"},"run")," 方法跟上文提到的\n快速执行方法很类似："),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js-with-links"}),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," webpack ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"require"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'webpack'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," compiler ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"webpack"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [配置对象](/configuration/)"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\ncompiler",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"run"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token parameter"}),"err",(0,n.kt)("span",o({parentName:"span"},{className:"token punctuation"}),",")," stats"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=>")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [Stats Object](#stats-object)"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// ..."),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("h2",o({},{id:"watching"}),"监听(Watching) ",(0,n.kt)("a",o({parentName:"h2"},{href:"#watching","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"调用 ",(0,n.kt)("inlineCode",{parentName:"p"},"watch")," 方法会触发 webpack 执行，但之后会监听变更（很像 CLI 命令: ",(0,n.kt)("inlineCode",{parentName:"p"},"webpack --watch"),"），\n一旦 webpack 检测到文件变更，就会重新执行编译。\n该方法返回一个 ",(0,n.kt)("inlineCode",{parentName:"p"},"Watching")," 实例。"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js"}),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"watch"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"watchOptions",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),",")," callback",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js-with-links"}),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," webpack ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"require"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'webpack'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," compiler ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"webpack"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [配置对象](/configuration/)"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," watching ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," compiler",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"watch"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [watchOptions](/configuration/watch/#watchoptions) 示例"),"\n  aggregateTimeout",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token number"}),"300"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),","),"\n  poll",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"undefined"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),",")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token parameter"}),"err",(0,n.kt)("span",o({parentName:"span"},{className:"token punctuation"}),",")," stats"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=>")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [Stats Object](#stats-object)"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// 这里打印 watch/build 结果..."),"\n  console",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"log"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"Watching")," 配置选项的细节可以在\n",(0,n.kt)("a",o({parentName:"p"},{href:"/configuration/watch/#watchoptions"}),"这里"),"查询。"),(0,n.kt)("blockquote",o({},{className:"warning"}),(0,n.kt)("p",{parentName:"blockquote"},"文件系统不正确的问题，可能会对单次修改触发多次构建。\n因此，在上面的示例中，一次修改可能会多次触发 ",(0,n.kt)("inlineCode",{parentName:"p"},"https://webpack.docschina.org/console.log")," 语句。\n用户应该预知此行为，\n并且可能需要检查 ",(0,n.kt)("inlineCode",{parentName:"p"},"https://webpack.docschina.org/stats.hash")," 来查看文件哈希是否确实变更。")),(0,n.kt)("h3",o({},{id:"close-watching"}),"关闭 ",(0,n.kt)("inlineCode",{parentName:"h3"},"Watching")," (Close ",(0,n.kt)("inlineCode",{parentName:"h3"},"Watching"),") ",(0,n.kt)("a",o({parentName:"h3"},{href:"#close-watching","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"watch")," 方法返回一个 ",(0,n.kt)("inlineCode",{parentName:"p"},"Watching")," 实例，该实例会暴露一个 ",(0,n.kt)("inlineCode",{parentName:"p"},".close(callback)")," 方法。\n调用该方法将会结束监听:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js"}),"watching",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"close"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=>")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  console",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"log"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'Watching Ended.'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("blockquote",o({},{className:"warning"}),(0,n.kt)("p",{parentName:"blockquote"},"不允许在监听器关闭或者失效前\n再次监听或执行。")),(0,n.kt)("h3",o({},{id:"invalidate-watching"}),"Invalidate ",(0,n.kt)("inlineCode",{parentName:"h3"},"Watching")," ",(0,n.kt)("a",o({parentName:"h3"},{href:"#invalidate-watching","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"使用 ",(0,n.kt)("inlineCode",{parentName:"p"},"watching.invalidate"),"，你可以手动使当前编译循环（compiling round）无效，\n而不会停止监听进程（process）："),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js"}),"watching",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"invalidate"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("h2",o({},{id:"stats-object"}),"Stats 对象(Stats Object) ",(0,n.kt)("a",o({parentName:"h2"},{href:"#stats-object","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"stats")," 对象会被作为 ",(0,n.kt)("a",o({parentName:"p"},{href:"#webpack"}),(0,n.kt)("inlineCode",{parentName:"a"},"webpack()"))," 回调函数的第二个参数传递，\n可以通过它获取到代码编译过程中的有用信息，\n包括："),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"错误和警告(有过有的话)"),(0,n.kt)("li",{parentName:"ul"},"计时信息"),(0,n.kt)("li",{parentName:"ul"},"module 和 chunk 信息")),(0,n.kt)("p",null,(0,n.kt)("a",o({parentName:"p"},{href:"/api/cli"}),"webpack CLI")," 正是基于这些信息在控制台\n展示友好的格式输出。"),(0,n.kt)("blockquote",o({},{className:"tip"}),(0,n.kt)("p",{parentName:"blockquote"},"当使用 ",(0,n.kt)("a",o({parentName:"p"},{href:"#multicompiler"}),(0,n.kt)("inlineCode",{parentName:"a"},"MultiCompiler"))," 时，\n会返回一个 ",(0,n.kt)("inlineCode",{parentName:"p"},"MultiStats")," 实例，\n它实现与 ",(0,n.kt)("inlineCode",{parentName:"p"},"stats")," 相同的接口，也就是下面描述的方法。")),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"stats")," 对象暴露了以下方法:"),(0,n.kt)("h3",o({},{id:"statshaserrors"}),(0,n.kt)("inlineCode",{parentName:"h3"},"stats.hasErrors()")," ",(0,n.kt)("a",o({parentName:"h3"},{href:"#statshaserrors","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"可以用来检查编译期是否有错误，\n返回值为 ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," 或 ",(0,n.kt)("inlineCode",{parentName:"p"},"false"),"。"),(0,n.kt)("h3",o({},{id:"statshaswarnings"}),(0,n.kt)("inlineCode",{parentName:"h3"},"stats.hasWarnings()")," ",(0,n.kt)("a",o({parentName:"h3"},{href:"#statshaswarnings","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"可以用来检查编译期是否有警告，\n返回值为 ",(0,n.kt)("inlineCode",{parentName:"p"},"true")," 或 ",(0,n.kt)("inlineCode",{parentName:"p"},"false"),"。"),(0,n.kt)("h3",o({},{id:"statstojsonoptions"}),(0,n.kt)("inlineCode",{parentName:"h3"},"stats.toJson(options)")," ",(0,n.kt)("a",o({parentName:"h3"},{href:"#statstojsonoptions","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"以 JSON 对象形式返回编译信息。\n",(0,n.kt)("inlineCode",{parentName:"p"},"options")," 可以是一个字符串（预设值）或是颗粒化控制的对象:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js-with-links"}),"stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"toJson"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'minimal'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),'// [更多选项如: "verbose" 等](/configuration/stats).'))),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js"}),"stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"toJson"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  assets",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token boolean"}),"false"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),","),"\n  hash",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token boolean"}),"true"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("p",null,"所有可用的配置选项和预设值都可查询 stats ",(0,n.kt)("a",o({parentName:"p"},{href:"/configuration/stats"}),"文档"),"。"),(0,n.kt)("blockquote",null,(0,n.kt)("p",{parentName:"blockquote"},"这里有\n该函数输出的\n",(0,n.kt)("a",o({parentName:"p"},{href:"https://raw.githubusercontent.com/webpack/analyse/master/app/pages/upload/example2.json"}),"示例"),"。")),(0,n.kt)("h3",o({},{id:"statstostringoptions"}),(0,n.kt)("inlineCode",{parentName:"h3"},"stats.toString(options)")," ",(0,n.kt)("a",o({parentName:"h3"},{href:"#statstostringoptions","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"以格式化的字符串形式返回描述编译信息\n（类似 ",(0,n.kt)("a",o({parentName:"p"},{href:"/api/cli"}),"CLI")," 的输出）。"),(0,n.kt)("p",null,"配置对象与 ",(0,n.kt)("a",o({parentName:"p"},{href:"/api/node/#statstojsonoptions"}),(0,n.kt)("inlineCode",{parentName:"a"},"stats.toJson(options)"))," 一致，除了额外增加的一个选项:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js"}),"stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"toString"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// 增加控制台颜色开关"),"\n  colors",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token boolean"}),"true"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("p",null,"下面是 ",(0,n.kt)("inlineCode",{parentName:"p"},"stats.toString()")," 用法的示例:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js-with-links"}),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," webpack ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"require"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'webpack'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"webpack"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [配置对象](/configuration/)"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),",")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token parameter"}),"err",(0,n.kt)("span",o({parentName:"span"},{className:"token punctuation"}),",")," stats"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=>")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"if")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"err",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n    console",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"error"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"err",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"return"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  console",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"log"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"toString"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n    chunks",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token boolean"}),"false"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),","),"  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// 使构建过程更静默无输出"),"\n    colors",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token boolean"}),"true"),"    ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// 在控制台展示颜色"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("h2",o({},{id:"multicompiler"}),"MultiCompiler ",(0,n.kt)("a",o({parentName:"h2"},{href:"#multicompiler","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,(0,n.kt)("inlineCode",{parentName:"p"},"MultiCompiler")," 模块可以让 webpack 同时执行多个配置。\n如果传给 webpack 的 Node.js API 的 ",(0,n.kt)("inlineCode",{parentName:"p"},"options")," 参数，\n该参数由是由多个配置对象构成的数组，webpack 会相应地创建多个 compiler 实例，\n并且在每次 compiler 执行结束时，都会调用 ",(0,n.kt)("inlineCode",{parentName:"p"},"callback")," 方法。"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js-with-links"}),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"var")," webpack ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"require"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'webpack'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"webpack"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"["),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," entry",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'index1.js'/*tpa=https://webpack.docschina.org/index1.js*/"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),",")," output",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," filename",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'bundle1.js'/*tpa=https://webpack.docschina.org/bundle1.js*/")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),","),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," entry",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'index2.js'/*tpa=https://webpack.docschina.org/index2.js*/"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),",")," output",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," filename",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),":")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'bundle2.js'/*tpa=https://webpack.docschina.org/bundle2.js*/")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"]"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),",")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token parameter"}),"err",(0,n.kt)("span",o({parentName:"span"},{className:"token punctuation"}),",")," stats"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=>")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [Stats Object](#stats-object)"),"\n  process",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),"stdout",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"write"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"toString"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"+")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'\\n'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"))),(0,n.kt)("blockquote",o({},{className:"warning"}),(0,n.kt)("p",{parentName:"blockquote"},"多个配置对象在执行时，",(0,n.kt)("strong",{parentName:"p"},"不会并行执行"),"。\n每个配置都只会在前一个处理结束后，才进行处理。\n想要并行处理，你可以使用第三方解决方案，\n例如 ",(0,n.kt)("a",o({parentName:"p"},{href:"https://www.npmjs.com/package/parallel-webpack"}),"parallel-webpack"),"。")),(0,n.kt)("h2",o({},{id:"error-handling"}),"错误处理(Error Handling) ",(0,n.kt)("a",o({parentName:"h2"},{href:"#error-handling","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"完备的错误处理中需要考虑以下三种类型的错误:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"致命的 wepback 错误（配置出错等）"),(0,n.kt)("li",{parentName:"ul"},"编译错误（缺失的 module，语法错误等）"),(0,n.kt)("li",{parentName:"ul"},"编译警告")),(0,n.kt)("p",null,"下面是一个覆盖这些场景的示例:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js-with-links"}),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," webpack ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"require"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'webpack'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"webpack"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// [配置对象](/configuration/)"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),",")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token parameter"}),"err",(0,n.kt)("span",o({parentName:"span"},{className:"token punctuation"}),",")," stats"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=>")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"if")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"err",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n    console",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"error"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"err",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),"stack ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"||")," err",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"if")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"err",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),"details",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n      console",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"error"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"err",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),"details",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n    ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),"\n    ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"return"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," info ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"toJson"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"if")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"hasErrors"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n    console",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"error"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"info",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),"errors",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"if")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"stats",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"hasWarnings"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n    console",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"warn"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),"info",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),"warnings",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),"\n\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// Log result..."),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("h2",o({},{id:"custom-file-systems"}),"自定义文件系统(Custom File Systems) ",(0,n.kt)("a",o({parentName:"h2"},{href:"#custom-file-systems","aria-hidden":"true",tabIndex:-1}),(0,n.kt)("span",o({parentName:"a"},{className:"header-link"})))),(0,n.kt)("p",null,"默认情况下，webpack 使用普通文件系统来读取文件并将文件写入磁盘。\n但是，还可以使用不同类型的文件系统（内存(memory), webDAV 等）来更改输入或输出行为。\n为了实现这一点，\n可以改变 ",(0,n.kt)("inlineCode",{parentName:"p"},"inputFileSystem")," 或 ",(0,n.kt)("inlineCode",{parentName:"p"},"outputFileSystem"),"。\n例如，可以使用 ",(0,n.kt)("a",o({parentName:"p"},{href:"https://github.com/streamich/memfs"}),(0,n.kt)("inlineCode",{parentName:"a"},"memfs"))," 替换默认的 ",(0,n.kt)("inlineCode",{parentName:"p"},"outputFileSystem"),"，\n以将文件写入到内存中，\n而不是写入到磁盘:"),(0,n.kt)("pre",null,(0,n.kt)("code",o({parentName:"pre"},{className:"hljs language-js"}),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," createFsFromVolume",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),",")," Volume ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"require"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'memfs'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," webpack ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"require"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'webpack'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\n",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," fs ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"createFsFromVolume"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"new")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token class-name"}),"Volume"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," compiler ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"webpack"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"/* options */")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n\ncompiler",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),"outputFileSystem ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," fs",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\ncompiler",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"run"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token parameter"}),"err",(0,n.kt)("span",o({parentName:"span"},{className:"token punctuation"}),",")," stats"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=>")," ",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"{"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token comment"}),"// 之后读取输出:"),"\n  ",(0,n.kt)("span",o({parentName:"code"},{className:"token keyword"}),"const")," content ",(0,n.kt)("span",o({parentName:"code"},{className:"token operator"}),"=")," fs",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"."),(0,n.kt)("span",o({parentName:"code"},{className:"token function"}),"readFileSync"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"("),(0,n.kt)("span",o({parentName:"code"},{className:"token string"}),"'...'"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"),"\n",(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),"}"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),")"),(0,n.kt)("span",o({parentName:"code"},{className:"token punctuation"}),";"))),(0,n.kt)("p",null,"值得一提的是，被\n",(0,n.kt)("a",o({parentName:"p"},{href:"https://github.com/webpack/webpack-dev-middleware"}),"webpack-dev-middleware"),"\n及众多其他包依赖的\n",(0,n.kt)("a",o({parentName:"p"},{href:"https://github.com/webpack/webpack-dev-server"}),"webpack-dev-server")," 就是通过这种方式，\n将你的文件神秘地隐藏起来，但却仍然可以用它们为浏览器提供服务！"),(0,n.kt)("blockquote",o({},{className:"tip"}),(0,n.kt)("p",{parentName:"blockquote"},"你指定的输出文件系统需要\n兼容 Node 自身的 ",(0,n.kt)("a",o({parentName:"p"},{href:"https://nodejs.org/api/fs.html"}),(0,n.kt)("inlineCode",{parentName:"a"},"fs"))," 模块接口，\n接口需要提供 ",(0,n.kt)("inlineCode",{parentName:"p"},"mkdirp")," 和 ",(0,n.kt)("inlineCode",{parentName:"p"},"join")," 工具方法。")))}k.isMDXComponent=!0}}]);