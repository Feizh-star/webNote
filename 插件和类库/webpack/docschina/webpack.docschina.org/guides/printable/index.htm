<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta name="theme-color" content="#2B3A42"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="robots" content="noindex,nofollow"/><title>webpack å®˜æ–¹ä¸­æ–‡æ–‡æ¡£</title><meta name="description" content="webpack æ˜¯ä¸€ä¸ªæ¨¡å—æ‰“åŒ…å™¨ã€‚å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯å°† JavaScript æ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œæ‰“åŒ…åçš„æ–‡ä»¶ç”¨äºåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼Œä½†å®ƒä¹Ÿèƒ½å¤Ÿèƒœä»»è½¬æ¢ï¼ˆtransformï¼‰ã€æ‰“åŒ…ï¼ˆbundleï¼‰æˆ–åŒ…è£¹ï¼ˆpackageï¼‰ä»»ä½•èµ„æº(resource or asset)ã€‚"/><meta property="og:site_name" content="webpack"/><meta property="og:type" content="website"/><meta property="og:title" content="webpack å®˜æ–¹ä¸­æ–‡æ–‡æ¡£"/><meta property="og:description" name="description" content="webpack æ˜¯ä¸€ä¸ªæ¨¡å—æ‰“åŒ…å™¨ã€‚å®ƒçš„ä¸»è¦ç›®æ ‡æ˜¯å°† JavaScript æ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œæ‰“åŒ…åçš„æ–‡ä»¶ç”¨äºåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ï¼Œä½†å®ƒä¹Ÿèƒ½å¤Ÿèƒœä»»è½¬æ¢ï¼ˆtransformï¼‰ã€æ‰“åŒ…ï¼ˆbundleï¼‰æˆ–åŒ…è£¹ï¼ˆpackageï¼‰ä»»ä½•èµ„æº(resource or asset)ã€‚"/><meta property="og:image" content="https://webpack.js.org/icon-pwa-512x512.d3dae4189855b3a72ff9.png"/><meta property="twitter:card" content="summary"/><meta property="twitter:site" content="@webpack"/><meta property="twitter:creator" content="@webpack"/><meta property="twitter:domain" content="https://webpack.js.org/"/><meta name="keywords" content="webpack5, webpack, webpack ä¸­æ–‡æ–‡æ¡£, å°è®°ä¸­æ–‡, docschina, docschina.org, webpack.docschina.org, doc.react-china.org, nodejs.cn, vue.docschina.org, babel.docschina.org, parceljs.docschina.org, rollup.docschina.org, koajs.docschina.org"/><link rel="icon" type="image/x-icon" href="/favicon.f326220248556af65f41.ico"/><link rel="stylesheet" href="../../index.62a0b2891bdf09ef93b2.css" tppabs="https://webpack.docschina.org/index.62a0b2891bdf09ef93b2.css"/><link rel="manifest" href="/manifest.json"/><link rel="canonical" href="https://webpack.js.org/guides/printable/"/><meta name="mobile-web-app-capable" content="yes"/><link rel="icon" sizes="192x192" href="/icon_192x192.png"/><link rel="icon" sizes="512x512" href="/icon_512x512.png"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black"/><meta name="apple-mobile-web-app-title" content="webpack"/><link rel="apple-touch-icon" href="/icon_180x180.png"/><link rel="mask-icon" href="/logo-on-white-bg.47eff95f9c01c5972f6f.svg" color="#465e69"/><meta name="msapplication-TileImage" content="/icon_150x150.png"/><meta name="msapplication-TileColor" content="#465e69"/></head><body><div id="root"><div class="site"><div class="site__header"><div class="notification-bar"><div class="container notification-bar__inner"><p>Webpack 5 ç°å·²æ­£å¼å‘å¸ƒã€‚è¯·é˜…è¯»æˆ‘ä»¬çš„ <a href="../../blog/2020-10-10-webpack-5-release/index.htm" tppabs="https://webpack.docschina.org/blog/2020-10-10-webpack-5-release/">å‘å¸ƒå…¬å‘Š</a>ã€‚å¦‚è¿˜æœªå‡†å¤‡å‡çº§ï¼Œè¯·é˜…è¯» <a href="javascript:if(confirm('https://v4.webpack.docschina.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://v4.webpack.docschina.org/'" tppabs="https://v4.webpack.docschina.org/">webpack 4 æ–‡æ¡£</a>ã€‚</p></div></div><header class="navigation   "><section class="navigation__inner"><button aria-label="Open menu" class="navigation__mobile"><svg viewBox="-62 138 25 25"><g><g><path d="M-60.2,140.2h20.9c1,0,1.8,0.8,1.8,1.8l0,0c0,1-0.8,1.8-1.8,1.8h-20.9c-1,0-1.8-0.8-1.8-1.8l0,0 C-62,141-61.2,140.2-60.2,140.2z"></path><path d="M-60.2,148.7h20.9c1,0,1.8,0.8,1.8,1.8l0,0c0,1-0.8,1.8-1.8,1.8h-20.9c-1,0-1.8-0.8-1.8-1.8l0,0 C-62,149.5-61.2,148.7-60.2,148.7z"></path><path d="M-60.2,157.2h20.9c1,0,1.8,0.8,1.8,1.8l0,0c0,1-0.8,1.8-1.8,1.8h-20.9c-1,0-1.8-0.8-1.8-1.8l0,0 C-62,158-61.2,157.2-60.2,157.2z"></path></g></g></svg></button><a class="navigation__logo" href="../../index-1.htm" tppabs="https://webpack.docschina.org/"><img class="logo" src="../../site-logo.1fcab817090e78435061.svg" tppabs="https://webpack.docschina.org/site-logo.1fcab817090e78435061.svg" alt="webpack logo"/></a><nav class="navigation__items"><a class="navigation__item  navigation__item--active" href="../../concepts/index.htm" tppabs="https://webpack.docschina.org/concepts/">ä¸­æ–‡æ–‡æ¡£</a><a class="navigation__item  " href="../../contribute/index.htm" tppabs="https://webpack.docschina.org/contribute/">å‚ä¸è´¡çŒ®</a><a class="navigation__item  " href="../../vote/index.htm" tppabs="https://webpack.docschina.org/vote/">æŠ•ç¥¨</a><a class="navigation__item  " href="../../blog/index.htm" tppabs="https://webpack.docschina.org/blog/">åšå®¢</a><a href="javascript:if(confirm('https://docschina.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docschina.org/'" tppabs="https://docschina.org/" target="_blank" rel="noopener noreferrer" class="navigation__item  ">å°è®°ä¸­æ–‡</a><a href="javascript:if(confirm('https://github.com/webpack/webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack'" tppabs="https://github.com/webpack/webpack" target="_blank" rel="noopener noreferrer" title="GitHub Repository" class="navigation__item navigation__item--icon "><svg viewBox="0 0 24 24" aria-hidden="true" fill="#fff" width="16"><path d="M12 2A10 10 0 002 12a10 10 0 006.8 9.5c.5 0 .7-.2.7-.5v-1.7C6.7 20 6.1 18 6.1 18c-.4-1.2-1-1.5-1-1.5-1-.6 0-.6 0-.6 1 0 1.5 1 1.5 1 .9 1.6 2.4 1.1 3 .9 0-.7.3-1.1.6-1.4-2.2-.2-4.6-1-4.6-4.9 0-1.1.4-2 1-2.7 0-.3-.4-1.3.2-2.7 0 0 .8-.2 2.7 1a9.4 9.4 0 015 0c2-1.2 2.8-1 2.8-1 .5 1.4.1 2.4 0 2.7.7.7 1 1.6 1 2.7 0 3.8-2.3 4.7-4.5 5 .4.2.7.8.7 1.8V21c0 .3.2.6.7.5 4-1.3 6.8-5 6.8-9.5A10 10 0 0012 2z"></path></svg></a><a href="javascript:if(confirm('https://twitter.com/webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://twitter.com/webpack'" tppabs="https://twitter.com/webpack" target="_blank" rel="noopener noreferrer" title="webpack on Twitter" class="navigation__item navigation__item--icon "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" aria-hidden="true" fill="#fff" width="16"><path d="M28 6.937c-.957.425-1.985.711-3.064.84a5.343 5.343 0 002.345-2.951 10.696 10.696 0 01-3.388 1.295 5.334 5.334 0 00-9.089 4.864A15.143 15.143 0 013.809 5.411a5.321 5.321 0 00-.721 2.683 5.33 5.33 0 002.372 4.439 5.323 5.323 0 01-2.416-.667v.067a5.335 5.335 0 004.279 5.23 5.336 5.336 0 01-2.409.092 5.34 5.34 0 004.983 3.705 10.699 10.699 0 01-6.625 2.284c-.43 0-.855-.025-1.273-.075a15.102 15.102 0 008.177 2.396c9.812 0 15.176-8.128 15.176-15.177 0-.231-.005-.461-.015-.69A10.855 10.855 0 0028 6.937z"></path></svg></a><a href="javascript:if(confirm('https://stackoverflow.com/questions/tagged/webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/tagged/webpack'" tppabs="https://stackoverflow.com/questions/tagged/webpack" target="_blank" rel="noopener noreferrer" title="webpack on Stack Overflow" class="navigation__item navigation__item--icon "><svg viewBox="0 0 24 24" aria-hidden="true" fill="#fff" width="16"><path d="M17.4 20.2v-5.4h1.8V22H3v-7.2h1.8v5.4h12.6M6.8 14.3l.3-1.7 8.8 1.8-.3 1.8-8.8-1.9m1.1-4.2l.8-1.6 8.1 3.8-.7 1.6-8.2-3.8m2.3-4l1.1-1.4 7 5.8-1.2 1.4L10 6m4.7-4L20 9l-1.4 1-5.4-7 1.4-1m-8 16.5v-1.8h9v1.8h-9z"></path></svg></a><span class="navigation__item navigation__item--icon"><nav class="dropdown navigation__languages"><button aria-haspopup="true" aria-expanded="false" aria-label="Select language"><img class="dropdown__language" alt="select language" src="../../language-icon.87a028c9bf555eeb5932.svg" tppabs="https://webpack.docschina.org/language-icon.87a028c9bf555eeb5932.svg"/><i aria-hidden="true" class="dropdown__arrow"></i></button><div class="dropdown__list "><ul><li><a href="javascript:if(confirm('https://webpack.js.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://webpack.js.org/'" tppabs="https://webpack.js.org/"><span>English</span></a></li><li><a href="../../index-1.htm" tppabs="https://webpack.docschina.org/"><span lang="zh">ä¸­æ–‡</span></a></li></ul></div></nav></span></nav><div class="navigation-search "><input type="text" class="navigation-search__input" placeholder="Search this site..." value=""/><button aria-label="Hide search box" class="navigation-search__icon navigation-search__clear"><svg viewBox="-137 138 25 25"><g transform="translate(0,-952.36218)"><path d="M-131.3,1094.4c-0.4,0-0.9,0.1-1.2,0.5c-0.7,0.7-0.7,1.7,0,2.4l5.6,5.6l-5.6,5.6c-0.7,0.7-0.7,1.7,0,2.4 c0.7,0.7,1.7,0.7,2.4,0l5.6-5.6l5.6,5.6c0.7,0.7,1.7,0.7,2.4,0c0.7-0.7,0.7-1.7,0-2.4l-5.6-5.6l5.6-5.6c0.7-0.7,0.7-1.7,0-2.4 c-0.7-0.7-1.7-0.7-2.4,0l-5.6,5.6l-5.6-5.6C-130.5,1094.5-130.9,1094.4-131.3,1094.4L-131.3,1094.4z"></path></g></svg></button><button aria-label="Show search box" class="navigation-search__icon navigation-search__search"><svg viewBox="-137 138 25 25"><g><path d="M-114.6,162.6l-7.5-7.5c-0.6-0.6-0.6-1.6,0-2.1l0,0c0.6-0.6,1.6-0.6,2.1,0l7.5,7.5c0.6,0.6,0.6,1.6,0,2.1l0,0 C-113,163.1-114,163.1-114.6,162.6z"></path><path d="M-134.1,140.9c-3.9,3.9-3.9,10.2,0,14.1s10.2,3.9,14.1,0s3.9-10.2,0-14.1S-130.2,137-134.1,140.9z M-122.1,153 c-2.7,2.7-7.1,2.7-9.8,0s-2.7-7.1,0-9.8s7.1-2.7,9.8,0C-119.4,145.9-119.4,150.2-122.1,153z"></path></g></svg></button></div></section><div class="navigation-sub"><div class="navigation-sub__inner"><a class="navigation-sub__link " title="api" content="api" href="../../api/index.htm" tppabs="https://webpack.docschina.org/api/">api</a><a class="navigation-sub__link " title="blog" content="blog" href="../../blog/index.htm" tppabs="https://webpack.docschina.org/blog/">blog</a><a class="navigation-sub__link " title="æ¦‚å¿µ" content="æ¦‚å¿µ" href="../../concepts/index.htm" tppabs="https://webpack.docschina.org/concepts/">æ¦‚å¿µ</a><a class="navigation-sub__link " title="é…ç½®" content="é…ç½®" href="../../configuration/index.htm" tppabs="https://webpack.docschina.org/configuration/">é…ç½®</a><a class="navigation-sub__link navigation-sub__link--active" title="æŒ‡å—" content="æŒ‡å—" href="../index.htm" tppabs="https://webpack.docschina.org/guides/">æŒ‡å—</a><a class="navigation-sub__link " title="loader" content="loader" href="../../loaders/index.htm" tppabs="https://webpack.docschina.org/loaders/">loader</a><a class="navigation-sub__link " title="è¿ç§»" content="è¿ç§»" href="../../migrate/index.htm" tppabs="https://webpack.docschina.org/migrate/">è¿ç§»</a><a class="navigation-sub__link " title="plugin" content="plugin" href="../../plugins/index.htm" tppabs="https://webpack.docschina.org/plugins/">plugin</a></div></div></header></div><div class="container site__content"><div class="sponsors"><a href="javascript:if(confirm('https://www.ag-grid.com/?utm_source=webpack&utm_medium=banner&utm_campaign=sponsorship  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.ag-grid.com/?utm_source=webpack&utm_medium=banner&utm_campaign=sponsorship'" tppabs="https://www.ag-grid.com/?utm_source=webpack&utm_medium=banner&utm_campaign=sponsorship" target="_blank" rel="noopener noreferrer" class="sponsors__content"><img src="../../ag-grid-logo.4fe9d34532b2c0821fc9.png" tppabs="https://webpack.docschina.org/ag-grid-logo.4fe9d34532b2c0821fc9.png"/><img class="sponsors__img__webpack" src="../../icon-square-small.85ba630cf0c5f29ae3e3.svg" tppabs="https://webpack.docschina.org/icon-square-small.85ba630cf0c5f29ae3e3.svg"/><div class="sponsors__content-cont">ag-grid is proud to partner with webpack</div></a></div><nav class="sidebar site__sidebar"><div class="sidebar__inner"><div class="sidebar__shields"><a href="javascript:if(confirm('https://github.com/webpack/webpack/releases  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack/releases'" tppabs="https://github.com/webpack/webpack/releases"><img alt="webpack shield" src="../../../img.shields.io/github/package-json/v/webpack/webpack.svg-label=webpack&style=flat-square&maxAge=3600" tppabs="https://img.shields.io/github/package-json/v/webpack/webpack.svg?label=webpack&style=flat-square&maxAge=3600"/></a></div><div class="sidebar-item sidebar-item--disabled`"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sidebar-item__toggle" width="15" height="17" fill="#175d96"><path d="M10 3.3c-.6 0-1 .4-1.1 1.1v11.2c0 .3.2.6.4.8.2.2.5.4.8.4.6 0 1-.4 1.1-1.1V4.5c0-.3-.2-.6-.4-.8-.2-.2-.5-.4-.8-.4z" color="#000" style="isolation:auto;mix-blend-mode:normal"></path></svg><a class="sidebar-item__title sidebar-link__print" href="index.htm" tppabs="https://webpack.docschina.org/guides/printable/" rel="nofollow noopener noreferrer" alt="Print" title="Print" target="_blank">Print Section<img src="../../icon-print.42ad40feec51e6f5f553.svg" tppabs="https://webpack.docschina.org/icon-print.42ad40feec51e6f5f553.svg"/></a></div><div><div class="sidebar-item  sidebar-item--disabled"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sidebar-item__toggle" width="15" height="17" fill="#175d96"><path d="M10 3.3c-.6 0-1 .4-1.1 1.1v11.2c0 .3.2.6.4.8.2.2.5.4.8.4.6 0 1-.4 1.1-1.1V4.5c0-.3-.2-.6-.4-.8-.2-.2-.5-.4-.8-.4z" color="#000" style="isolation:auto;mix-blend-mode:normal"></path></svg><a class="sidebar-item__title" href="../index.htm" tppabs="https://webpack.docschina.org/guides/">æŒ‡å—</a></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../getting-started/index.htm" tppabs="https://webpack.docschina.org/guides/getting-started/">èµ·æ­¥</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="åŸºæœ¬å®‰è£…"><a href="../getting-started/index.htm#basic-setup" tppabs="https://webpack.docschina.org/guides/getting-started/#basic-setup">åŸºæœ¬å®‰è£…</a></li><li class="sidebar-item__anchor" title="åˆ›å»ºä¸€ä¸ª bundle"><a href="../getting-started/index.htm#creating-a-bundle" tppabs="https://webpack.docschina.org/guides/getting-started/#creating-a-bundle">åˆ›å»ºä¸€ä¸ª bundle</a></li><li class="sidebar-item__anchor" title="æ¨¡å—"><a href="../getting-started/index.htm#modules" tppabs="https://webpack.docschina.org/guides/getting-started/#modules">æ¨¡å—</a></li><li class="sidebar-item__anchor" title="ä½¿ç”¨ä¸€ä¸ªé…ç½®æ–‡ä»¶"><a href="../getting-started/index.htm#using-a-configuration" tppabs="https://webpack.docschina.org/guides/getting-started/#using-a-configuration">ä½¿ç”¨ä¸€ä¸ªé…ç½®æ–‡ä»¶</a></li><li class="sidebar-item__anchor" title="npm scripts"><a href="../getting-started/index.htm#npm-scripts" tppabs="https://webpack.docschina.org/guides/getting-started/#npm-scripts">npm scripts</a></li><li class="sidebar-item__anchor" title="ç»“è®º"><a href="../getting-started/index.htm#conclusion" tppabs="https://webpack.docschina.org/guides/getting-started/#conclusion">ç»“è®º</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../asset-management/index.htm" tppabs="https://webpack.docschina.org/guides/asset-management/">ç®¡ç†èµ„æº</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="è®¾ç½®"><a href="../asset-management/index.htm#setup" tppabs="https://webpack.docschina.org/guides/asset-management/#setup">è®¾ç½®</a></li><li class="sidebar-item__anchor" title="åŠ è½½ CSS"><a href="../asset-management/index.htm#loading-css" tppabs="https://webpack.docschina.org/guides/asset-management/#loading-css">åŠ è½½ CSS</a></li><li class="sidebar-item__anchor" title="åŠ è½½ images å›¾åƒ"><a href="../asset-management/index.htm#loading-images" tppabs="https://webpack.docschina.org/guides/asset-management/#loading-images">åŠ è½½ images å›¾åƒ</a></li><li class="sidebar-item__anchor" title="åŠ è½½ fonts å­—ä½“"><a href="../asset-management/index.htm#loading-fonts" tppabs="https://webpack.docschina.org/guides/asset-management/#loading-fonts">åŠ è½½ fonts å­—ä½“</a></li><li class="sidebar-item__anchor" title="åŠ è½½æ•°æ®"><a href="../asset-management/index.htm#loading-data" tppabs="https://webpack.docschina.org/guides/asset-management/#loading-data">åŠ è½½æ•°æ®</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="è‡ªå®šä¹‰ JSON æ¨¡å— parser"><a href="../asset-management/index.htm#customize-parser-of-json-modules" tppabs="https://webpack.docschina.org/guides/asset-management/#customize-parser-of-json-modules">è‡ªå®šä¹‰ JSON æ¨¡å— parser</a></li></ul></li><li class="sidebar-item__anchor" title="å…¨å±€èµ„æº"><a href="../asset-management/index.htm#global-assets" tppabs="https://webpack.docschina.org/guides/asset-management/#global-assets">å…¨å±€èµ„æº</a></li><li class="sidebar-item__anchor" title="å›é€€å¤„ç†"><a href="../asset-management/index.htm#wrapping-up" tppabs="https://webpack.docschina.org/guides/asset-management/#wrapping-up">å›é€€å¤„ç†</a></li><li class="sidebar-item__anchor" title="ä¸‹ç¯‡æŒ‡å—"><a href="../asset-management/index.htm#next-guide" tppabs="https://webpack.docschina.org/guides/asset-management/#next-guide">ä¸‹ç¯‡æŒ‡å—</a></li><li class="sidebar-item__anchor" title="å»¶ä¼¸é˜…è¯»"><a href="../asset-management/index.htm#further-reading" tppabs="https://webpack.docschina.org/guides/asset-management/#further-reading">å»¶ä¼¸é˜…è¯»</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../output-management/index.htm" tppabs="https://webpack.docschina.org/guides/output-management/">ç®¡ç†è¾“å‡º</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="é¢„å…ˆå‡†å¤‡"><a href="../output-management/index.htm#preparation" tppabs="https://webpack.docschina.org/guides/output-management/#preparation">é¢„å…ˆå‡†å¤‡</a></li><li class="sidebar-item__anchor" title="è®¾ç½® HtmlWebpackPlugin"><a href="../output-management/index.htm#setting-up-htmlwebpackplugin" tppabs="https://webpack.docschina.org/guides/output-management/#setting-up-htmlwebpackplugin">è®¾ç½® HtmlWebpackPlugin</a></li><li class="sidebar-item__anchor" title="æ¸…ç† /dist æ–‡ä»¶å¤¹"><a href="../output-management/index.htm#cleaning-up-the-dist-folder" tppabs="https://webpack.docschina.org/guides/output-management/#cleaning-up-the-dist-folder">æ¸…ç† /dist æ–‡ä»¶å¤¹</a></li><li class="sidebar-item__anchor" title="manifest"><a href="../output-management/index.htm#the-manifest" tppabs="https://webpack.docschina.org/guides/output-management/#the-manifest">manifest</a></li><li class="sidebar-item__anchor" title="ç»“è®º"><a href="../output-management/index.htm#conclusion" tppabs="https://webpack.docschina.org/guides/output-management/#conclusion">ç»“è®º</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../development/index.htm" tppabs="https://webpack.docschina.org/guides/development/">å¼€å‘ç¯å¢ƒ</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="ä½¿ç”¨ source map"><a href="../development/index.htm#using-source-maps" tppabs="https://webpack.docschina.org/guides/development/#using-source-maps">ä½¿ç”¨ source map</a></li><li class="sidebar-item__anchor" title="é€‰æ‹©ä¸€ä¸ªå¼€å‘å·¥å…·"><a href="../development/index.htm#choosing-a-development-tool" tppabs="https://webpack.docschina.org/guides/development/#choosing-a-development-tool">é€‰æ‹©ä¸€ä¸ªå¼€å‘å·¥å…·</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="ä½¿ç”¨ watch mode(è§‚å¯Ÿæ¨¡å¼)"><a href="../development/index.htm#using-watch-mode" tppabs="https://webpack.docschina.org/guides/development/#using-watch-mode">ä½¿ç”¨ watch mode(è§‚å¯Ÿæ¨¡å¼)</a></li><li class="sidebar-item__anchor" title="ä½¿ç”¨ webpack-dev-server"><a href="../development/index.htm#using-webpack-dev-server" tppabs="https://webpack.docschina.org/guides/development/#using-webpack-dev-server">ä½¿ç”¨ webpack-dev-server</a></li><li class="sidebar-item__anchor" title="ä½¿ç”¨ webpack-dev-middleware"><a href="../development/index.htm#using-webpack-dev-middleware" tppabs="https://webpack.docschina.org/guides/development/#using-webpack-dev-middleware">ä½¿ç”¨ webpack-dev-middleware</a></li></ul></li><li class="sidebar-item__anchor" title="è°ƒæ•´æ–‡æœ¬ç¼–è¾‘å™¨"><a href="../development/index.htm#adjusting-your-text-editor" tppabs="https://webpack.docschina.org/guides/development/#adjusting-your-text-editor">è°ƒæ•´æ–‡æœ¬ç¼–è¾‘å™¨</a></li><li class="sidebar-item__anchor" title="ç»“è®º"><a href="../development/index.htm#conclusion" tppabs="https://webpack.docschina.org/guides/development/#conclusion">ç»“è®º</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../code-splitting/index.htm" tppabs="https://webpack.docschina.org/guides/code-splitting/">ä»£ç åˆ†ç¦»</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="å…¥å£èµ·ç‚¹(entry point)"><a href="../code-splitting/index.htm#entry-points" tppabs="https://webpack.docschina.org/guides/code-splitting/#entry-points">å…¥å£èµ·ç‚¹(entry point)</a></li><li class="sidebar-item__anchor" title="é˜²æ­¢é‡å¤(prevent duplication)"><a href="../code-splitting/index.htm#prevent-duplication" tppabs="https://webpack.docschina.org/guides/code-splitting/#prevent-duplication">é˜²æ­¢é‡å¤(prevent duplication)</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="å…¥å£ä¾èµ–"><a href="../code-splitting/index.htm#entry-dependencies" tppabs="https://webpack.docschina.org/guides/code-splitting/#entry-dependencies">å…¥å£ä¾èµ–</a></li><li class="sidebar-item__anchor" title="SplitChunksPlugin"><a href="../code-splitting/index.htm#splitchunksplugin" tppabs="https://webpack.docschina.org/guides/code-splitting/#splitchunksplugin">SplitChunksPlugin</a></li></ul></li><li class="sidebar-item__anchor" title="åŠ¨æ€å¯¼å…¥(dynamic import)"><a href="../code-splitting/index.htm#dynamic-imports" tppabs="https://webpack.docschina.org/guides/code-splitting/#dynamic-imports">åŠ¨æ€å¯¼å…¥(dynamic import)</a></li><li class="sidebar-item__anchor" title="é¢„è·å–/é¢„åŠ è½½æ¨¡å—(prefetch/preload module)"><a href="../code-splitting/index.htm#prefetchingpreloading-modules" tppabs="https://webpack.docschina.org/guides/code-splitting/#prefetchingpreloading-modules">é¢„è·å–/é¢„åŠ è½½æ¨¡å—(prefetch/preload module)</a></li><li class="sidebar-item__anchor" title="bundle åˆ†æ(bundle analysis)"><a href="../code-splitting/index.htm#bundle-analysis" tppabs="https://webpack.docschina.org/guides/code-splitting/#bundle-analysis">bundle åˆ†æ(bundle analysis)</a></li><li class="sidebar-item__anchor" title="ä¸‹ä¸€æ­¥"><a href="../code-splitting/index.htm#next-steps" tppabs="https://webpack.docschina.org/guides/code-splitting/#next-steps">ä¸‹ä¸€æ­¥</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../caching/index.htm" tppabs="https://webpack.docschina.org/guides/caching/">ç¼“å­˜</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="è¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶å(output filename)"><a href="../caching/index.htm#output-filenames" tppabs="https://webpack.docschina.org/guides/caching/#output-filenames">è¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶å(output filename)</a></li><li class="sidebar-item__anchor" title="æå–å¼•å¯¼æ¨¡æ¿(extracting boilerplate)"><a href="../caching/index.htm#extracting-boilerplate" tppabs="https://webpack.docschina.org/guides/caching/#extracting-boilerplate">æå–å¼•å¯¼æ¨¡æ¿(extracting boilerplate)</a></li><li class="sidebar-item__anchor" title="æ¨¡å—æ ‡è¯†ç¬¦(module identifier)"><a href="../caching/index.htm#module-identifiers" tppabs="https://webpack.docschina.org/guides/caching/#module-identifiers">æ¨¡å—æ ‡è¯†ç¬¦(module identifier)</a></li><li class="sidebar-item__anchor" title="ç»“è®º"><a href="../caching/index.htm#conclusion" tppabs="https://webpack.docschina.org/guides/caching/#conclusion">ç»“è®º</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../author-libraries/index.htm" tppabs="https://webpack.docschina.org/guides/author-libraries/">åˆ›å»º library</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="åˆ›å»ºä¸€ä¸ª library"><a href="../author-libraries/index.htm#authoring-a-library" tppabs="https://webpack.docschina.org/guides/author-libraries/#authoring-a-library">åˆ›å»ºä¸€ä¸ª library</a></li><li class="sidebar-item__anchor" title="åŸºæœ¬é…ç½®"><a href="../author-libraries/index.htm#base-configuration" tppabs="https://webpack.docschina.org/guides/author-libraries/#base-configuration">åŸºæœ¬é…ç½®</a></li><li class="sidebar-item__anchor" title="ä½¿ç”¨ source map çš„åŸºæœ¬é…ç½®"><a href="../author-libraries/index.htm#base-configuration-with-source-map" tppabs="https://webpack.docschina.org/guides/author-libraries/#base-configuration-with-source-map">ä½¿ç”¨ source map çš„åŸºæœ¬é…ç½®</a></li><li class="sidebar-item__anchor" title="å¤–éƒ¨åŒ– lodash"><a href="../author-libraries/index.htm#externalize-lodash" tppabs="https://webpack.docschina.org/guides/author-libraries/#externalize-lodash">å¤–éƒ¨åŒ– lodash</a></li><li class="sidebar-item__anchor" title="å¤–éƒ¨åŒ–çš„é™åˆ¶"><a href="../author-libraries/index.htm#external-limitations" tppabs="https://webpack.docschina.org/guides/author-libraries/#external-limitations">å¤–éƒ¨åŒ–çš„é™åˆ¶</a></li><li class="sidebar-item__anchor" title="æš´éœ² library"><a href="../author-libraries/index.htm#expose-the-library" tppabs="https://webpack.docschina.org/guides/author-libraries/#expose-the-library">æš´éœ² library</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="æœ€ç»ˆæ­¥éª¤"><a href="../author-libraries/index.htm#final-steps" tppabs="https://webpack.docschina.org/guides/author-libraries/#final-steps">æœ€ç»ˆæ­¥éª¤</a></li></ul></li></ul></div></div><div><div class="sidebar-item  sidebar-item--disabled"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sidebar-item__toggle" width="15" height="17" fill="#175d96"><path d="M10 3.3c-.6 0-1 .4-1.1 1.1v11.2c0 .3.2.6.4.8.2.2.5.4.8.4.6 0 1-.4 1.1-1.1V4.5c0-.3-.2-.6-.4-.8-.2-.2-.5-.4-.8-.4z" color="#000" style="isolation:auto;mix-blend-mode:normal"></path></svg><a class="sidebar-item__title" href="../environment-variables/index.htm" tppabs="https://webpack.docschina.org/guides/environment-variables/">ç¯å¢ƒå˜é‡</a></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../build-performance/index.htm" tppabs="https://webpack.docschina.org/guides/build-performance/">æ„å»ºæ€§èƒ½</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="é€šç”¨ç¯å¢ƒ"><a href="../build-performance/index.htm#general" tppabs="https://webpack.docschina.org/guides/build-performance/#general">é€šç”¨ç¯å¢ƒ</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬"><a href="../build-performance/index.htm#stay-up-to-date" tppabs="https://webpack.docschina.org/guides/build-performance/#stay-up-to-date">æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬</a></li><li class="sidebar-item__anchor" title="loader"><a href="../build-performance/index.htm#loaders" tppabs="https://webpack.docschina.org/guides/build-performance/#loaders">loader</a></li><li class="sidebar-item__anchor" title="å¼•å¯¼(bootstrap)"><a href="../build-performance/index.htm#bootstrap" tppabs="https://webpack.docschina.org/guides/build-performance/#bootstrap">å¼•å¯¼(bootstrap)</a></li><li class="sidebar-item__anchor" title="è§£æ"><a href="../build-performance/index.htm#resolving" tppabs="https://webpack.docschina.org/guides/build-performance/#resolving">è§£æ</a></li><li class="sidebar-item__anchor" title="dll"><a href="../build-performance/index.htm#dlls" tppabs="https://webpack.docschina.org/guides/build-performance/#dlls">dll</a></li><li class="sidebar-item__anchor" title="å°å³æ˜¯å¿«(smaller = faster)"><a href="../build-performance/index.htm#smaller--faster" tppabs="https://webpack.docschina.org/guides/build-performance/#smaller--faster">å°å³æ˜¯å¿«(smaller = faster)</a></li><li class="sidebar-item__anchor" title="worker æ± (worker pool)"><a href="../build-performance/index.htm#worker-pool" tppabs="https://webpack.docschina.org/guides/build-performance/#worker-pool">worker æ± (worker pool)</a></li><li class="sidebar-item__anchor" title="æŒä¹…åŒ–ç¼“å­˜"><a href="../build-performance/index.htm#persistent-cache" tppabs="https://webpack.docschina.org/guides/build-performance/#persistent-cache">æŒä¹…åŒ–ç¼“å­˜</a></li><li class="sidebar-item__anchor" title="è‡ªå®šä¹‰ plugin/loader"><a href="../build-performance/index.htm#custom-pluginsloaders" tppabs="https://webpack.docschina.org/guides/build-performance/#custom-pluginsloaders">è‡ªå®šä¹‰ plugin/loader</a></li><li class="sidebar-item__anchor" title="Progress plugin"><a href="../build-performance/index.htm#progress-plugin" tppabs="https://webpack.docschina.org/guides/build-performance/#progress-plugin">Progress plugin</a></li></ul></li><li class="sidebar-item__anchor" title="å¼€å‘ç¯å¢ƒ"><a href="../build-performance/index.htm#development" tppabs="https://webpack.docschina.org/guides/build-performance/#development">å¼€å‘ç¯å¢ƒ</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="å¢é‡ç¼–è¯‘"><a href="../build-performance/index.htm#incremental-builds" tppabs="https://webpack.docschina.org/guides/build-performance/#incremental-builds">å¢é‡ç¼–è¯‘</a></li><li class="sidebar-item__anchor" title="åœ¨å†…å­˜ä¸­ç¼–è¯‘"><a href="../build-performance/index.htm#compile-in-memory" tppabs="https://webpack.docschina.org/guides/build-performance/#compile-in-memory">åœ¨å†…å­˜ä¸­ç¼–è¯‘</a></li><li class="sidebar-item__anchor" title="stats.toJson åŠ é€Ÿ"><a href="../build-performance/index.htm#statstojson-speed" tppabs="https://webpack.docschina.org/guides/build-performance/#statstojson-speed">stats.toJson åŠ é€Ÿ</a></li><li class="sidebar-item__anchor" title="Devtool"><a href="../build-performance/index.htm#devtool" tppabs="https://webpack.docschina.org/guides/build-performance/#devtool">Devtool</a></li><li class="sidebar-item__anchor" title="é¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æ‰ä¼šç”¨åˆ°çš„å·¥å…·"><a href="../build-performance/index.htm#avoid-production-specific-tooling" tppabs="https://webpack.docschina.org/guides/build-performance/#avoid-production-specific-tooling">é¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æ‰ä¼šç”¨åˆ°çš„å·¥å…·</a></li><li class="sidebar-item__anchor" title="æœ€å°åŒ– entry chunk"><a href="../build-performance/index.htm#minimal-entry-chunk" tppabs="https://webpack.docschina.org/guides/build-performance/#minimal-entry-chunk">æœ€å°åŒ– entry chunk</a></li><li class="sidebar-item__anchor" title="é¿å…é¢å¤–çš„ä¼˜åŒ–æ­¥éª¤"><a href="../build-performance/index.htm#avoid-extra-optimization-steps" tppabs="https://webpack.docschina.org/guides/build-performance/#avoid-extra-optimization-steps">é¿å…é¢å¤–çš„ä¼˜åŒ–æ­¥éª¤</a></li><li class="sidebar-item__anchor" title="è¾“å‡ºç»“æœä¸æºå¸¦è·¯å¾„ä¿¡æ¯"><a href="../build-performance/index.htm#output-without-path-info" tppabs="https://webpack.docschina.org/guides/build-performance/#output-without-path-info">è¾“å‡ºç»“æœä¸æºå¸¦è·¯å¾„ä¿¡æ¯</a></li><li class="sidebar-item__anchor" title="Node.js ç‰ˆæœ¬ 8.9.10-9.11.1"><a href="../build-performance/index.htm#nodejs-versions-8910-9111" tppabs="https://webpack.docschina.org/guides/build-performance/#nodejs-versions-8910-9111">Node.js ç‰ˆæœ¬ 8.9.10-9.11.1</a></li><li class="sidebar-item__anchor" title="TypeScript loader"><a href="../build-performance/index.htm#typescript-loader" tppabs="https://webpack.docschina.org/guides/build-performance/#typescript-loader">TypeScript loader</a></li></ul></li><li class="sidebar-item__anchor" title="ç”Ÿäº§ç¯å¢ƒ"><a href="../build-performance/index.htm#production" tppabs="https://webpack.docschina.org/guides/build-performance/#production">ç”Ÿäº§ç¯å¢ƒ</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="å¤šä¸ª compilation å¯¹è±¡"><a href="../build-performance/index.htm#multiple-compilations" tppabs="https://webpack.docschina.org/guides/build-performance/#multiple-compilations">å¤šä¸ª compilation å¯¹è±¡</a></li><li class="sidebar-item__anchor" title="Source Maps"><a href="../build-performance/index.htm#source-maps" tppabs="https://webpack.docschina.org/guides/build-performance/#source-maps">Source Maps</a></li></ul></li><li class="sidebar-item__anchor" title="å·¥å…·ç›¸å…³é—®é¢˜"><a href="../build-performance/index.htm#specific-tooling-issues" tppabs="https://webpack.docschina.org/guides/build-performance/#specific-tooling-issues">å·¥å…·ç›¸å…³é—®é¢˜</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Babel"><a href="../build-performance/index.htm#babel" tppabs="https://webpack.docschina.org/guides/build-performance/#babel">Babel</a></li><li class="sidebar-item__anchor" title="TypeScript"><a href="../build-performance/index.htm#typescript" tppabs="https://webpack.docschina.org/guides/build-performance/#typescript">TypeScript</a></li><li class="sidebar-item__anchor" title="Sass"><a href="../build-performance/index.htm#sass" tppabs="https://webpack.docschina.org/guides/build-performance/#sass">Sass</a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../csp/index.htm" tppabs="https://webpack.docschina.org/guides/csp/">å†…å®¹å®‰å…¨ç­–ç•¥</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="ç¤ºä¾‹"><a href="../csp/index.htm#examples" tppabs="https://webpack.docschina.org/guides/csp/#examples">ç¤ºä¾‹</a></li><li class="sidebar-item__anchor" title="å¯ç”¨ CSP"><a href="../csp/index.htm#enabling-csp" tppabs="https://webpack.docschina.org/guides/csp/#enabling-csp">å¯ç”¨ CSP</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../development-vagrant/index.htm" tppabs="https://webpack.docschina.org/guides/development-vagrant/">å¼€å‘ - Vagrant</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="é…ç½®é¡¹ç›®"><a href="../development-vagrant/index.htm#configuring-the-project" tppabs="https://webpack.docschina.org/guides/development-vagrant/#configuring-the-project">é…ç½®é¡¹ç›®</a></li><li class="sidebar-item__anchor" title="å¯åŠ¨æœåŠ¡å™¨"><a href="../development-vagrant/index.htm#running-the-server" tppabs="https://webpack.docschina.org/guides/development-vagrant/#running-the-server">å¯åŠ¨æœåŠ¡å™¨</a></li><li class="sidebar-item__anchor" title="é…åˆ nginx çš„é«˜çº§ç”¨æ³•"><a href="../development-vagrant/index.htm#advanced-usage-with-nginx" tppabs="https://webpack.docschina.org/guides/development-vagrant/#advanced-usage-with-nginx">é…åˆ nginx çš„é«˜çº§ç”¨æ³•</a></li><li class="sidebar-item__anchor" title="ç»“è®º"><a href="../development-vagrant/index.htm#conclusion" tppabs="https://webpack.docschina.org/guides/development-vagrant/#conclusion">ç»“è®º</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../dependency-management/index.htm" tppabs="https://webpack.docschina.org/guides/dependency-management/">ä¾èµ–ç®¡ç†</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="å¸¦è¡¨è¾¾å¼çš„ require è¯­å¥"><a href="../dependency-management/index.htm#require-with-expression" tppabs="https://webpack.docschina.org/guides/dependency-management/#require-with-expression">å¸¦è¡¨è¾¾å¼çš„ require è¯­å¥</a></li><li class="sidebar-item__anchor" title="require.context"><a href="../dependency-management/index.htm#requirecontext" tppabs="https://webpack.docschina.org/guides/dependency-management/#requirecontext">require.context</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="context module API"><a href="../dependency-management/index.htm#context-module-api" tppabs="https://webpack.docschina.org/guides/dependency-management/#context-module-api">context module API</a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../installation/index.htm" tppabs="https://webpack.docschina.org/guides/installation/">å®‰è£…</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="å‰ææ¡ä»¶"><a href="../installation/index.htm#prerequisites" tppabs="https://webpack.docschina.org/guides/installation/#prerequisites">å‰ææ¡ä»¶</a></li><li class="sidebar-item__anchor" title="æœ¬åœ°å®‰è£…"><a href="../installation/index.htm#local-installation" tppabs="https://webpack.docschina.org/guides/installation/#local-installation">æœ¬åœ°å®‰è£…</a></li><li class="sidebar-item__anchor" title="å…¨å±€å®‰è£…"><a href="../installation/index.htm#global-installation" tppabs="https://webpack.docschina.org/guides/installation/#global-installation">å…¨å±€å®‰è£…</a></li><li class="sidebar-item__anchor" title="æœ€æ–°ä½“éªŒç‰ˆæœ¬"><a href="../installation/index.htm#bleeding-edge" tppabs="https://webpack.docschina.org/guides/installation/#bleeding-edge">æœ€æ–°ä½“éªŒç‰ˆæœ¬</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../scaffolding/index.htm" tppabs="https://webpack.docschina.org/guides/scaffolding/">è„šæ‰‹æ¶</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="åˆ›å»ºè„šæ‰‹æ¶"><a href="../scaffolding/index.htm#creating-a-scaffold" tppabs="https://webpack.docschina.org/guides/scaffolding/#creating-a-scaffold">åˆ›å»ºè„šæ‰‹æ¶</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="ç¼–å†™è„šæ‰‹æ¶"><a href="../scaffolding/index.htm#writing-a-scaffold" tppabs="https://webpack.docschina.org/guides/scaffolding/#writing-a-scaffold">ç¼–å†™è„šæ‰‹æ¶</a></li><li class="sidebar-item__anchor" title="æ‰§è¡Œè„šæ‰‹æ¶"><a href="../scaffolding/index.htm#running-a-scaffold" tppabs="https://webpack.docschina.org/guides/scaffolding/#running-a-scaffold">æ‰§è¡Œè„šæ‰‹æ¶</a></li></ul></li><li class="sidebar-item__anchor" title="API"><a href="../scaffolding/index.htm#api" tppabs="https://webpack.docschina.org/guides/scaffolding/#api">API</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="å¿…é€‰é¡¹"><a href="../scaffolding/index.htm#required" tppabs="https://webpack.docschina.org/guides/scaffolding/#required">å¿…é€‰é¡¹</a></li><li class="sidebar-item__anchor" title="å¯é€‰é¡¹"><a href="../scaffolding/index.htm#optional" tppabs="https://webpack.docschina.org/guides/scaffolding/#optional">å¯é€‰é¡¹</a></li><li class="sidebar-item__anchor" title="opts.env.configurationï¼ˆå¿…é€‰é¡¹ï¼‰"><a href="../scaffolding/index.htm#optsenvconfigurationrequired" tppabs="https://webpack.docschina.org/guides/scaffolding/#optsenvconfigurationrequired">opts.env.configurationï¼ˆå¿…é€‰é¡¹ï¼‰</a></li><li class="sidebar-item__anchor" title="opts.env.configuration.myObjï¼ˆå¿…é€‰é¡¹ï¼‰"><a href="../scaffolding/index.htm#optsenvconfigurationmyobj-required" tppabs="https://webpack.docschina.org/guides/scaffolding/#optsenvconfigurationmyobj-required">opts.env.configuration.myObjï¼ˆå¿…é€‰é¡¹ï¼‰</a></li><li class="sidebar-item__anchor" title="myObj.webpackOptionsï¼ˆå¿…é€‰é¡¹ï¼‰"><a href="../scaffolding/index.htm#myobjwebpackoptions-required" tppabs="https://webpack.docschina.org/guides/scaffolding/#myobjwebpackoptions-required">myObj.webpackOptionsï¼ˆå¿…é€‰é¡¹ï¼‰</a></li><li class="sidebar-item__anchor" title="writingï¼ˆå¿…é€‰é¡¹ï¼‰"><a href="../scaffolding/index.htm#writing-required" tppabs="https://webpack.docschina.org/guides/scaffolding/#writing-required">writingï¼ˆå¿…é€‰é¡¹ï¼‰</a></li><li class="sidebar-item__anchor" title="myObj.mergeï¼ˆå¯é€‰é¡¹ï¼‰"><a href="../scaffolding/index.htm#myobjmerge-optional" tppabs="https://webpack.docschina.org/guides/scaffolding/#myobjmerge-optional">myObj.mergeï¼ˆå¯é€‰é¡¹ï¼‰</a></li><li class="sidebar-item__anchor" title="myObj.topScopeï¼ˆå¯é€‰é¡¹ï¼‰"><a href="../scaffolding/index.htm#myobjtopscopeoptional" tppabs="https://webpack.docschina.org/guides/scaffolding/#myobjtopscopeoptional">myObj.topScopeï¼ˆå¯é€‰é¡¹ï¼‰</a></li><li class="sidebar-item__anchor" title="myObj.configNameï¼ˆå¯é€‰é¡¹ï¼‰"><a href="../scaffolding/index.htm#myobjconfignameoptional" tppabs="https://webpack.docschina.org/guides/scaffolding/#myobjconfignameoptional">myObj.configNameï¼ˆå¯é€‰é¡¹ï¼‰</a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../hot-module-replacement/index.htm" tppabs="https://webpack.docschina.org/guides/hot-module-replacement/">æ¨¡å—çƒ­æ›¿æ¢</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="å¯ç”¨ HMR"><a href="../hot-module-replacement/index.htm#enabling-hmr" tppabs="https://webpack.docschina.org/guides/hot-module-replacement/#enabling-hmr">å¯ç”¨ HMR</a></li><li class="sidebar-item__anchor" title="é€šè¿‡ Node.js API"><a href="../hot-module-replacement/index.htm#via-the-nodejs-api" tppabs="https://webpack.docschina.org/guides/hot-module-replacement/#via-the-nodejs-api">é€šè¿‡ Node.js API</a></li><li class="sidebar-item__anchor" title="é—®é¢˜"><a href="../hot-module-replacement/index.htm#gotchas" tppabs="https://webpack.docschina.org/guides/hot-module-replacement/#gotchas">é—®é¢˜</a></li><li class="sidebar-item__anchor" title="HMR åŠ è½½æ ·å¼"><a href="../hot-module-replacement/index.htm#hmr-with-stylesheets" tppabs="https://webpack.docschina.org/guides/hot-module-replacement/#hmr-with-stylesheets">HMR åŠ è½½æ ·å¼</a></li><li class="sidebar-item__anchor" title="å…¶ä»–ä»£ç å’Œæ¡†æ¶"><a href="../hot-module-replacement/index.htm#other-code-and-frameworks" tppabs="https://webpack.docschina.org/guides/hot-module-replacement/#other-code-and-frameworks">å…¶ä»–ä»£ç å’Œæ¡†æ¶</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../tree-shaking/index.htm" tppabs="https://webpack.docschina.org/guides/tree-shaking/">Tree Shaking</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="æ·»åŠ ä¸€ä¸ªé€šç”¨æ¨¡å—"><a href="../tree-shaking/index.htm#add-a-utility" tppabs="https://webpack.docschina.org/guides/tree-shaking/#add-a-utility">æ·»åŠ ä¸€ä¸ªé€šç”¨æ¨¡å—</a></li><li class="sidebar-item__anchor" title="å°†æ–‡ä»¶æ ‡è®°ä¸º side-effect-free(æ— å‰¯ä½œç”¨)"><a href="../tree-shaking/index.htm#mark-the-file-as-side-effect-free" tppabs="https://webpack.docschina.org/guides/tree-shaking/#mark-the-file-as-side-effect-free">å°†æ–‡ä»¶æ ‡è®°ä¸º side-effect-free(æ— å‰¯ä½œç”¨)</a></li><li class="sidebar-item__anchor" title="è§£é‡Š tree shaking å’Œ sideEffects"><a href="../tree-shaking/index.htm#clarifying-tree-shaking-and-sideeffects" tppabs="https://webpack.docschina.org/guides/tree-shaking/#clarifying-tree-shaking-and-sideeffects">è§£é‡Š tree shaking å’Œ sideEffects</a></li><li class="sidebar-item__anchor" title="å°†å‡½æ•°è°ƒç”¨æ ‡è®°ä¸ºæ— å‰¯ä½œç”¨"><a href="../tree-shaking/index.htm#mark-a-function-call-as-side-effect-free" tppabs="https://webpack.docschina.org/guides/tree-shaking/#mark-a-function-call-as-side-effect-free">å°†å‡½æ•°è°ƒç”¨æ ‡è®°ä¸ºæ— å‰¯ä½œç”¨</a></li><li class="sidebar-item__anchor" title="å‹ç¼©è¾“å‡ºç»“æœ"><a href="../tree-shaking/index.htm#minify-the-output" tppabs="https://webpack.docschina.org/guides/tree-shaking/#minify-the-output">å‹ç¼©è¾“å‡ºç»“æœ</a></li><li class="sidebar-item__anchor" title="ç»“è®º"><a href="../tree-shaking/index.htm#conclusion" tppabs="https://webpack.docschina.org/guides/tree-shaking/#conclusion">ç»“è®º</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../production/index.htm" tppabs="https://webpack.docschina.org/guides/production/">ç”Ÿäº§ç¯å¢ƒ</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="é…ç½®"><a href="../production/index.htm#setup" tppabs="https://webpack.docschina.org/guides/production/#setup">é…ç½®</a></li><li class="sidebar-item__anchor" title="NPM Scripts"><a href="../production/index.htm#npm-scripts" tppabs="https://webpack.docschina.org/guides/production/#npm-scripts">NPM Scripts</a></li><li class="sidebar-item__anchor" title="æŒ‡å®š mode"><a href="../production/index.htm#specify-the-mode" tppabs="https://webpack.docschina.org/guides/production/#specify-the-mode">æŒ‡å®š mode</a></li><li class="sidebar-item__anchor" title="å‹ç¼©(Minification)"><a href="../production/index.htm#minification" tppabs="https://webpack.docschina.org/guides/production/#minification">å‹ç¼©(Minification)</a></li><li class="sidebar-item__anchor" title="æºç æ˜ å°„(Source Mapping)"><a href="../production/index.htm#source-mapping" tppabs="https://webpack.docschina.org/guides/production/#source-mapping">æºç æ˜ å°„(Source Mapping)</a></li><li class="sidebar-item__anchor" title="å‹ç¼© CSS"><a href="../production/index.htm#minimize-css" tppabs="https://webpack.docschina.org/guides/production/#minimize-css">å‹ç¼© CSS</a></li><li class="sidebar-item__anchor" title="CLI æ›¿ä»£é€‰é¡¹"><a href="../production/index.htm#cli-alternatives" tppabs="https://webpack.docschina.org/guides/production/#cli-alternatives">CLI æ›¿ä»£é€‰é¡¹</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../lazy-loading/index.htm" tppabs="https://webpack.docschina.org/guides/lazy-loading/">æ‡’åŠ è½½</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="ç¤ºä¾‹"><a href="../lazy-loading/index.htm#example" tppabs="https://webpack.docschina.org/guides/lazy-loading/#example">ç¤ºä¾‹</a></li><li class="sidebar-item__anchor" title="æ¡†æ¶"><a href="../lazy-loading/index.htm#frameworks" tppabs="https://webpack.docschina.org/guides/lazy-loading/#frameworks">æ¡†æ¶</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../ecma-script-modules/index.htm" tppabs="https://webpack.docschina.org/guides/ecma-script-modules/">ECMAScript Modules</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Exporting"><a href="../ecma-script-modules/index.htm#exporting" tppabs="https://webpack.docschina.org/guides/ecma-script-modules/#exporting">Exporting</a></li><li class="sidebar-item__anchor" title="Importing"><a href="../ecma-script-modules/index.htm#importing" tppabs="https://webpack.docschina.org/guides/ecma-script-modules/#importing">Importing</a></li><li class="sidebar-item__anchor" title="Flagging modules are ESM"><a href="../ecma-script-modules/index.htm#flagging-modules-are-esm" tppabs="https://webpack.docschina.org/guides/ecma-script-modules/#flagging-modules-are-esm">Flagging modules are ESM</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../shimming/index.htm" tppabs="https://webpack.docschina.org/guides/shimming/">Shimming é¢„ç½®ä¾èµ–</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Shimming é¢„ç½®å…¨å±€å˜é‡"><a href="../shimming/index.htm#shimming-globals" tppabs="https://webpack.docschina.org/guides/shimming/#shimming-globals">Shimming é¢„ç½®å…¨å±€å˜é‡</a></li><li class="sidebar-item__anchor" title="ç»†ç²’åº¦ Shimming"><a href="../shimming/index.htm#granular-shimming" tppabs="https://webpack.docschina.org/guides/shimming/#granular-shimming">ç»†ç²’åº¦ Shimming</a></li><li class="sidebar-item__anchor" title="å…¨å±€ Exports"><a href="../shimming/index.htm#global-exports" tppabs="https://webpack.docschina.org/guides/shimming/#global-exports">å…¨å±€ Exports</a></li><li class="sidebar-item__anchor" title="åŠ è½½ Polyfills"><a href="../shimming/index.htm#loading-polyfills" tppabs="https://webpack.docschina.org/guides/shimming/#loading-polyfills">åŠ è½½ Polyfills</a></li><li class="sidebar-item__anchor" title="è¿›ä¸€æ­¥ä¼˜åŒ–"><a href="../shimming/index.htm#further-optimizations" tppabs="https://webpack.docschina.org/guides/shimming/#further-optimizations">è¿›ä¸€æ­¥ä¼˜åŒ–</a></li><li class="sidebar-item__anchor" title="Node å†…ç½®"><a href="../shimming/index.htm#node-built-ins" tppabs="https://webpack.docschina.org/guides/shimming/#node-built-ins">Node å†…ç½®</a></li><li class="sidebar-item__anchor" title="å…¶ä»–å·¥å…·"><a href="../shimming/index.htm#other-utilities" tppabs="https://webpack.docschina.org/guides/shimming/#other-utilities">å…¶ä»–å·¥å…·</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../typescript/index.htm" tppabs="https://webpack.docschina.org/guides/typescript/">TypeScript</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="åŸºç¡€é…ç½®"><a href="../typescript/index.htm#basic-setup" tppabs="https://webpack.docschina.org/guides/typescript/#basic-setup">åŸºç¡€é…ç½®</a></li><li class="sidebar-item__anchor" title="Loader"><a href="../typescript/index.htm#loader" tppabs="https://webpack.docschina.org/guides/typescript/#loader">Loader</a></li><li class="sidebar-item__anchor" title="Source Maps"><a href="../typescript/index.htm#source-maps" tppabs="https://webpack.docschina.org/guides/typescript/#source-maps">Source Maps</a></li><li class="sidebar-item__anchor" title="ä½¿ç”¨ç¬¬ä¸‰æ–¹ç±»åº“"><a href="../typescript/index.htm#using-third-party-libraries" tppabs="https://webpack.docschina.org/guides/typescript/#using-third-party-libraries">ä½¿ç”¨ç¬¬ä¸‰æ–¹ç±»åº“</a></li><li class="sidebar-item__anchor" title="å¯¼å…¥å…¶ä»–èµ„æº"><a href="../typescript/index.htm#importing-other-assets" tppabs="https://webpack.docschina.org/guides/typescript/#importing-other-assets">å¯¼å…¥å…¶ä»–èµ„æº</a></li><li class="sidebar-item__anchor" title="æ„å»ºæ€§èƒ½"><a href="../typescript/index.htm#build-performance" tppabs="https://webpack.docschina.org/guides/typescript/#build-performance">æ„å»ºæ€§èƒ½</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../progressive-web-application/index.htm" tppabs="https://webpack.docschina.org/guides/progressive-web-application/">æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åº</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="ç°åœ¨ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰è¿è¡Œåœ¨ç¦»çº¿ç¯å¢ƒä¸‹"><a href="../progressive-web-application/index.htm#we-dont-work-offline-now" tppabs="https://webpack.docschina.org/guides/progressive-web-application/#we-dont-work-offline-now">ç°åœ¨ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰è¿è¡Œåœ¨ç¦»çº¿ç¯å¢ƒä¸‹</a></li><li class="sidebar-item__anchor" title="æ·»åŠ  Workbox"><a href="../progressive-web-application/index.htm#adding-workbox" tppabs="https://webpack.docschina.org/guides/progressive-web-application/#adding-workbox">æ·»åŠ  Workbox</a></li><li class="sidebar-item__anchor" title="æ³¨å†Œ Service Worker"><a href="../progressive-web-application/index.htm#registering-our-service-worker" tppabs="https://webpack.docschina.org/guides/progressive-web-application/#registering-our-service-worker">æ³¨å†Œ Service Worker</a></li><li class="sidebar-item__anchor" title="ç»“è®º"><a href="../progressive-web-application/index.htm#conclusion" tppabs="https://webpack.docschina.org/guides/progressive-web-application/#conclusion">ç»“è®º</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../public-path/index.htm" tppabs="https://webpack.docschina.org/guides/public-path/">å…¬å…±è·¯å¾„</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="ç¤ºä¾‹"><a href="../public-path/index.htm#use-cases" tppabs="https://webpack.docschina.org/guides/public-path/#use-cases">ç¤ºä¾‹</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="åŸºäºç¯å¢ƒè®¾ç½®"><a href="../public-path/index.htm#environment-based" tppabs="https://webpack.docschina.org/guides/public-path/#environment-based">åŸºäºç¯å¢ƒè®¾ç½®</a></li><li class="sidebar-item__anchor" title="åœ¨è¿è¡Œæ—¶è®¾ç½®"><a href="../public-path/index.htm#on-the-fly" tppabs="https://webpack.docschina.org/guides/public-path/#on-the-fly">åœ¨è¿è¡Œæ—¶è®¾ç½®</a></li></ul></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../integrations/index.htm" tppabs="https://webpack.docschina.org/guides/integrations/">é›†æˆ</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="NPM Scripts"><a href="../integrations/index.htm#npm-scripts" tppabs="https://webpack.docschina.org/guides/integrations/#npm-scripts">NPM Scripts</a></li><li class="sidebar-item__anchor" title="Grunt"><a href="../integrations/index.htm#grunt" tppabs="https://webpack.docschina.org/guides/integrations/#grunt">Grunt</a></li><li class="sidebar-item__anchor" title="Gulp"><a href="../integrations/index.htm#gulp" tppabs="https://webpack.docschina.org/guides/integrations/#gulp">Gulp</a></li><li class="sidebar-item__anchor" title="Mocha"><a href="../integrations/index.htm#mocha" tppabs="https://webpack.docschina.org/guides/integrations/#mocha">Mocha</a></li><li class="sidebar-item__anchor" title="Karma"><a href="../integrations/index.htm#karma" tppabs="https://webpack.docschina.org/guides/integrations/#karma">Karma</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../asset-modules/index.htm" tppabs="https://webpack.docschina.org/guides/asset-modules/">èµ„æºæ¨¡å—</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Resource èµ„æº"><a href="../asset-modules/index.htm#resource-assets" tppabs="https://webpack.docschina.org/guides/asset-modules/#resource-assets">Resource èµ„æº</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å"><a href="../asset-modules/index.htm#custom-output-filename" tppabs="https://webpack.docschina.org/guides/asset-modules/#custom-output-filename">è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å</a></li></ul></li><li class="sidebar-item__anchor" title="inline èµ„æº(inlining asset)"><a href="../asset-modules/index.htm#inlining-assets" tppabs="https://webpack.docschina.org/guides/asset-modules/#inlining-assets">inline èµ„æº(inlining asset)</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="è‡ªå®šä¹‰ data URI ç”Ÿæˆå™¨"><a href="../asset-modules/index.htm#custom-data-uri-generator" tppabs="https://webpack.docschina.org/guides/asset-modules/#custom-data-uri-generator">è‡ªå®šä¹‰ data URI ç”Ÿæˆå™¨</a></li></ul></li><li class="sidebar-item__anchor" title="source èµ„æº(source asset)"><a href="../asset-modules/index.htm#source-assets" tppabs="https://webpack.docschina.org/guides/asset-modules/#source-assets">source èµ„æº(source asset)</a></li><li class="sidebar-item__anchor" title="URL èµ„æº"><a href="../asset-modules/index.htm#url-èµ„æº" tppabs="https://webpack.docschina.org/guides/asset-modules/#url-èµ„æº">URL èµ„æº</a></li><li class="sidebar-item__anchor" title="é€šç”¨èµ„æºç±»å‹"><a href="../asset-modules/index.htm#general-asset-type" tppabs="https://webpack.docschina.org/guides/asset-modules/#general-asset-type">é€šç”¨èµ„æºç±»å‹</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../entry-advanced/index.htm" tppabs="https://webpack.docschina.org/guides/entry-advanced/">entry é«˜çº§ç”¨æ³•</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="æ¯ä¸ªå…¥å£ä½¿ç”¨å¤šç§æ–‡ä»¶ç±»å‹"><a href="../entry-advanced/index.htm#multiple-file-types-per-entry" tppabs="https://webpack.docschina.org/guides/entry-advanced/#multiple-file-types-per-entry">æ¯ä¸ªå…¥å£ä½¿ç”¨å¤šç§æ–‡ä»¶ç±»å‹</a></li></ul></div></div><div><div class="sidebar-item  "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="15" height="17" fill="#175d96" class="sidebar-item__toggle"><path d="M9.2 4.5l4.5 4.7c.2.2.3.5.3.8s-.1.6-.3.8l-4.5 4.7c-.5.4-1.2.4-1.7 0-.4-.5-.4-1 0-1.6l3.8-3.9-3.8-4c-.4-.4-.4-1 0-1.5.5-.4 1.2-.4 1.7 0z"></path></svg><a class="sidebar-item__title" href="../package-exports/index.htm" tppabs="https://webpack.docschina.org/guides/package-exports/">Package exports</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="General syntax"><a href="../package-exports/index.htm#general-syntax" tppabs="https://webpack.docschina.org/guides/package-exports/#general-syntax">General syntax</a></li><li class="sidebar-item__anchor" title="Alternatives"><a href="../package-exports/index.htm#alternatives" tppabs="https://webpack.docschina.org/guides/package-exports/#alternatives">Alternatives</a></li><li class="sidebar-item__anchor" title="Conditional syntax"><a href="../package-exports/index.htm#conditional-syntax" tppabs="https://webpack.docschina.org/guides/package-exports/#conditional-syntax">Conditional syntax</a></li><li class="sidebar-item__anchor" title="Abbreviation"><a href="../package-exports/index.htm#abbreviation" tppabs="https://webpack.docschina.org/guides/package-exports/#abbreviation">Abbreviation</a></li><li class="sidebar-item__anchor" title="Notes about ordering"><a href="../package-exports/index.htm#notes-about-ordering" tppabs="https://webpack.docschina.org/guides/package-exports/#notes-about-ordering">Notes about ordering</a></li><li class="sidebar-item__anchor" title="Conditions"><a href="../package-exports/index.htm#conditions" tppabs="https://webpack.docschina.org/guides/package-exports/#conditions">Conditions</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Reference syntax"><a href="../package-exports/index.htm#reference-syntax" tppabs="https://webpack.docschina.org/guides/package-exports/#reference-syntax">Reference syntax</a></li><li class="sidebar-item__anchor" title="Optimizations"><a href="../package-exports/index.htm#optimizations" tppabs="https://webpack.docschina.org/guides/package-exports/#optimizations">Optimizations</a></li><li class="sidebar-item__anchor" title="Target environment"><a href="../package-exports/index.htm#target-environment" tppabs="https://webpack.docschina.org/guides/package-exports/#target-environment">Target environment</a></li><li class="sidebar-item__anchor" title="Conditions: Preprocessor and runtimes"><a href="../package-exports/index.htm#conditions-preprocessor-and-runtimes" tppabs="https://webpack.docschina.org/guides/package-exports/#conditions-preprocessor-and-runtimes">Conditions: Preprocessor and runtimes</a></li><li class="sidebar-item__anchor" title="Conditions: Custom"><a href="../package-exports/index.htm#conditions-custom" tppabs="https://webpack.docschina.org/guides/package-exports/#conditions-custom">Conditions: Custom</a></li></ul></li><li class="sidebar-item__anchor" title="Common patterns"><a href="../package-exports/index.htm#common-patterns" tppabs="https://webpack.docschina.org/guides/package-exports/#common-patterns">Common patterns</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Target environment independent packages"><a href="../package-exports/index.htm#target-environment-independent-packages" tppabs="https://webpack.docschina.org/guides/package-exports/#target-environment-independent-packages">Target environment independent packages</a></li><li class="sidebar-item__anchor" title="Providing devtools or production optimizations"><a href="../package-exports/index.htm#providing-devtools-or-production-optimizations" tppabs="https://webpack.docschina.org/guides/package-exports/#providing-devtools-or-production-optimizations">Providing devtools or production optimizations</a></li><li class="sidebar-item__anchor" title="Providing different versions depending on target environment"><a href="../package-exports/index.htm#providing-different-versions-depending-on-target-environment" tppabs="https://webpack.docschina.org/guides/package-exports/#providing-different-versions-depending-on-target-environment">Providing different versions depending on target environment</a></li><li class="sidebar-item__anchor" title="Combining patterns"><a href="../package-exports/index.htm#combining-patterns" tppabs="https://webpack.docschina.org/guides/package-exports/#combining-patterns">Combining patterns</a></li></ul></li><li class="sidebar-item__anchor" title="Guidelines"><a href="../package-exports/index.htm#guidelines" tppabs="https://webpack.docschina.org/guides/package-exports/#guidelines">Guidelines</a></li></ul></div></div><div class="sidebar__docs-version">You are reading webpack <!-- -->5<!-- --> documentation. Change here to:<ul><li><a rel="nofollow" href="javascript:if(confirm('https://v4.webpack.docschina.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://v4.webpack.docschina.org/'" tppabs="https://v4.webpack.docschina.org/">webpack <!-- -->4<!-- --> documentation</a></li></ul></div></div></nav><section class="page"><div class="page-links"><a class="page-links__link" href="javascript:if(confirm('https://github.com/docschina/webpack.js.org/edit/cn/src/content/guides/printable.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/docschina/webpack.js.org/edit/cn/src/content/guides/printable.md'" tppabs="https://github.com/docschina/webpack.js.org/edit/cn/src/content/guides/printable.md">ç¼–è¾‘æ­¤é¡µ<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="page-links__icon" width="12" fill="#1a6bac"><path d="M17.6 2.4C16 1 15 1.2 15 1.2l-6 6L2.2 14l-1 4.8 4.8-1 6.7-6.8 6-6s.3-1.1-1.1-2.6zm-12 14.8l-1.5.4-.7-1-1-.7.4-1.6.5-.4s.8 0 1.8 1 1 1.8 1 1.8l-.4.5z"></path></svg></a><span class="page-links__gap">|</span><button class="page-links__link page-links__print as-link" title="Print this page">æ‰“å°æ–‡æ¡£<img src="../../icon-print.42ad40feec51e6f5f553.svg" tppabs="https://webpack.docschina.org/icon-print.42ad40feec51e6f5f553.svg" alt=""/></button></div><div class="markdown"><h1>Printable</h1><div><h1 id="æŒ‡å—">æŒ‡å—<a href="#%E6%8C%87%E5%8D%97" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>æŒ‡å—ç« èŠ‚ï¼Œç”¨äºç†è§£å’ŒæŒæ¡ webpack æä¾›çš„å„ç§å·¥å…·å’Œç‰¹æ€§ã€‚é¦–å…ˆï¼Œé€šè¿‡ <a href="../getting-started/index.htm" tppabs="https://webpack.docschina.org/guides/getting-started/">èµ·æ­¥</a> è¿›è¡Œç®€å•å¯¼å…¥ã€‚</p> <p>æŒ‡å—ä¼šé€æ­¥å¸¦ä½ ç”±æµ…å…¥æ·±ã€‚æœ¬ç« èŠ‚æ›´å¤šæ˜¯ä½œä¸ºä¸€ä¸ªåˆ‡å…¥ç‚¹ï¼Œä¸€æ—¦é˜…è¯»å®Œæˆåï¼Œä½ å°±ä¼šæ›´åŠ å®¹æ˜“æ·±å…¥åˆ°å®é™…çš„ <a href="../../configuration.htm" tppabs="https://webpack.docschina.org/configuration">é…ç½®</a> æ–‡æ¡£ä¸­ã€‚</p> <blockquote class="warning"> <p>æŒ‡å—ä¸­è¿è¡Œ webpack åæ˜¾ç¤ºçš„è¾“å‡ºï¼Œå¯èƒ½å’Œæ–°ç‰ˆæœ¬çš„è¾“å‡ºç•¥æœ‰ä¸åŒã€‚è¿™æ˜¯æ„æ–™ä¹‹ä¸­çš„äº‹æƒ…ã€‚åªè¦ bundle çœ‹èµ·æ¥æ¥è¿‘ï¼Œè€Œä¸”è¿è¡Œæ­£å¸¸ï¼Œé‚£å°±æ²¡æœ‰é—®é¢˜ã€‚å¦‚æœä½ é‡åˆ°åœ¨æ–°ç‰ˆæœ¬ä¸­ï¼Œç¤ºä¾‹æ— æ³•è‰¯å¥½è¿è¡Œï¼Œè¯· <a href="javascript:if(confirm('https://github.com/webpack/webpack.js.org/issues/new/choose  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack.js.org/issues/new/choose'" tppabs="https://github.com/webpack/webpack.js.org/issues/new/choose">åˆ›å»ºä¸€ä¸ª issue</a>ï¼Œæˆ‘ä»¬å°†å°½åŠ›è§£å†³ç‰ˆæœ¬å·®å¼‚ã€‚</p> </blockquote> <h1 id="èµ·æ­¥">èµ·æ­¥<a href="#%E8%B5%B7%E6%AD%A5" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>webpack ç”¨äºç¼–è¯‘ JavaScript æ¨¡å—ã€‚ä¸€æ—¦å®Œæˆ <a href="../installation.htm" tppabs="https://webpack.docschina.org/guides/installation">å®‰è£…</a>ï¼Œä½ å°±å¯ä»¥é€šè¿‡ webpack <a href="../../api/cli.htm" tppabs="https://webpack.docschina.org/api/cli">CLI</a> æˆ– <a href="../../api/node.htm" tppabs="https://webpack.docschina.org/api/node">API</a> ä¸å…¶é…åˆäº¤äº’ã€‚å¦‚æœä½ è¿˜ä¸ç†Ÿæ‚‰ webpackï¼Œè¯·é˜…è¯» <a href="../../concepts.htm" tppabs="https://webpack.docschina.org/concepts">æ ¸å¿ƒæ¦‚å¿µ</a> å’Œ <a href="../../comparison.htm" tppabs="https://webpack.docschina.org/comparison">å¯¹æ¯”</a>ï¼Œäº†è§£ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ webpackï¼Œè€Œä¸æ˜¯ç¤¾åŒºä¸­çš„å…¶ä»–å·¥å…·ã€‚</p> <blockquote class="warning"> <p>è¿è¡Œ webpack 5 çš„ Node.js æœ€ä½ç‰ˆæœ¬æ˜¯ 10.13.0 (LTS)ã€‚</p> </blockquote> <h2 id="basic-setup">åŸºæœ¬å®‰è£… <a href="#basic-setup" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç›®å½•ï¼Œåˆå§‹åŒ– npmï¼Œç„¶å <a href="../installation.htm#local-installation" tppabs="https://webpack.docschina.org/guides/installation#local-installation">åœ¨æœ¬åœ°å®‰è£… webpack</a>ï¼Œæ¥ç€å®‰è£… <a href="javascript:if(confirm('https://github.com/webpack/webpack-cli  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack-cli'" tppabs="https://github.com/webpack/webpack-cli"><code>webpack-cli</code></a>ï¼ˆæ­¤å·¥å…·ç”¨äºåœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ webpackï¼‰ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">mkdir</span> webpack-demo
<span class="token builtin class-name">cd</span> webpack-demo
<span class="token function">npm</span> init -y
<span class="token function">npm</span> <span class="token function">install</span> webpack webpack-cli --save-dev</code></pre> <p>åœ¨æ•´ä¸ªæŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>diff</code> å—ï¼Œæ¥å±•ç¤ºå¯¹ç›®å½•ã€æ–‡ä»¶å’Œä»£ç æ‰€åšçš„ä¿®æ”¹ã€‚ä¾‹å¦‚ï¼š</p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> this is a new line you shall copy into your code
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> and this is a line to be removed from your code
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> and this is a line not to touch. </span></span></code></pre> <p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä»¥ä¸‹ç›®å½•ç»“æ„ã€æ–‡ä»¶å’Œå†…å®¹ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- index.html
</span><span class="token prefix inserted">+</span><span class="token line"> |- /src
</span><span class="token prefix inserted">+</span><span class="token line">   |- index.js</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">function</span> <span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> element <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// lodashï¼ˆç›®å‰é€šè¿‡ä¸€ä¸ª script å¼•å…¥ï¼‰å¯¹äºæ‰§è¡Œè¿™ä¸€è¡Œæ˜¯å¿…éœ€çš„</span>
  element<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> _<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Hello'</span><span class="token punctuation">,</span> <span class="token string">'webpack'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> element<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token function">component</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p><strong>index.html</strong></p> <pre><code class="hljs language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>title</span><span class="token punctuation">></span></span>èµ·æ­¥<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>title</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/lodash@4.17.20<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>./src/index.js<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre> <p>æˆ‘ä»¬è¿˜éœ€è¦è°ƒæ•´ <code>package.json</code> æ–‡ä»¶ï¼Œä»¥ä¾¿ç¡®ä¿æˆ‘ä»¬å®‰è£…åŒ…æ˜¯ <code>private(ç§æœ‰çš„)</code>ï¼Œå¹¶ä¸”ç§»é™¤ <code>main</code> å…¥å£ã€‚è¿™å¯ä»¥é˜²æ­¢æ„å¤–å‘å¸ƒä½ çš„ä»£ç ã€‚</p> <blockquote class="tip"> <p>å¦‚æœä½ æƒ³è¦äº†è§£ <code>package.json</code> å†…åœ¨æœºåˆ¶çš„æ›´å¤šä¿¡æ¯ï¼Œæˆ‘ä»¬æ¨èé˜…è¯» <a href="javascript:if(confirm('https://docs.npmjs.com/files/package.json  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docs.npmjs.com/files/package.json'" tppabs="https://docs.npmjs.com/files/package.json">npm æ–‡æ¡£</a>ã€‚</p> </blockquote> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  "main": "index.js",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  "private": true,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.4.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.2.0"
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œ<code>&#x3C;script></code> æ ‡ç­¾ä¹‹é—´å­˜åœ¨éšå¼ä¾èµ–å…³ç³»ã€‚åœ¨ <code>index.js</code> æ–‡ä»¶æ‰§è¡Œä¹‹å‰ï¼Œè¿˜éœ€è¦åœ¨é¡µé¢ä¸­å…ˆå¼•å…¥ <code>lodash</code>ã€‚è¿™æ˜¯å› ä¸º <code>index.js</code> å¹¶æœªæ˜¾å¼å£°æ˜å®ƒéœ€è¦ <code>lodash</code>ï¼Œåªæ˜¯å‡å®šæ¨æµ‹å·²ç»å­˜åœ¨ä¸€ä¸ªå…¨å±€å˜é‡ <code>_</code>ã€‚</p> <p>ä½¿ç”¨è¿™ç§æ–¹å¼å»ç®¡ç† JavaScript é¡¹ç›®ä¼šæœ‰ä¸€äº›é—®é¢˜ï¼š</p> <ul> <li>æ— æ³•ç›´æ¥ä½“ç°ï¼Œè„šæœ¬çš„æ‰§è¡Œä¾èµ–äºå¤–éƒ¨åº“ã€‚</li> <li>å¦‚æœä¾èµ–ä¸å­˜åœ¨ï¼Œæˆ–è€…å¼•å…¥é¡ºåºé”™è¯¯ï¼Œåº”ç”¨ç¨‹åºå°†æ— æ³•æ­£å¸¸è¿è¡Œã€‚</li> <li>å¦‚æœä¾èµ–è¢«å¼•å…¥ä½†æ˜¯å¹¶æ²¡æœ‰ä½¿ç”¨ï¼Œæµè§ˆå™¨å°†è¢«è¿«ä¸‹è½½æ— ç”¨ä»£ç ã€‚</li> </ul> <p>è®©æˆ‘ä»¬ä½¿ç”¨ webpack æ¥ç®¡ç†è¿™äº›è„šæœ¬ã€‚</p> <h2 id="creating-a-bundle">åˆ›å»ºä¸€ä¸ª bundle <a href="#creating-a-bundle" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é¦–å…ˆï¼Œæˆ‘ä»¬ç¨å¾®è°ƒæ•´ä¸‹ç›®å½•ç»“æ„ï¼Œåˆ›å»ºåˆ†å‘ä»£ç (<code>./dist</code>)æ–‡ä»¶å¤¹ç”¨äºå­˜æ”¾åˆ†å‘ä»£ç ï¼Œæºä»£ç (<code>./src</code>)æ–‡ä»¶å¤¹ä»å­˜æ”¾æºä»£ç ã€‚æºä»£ç æ˜¯æŒ‡ç”¨äºä¹¦å†™å’Œç¼–è¾‘çš„ä»£ç ã€‚åˆ†å‘ä»£ç æ˜¯æŒ‡åœ¨æ„å»ºè¿‡ç¨‹ä¸­ï¼Œç»è¿‡æœ€å°åŒ–å’Œä¼˜åŒ–åäº§ç”Ÿçš„è¾“å‡ºç»“æœï¼Œæœ€ç»ˆå°†åœ¨æµè§ˆå™¨ä¸­åŠ è½½ã€‚è°ƒæ•´åç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- /dist
</span><span class="token prefix inserted">+</span><span class="token line">   |- index.html
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> |- index.html
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js</span></span></code></pre> <blockquote class="tip"> <p>ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½ä¸éš¾å‘ç°ï¼Œå°½ç®¡ <code>index.html</code> ç›®å‰æ”¾åœ¨ <code>dist</code> ç›®å½•ä¸‹ï¼Œä½†å®ƒæ˜¯æ‰‹åŠ¨åˆ›å»ºçš„ã€‚åœ¨æœ¬æŒ‡å—æ¥ä¸‹æ¥çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬ä¼šæ•™ä½ å¦‚ä½•ç”Ÿæˆ <code>index.html</code> è€Œéæ‰‹åŠ¨ç¼–è¾‘å®ƒã€‚å¦‚æ­¤åšï¼Œä¾¿å¯å®‰å…¨åœ°æ¸…ç©º <code>dist</code> ç›®å½•å¹¶é‡æ–°ç”Ÿæˆç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚</p> </blockquote> <p>è¦åœ¨ <code>index.js</code> ä¸­æ‰“åŒ… <code>lodash</code> ä¾èµ–ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°å®‰è£… libraryï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save lodash</code></pre> <blockquote class="tip"> <p>åœ¨å®‰è£…ä¸€ä¸ª packageï¼Œè€Œæ­¤ package è¦æ‰“åŒ…åˆ°ç”Ÿäº§ç¯å¢ƒ bundle ä¸­æ—¶ï¼Œä½ åº”è¯¥ä½¿ç”¨ <code>npm install --save</code>ã€‚å¦‚æœä½ åœ¨å®‰è£…ä¸€ä¸ªç”¨äºå¼€å‘ç¯å¢ƒçš„ package æ—¶ï¼ˆä¾‹å¦‚ï¼Œlinter, æµ‹è¯•åº“ç­‰ï¼‰ï¼Œä½ åº”è¯¥ä½¿ç”¨ <code>npm install --save-dev</code>ã€‚æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹ <a href="javascript:if(confirm('https://docs.npmjs.com/cli/install  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docs.npmjs.com/cli/install'" tppabs="https://docs.npmjs.com/cli/install">npm æ–‡æ¡£</a>ã€‚</p> </blockquote> <p>ç°åœ¨ï¼Œåœ¨æˆ‘ä»¬çš„ script ä¸­ import <code>lodash</code>ï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import _ from 'lodash';
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  // lodashï¼ˆç›®å‰é€šè¿‡ä¸€ä¸ª script å¼•å…¥ï¼‰å¯¹äºæ‰§è¡Œè¿™ä¸€è¡Œæ˜¯å¿…éœ€çš„
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  // lodashï¼Œç°åœ¨é€šè¿‡ä¸€ä¸ª script å¼•å…¥
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¼šæ‰“åŒ…æ‰€æœ‰è„šæœ¬ï¼Œæˆ‘ä»¬å¿…é¡»æ›´æ–° <code>index.html</code> æ–‡ä»¶ã€‚ç”±äºç°åœ¨æ˜¯é€šè¿‡ <code>import</code> å¼•å…¥ lodashï¼Œæ‰€ä»¥è¦å°† lodash <code>&#x3C;script></code> åˆ é™¤ï¼Œç„¶åä¿®æ”¹å¦ä¸€ä¸ª <code>&#x3C;script></code> æ ‡ç­¾æ¥åŠ è½½ bundleï¼Œè€Œä¸æ˜¯åŸå§‹çš„ <code>./src</code> æ–‡ä»¶ï¼š</p> <p><strong>dist/index.html</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&#x3C;!DOCTYPE html>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;html>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;head>
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;meta charset="utf-8" />
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;title>èµ·æ­¥&#x3C;/title>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="https://unpkg.com/lodash@4.17.20">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/head>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;body>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="./src/index.js">&#x3C;/script>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="main.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/body>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;/html></span></span></code></pre> <p>åœ¨è¿™ä¸ªè®¾ç½®ä¸­ï¼Œ<code>index.js</code> æ˜¾å¼è¦æ±‚å¼•å…¥çš„ <code>lodash</code> å¿…é¡»å­˜åœ¨ï¼Œç„¶åå°†å®ƒç»‘å®šä¸º <code>_</code>ï¼ˆæ²¡æœ‰å…¨å±€ä½œç”¨åŸŸæ±¡æŸ“ï¼‰ã€‚é€šè¿‡å£°æ˜æ¨¡å—æ‰€éœ€çš„ä¾èµ–ï¼Œwebpack èƒ½å¤Ÿåˆ©ç”¨è¿™äº›ä¿¡æ¯å»æ„å»ºä¾èµ–å›¾ï¼Œç„¶åä½¿ç”¨å›¾ç”Ÿæˆä¸€ä¸ªä¼˜åŒ–è¿‡çš„ bundleï¼Œå¹¶ä¸”ä¼šä»¥æ­£ç¡®é¡ºåºæ‰§è¡Œã€‚</p> <p>å¯ä»¥è¿™æ ·è¯´ï¼Œæ‰§è¡Œ <code>npx webpack</code>ï¼Œä¼šå°†æˆ‘ä»¬çš„è„šæœ¬ <code>src/index.js</code> ä½œä¸º <a href="../../concepts/entry-points.htm" tppabs="https://webpack.docschina.org/concepts/entry-points">å…¥å£èµ·ç‚¹</a>ï¼Œä¹Ÿä¼šç”Ÿæˆ <code>dist/main.js</code> ä½œä¸º <a href="../../concepts/output.htm" tppabs="https://webpack.docschina.org/concepts/output">è¾“å‡º</a>ã€‚Node 8.2/npm 5.2.0 ä»¥ä¸Šç‰ˆæœ¬æä¾›çš„ <code>npx</code> å‘½ä»¤ï¼Œå¯ä»¥è¿è¡Œåœ¨åˆæ¬¡å®‰è£…çš„ webpack package ä¸­çš„ webpack äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå³ <code>./node_modules/.bin/webpack</code>ï¼‰ï¼š</p> <pre><code class="hljs language-bash">$ npx webpack
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset main.js <span class="token number">69.3</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1000</span> bytes <span class="token number">5</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1851</span> ms</code></pre> <blockquote class="tip"> <p>è¾“å‡ºå¯èƒ½ä¼šç¨æœ‰ä¸åŒï¼Œä½†æ˜¯åªè¦æ„å»ºæˆåŠŸï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥æ”¾å¿ƒç»§ç»­ã€‚</p> </blockquote> <p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>dist</code> ç›®å½•ä¸‹çš„ <code>index.html</code>ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°ä»¥ä¸‹æ–‡æœ¬ï¼š<code>'Hello webpack'</code>ã€‚</p> <h2 id="modules">æ¨¡å— <a href="#modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="javascript:if(confirm('https://babeljs.io/learn-es2015/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://babeljs.io/learn-es2015/'" tppabs="https://babeljs.io/learn-es2015/">ES2015</a> ä¸­çš„ <a href="javascript:if(confirm('https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import'" tppabs="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import"><code>import</code></a> å’Œ <a href="javascript:if(confirm('https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export'" tppabs="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export"><code>export</code></a> è¯­å¥å·²ç»è¢«æ ‡å‡†åŒ–ã€‚è™½ç„¶å¤§å¤šæ•°æµè§ˆå™¨è¿˜æ— æ³•æ”¯æŒå®ƒä»¬ï¼Œä½†æ˜¯ webpack å´èƒ½å¤Ÿæä¾›å¼€ç®±å³ç”¨èˆ¬çš„æ”¯æŒã€‚</p> <p>äº‹å®ä¸Šï¼Œwebpack åœ¨å¹•åä¼šå°†ä»£ç â€œ<strong>è½¬è¯‘</strong>â€ï¼Œä»¥ä¾¿æ—§ç‰ˆæœ¬æµè§ˆå™¨å¯ä»¥æ‰§è¡Œã€‚å¦‚æœä½ æ£€æŸ¥ <code>dist/main.js</code>ï¼Œä½ å¯ä»¥çœ‹åˆ° webpack å…·ä½“å¦‚ä½•å®ç°ï¼Œè¿™æ˜¯ç‹¬åˆ›ç²¾å·§çš„è®¾è®¡ï¼é™¤äº† <code>import</code> å’Œ <code>export</code>ï¼Œwebpack è¿˜èƒ½å¤Ÿå¾ˆå¥½åœ°æ”¯æŒå¤šç§å…¶ä»–æ¨¡å—è¯­æ³•ï¼Œæ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹ <a href="../../api/module-methods.htm" tppabs="https://webpack.docschina.org/api/module-methods">æ¨¡å— API</a>ã€‚</p> <p>æ³¨æ„ï¼Œwebpack ä¸ä¼šæ›´æ”¹ä»£ç ä¸­é™¤ <code>import</code> å’Œ <code>export</code> è¯­å¥ä»¥å¤–çš„éƒ¨åˆ†ã€‚å¦‚æœä½ åœ¨ä½¿ç”¨å…¶å®ƒ <a href="javascript:if(confirm('http://es6-features.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://es6-features.org/'" tppabs="http://es6-features.org/">ES2015 ç‰¹æ€§</a>ï¼Œè¯·ç¡®ä¿ä½ åœ¨ webpack <a href="../../concepts/loaders/index.htm" tppabs="https://webpack.docschina.org/concepts/loaders/">loader ç³»ç»Ÿ</a> ä¸­ä½¿ç”¨äº†ä¸€ä¸ªåƒæ˜¯ <a href="javascript:if(confirm('https://babel.docschina.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://babel.docschina.org/'" tppabs="https://babel.docschina.org/">Babel</a> æˆ– <a href="javascript:if(confirm('https://buble.surge.sh/guide/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://buble.surge.sh/guide/'" tppabs="https://buble.surge.sh/guide/">BublÃ©</a> çš„ <a href="../../loaders/index.htm#transpiling" tppabs="https://webpack.docschina.org/loaders/#transpiling">transpiler(è½¬è¯‘å™¨)</a>ã€‚</p> <h2 id="using-a-configuration">ä½¿ç”¨ä¸€ä¸ªé…ç½®æ–‡ä»¶ <a href="#using-a-configuration" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨ webpack v4 ä¸­ï¼Œå¯ä»¥æ— é¡»ä»»ä½•é…ç½®ï¼Œç„¶è€Œå¤§å¤šæ•°é¡¹ç›®ä¼šéœ€è¦å¾ˆå¤æ‚çš„è®¾ç½®ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ webpack ä»ç„¶è¦æ”¯æŒ <a href="../../concepts/configuration.htm" tppabs="https://webpack.docschina.org/concepts/configuration">é…ç½®æ–‡ä»¶</a>ã€‚è¿™æ¯”åœ¨ terminal(ç»ˆç«¯) ä¸­æ‰‹åŠ¨è¾“å…¥å¤§é‡å‘½ä»¤è¦é«˜æ•ˆçš„å¤šï¼Œæ‰€ä»¥è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- webpack.config.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js</span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'main.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡æ–°çš„é…ç½®æ–‡ä»¶å†æ¬¡æ‰§è¡Œæ„å»ºï¼š</p> <pre><code class="hljs language-bash">$ npx webpack --config webpack.config.js 
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset main.js <span class="token number">69.3</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1000</span> bytes <span class="token number">5</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1934</span> ms</code></pre> <blockquote class="tip"> <p>å¦‚æœ <code>webpack.config.js</code> å­˜åœ¨ï¼Œåˆ™ <code>webpack</code> å‘½ä»¤å°†é»˜è®¤é€‰æ‹©ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ <code>--config</code> é€‰é¡¹åªæ˜¯å‘ä½ è¡¨æ˜ï¼Œå¯ä»¥ä¼ é€’ä»»ä½•åç§°çš„é…ç½®æ–‡ä»¶ã€‚è¿™å¯¹äºéœ€è¦æ‹†åˆ†æˆå¤šä¸ªæ–‡ä»¶çš„å¤æ‚é…ç½®æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p> </blockquote> <p>æ¯”èµ· CLI è¿™ç§ç®€å•ç›´æ¥çš„ä½¿ç”¨æ–¹å¼ï¼Œé…ç½®æ–‡ä»¶å…·æœ‰æ›´å¤šçš„çµæ´»æ€§ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®æ–¹å¼æŒ‡å®š loader è§„åˆ™(loader rule)ã€plugin(æ’ä»¶)ã€resolve é€‰é¡¹ï¼Œä»¥åŠè®¸å¤šå…¶ä»–å¢å¼ºåŠŸèƒ½ã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·æŸ¥çœ‹ <a href="../../configuration.htm" tppabs="https://webpack.docschina.org/configuration">é…ç½®æ–‡æ¡£</a>ã€‚</p> <h2 id="npm-scripts">npm scripts <a href="#npm-scripts" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>è€ƒè™‘åˆ°ç”¨ CLI è¿™ç§æ–¹å¼æ¥è¿è¡Œæœ¬åœ°çš„ webpack å‰¯æœ¬å¹¶ä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªå¿«æ·æ–¹å¼ã€‚è°ƒæ•´ <em>package.json</em> æ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ª <a href="javascript:if(confirm('https://docs.npmjs.com/misc/scripts  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docs.npmjs.com/misc/scripts'" tppabs="https://docs.npmjs.com/misc/scripts">npm script</a>ï¼š</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "private": true,
</span><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1"
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1",
</span><span class="token prefix inserted">+</span><span class="token line">    "build": "webpack"
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.4.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.2.0"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "dependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "lodash": "^4.17.20"
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>ç°åœ¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>npm run build</code> å‘½ä»¤ï¼Œæ¥æ›¿ä»£æˆ‘ä»¬ä¹‹å‰ä½¿ç”¨çš„ <code>npx</code> å‘½ä»¤ã€‚æ³¨æ„ï¼Œä½¿ç”¨ npm <code>scripts</code>ï¼Œæˆ‘ä»¬å¯ä»¥åƒä½¿ç”¨ <code>npx</code> é‚£æ ·é€šè¿‡æ¨¡å—åå¼•ç”¨æœ¬åœ°å®‰è£…çš„ npm packagesã€‚è¿™æ˜¯å¤§å¤šæ•°åŸºäº npm çš„é¡¹ç›®éµå¾ªçš„æ ‡å‡†ï¼Œå› ä¸ºå®ƒå…è®¸æ‰€æœ‰è´¡çŒ®è€…ä½¿ç”¨åŒä¸€ç»„é€šç”¨è„šæœ¬ã€‚</p> <p>ç°åœ¨è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç„¶åçœ‹çœ‹ä½ çš„è„šæœ¬åˆ«åæ˜¯å¦æ­£å¸¸è¿è¡Œï¼š</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>.

<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset main.js <span class="token number">69.3</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1000</span> bytes <span class="token number">5</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1940</span> ms</code></pre> <blockquote class="tip"> <p>Custom parameters can be passed to webpack by adding two dashes between the <code>npm run build</code> command and your parameters, e.g. <code>npm run build -- --color</code>.</p> </blockquote> <h2 id="conclusion">ç»“è®º <a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç°åœ¨ï¼Œä½ å·²ç»æœ‰äº†ä¸€ä¸ªåŸºç¡€æ„å»ºé…ç½®ï¼Œä½ åº”è¯¥ç§»è‡³ä¸‹ä¸€ç« èŠ‚ <a href="../asset-management.htm" tppabs="https://webpack.docschina.org/guides/asset-management"><code>èµ„æºç®¡ç†</code></a> æŒ‡å—ï¼Œä»¥äº†è§£å¦‚ä½•é€šè¿‡ webpack æ¥ç®¡ç†èµ„æºï¼Œä¾‹å¦‚ imagesã€fontsã€‚æ­¤åˆ»ä½ çš„é¡¹ç›®çœ‹èµ·æ¥åº”è¯¥å¦‚ä¸‹ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- main.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- index.html
</span></span>|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span>|- /node_modules</code></pre> <blockquote class="tip"> <p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ npm 5+ï¼Œä½ å¯èƒ½è¿˜ä¼šåœ¨ç›®å½•ä¸­çœ‹åˆ°ä¸€ä¸ª <code>package-lock.json</code> æ–‡ä»¶ã€‚</p> </blockquote> <blockquote class="warning"> <p>ä¸è¦ä½¿ç”¨ webpack ç¼–è¯‘ä¸å¯ä¿¡çš„ä»£ç ã€‚å®ƒå¯èƒ½ä¼šåœ¨ä½ çš„è®¡ç®—æœºï¼Œè¿œç¨‹æœåŠ¡å™¨æˆ–è€…åœ¨ä½  web åº”ç”¨ç¨‹åºä½¿ç”¨è€…çš„æµè§ˆå™¨ä¸­æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p> </blockquote> <p>å¦‚æœæƒ³è¦äº†è§£ webpack è®¾è®¡æ€æƒ³ï¼Œä½ åº”è¯¥çœ‹ä¸‹ <a href="../../concepts.htm" tppabs="https://webpack.docschina.org/concepts">åŸºæœ¬æ¦‚å¿µ</a> å’Œ <a href="../../configuration.htm" tppabs="https://webpack.docschina.org/configuration">é…ç½®</a> é¡µé¢ã€‚æ­¤å¤–ï¼Œ<a href="../../api.htm" tppabs="https://webpack.docschina.org/api">API</a> ç« èŠ‚å¯ä»¥æ·±å…¥äº†è§£ webpack æä¾›çš„å„ç§æ¥å£ã€‚</p> <h1 id="ç®¡ç†èµ„æº">ç®¡ç†èµ„æº<a href="#%E7%AE%A1%E7%90%86%E8%B5%84%E6%BA%90" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>å¦‚æœä½ æ˜¯ä»å¼€å§‹ä¸€ç›´åœ¨æ²¿ç”¨æŒ‡å—çš„ç¤ºä¾‹ï¼Œç°åœ¨ä¼šæœ‰ä¸€ä¸ªå°é¡¹ç›®ï¼Œæ˜¾ç¤ºÂ "Hello webpack"ã€‚ç°åœ¨æˆ‘ä»¬å°è¯•æ··åˆä¸€äº›å…¶ä»–èµ„æºï¼Œæ¯”å¦‚ imagesï¼Œçœ‹çœ‹ webpack å¦‚ä½•å¤„ç†ã€‚</p> <p>åœ¨ webpack å‡ºç°ä¹‹å‰ï¼Œå‰ç«¯å¼€å‘äººå‘˜ä¼šä½¿ç”¨ <a href="javascript:if(confirm('https://gruntjs.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://gruntjs.com/'" tppabs="https://gruntjs.com/">grunt</a> å’Œ <a href="javascript:if(confirm('https://gulpjs.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://gulpjs.com/'" tppabs="https://gulpjs.com/">gulp</a> ç­‰å·¥å…·æ¥å¤„ç†èµ„æºï¼Œå¹¶å°†å®ƒä»¬ä» <code>/src</code> æ–‡ä»¶å¤¹ç§»åŠ¨åˆ° <code>/dist</code> æˆ– <code>/build</code> ç›®å½•ä¸­ã€‚JavaScript æ¨¡å—ä¹Ÿéµå¾ªåŒæ ·æ–¹å¼ï¼Œä½†æ˜¯ï¼Œåƒ webpack è¿™æ ·çš„å·¥å…·ï¼Œå°†__åŠ¨æ€æ‰“åŒ…__æ‰€æœ‰ä¾èµ–ï¼ˆåˆ›å»ºæ‰€è°“çš„ <a href="../../concepts/dependency-graph.htm" tppabs="https://webpack.docschina.org/concepts/dependency-graph">ä¾èµ–å›¾(dependency graph)</a>ï¼‰ã€‚è¿™æ˜¯æå¥½çš„åˆ›ä¸¾ï¼Œå› ä¸ºç°åœ¨æ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥_æ˜ç¡®è¡¨è¿°å®ƒè‡ªèº«çš„ä¾èµ–_ï¼Œå¯ä»¥é¿å…æ‰“åŒ…æœªä½¿ç”¨çš„æ¨¡å—ã€‚</p> <p>webpack æœ€å‡ºè‰²çš„åŠŸèƒ½ä¹‹ä¸€å°±æ˜¯ï¼Œé™¤äº†å¼•å…¥ JavaScriptï¼Œè¿˜å¯ä»¥é€šè¿‡ loader æˆ–å†…ç½®çš„ <a href="../asset-modules/index.htm" tppabs="https://webpack.docschina.org/guides/asset-modules/">Asset Modules</a> <em>å¼•å…¥ä»»ä½•å…¶ä»–ç±»å‹çš„æ–‡ä»¶</em>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥ä¸Šåˆ—å‡ºçš„é‚£äº› JavaScript çš„ä¼˜ç‚¹ï¼ˆä¾‹å¦‚æ˜¾å¼ä¾èµ–ï¼‰ï¼ŒåŒæ ·å¯ä»¥ç”¨æ¥æ„å»º web ç«™ç‚¹æˆ– web åº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰é JavaScript å†…å®¹ã€‚è®©æˆ‘ä»¬ä» CSS å¼€å§‹èµ·æ­¥ï¼Œæˆ–è®¸ä½ å¯èƒ½å·²ç»ç†Ÿæ‚‰äº†ä¸‹é¢è¿™äº›è®¾ç½®ã€‚</p> <h2 id="setup">è®¾ç½® <a href="#setup" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å¯¹é¡¹ç›®åšä¸€ä¸ªå°çš„ä¿®æ”¹ï¼š</p> <p><strong>dist/index.html</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&#x3C;!DOCTYPE html>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;html>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;head>
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;meta charset="utf-8" />
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;title>èµ·æ­¥&#x3C;/title>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;title>ç®¡ç†èµ„æº&#x3C;/title>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/head>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;body>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="main.js">&#x3C;/script>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="bundle.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/body>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;/html></span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    filename: 'main.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename: 'bundle.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <h2 id="loading-css">åŠ è½½ CSS <a href="#loading-css" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä¸ºäº†åœ¨ JavaScript æ¨¡å—ä¸­ <code>import</code> ä¸€ä¸ª CSS æ–‡ä»¶ï¼Œä½ éœ€è¦å®‰è£… <a href="../../loaders/style-loader.htm" tppabs="https://webpack.docschina.org/loaders/style-loader">style-loader</a> å’Œ <a href="../../loaders/css-loader.htm" tppabs="https://webpack.docschina.org/loaders/css-loader">css-loader</a>ï¼Œå¹¶åœ¨ <a href="../../configuration/module.htm" tppabs="https://webpack.docschina.org/configuration/module"><code>module</code> é…ç½®</a> ä¸­æ·»åŠ è¿™äº› loaderï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev style-loader css-loader</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  module: {
</span><span class="token prefix inserted">+</span><span class="token line">    rules: [
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">    ],
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>æ¨¡å— loader å¯ä»¥é“¾å¼è°ƒç”¨ã€‚é“¾ä¸­çš„æ¯ä¸ª loader éƒ½å°†å¯¹èµ„æºè¿›è¡Œè½¬æ¢ã€‚é“¾ä¼šé€†åºæ‰§è¡Œã€‚ç¬¬ä¸€ä¸ª loader å°†å…¶ç»“æœï¼ˆè¢«è½¬æ¢åçš„èµ„æºï¼‰ä¼ é€’ç»™ä¸‹ä¸€ä¸ª loaderï¼Œä¾æ­¤ç±»æ¨ã€‚æœ€åï¼Œwebpack æœŸæœ›é“¾ä¸­çš„æœ€åçš„ loader è¿”å› JavaScriptã€‚</p> <p>åº”ä¿è¯ loader çš„å…ˆåé¡ºåºï¼š<a href="../../loaders/style-loader.htm" tppabs="https://webpack.docschina.org/loaders/style-loader"><code>'style-loader'</code></a> åœ¨å‰ï¼Œè€Œ <a href="../../loaders/css-loader.htm" tppabs="https://webpack.docschina.org/loaders/css-loader"><code>'css-loader'</code></a> åœ¨åã€‚å¦‚æœä¸éµå®ˆæ­¤çº¦å®šï¼Œwebpack å¯èƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p> <blockquote class="tip"> <p>webpack æ ¹æ®æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¥ç¡®å®šåº”è¯¥æŸ¥æ‰¾å“ªäº›æ–‡ä»¶ï¼Œå¹¶å°†å…¶æä¾›ç»™æŒ‡å®šçš„ loaderã€‚åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæ‰€æœ‰ä»¥ <code>.css</code> ç»“å°¾çš„æ–‡ä»¶ï¼Œéƒ½å°†è¢«æä¾›ç»™ <code>style-loader</code> å’Œ <code>css-loader</code>ã€‚</p> </blockquote> <p>è¿™ä½¿ä½ å¯ä»¥åœ¨ä¾èµ–äºæ­¤æ ·å¼çš„ js æ–‡ä»¶ä¸­ <code>import './style.css'</code>ã€‚ç°åœ¨ï¼Œåœ¨æ­¤æ¨¡å—æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå«æœ‰ CSS å­—ç¬¦ä¸²çš„ <code>&#x3C;style></code> æ ‡ç­¾ï¼Œå°†è¢«æ’å…¥åˆ° html æ–‡ä»¶çš„ <code>&#x3C;head></code> ä¸­ã€‚</p> <p>æˆ‘ä»¬å°è¯•ä¸€ä¸‹ï¼Œé€šè¿‡åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„ <code>style.css</code> æ–‡ä»¶ï¼Œå¹¶å°†å…¶ import åˆ°æˆ‘ä»¬çš„ <code>index.js</code> ä¸­ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- style.css
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/style.css</strong></p> <pre><code class="hljs language-css"><span class="token selector">.hello</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import './style.css';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  element.classList.add('hello');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>ç°åœ¨è¿è¡Œ build å‘½ä»¤ï¼š</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset bundle.js <span class="token number">72.6</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1000</span> bytes <span class="token number">5</span> modules
orphan modules <span class="token number">326</span> bytes <span class="token punctuation">[</span>orphan<span class="token punctuation">]</span> <span class="token number">1</span> module
cacheable modules <span class="token number">539</span> KiB
  modules by path ./node_modules/ <span class="token number">538</span> KiB
    ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js <span class="token number">6.67</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/css-loader/dist/runtime/api.js <span class="token number">1.57</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  modules by path ./src/ <span class="token number">965</span> bytes
    ./src/index.js + <span class="token number">1</span> modules <span class="token number">639</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/css-loader/dist/cjs.js<span class="token operator">!</span>./src/style.css <span class="token number">326</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">2231</span> ms</code></pre> <p>å†æ¬¡åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>dist/index.html</code>ï¼Œä½ åº”è¯¥çœ‹åˆ° <code>Hello webpack</code> ç°åœ¨çš„æ ·å¼æ˜¯çº¢è‰²ã€‚è¦æŸ¥çœ‹ webpack åšäº†ä»€ä¹ˆï¼Œè¯·æ£€æŸ¥é¡µé¢ï¼ˆä¸è¦æŸ¥çœ‹é¡µé¢æºä»£ç ï¼Œå®ƒä¸ä¼šæ˜¾ç¤ºç»“æœï¼Œå› ä¸º <code>&#x3C;style></code> æ ‡ç­¾æ˜¯ç”± JavaScript åŠ¨æ€åˆ›å»ºçš„ï¼‰ï¼Œå¹¶æŸ¥çœ‹é¡µé¢çš„ head æ ‡ç­¾ã€‚å®ƒåº”è¯¥åŒ…å« style å—å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨ <code>index.js</code> ä¸­ import çš„ css æ–‡ä»¶ä¸­çš„æ ·å¼ã€‚</p> <p>æ³¨æ„ï¼Œåœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¹Ÿå¯ä»¥è¿›è¡Œ <a href="../../plugins/mini-css-extract-plugin/index.htm#minimizing-for-production" tppabs="https://webpack.docschina.org/plugins/mini-css-extract-plugin/#minimizing-for-production">å‹ç¼© CSS</a>ï¼Œä»¥ä¾¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­èŠ‚çœåŠ è½½æ—¶é—´ã€‚æœ€é‡è¦çš„æ˜¯ï¼Œç°æœ‰çš„ loader å¯ä»¥æ”¯æŒä»»ä½•ä½ å¯ä»¥æƒ³åˆ°çš„ CSS é£æ ¼ - <a href="../../loaders/postcss-loader.htm" tppabs="https://webpack.docschina.org/loaders/postcss-loader">postcss</a>, <a href="../../loaders/sass-loader.htm" tppabs="https://webpack.docschina.org/loaders/sass-loader">sass</a> å’Œ <a href="../../loaders/less-loader.htm" tppabs="https://webpack.docschina.org/loaders/less-loader">less</a> ç­‰ã€‚</p> <h2 id="loading-images">åŠ è½½ images å›¾åƒ <a href="#loading-images" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å‡å¦‚ï¼Œç°åœ¨æˆ‘ä»¬æ­£åœ¨ä¸‹è½½ CSSï¼Œä½†æ˜¯åƒ background å’Œ icon è¿™æ ·çš„å›¾åƒï¼Œè¦å¦‚ä½•å¤„ç†å‘¢ï¼Ÿåœ¨ webpack 5 ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å†…ç½®çš„ <a href="../asset-modules/index.htm" tppabs="https://webpack.docschina.org/guides/asset-modules/">Asset Modules</a>ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°å°†è¿™äº›å†…å®¹æ··å…¥æˆ‘ä»¬çš„ç³»ç»Ÿä¸­ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>ç°åœ¨ï¼Œåœ¨ <code>import MyImage from './my-image.png'</code> æ—¶ï¼Œæ­¤å›¾åƒå°†è¢«å¤„ç†å¹¶æ·»åŠ åˆ° <code>output</code> ç›®å½•ï¼Œ<em>å¹¶ä¸”</em> <code>MyImage</code> å˜é‡å°†åŒ…å«è¯¥å›¾åƒåœ¨å¤„ç†åçš„æœ€ç»ˆ urlã€‚åœ¨ä½¿ç”¨ <a href="../../loaders/css-loader.htm" tppabs="https://webpack.docschina.org/loaders/css-loader">css-loader</a> æ—¶ï¼Œå¦‚å‰æ‰€ç¤ºï¼Œä¼šä½¿ç”¨ç±»ä¼¼è¿‡ç¨‹å¤„ç†ä½ çš„ CSS ä¸­çš„ <code>url('./my-image.png')</code>ã€‚loader ä¼šè¯†åˆ«è¿™æ˜¯ä¸€ä¸ªæœ¬åœ°æ–‡ä»¶ï¼Œå¹¶å°† <code>'./my-image.png'</code> è·¯å¾„ï¼Œæ›¿æ¢ä¸º <code>output</code> ç›®å½•ä¸­å›¾åƒçš„æœ€ç»ˆè·¯å¾„ã€‚è€Œ <a href="../../loaders/html-loader.htm" tppabs="https://webpack.docschina.org/loaders/html-loader">html-loader</a> ä»¥ç›¸åŒçš„æ–¹å¼å¤„ç† <code>&#x3C;img src="./my-image.png" /></code>ã€‚</p> <p>æˆ‘ä»¬å‘é¡¹ç›®æ·»åŠ ä¸€ä¸ªå›¾åƒï¼Œç„¶åçœ‹å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ å–œæ¬¢çš„å›¾åƒï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- icon.png
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- style.css
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line">import './style.css';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import Icon from './icon.png';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">  element.classList.add('hello');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  // å°†å›¾åƒæ·»åŠ åˆ°æˆ‘ä»¬å·²ç»å­˜åœ¨çš„ div ä¸­ã€‚
</span><span class="token prefix inserted">+</span><span class="token line">  const myIcon = new Image();
</span><span class="token prefix inserted">+</span><span class="token line">  myIcon.src = Icon;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">  element.appendChild(myIcon);
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><strong>src/style.css</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">.hello {
</span><span class="token prefix unchanged"> </span><span class="token line">  color: red;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  background: url('./icon.png');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>é‡æ–°æ„å»ºå¹¶å†æ¬¡æ‰“å¼€ <code>index.html</code> æ–‡ä»¶ï¼š</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
assets by status <span class="token number">9.88</span> KiB <span class="token punctuation">[</span>cached<span class="token punctuation">]</span> <span class="token number">1</span> asset
asset bundle.js <span class="token number">73.4</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1.82</span> KiB <span class="token number">6</span> modules
orphan modules <span class="token number">326</span> bytes <span class="token punctuation">[</span>orphan<span class="token punctuation">]</span> <span class="token number">1</span> module
cacheable modules <span class="token number">540</span> KiB <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">9.88</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span>
  modules by path ./node_modules/ <span class="token number">539</span> KiB
    modules by path ./node_modules/css-loader/dist/runtime/*.js <span class="token number">2.38</span> KiB
      ./node_modules/css-loader/dist/runtime/api.js <span class="token number">1.57</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
      ./node_modules/css-loader/dist/runtime/getUrl.js <span class="token number">830</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js <span class="token number">6.67</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  modules by path ./src/ <span class="token number">1.45</span> KiB <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">9.88</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span>
    ./src/index.js + <span class="token number">1</span> modules <span class="token number">794</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./src/icon.png <span class="token number">42</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">9.88</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./node_modules/css-loader/dist/cjs.js<span class="token operator">!</span>./src/style.css <span class="token number">648</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1972</span> ms</code></pre> <p>å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä½ ç°åœ¨åº”è¯¥çœ‹åˆ°ä½ çš„ icon å›¾æ ‡æˆä¸ºäº†é‡å¤çš„èƒŒæ™¯å›¾ï¼Œä»¥åŠ <code>Hello webpack</code> æ–‡æœ¬æ—è¾¹çš„ <code>img</code> å…ƒç´ ã€‚å¦‚æœæ£€æŸ¥æ­¤å…ƒç´ ï¼Œä½ å°†çœ‹åˆ°å®é™…çš„æ–‡ä»¶åå·²æ›´æ”¹ä¸º <code>29822eaa871e8eadeaa4.png</code>ã€‚è¿™æ„å‘³ç€ webpack åœ¨ <code>src</code> æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°æˆ‘ä»¬çš„æ–‡ä»¶ï¼Œå¹¶å¯¹å…¶è¿›è¡Œäº†å¤„ç†ï¼</p> <h2 id="loading-fonts">åŠ è½½ fonts å­—ä½“ <a href="#loading-fonts" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é‚£ä¹ˆï¼Œåƒå­—ä½“è¿™æ ·çš„å…¶ä»–èµ„æºå¦‚ä½•å¤„ç†å‘¢ï¼Ÿä½¿ç”¨ Asset Modules å¯ä»¥æ¥æ”¶å¹¶åŠ è½½ä»»ä½•æ–‡ä»¶ï¼Œç„¶åå°†å…¶è¾“å‡ºåˆ°æ„å»ºç›®å½•ã€‚è¿™å°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬ç”¨äºä»»ä½•ç±»å‹çš„æ–‡ä»¶ï¼Œä¹ŸåŒ…æ‹¬å­—ä½“ã€‚è®©æˆ‘ä»¬æ›´æ–° <code>webpack.config.js</code> æ¥å¤„ç†å­—ä½“æ–‡ä»¶ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.(woff|woff2|eot|ttf|otf)$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€äº›å­—ä½“æ–‡ä»¶ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- my-font.woff
</span><span class="token prefix inserted">+</span><span class="token line">   |- my-font.woff2
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- icon.png
</span><span class="token prefix unchanged"> </span><span class="token line">   |- style.css
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p>é…ç½®å¥½ loader å¹¶å°†å­—ä½“æ–‡ä»¶æ”¾åœ¨åˆé€‚çš„ä½ç½®åï¼Œä½ å¯ä»¥é€šè¿‡ä¸€ä¸ª <code>@font-face</code> å£°æ˜å°†å…¶æ··åˆã€‚æœ¬åœ°çš„ <code>url(...)</code> æŒ‡ä»¤ä¼šè¢« webpack è·å–å¤„ç†ï¼Œå°±åƒå®ƒå¤„ç†å›¾ç‰‡ä¸€æ ·ï¼š</p> <p><strong>src/style.css</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">@font-face {
</span><span class="token prefix inserted">+</span><span class="token line">  font-family: 'MyFont';
</span><span class="token prefix inserted">+</span><span class="token line">  src: url('./my-font.woff2') format('woff2'),
</span><span class="token prefix inserted">+</span><span class="token line">    url('./my-font.woff') format('woff');
</span><span class="token prefix inserted">+</span><span class="token line">  font-weight: 600;
</span><span class="token prefix inserted">+</span><span class="token line">  font-style: normal;
</span><span class="token prefix inserted">+</span><span class="token line">}
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">.hello {
</span><span class="token prefix unchanged"> </span><span class="token line">  color: red;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  font-family: 'MyFont';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  background: url('./icon.png');
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬é‡æ–°æ„å»ºï¼Œç„¶åçœ‹ä¸‹ webpack æ˜¯å¦å¤„ç†äº†æˆ‘ä»¬çš„å­—ä½“ï¼š</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
assets by status <span class="token number">9.88</span> KiB <span class="token punctuation">[</span>cached<span class="token punctuation">]</span> <span class="token number">1</span> asset
assets by info <span class="token number">33.2</span> KiB <span class="token punctuation">[</span>immutable<span class="token punctuation">]</span>
  asset 55055dbfc7c6a83f60ba.woff <span class="token number">18.8</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>immutable<span class="token punctuation">]</span> <span class="token punctuation">[</span>from: src/my-font.woff<span class="token punctuation">]</span> <span class="token punctuation">(</span>auxiliary name: main<span class="token punctuation">)</span>
  asset 8f717b802eaab4d7fb94.woff2 <span class="token number">14.5</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>immutable<span class="token punctuation">]</span> <span class="token punctuation">[</span>from: src/my-font.woff2<span class="token punctuation">]</span> <span class="token punctuation">(</span>auxiliary name: main<span class="token punctuation">)</span>
asset bundle.js <span class="token number">73.7</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">1.82</span> KiB <span class="token number">6</span> modules
orphan modules <span class="token number">326</span> bytes <span class="token punctuation">[</span>orphan<span class="token punctuation">]</span> <span class="token number">1</span> module
cacheable modules <span class="token number">541</span> KiB <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">43.1</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span>
  javascript modules <span class="token number">541</span> KiB
    modules by path ./node_modules/ <span class="token number">539</span> KiB
      modules by path ./node_modules/css-loader/dist/runtime/*.js <span class="token number">2.38</span> KiB <span class="token number">2</span> modules
      ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
      ./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js <span class="token number">6.67</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    modules by path ./src/ <span class="token number">1.98</span> KiB
      ./src/index.js + <span class="token number">1</span> modules <span class="token number">794</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
      ./node_modules/css-loader/dist/cjs.js<span class="token operator">!</span>./src/style.css <span class="token number">1.21</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  asset modules <span class="token number">126</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">43.1</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span>
    ./src/icon.png <span class="token number">42</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">9.88</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./src/my-font.woff2 <span class="token number">42</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">14.5</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
    ./src/my-font.woff <span class="token number">42</span> bytes <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">18.8</span> KiB <span class="token punctuation">(</span>asset<span class="token punctuation">)</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">2142</span> ms</code></pre> <p>é‡æ–°æ‰“å¼€ <code>dist/index.html</code> çœ‹çœ‹æˆ‘ä»¬çš„ <code>Hello webpack</code> æ–‡æœ¬æ˜¾ç¤ºæ˜¯å¦æ¢ä¸Šäº†æ–°çš„å­—ä½“ã€‚å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°å˜åŒ–ã€‚</p> <h2 id="loading-data">åŠ è½½æ•°æ® <a href="#loading-data" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ­¤å¤–ï¼Œå¯ä»¥åŠ è½½çš„æœ‰ç”¨èµ„æºè¿˜æœ‰æ•°æ®ï¼Œå¦‚ JSON æ–‡ä»¶ï¼ŒCSVã€TSV å’Œ XMLã€‚ç±»ä¼¼äº NodeJSï¼ŒJSON æ”¯æŒå®é™…ä¸Šæ˜¯å†…ç½®çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>import Data from './data.json'</code> é»˜è®¤å°†æ­£å¸¸è¿è¡Œã€‚è¦å¯¼å…¥ CSVã€TSV å’Œ XMLï¼Œä½ å¯ä»¥ä½¿ç”¨ <a href="javascript:if(confirm('https://github.com/theplatapi/csv-loader  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/theplatapi/csv-loader'" tppabs="https://github.com/theplatapi/csv-loader">csv-loader</a> å’Œ <a href="javascript:if(confirm('https://github.com/gisikw/xml-loader  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/gisikw/xml-loader'" tppabs="https://github.com/gisikw/xml-loader">xml-loader</a>ã€‚è®©æˆ‘ä»¬å¤„ç†åŠ è½½è¿™ä¸‰ç±»æ–‡ä»¶ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev csv-loader xml-loader</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(woff|woff2|eot|ttf|otf)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.(csv|tsv)$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        use: ['csv-loader'],
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.xml$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        use: ['xml-loader'],
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>åœ¨é¡¹ç›®ä¸­æ·»åŠ ä¸€äº›æ•°æ®æ–‡ä»¶ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- data.xml
</span><span class="token prefix inserted">+</span><span class="token line">   |- data.csv
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- my-font.woff
</span><span class="token prefix unchanged"> </span><span class="token line">   |- my-font.woff2
</span><span class="token prefix unchanged"> </span><span class="token line">   |- icon.png
</span><span class="token prefix unchanged"> </span><span class="token line">   |- style.css
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/data.xml</strong></p> <pre><code class="hljs language-xml"><span class="token prolog">&#x3C;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>note</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>to</span><span class="token punctuation">></span></span>Mary<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>to</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>from</span><span class="token punctuation">></span></span>John<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>from</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>heading</span><span class="token punctuation">></span></span>Reminder<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>heading</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>Call Cindy on Tuesday<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>note</span><span class="token punctuation">></span></span></code></pre> <p><strong>src/data.csv</strong></p> <pre><code class="hljs language-csv">to,from,heading,body
Mary,John,Reminder,Call Cindy on Tuesday
Zoe,Bill,Reminder,Buy orange juice
Autumn,Lindsey,Letter,I miss you
</code></pre> <p>ç°åœ¨ï¼Œä½ å¯ä»¥ <code>import</code> è¿™å››ç§ç±»å‹çš„æ•°æ®(JSON, CSV, TSV, XML)ä¸­çš„ä»»ä½•ä¸€ç§ï¼Œæ‰€å¯¼å…¥çš„ <code>Data</code> å˜é‡ï¼Œå°†åŒ…å«å¯ç›´æ¥ä½¿ç”¨çš„å·²è§£æ JSONï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line">import './style.css';
</span><span class="token prefix unchanged"> </span><span class="token line">import Icon from './icon.png';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import Data from './data.xml';
</span><span class="token prefix inserted">+</span><span class="token line">import Notes from './data.csv';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">  element.classList.add('hello');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  // Add the image to our existing div.
</span><span class="token prefix unchanged"> </span><span class="token line">  const myIcon = new Image();
</span><span class="token prefix unchanged"> </span><span class="token line">  myIcon.src = Icon;
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  element.appendChild(myIcon);
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  console.log(Data);
</span><span class="token prefix inserted">+</span><span class="token line">  console.log(Notes);
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>é‡æ–°æ‰§è¡Œ <code>npm run build</code> å‘½ä»¤ï¼Œç„¶åæ‰“å¼€ <code>dist/index.html</code>ã€‚æŸ¥çœ‹å¼€å‘è€…å·¥å…·ä¸­çš„æ§åˆ¶å°ï¼Œä½ åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°å¯¼å…¥çš„æ•°æ®ä¼šè¢«æ‰“å°å‡ºæ¥ï¼</p> <blockquote class="tip"> <p>åœ¨ä½¿ç”¨ <a href="javascript:if(confirm('https://github.com/d3  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/d3'" tppabs="https://github.com/d3">d3</a> ç­‰å·¥å…·å®ç°æŸäº›æ•°æ®å¯è§†åŒ–æ—¶ï¼Œè¿™ä¸ªåŠŸèƒ½æå…¶æœ‰ç”¨ã€‚å¯ä»¥ä¸ç”¨åœ¨è¿è¡Œæ—¶å†å»å‘é€ä¸€ä¸ª ajax è¯·æ±‚è·å–å’Œè§£ææ•°æ®ï¼Œè€Œæ˜¯åœ¨æ„å»ºè¿‡ç¨‹ä¸­å°†å…¶æå‰åŠ è½½åˆ°æ¨¡å—ä¸­ï¼Œä»¥ä¾¿æµè§ˆå™¨åŠ è½½æ¨¡å—åï¼Œç›´æ¥å°±å¯ä»¥è®¿é—®è§£æè¿‡çš„æ•°æ®ã€‚</p> </blockquote> <blockquote class="warning"> <p>åªæœ‰åœ¨ä½¿ç”¨ JSON æ¨¡å—é»˜è®¤å¯¼å‡ºæ—¶ä¼šæ²¡æœ‰è­¦å‘Šã€‚</p> </blockquote> <pre><code class="hljs language-javascript"><span class="token comment">// æ²¡æœ‰è­¦å‘Š</span>
<span class="token keyword">import</span> data <span class="token keyword">from</span> <span class="token string">'./data.json'</span><span class="token punctuation">;</span>

<span class="token comment">// æ˜¾ç¤ºè­¦å‘Šï¼Œè§„èŒƒä¸å…è®¸è¿™æ ·åšã€‚</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> foo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./data.json'</span><span class="token punctuation">;</span></code></pre> <h3 id="customize-parser-of-json-modules">è‡ªå®šä¹‰ JSON æ¨¡å— parser <a href="#customize-parser-of-json-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>é€šè¿‡ä½¿ç”¨ <a href="../../configuration/module/index.htm#ruleparserparse" tppabs="https://webpack.docschina.org/configuration/module/#ruleparserparse">è‡ªå®šä¹‰ parser</a> æ›¿ä»£ç‰¹å®šçš„ webpack loaderï¼Œå¯ä»¥å°†ä»»ä½• <code>toml</code>ã€<code>yaml</code> æˆ– <code>json5</code> æ–‡ä»¶ä½œä¸º JSON æ¨¡å—å¯¼å…¥ã€‚</p> <p>å‡è®¾ä½ åœ¨ <code>src</code> æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ª <code>data.toml</code>ã€ä¸€ä¸ª <code>data.yaml</code> ä»¥åŠä¸€ä¸ª <code>data.json5</code> æ–‡ä»¶ï¼š</p> <p><strong>src/data.toml</strong></p> <pre><code class="hljs language-toml">title = "TOML Example"

[owner]
name = "Tom Preston-Werner"
organization = "GitHub"
bio = "GitHub Cofounder &#x26; CEO\nLikes tater tots and beer."
dob = 1979-05-27T07:32:00Z
</code></pre> <p><strong>src/data.yaml</strong></p> <pre><code class="hljs language-yaml"><span class="token key atrule">title</span><span class="token punctuation">:</span> YAML Example
<span class="token key atrule">owner</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> Tom Preston<span class="token punctuation">-</span>Werner
  <span class="token key atrule">organization</span><span class="token punctuation">:</span> GitHub
  <span class="token key atrule">bio</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token punctuation">-</span>
    GitHub Cofounder &#x26; CEO
    Likes tater tots and beer.
  <span class="token key atrule">dob</span><span class="token punctuation">:</span> <span class="token datetime number">1979-05-27T07:32:00.000Z</span></code></pre> <p><strong>src/data.json5</strong></p> <pre><code class="hljs language-json5">{
  // comment
  title: "JSON5 Example",
  owner: {
    name: "Tom Preston-Werner",
    organization: "GitHub",
    bio: "GitHub Cofounder &#x26; CEO\n\
Likes tater tots and beer.",
    dob: "1979-05-27T07:32:00.000Z"
  }
}
</code></pre> <p>é¦–å…ˆå®‰è£… <code>toml</code>ï¼Œ<code>yamljs</code> å’Œ <code>json5</code> çš„ packagesï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> toml yamljs json5 --save-dev</code></pre> <p>å¹¶åœ¨ä½ çš„ webpack ä¸­é…ç½®å®ƒä»¬ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const toml = require('toml');
</span><span class="token prefix inserted">+</span><span class="token line">const yaml = require('yamljs');
</span><span class="token prefix inserted">+</span><span class="token line">const json5 = require('json5');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(woff|woff2|eot|ttf|otf)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.(csv|tsv)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['csv-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: /\.xml$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">        use: ['xml-loader'],
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.toml$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'json',
</span><span class="token prefix inserted">+</span><span class="token line">        parser: {
</span><span class="token prefix inserted">+</span><span class="token line">          parse: toml.parse,
</span><span class="token prefix inserted">+</span><span class="token line">        },
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.yaml$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'json',
</span><span class="token prefix inserted">+</span><span class="token line">        parser: {
</span><span class="token prefix inserted">+</span><span class="token line">          parse: yaml.parse,
</span><span class="token prefix inserted">+</span><span class="token line">        },
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.json5$/i,
</span><span class="token prefix inserted">+</span><span class="token line">        type: 'json',
</span><span class="token prefix inserted">+</span><span class="token line">        parser: {
</span><span class="token prefix inserted">+</span><span class="token line">          parse: json5.parse,
</span><span class="token prefix inserted">+</span><span class="token line">        },
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line">import './style.css';
</span><span class="token prefix unchanged"> </span><span class="token line">import Icon from './icon.png';
</span><span class="token prefix unchanged"> </span><span class="token line">import Data from './data.xml';
</span><span class="token prefix unchanged"> </span><span class="token line">import Notes from './data.csv';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import toml from './data.toml';
</span><span class="token prefix inserted">+</span><span class="token line">import yaml from './data.yaml';
</span><span class="token prefix inserted">+</span><span class="token line">import json from './data.json5';
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">console.log(toml.title); // output `TOML Example`
</span><span class="token prefix inserted">+</span><span class="token line">console.log(toml.owner.name); // output `Tom Preston-Werner`
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">console.log(yaml.title); // output `YAML Example`
</span><span class="token prefix inserted">+</span><span class="token line">console.log(yaml.owner.name); // output `Tom Preston-Werner`
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">console.log(json.title); // output `JSON5 Example`
</span><span class="token prefix inserted">+</span><span class="token line">console.log(json.owner.name); // output `Tom Preston-Werner`
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">  element.classList.add('hello');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  // Add the image to our existing div.
</span><span class="token prefix unchanged"> </span><span class="token line">  const myIcon = new Image();
</span><span class="token prefix unchanged"> </span><span class="token line">  myIcon.src = Icon;
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  element.appendChild(myIcon);
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  console.log(Data);
</span><span class="token prefix unchanged"> </span><span class="token line">  console.log(Notes);
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>Re-run the <code>npm run build</code> command and open <code>dist/index.html</code>. You should be able to see your imported data being logged to the console!</p> <h2 id="global-assets">å…¨å±€èµ„æº <a href="#global-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä¸Šè¿°æ‰€æœ‰å†…å®¹ä¸­æœ€å‡ºè‰²ä¹‹å¤„åœ¨äºï¼Œä»¥è¿™ç§æ–¹å¼åŠ è½½èµ„æºï¼Œä½ å¯ä»¥ä»¥æ›´ç›´è§‚çš„æ–¹å¼å°†æ¨¡å—å’Œèµ„æºç»„åˆåœ¨ä¸€èµ·ã€‚æ— éœ€ä¾èµ–äºå«æœ‰å…¨éƒ¨èµ„æºçš„ <code>/assets</code> ç›®å½•ï¼Œè€Œæ˜¯å°†èµ„æºä¸ä»£ç ç»„åˆåœ¨ä¸€èµ·ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œç±»ä¼¼è¿™æ ·çš„ç»“æ„ä¼šéå¸¸æœ‰ç”¨ï¼š</p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> |- /assets
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |â€“ /components
</span><span class="token prefix inserted">+</span><span class="token line"> |  |â€“ /my-component
</span><span class="token prefix inserted">+</span><span class="token line"> |  |  |â€“ index.jsx
</span><span class="token prefix inserted">+</span><span class="token line"> |  |  |â€“ index.css
</span><span class="token prefix inserted">+</span><span class="token line"> |  |  |â€“ icon.svg
</span><span class="token prefix inserted">+</span><span class="token line"> |  |  |â€“ img.png</span></span></code></pre> <p>è¿™ç§é…ç½®æ–¹å¼ä¼šä½¿ä½ çš„ä»£ç æ›´å…·å¤‡å¯ç§»æ¤æ€§ï¼Œå› ä¸ºç°æœ‰çš„é›†ä¸­æ”¾ç½®çš„æ–¹å¼ä¼šè®©æ‰€æœ‰èµ„æºç´§å¯†è€¦åˆèµ·æ¥ã€‚å‡å¦‚ä½ æƒ³åœ¨å¦ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ <code>/my-component</code>ï¼Œåªéœ€å°†å…¶å¤åˆ¶æˆ–ç§»åŠ¨åˆ° <code>/components</code> ç›®å½•ä¸‹ã€‚åªè¦ä½ å·²ç»å®‰è£…è¿‡å…¨éƒ¨_å¤–éƒ¨ä¾èµ–_ï¼Œå¹¶ä¸”_å·²ç»åœ¨é…ç½®ä¸­å®šä¹‰è¿‡ç›¸åŒçš„ loader_ï¼Œé‚£ä¹ˆé¡¹ç›®åº”è¯¥èƒ½å¤Ÿè‰¯å¥½è¿è¡Œã€‚</p> <p>ä½†æ˜¯ï¼Œå‡å¦‚ä½ åªèƒ½è¢«å±€é™åœ¨æ—§æœ‰å¼€å‘æ–¹å¼ï¼Œæˆ–è€…ä½ æœ‰ä¸€äº›åœ¨å¤šä¸ªç»„ä»¶ï¼ˆè§†å›¾ã€æ¨¡æ¿ã€æ¨¡å—ç­‰ï¼‰ä¹‹é—´å…±äº«çš„èµ„æºã€‚ä½ ä»ç„¶å¯ä»¥å°†è¿™äº›èµ„æºå­˜å‚¨åœ¨ä¸€ä¸ªåŸºæœ¬ç›®å½•(base directory)ä¸­ï¼Œç”šè‡³é…åˆä½¿ç”¨ <a href="../../configuration/resolve/index.htm#resolvealias" tppabs="https://webpack.docschina.org/configuration/resolve/#resolvealias">alias</a> æ¥ä½¿å®ƒä»¬æ›´æ–¹ä¾¿ <code>import å¯¼å…¥</code>ã€‚</p> <h2 id="wrapping-up">å›é€€å¤„ç† <a href="#wrapping-up" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å¯¹äºä¸‹ç¯‡æŒ‡å—ï¼Œæˆ‘ä»¬æ— éœ€ä½¿ç”¨æœ¬æŒ‡å—ä¸­æ‰€æœ‰ç”¨åˆ°çš„èµ„æºï¼Œå› æ­¤æˆ‘ä»¬ä¼šè¿›è¡Œä¸€äº›æ¸…ç†å·¥ä½œï¼Œä»¥ä¾¿ä¸ºä¸‹ç¯‡æŒ‡å— <a href="../output-management/index.htm" tppabs="https://webpack.docschina.org/guides/output-management/">ç®¡ç†è¾“å‡º</a> åšå¥½å‡†å¤‡ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   |- data.csv
</span><span class="token prefix deleted">-</span><span class="token line">   |- data.json5
</span><span class="token prefix deleted">-</span><span class="token line">   |- data.toml
</span><span class="token prefix deleted">-</span><span class="token line">   |- data.xml
</span><span class="token prefix deleted">-</span><span class="token line">   |- data.yaml
</span><span class="token prefix deleted">-</span><span class="token line">   |- icon.png
</span><span class="token prefix deleted">-</span><span class="token line">   |- my-font.woff
</span><span class="token prefix deleted">-</span><span class="token line">   |- my-font.woff2
</span><span class="token prefix deleted">-</span><span class="token line">   |- style.css
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">const toml = require('toml');
</span><span class="token prefix deleted">-</span><span class="token line">const yaml = require('yamljs');
</span><span class="token prefix deleted">-</span><span class="token line">const json5 = require('json5');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  module: {
</span><span class="token prefix deleted">-</span><span class="token line">    rules: [
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.css$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        use: ['style-loader', 'css-loader'],
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.(png|svg|jpg|jpeg|gif)$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.(woff|woff2|eot|ttf|otf)$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'asset/resource',
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.(csv|tsv)$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        use: ['csv-loader'],
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.xml$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        use: ['xml-loader'],
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.toml$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'json',
</span><span class="token prefix deleted">-</span><span class="token line">        parser: {
</span><span class="token prefix deleted">-</span><span class="token line">          parse: toml.parse,
</span><span class="token prefix deleted">-</span><span class="token line">        },
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.yaml$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'json',
</span><span class="token prefix deleted">-</span><span class="token line">        parser: {
</span><span class="token prefix deleted">-</span><span class="token line">          parse: yaml.parse,
</span><span class="token prefix deleted">-</span><span class="token line">        },
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">      {
</span><span class="token prefix deleted">-</span><span class="token line">        test: /\.json5$/i,
</span><span class="token prefix deleted">-</span><span class="token line">        type: 'json',
</span><span class="token prefix deleted">-</span><span class="token line">        parser: {
</span><span class="token prefix deleted">-</span><span class="token line">          parse: json5.parse,
</span><span class="token prefix deleted">-</span><span class="token line">        },
</span><span class="token prefix deleted">-</span><span class="token line">      },
</span><span class="token prefix deleted">-</span><span class="token line">    ],
</span><span class="token prefix deleted">-</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import './style.css';
</span><span class="token prefix deleted">-</span><span class="token line">import Icon from './icon.png';
</span><span class="token prefix deleted">-</span><span class="token line">import Data from './data.xml';
</span><span class="token prefix deleted">-</span><span class="token line">import Notes from './data.csv';
</span><span class="token prefix deleted">-</span><span class="token line">import toml from './data.toml';
</span><span class="token prefix deleted">-</span><span class="token line">import yaml from './data.yaml';
</span><span class="token prefix deleted">-</span><span class="token line">import json from './data.json5';
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">console.log(toml.title); // output `TOML Example`
</span><span class="token prefix deleted">-</span><span class="token line">console.log(toml.owner.name); // output `Tom Preston-Werner`
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">console.log(yaml.title); // output `YAML Example`
</span><span class="token prefix deleted">-</span><span class="token line">console.log(yaml.owner.name); // output `Tom Preston-Werner`
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">console.log(json.title); //  `JSON5 Example`
</span><span class="token prefix deleted">-</span><span class="token line">console.log(json.owner.name); // output `Tom Preston-Werner`
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  // lodashï¼Œç°åœ¨é€šè¿‡ script æ ‡ç­¾å¯¼å…¥
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  element.classList.add('hello');
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">  // Add the image to our existing div.
</span><span class="token prefix deleted">-</span><span class="token line">  const myIcon = new Image();
</span><span class="token prefix deleted">-</span><span class="token line">  myIcon.src = Icon;
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">  element.appendChild(myIcon);
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">  console.log(Data);
</span><span class="token prefix deleted">-</span><span class="token line">  console.log(Notes);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>And remove those dependencies we added before:</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> uninstall css-loader csv-loader json5 style-loader toml xml-loader yamljs</code></pre> <h2 id="next-guide">ä¸‹ç¯‡æŒ‡å— <a href="#next-guide" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æˆ‘ä»¬ç»§ç»­ç§»æ­¥åˆ° <a href="../output-management/index.htm" tppabs="https://webpack.docschina.org/guides/output-management/">ç®¡ç†è¾“å‡º</a></p> <h2 id="further-reading">å»¶ä¼¸é˜…è¯» <a href="#further-reading" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <ul> <li><a href="javascript:if(confirm('https://survivejs.com/webpack/loading/fonts/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://survivejs.com/webpack/loading/fonts/'" tppabs="https://survivejs.com/webpack/loading/fonts/">åŠ è½½å­—ä½“</a> on SurviveJS</li> </ul> <h1 id="ç®¡ç†è¾“å‡º">ç®¡ç†è¾“å‡º<a href="#%E7%AE%A1%E7%90%86%E8%BE%93%E5%87%BA" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote class="tip"> <p>æœ¬æŒ‡å—ç»§ç»­æ²¿ç”¨ <a href="../asset-management.htm" tppabs="https://webpack.docschina.org/guides/asset-management"><code>ç®¡ç†èµ„æº</code></a> æŒ‡å—ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚</p> </blockquote> <p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬éƒ½æ˜¯åœ¨ <code>index.html</code> æ–‡ä»¶ä¸­æ‰‹åŠ¨å¼•å…¥æ‰€æœ‰èµ„æºï¼Œç„¶è€Œéšç€åº”ç”¨ç¨‹åºå¢é•¿ï¼Œå¹¶ä¸”ä¸€æ—¦å¼€å§‹ <a href="../caching.htm" tppabs="https://webpack.docschina.org/guides/caching">åœ¨æ–‡ä»¶åä¸­ä½¿ç”¨ hash</a> å¹¶è¾“å‡º <a href="../code-splitting.htm" tppabs="https://webpack.docschina.org/guides/code-splitting">å¤šä¸ª bundle</a>ï¼Œå¦‚æœç»§ç»­æ‰‹åŠ¨ç®¡ç† <code>index.html</code> æ–‡ä»¶ï¼Œå°±ä¼šå˜å¾—å›°éš¾èµ·æ¥ã€‚ç„¶è€Œï¼Œé€šè¿‡ä¸€äº›æ’ä»¶å¯ä»¥ä½¿è¿™ä¸ªè¿‡ç¨‹æ›´å®¹æ˜“ç®¡æ§ã€‚</p> <h2 id="preparation">é¢„å…ˆå‡†å¤‡ <a href="#preparation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é¦–å…ˆï¼Œè°ƒæ•´ä¸€ä¸‹æˆ‘ä»¬çš„é¡¹ç›®ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- print.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p>æˆ‘ä»¬åœ¨ <code>src/print.js</code> æ–‡ä»¶ä¸­æ·»åŠ ä¸€äº›é€»è¾‘ï¼š</p> <p><strong>src/print.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">printMe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'I get called from print.js!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p>å¹¶ä¸”åœ¨ <code>src/index.js</code> æ–‡ä»¶ä¸­ä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import printMe from './print.js';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const btn = document.createElement('button');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  btn.innerHTML = 'Click me and check the console!';
</span><span class="token prefix inserted">+</span><span class="token line">  btn.onclick = printMe;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">  element.appendChild(btn);
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>è¿˜è¦æ›´æ–° <code>dist/index.html</code> æ–‡ä»¶ï¼Œæ¥ä¸º webpack åˆ†ç¦»å…¥å£åšå¥½å‡†å¤‡ï¼š</p> <p><strong>dist/index.html</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&#x3C;!DOCTYPE html>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;html>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;head>
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;meta charset="utf-8" />
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;title>ç®¡ç†èµ„æº&#x3C;/title>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;title>ç®¡ç†è¾“å‡º&#x3C;/title>
</span><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="./print.bundle.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/head>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;body>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="bundle.js">&#x3C;/script>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="./index.bundle.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/body>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;/html></span></span></code></pre> <p>ç°åœ¨è°ƒæ•´é…ç½®ã€‚æˆ‘ä»¬å°†åœ¨ entry æ·»åŠ  <code>src/print.js</code> ä½œä¸ºæ–°çš„å…¥å£èµ·ç‚¹ï¼ˆ<code>print</code>ï¼‰ï¼Œç„¶åä¿®æ”¹ outputï¼Œä»¥ä¾¿æ ¹æ®å…¥å£èµ·ç‚¹å®šä¹‰çš„åç§°ï¼ŒåŠ¨æ€åœ°äº§ç”Ÿ bundle åç§°ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  entry: './src/index.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  entry: {
</span><span class="token prefix inserted">+</span><span class="token line">    index: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">    print: './src/print.js',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    filename: 'bundle.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename: '[name].bundle.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>æ‰§è¡Œ <code>npm run build</code>ï¼Œç„¶åçœ‹åˆ°ç”Ÿæˆå¦‚ä¸‹ï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset index.bundle.js <span class="token number">69.5</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span> <span class="token number">1</span> related asset
asset print.bundle.js <span class="token number">316</span> bytes <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: print<span class="token punctuation">)</span>
runtime modules <span class="token number">1.36</span> KiB <span class="token number">7</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">406</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/print.js <span class="token number">83</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">1996</span> ms</code></pre> <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œwebpack ç”Ÿæˆ <code>print.bundle.js</code> å’Œ <code>index.bundle.js</code> æ–‡ä»¶ï¼Œè¿™ä¹Ÿå’Œæˆ‘ä»¬åœ¨ <code>index.html</code> æ–‡ä»¶ä¸­æŒ‡å®šçš„æ–‡ä»¶åç§°ç›¸å¯¹åº”ã€‚å¦‚æœä½ åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>index.html</code>ï¼Œå°±å¯ä»¥çœ‹åˆ°åœ¨ç‚¹å‡»æŒ‰é’®æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚</p> <p>ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æ›´æ”¹äº†æˆ‘ä»¬çš„ä¸€ä¸ªå…¥å£èµ·ç‚¹çš„åç§°ï¼Œç”šè‡³æ·»åŠ äº†ä¸€ä¸ªæ–°çš„å…¥å£ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä¼šåœ¨æ„å»ºæ—¶é‡æ–°å‘½åç”Ÿæˆçš„ bundleï¼Œä½†æ˜¯æˆ‘ä»¬çš„ <code>index.html</code> æ–‡ä»¶ä»ç„¶å¼•ç”¨æ—§çš„åç§°ã€‚è®©æˆ‘ä»¬ç”¨ <a href="../../plugins/html-webpack-plugin.htm" tppabs="https://webpack.docschina.org/plugins/html-webpack-plugin"><code>HtmlWebpackPlugin</code></a> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p> <h2 id="setting-up-htmlwebpackplugin">è®¾ç½® HtmlWebpackPlugin <a href="#setting-up-htmlwebpackplugin" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é¦–å…ˆå®‰è£…æ’ä»¶ï¼Œå¹¶ä¸”è°ƒæ•´ <code>webpack.config.js</code> æ–‡ä»¶ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev html-webpack-plugin</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  plugins: [
</span><span class="token prefix inserted">+</span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix inserted">+</span><span class="token line">      title: 'ç®¡ç†è¾“å‡º',
</span><span class="token prefix inserted">+</span><span class="token line">    }),
</span><span class="token prefix inserted">+</span><span class="token line">  ],
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>åœ¨æˆ‘ä»¬æ„å»ºä¹‹å‰ï¼Œä½ åº”è¯¥äº†è§£ï¼Œè™½ç„¶åœ¨ <code>dist/</code> æ–‡ä»¶å¤¹æˆ‘ä»¬å·²ç»æœ‰äº† <code>index.html</code> è¿™ä¸ªæ–‡ä»¶ï¼Œç„¶è€Œ <code>HtmlWebpackPlugin</code> è¿˜æ˜¯ä¼šé»˜è®¤ç”Ÿæˆå®ƒè‡ªå·±çš„ <code>index.html</code> æ–‡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¼šç”¨æ–°ç”Ÿæˆçš„ <code>index.html</code> æ–‡ä»¶ï¼Œæ›¿æ¢æˆ‘ä»¬çš„åŸæœ‰æ–‡ä»¶ã€‚æˆ‘ä»¬çœ‹ä¸‹æ‰§è¡Œ <code>npm run build</code> åä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset index.bundle.js <span class="token number">69.5</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span> <span class="token number">1</span> related asset
asset print.bundle.js <span class="token number">316</span> bytes <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: print<span class="token punctuation">)</span>
asset index.html <span class="token number">253</span> bytes <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
runtime modules <span class="token number">1.36</span> KiB <span class="token number">7</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">406</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/print.js <span class="token number">83</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">2189</span> ms</code></pre> <p>å¦‚æœåœ¨ä»£ç ç¼–è¾‘å™¨ä¸­æ‰“å¼€ <code>index.html</code>ï¼Œä½ ä¼šçœ‹åˆ° <code>HtmlWebpackPlugin</code> åˆ›å»ºäº†ä¸€ä¸ªå…¨æ–°çš„æ–‡ä»¶ï¼Œæ‰€æœ‰çš„ bundle ä¼šè‡ªåŠ¨æ·»åŠ åˆ° html ä¸­ã€‚</p> <p>å¦‚æœä½ æƒ³è¦äº†è§£ <code>HtmlWebpackPlugin</code> æ’ä»¶æä¾›çš„å…¨éƒ¨çš„åŠŸèƒ½å’Œé€‰é¡¹ï¼Œä½ å°±åº”è¯¥é˜…è¯» <a href="javascript:if(confirm('https://github.com/jantimon/html-webpack-plugin  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/jantimon/html-webpack-plugin'" tppabs="https://github.com/jantimon/html-webpack-plugin"><code>HtmlWebpackPlugin</code></a> ä»“åº“ä¸­çš„æºç ã€‚</p> <h2 id="cleaning-up-the-dist-folder">æ¸…ç† <code>/dist</code> æ–‡ä»¶å¤¹ <a href="#cleaning-up-the-dist-folder" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œç”±äºé—ç•™äº†ä¹‹å‰çš„æŒ‡å—å’Œä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬çš„ <code>/dist</code> æ–‡ä»¶å¤¹æ˜¾å¾—ç›¸å½“æ‚ä¹±ã€‚webpack å°†ç”Ÿæˆæ–‡ä»¶å¹¶æ”¾ç½®åœ¨ <code>/dist</code> æ–‡ä»¶å¤¹ä¸­ï¼Œä½†æ˜¯å®ƒä¸ä¼šè¿½è¸ªå“ªäº›æ–‡ä»¶æ˜¯å®é™…åœ¨é¡¹ç›®ä¸­ç”¨åˆ°çš„ã€‚</p> <p>é€šå¸¸æ¯”è¾ƒæ¨èçš„åšæ³•æ˜¯ï¼Œåœ¨æ¯æ¬¡æ„å»ºå‰æ¸…ç† <code>/dist</code> æ–‡ä»¶å¤¹ï¼Œè¿™æ ·åªä¼šç”Ÿæˆç”¨åˆ°çš„æ–‡ä»¶ã€‚è®©æˆ‘ä»¬å®ç°è¿™ä¸ªéœ€æ±‚ã€‚</p> <p><a href="javascript:if(confirm('https://www.npmjs.com/package/clean-webpack-plugin  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.npmjs.com/package/clean-webpack-plugin'" tppabs="https://www.npmjs.com/package/clean-webpack-plugin"><code>clean-webpack-plugin</code></a> æ˜¯ä¸€ä¸ªæµè¡Œçš„æ¸…ç†æ’ä»¶ï¼Œå®‰è£…å’Œé…ç½®å®ƒã€‚</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev clean-webpack-plugin</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    new CleanWebpackPlugin(),
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      title: 'Output Management',
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>ç°åœ¨ï¼Œæ‰§è¡Œ <code>npm run build</code>ï¼Œæ£€æŸ¥ <code>/dist</code> æ–‡ä»¶å¤¹ã€‚å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œç°åœ¨åªä¼šçœ‹åˆ°æ„å»ºåç”Ÿæˆçš„æ–‡ä»¶ï¼Œè€Œæ²¡æœ‰æ—§æ–‡ä»¶ï¼</p> <h2 id="the-manifest">manifest <a href="#the-manifest" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä½ å¯èƒ½ä¼šå¾ˆæ„Ÿå…´è¶£ï¼Œwebpack å’Œ webpack æ’ä»¶ä¼¼ä¹â€œçŸ¥é“â€åº”è¯¥ç”Ÿæˆå“ªäº›æ–‡ä»¶ã€‚ç­”æ¡ˆæ˜¯ï¼Œwebpack é€šè¿‡ manifestï¼Œå¯ä»¥è¿½è¸ªæ‰€æœ‰æ¨¡å—åˆ°è¾“å‡º bundle ä¹‹é—´çš„æ˜ å°„ã€‚å¦‚æœä½ æƒ³è¦çŸ¥é“å¦‚ä½•ä»¥å…¶ä»–æ–¹å¼æ¥æ§åˆ¶ webpack <a href="../../configuration/output.htm" tppabs="https://webpack.docschina.org/configuration/output"><code>è¾“å‡º</code></a>ï¼Œäº†è§£ manifest æ˜¯ä¸ªå¥½çš„å¼€å§‹ã€‚</p> <p>é€šè¿‡ <a href="javascript:if(confirm('https://github.com/shellscape/webpack-manifest-plugin  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/shellscape/webpack-manifest-plugin'" tppabs="https://github.com/shellscape/webpack-manifest-plugin"><code>WebpackManifestPlugin</code></a> æ’ä»¶ï¼Œå¯ä»¥å°† manifest æ•°æ®æå–ä¸ºä¸€ä¸ªå®¹æ˜“ä½¿ç”¨çš„ json æ–‡ä»¶ã€‚</p> <p>æˆ‘ä»¬ä¸ä¼šåœ¨æ­¤å±•ç¤ºä¸€ä¸ªå¦‚ä½•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ­¤æ’ä»¶çš„å®Œæ•´ç¤ºä¾‹ï¼Œä½ å¯ä»¥åœ¨ <a href="../../concepts/manifest.htm" tppabs="https://webpack.docschina.org/concepts/manifest">manifest</a> æ¦‚å¿µé¡µé¢æ·±å…¥é˜…è¯»ï¼Œä»¥åŠåœ¨ <a href="../caching.htm" tppabs="https://webpack.docschina.org/guides/caching">ç¼“å­˜</a> æŒ‡å—ä¸­ï¼Œäº†è§£å®ƒä¸é•¿æ•ˆç¼“å­˜æœ‰ä½•å…³ç³»ã€‚</p> <h2 id="conclusion">ç»“è®º <a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç°åœ¨ï¼Œä½ å·²ç»äº†è§£å¦‚ä½•å‘ HTML åŠ¨æ€æ·»åŠ  bundleï¼Œè®©æˆ‘ä»¬æ·±å…¥ <a href="../development.htm" tppabs="https://webpack.docschina.org/guides/development">å¼€å‘ç¯å¢ƒ</a> æŒ‡å—ã€‚æˆ–è€…å¦‚æœä½ æƒ³è¦æ·±å…¥æ›´å¤šç›¸å…³é«˜çº§è¯é¢˜ï¼Œæˆ‘ä»¬æ¨èä½ å‰å¾€ <a href="../code-splitting.htm" tppabs="https://webpack.docschina.org/guides/code-splitting">ä»£ç åˆ†ç¦»</a> æŒ‡å—ã€‚</p> <h1 id="å¼€å‘ç¯å¢ƒ">å¼€å‘ç¯å¢ƒ<a href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote class="tip"> <p>æœ¬æŒ‡å—ç»§ç»­æ²¿ç”¨ <a href="../output-management.htm" tppabs="https://webpack.docschina.org/guides/output-management">ç®¡ç†è¾“å‡º</a> æŒ‡å—ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚</p> </blockquote> <p>å¦‚æœä½ ä¸€ç›´è·Ÿéšä¹‹å‰çš„æŒ‡å—ï¼Œåº”è¯¥å¯¹ä¸€äº› webpack åŸºç¡€çŸ¥è¯†æœ‰ç€å¾ˆæ‰å®çš„ç†è§£ã€‚åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œå…ˆæ¥çœ‹çœ‹å¦‚ä½•è®¾ç½®ä¸€ä¸ªå¼€å‘ç¯å¢ƒï¼Œä½¿æˆ‘ä»¬çš„å¼€å‘ä½“éªŒå˜å¾—æ›´è½»æ¾ä¸€äº›ã€‚</p> <blockquote class="warning"> <p>æœ¬æŒ‡å—ä¸­çš„å·¥å…·__ä»…ç”¨äºå¼€å‘ç¯å¢ƒ__ï¼Œè¯·__ä¸è¦__åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å®ƒä»¬ï¼</p> </blockquote> <p>åœ¨å¼€å§‹å‰ï¼Œæˆ‘ä»¬å…ˆå°† <a href="../../configuration/mode/index.htm#mode-development" tppabs="https://webpack.docschina.org/configuration/mode/#mode-development"><code>mode</code> è®¾ç½®ä¸º <code>'development'</code></a>ï¼Œå¹¶å°† <code>title</code> è®¾ç½®ä¸º <code>'Development'</code>ã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  mode: 'development',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new CleanWebpackPlugin(),
</span><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      title: 'Output Management',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      title: 'Development',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <h2 id="using-source-maps">ä½¿ç”¨ source map <a href="#using-source-maps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å½“ webpack æ‰“åŒ…æºä»£ç æ—¶ï¼Œå¯èƒ½ä¼šå¾ˆéš¾è¿½è¸ªåˆ° error(é”™è¯¯) å’Œ warning(è­¦å‘Š) åœ¨æºä»£ç ä¸­çš„åŸå§‹ä½ç½®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå°†ä¸‰ä¸ªæºæ–‡ä»¶ï¼ˆ<code>a.js</code>, <code>b.js</code> å’Œ <code>c.js</code>ï¼‰æ‰“åŒ…åˆ°ä¸€ä¸ª bundleï¼ˆ<code>bundle.js</code>ï¼‰ä¸­ï¼Œè€Œå…¶ä¸­ä¸€ä¸ªæºæ–‡ä»¶åŒ…å«ä¸€ä¸ªé”™è¯¯ï¼Œé‚£ä¹ˆå †æ ˆè·Ÿè¸ªå°±ä¼šç›´æ¥æŒ‡å‘åˆ° <code>bundle.js</code>ã€‚ä½ å¯èƒ½éœ€è¦å‡†ç¡®åœ°çŸ¥é“é”™è¯¯æ¥è‡ªäºå“ªä¸ªæºæ–‡ä»¶ï¼Œæ‰€ä»¥è¿™ç§æç¤ºè¿™é€šå¸¸ä¸ä¼šæä¾›å¤ªå¤šå¸®åŠ©ã€‚</p> <p>ä¸ºäº†æ›´å®¹æ˜“åœ°è¿½è¸ª error å’Œ warningï¼ŒJavaScript æä¾›äº† <a href="javascript:if(confirm('http://blog.teamtreehouse.com/introduction-source-maps  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://blog.teamtreehouse.com/introduction-source-maps'" tppabs="http://blog.teamtreehouse.com/introduction-source-maps">source maps</a> åŠŸèƒ½ï¼Œå¯ä»¥å°†ç¼–è¯‘åçš„ä»£ç æ˜ å°„å›åŸå§‹æºä»£ç ã€‚å¦‚æœä¸€ä¸ªé”™è¯¯æ¥è‡ªäº <code>b.js</code>ï¼Œsource map å°±ä¼šæ˜ç¡®çš„å‘Šè¯‰ä½ ã€‚</p> <p>source map æœ‰è®¸å¤š <a href="../../configuration/devtool.htm" tppabs="https://webpack.docschina.org/configuration/devtool">å¯ç”¨é€‰é¡¹</a>ï¼Œè¯·åŠ¡å¿…ä»”ç»†é˜…è¯»å®ƒä»¬ï¼Œä»¥ä¾¿å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œé…ç½®ã€‚</p> <p>å¯¹äºæœ¬æŒ‡å—ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ <code>inline-source-map</code> é€‰é¡¹ï¼Œè¿™æœ‰åŠ©äºè§£é‡Šè¯´æ˜ç¤ºä¾‹æ„å›¾ï¼ˆæ­¤é…ç½®ä»…ç”¨äºç¤ºä¾‹ï¼Œä¸è¦ç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  devtool: 'inline-source-map',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new CleanWebpackPlugin(),
</span><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      title: 'Development',
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥åšä¸€äº›è°ƒè¯•ï¼Œåœ¨ <code>print.js</code> æ–‡ä»¶ä¸­ç”Ÿæˆä¸€ä¸ªé”™è¯¯ï¼š</p> <p><strong>src/print.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">export default function printMe() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  console.log('I get called from print.js!');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  cosnole.log('I get called from print.js!');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>è¿è¡Œ <code>npm run build</code>ï¼Œç¼–è¯‘å¦‚ä¸‹ï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset index.bundle.js <span class="token number">1.38</span> MiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
asset print.bundle.js <span class="token number">6.25</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: print<span class="token punctuation">)</span>
asset index.html <span class="token number">272</span> bytes <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
runtime modules <span class="token number">1.9</span> KiB <span class="token number">9</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">406</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/print.js <span class="token number">83</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">706</span> ms</code></pre> <p>ç°åœ¨ï¼Œåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ç”Ÿæˆçš„ <code>index.html</code> æ–‡ä»¶ï¼Œç‚¹å‡»æŒ‰é’®ï¼Œå¹¶ä¸”åœ¨æ§åˆ¶å°æŸ¥çœ‹æ˜¾ç¤ºçš„é”™è¯¯ã€‚é”™è¯¯åº”è¯¥å¦‚ä¸‹ï¼š</p> <pre><code class="hljs language-bash">Uncaught ReferenceError: cosnole is not defined
   at HTMLButtonElement.printMe <span class="token punctuation">(</span>print.js:2<span class="token punctuation">)</span></code></pre> <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ­¤é”™è¯¯åŒ…å«æœ‰å‘ç”Ÿé”™è¯¯çš„æ–‡ä»¶ï¼ˆ<code>print.js</code>ï¼‰å’Œè¡Œå·ï¼ˆ2ï¼‰çš„å¼•ç”¨ã€‚è¿™æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ï¼Œå› ä¸ºç°åœ¨æˆ‘ä»¬å¯ä»¥ç¡®åˆ‡åœ°çŸ¥é“ï¼Œæ‰€è¦è§£å†³é—®é¢˜çš„ä½ç½®ã€‚</p> <h2 id="choosing-a-development-tool">é€‰æ‹©ä¸€ä¸ªå¼€å‘å·¥å…· <a href="#choosing-a-development-tool" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <blockquote class="warning"> <p>æŸäº›æ–‡æœ¬ç¼–è¾‘å™¨å…·æœ‰ "safe write(å®‰å…¨å†™å…¥)" åŠŸèƒ½ï¼Œå¯èƒ½ä¼šå¹²æ‰°ä¸‹é¢ä¸€äº›å·¥å…·ã€‚é˜…è¯» <a href="#adjusting-your-text-editor">è°ƒæ•´æ–‡æœ¬ç¼–è¾‘å™¨</a> ä»¥è§£å†³è¿™äº›é—®é¢˜ã€‚</p> </blockquote> <p>åœ¨æ¯æ¬¡ç¼–è¯‘ä»£ç æ—¶ï¼Œæ‰‹åŠ¨è¿è¡Œ <code>npm run build</code> ä¼šæ˜¾å¾—å¾ˆéº»çƒ¦ã€‚</p> <p>webpack æä¾›å‡ ç§å¯é€‰æ–¹å¼ï¼Œå¸®åŠ©ä½ åœ¨ä»£ç å‘ç”Ÿå˜åŒ–åè‡ªåŠ¨ç¼–è¯‘ä»£ç ï¼š</p> <ol> <li>webpack's <a href="../../configuration/watch/index.htm#watch" tppabs="https://webpack.docschina.org/configuration/watch/#watch">Watch Mode</a></li> <li><a href="javascript:if(confirm('https://github.com/webpack/webpack-dev-server  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack-dev-server'" tppabs="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a></li> <li><a href="javascript:if(confirm('https://github.com/webpack/webpack-dev-middleware  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack-dev-middleware'" tppabs="https://github.com/webpack/webpack-dev-middleware">webpack-dev-middleware</a></li> </ol> <p>å¤šæ•°åœºæ™¯ä¸­ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨ <code>webpack-dev-server</code>ï¼Œä½†æ˜¯ä¸å¦¨æ¢è®¨ä¸€ä¸‹ä»¥ä¸Šçš„æ‰€æœ‰é€‰é¡¹ã€‚</p> <h3 id="using-watch-mode">ä½¿ç”¨ watch mode(è§‚å¯Ÿæ¨¡å¼) <a href="#using-watch-mode" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>ä½ å¯ä»¥æŒ‡ç¤º webpack "watch" ä¾èµ–å›¾ä¸­æ‰€æœ‰æ–‡ä»¶çš„æ›´æ”¹ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªæ–‡ä»¶è¢«æ›´æ–°ï¼Œä»£ç å°†è¢«é‡æ–°ç¼–è¯‘ï¼Œæ‰€ä»¥ä½ ä¸å¿…å†å»æ‰‹åŠ¨è¿è¡Œæ•´ä¸ªæ„å»ºã€‚</p> <p>æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªç”¨äºå¯åŠ¨ webpack watch mode çš„ npm scriptsï¼š</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "private": true,
</span><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "watch": "webpack --watch",
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    "build": "webpack"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "clean-webpack-plugin": "^3.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "html-webpack-plugin": "^4.5.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.4.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.2.0"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "dependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "lodash": "^4.17.20"
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>å¦‚æœä¸æƒ³åœ¨ watch è§¦å‘å¢é‡æ„å»ºååˆ é™¤ <code>index.html</code> æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ <code>CleanWebpackPlugin</code> ä¸­é…ç½® <a href="javascript:if(confirm('https://github.com/johnagan/clean-webpack-plugin  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/johnagan/clean-webpack-plugin#options-and-defaults-optional'" tppabs="https://github.com/johnagan/clean-webpack-plugin#options-and-defaults-optional"><code>cleanStaleWebpackAssets</code> é€‰é¡¹</a> æ¥å®ç°ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  devtool: 'inline-source-map',
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    new CleanWebpackPlugin(),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    new CleanWebpackPlugin({ cleanStaleWebpackAssets: false }),
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      title: 'Development',
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>ç°åœ¨ï¼Œä½ å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ <code>npm run watch</code>ï¼Œç„¶åå°±ä¼šçœ‹åˆ° webpack æ˜¯å¦‚ä½•ç¼–è¯‘ä»£ç ã€‚ ç„¶è€Œï¼Œä½ ä¼šå‘ç°å¹¶æ²¡æœ‰é€€å‡ºå‘½ä»¤è¡Œã€‚è¿™æ˜¯å› ä¸ºæ­¤ script å½“å‰è¿˜åœ¨ watch ä½ çš„æ–‡ä»¶ã€‚</p> <p>ç°åœ¨ï¼Œwebpack è§‚å¯Ÿæ–‡ä»¶çš„åŒæ—¶ï¼Œå…ˆç§»é™¤æˆ‘ä»¬ä¹‹å‰åŠ å…¥çš„é”™è¯¯ï¼š</p> <p><strong>src/print.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">export default function printMe() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  cosnole.log('I get called from print.js!');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  console.log('I get called from print.js!');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>ç°åœ¨ï¼Œä¿å­˜æ–‡ä»¶å¹¶æ£€æŸ¥ terminal(ç»ˆç«¯) çª—å£ã€‚åº”è¯¥å¯ä»¥çœ‹åˆ° webpack è‡ªåŠ¨åœ°é‡æ–°ç¼–è¯‘ä¿®æ”¹åçš„æ¨¡å—ï¼</p> <p>å”¯ä¸€çš„ç¼ºç‚¹æ˜¯ï¼Œä¸ºäº†çœ‹åˆ°ä¿®æ”¹åçš„å®é™…æ•ˆæœï¼Œä½ éœ€è¦åˆ·æ–°æµè§ˆå™¨ã€‚å¦‚æœèƒ½å¤Ÿè‡ªåŠ¨åˆ·æ–°æµè§ˆå™¨å°±æ›´å¥½äº†ï¼Œå› æ­¤æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šå°è¯•é€šè¿‡ <code>webpack-dev-server</code> å®ç°æ­¤åŠŸèƒ½ã€‚</p> <h3 id="using-webpack-dev-server">ä½¿ç”¨ webpack-dev-server <a href="#using-webpack-dev-server" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>webpack-dev-server</code> ä¸ºä½ æä¾›äº†ä¸€ä¸ªç®€å•çš„ web serverï¼Œå¹¶ä¸”å…·æœ‰ live reloading(å®æ—¶é‡æ–°åŠ è½½) åŠŸèƒ½ã€‚è®¾ç½®å¦‚ä¸‹ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack-dev-server</code></pre> <p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå‘ŠçŸ¥ dev serverï¼Œä»ä»€ä¹ˆä½ç½®æŸ¥æ‰¾æ–‡ä»¶ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  devtool: 'inline-source-map',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  devServer: {
</span><span class="token prefix inserted">+</span><span class="token line">    contentBase: './dist',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new CleanWebpackPlugin({ cleanStaleWebpackAssets: false }),
</span><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      title: 'Development',
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>ä»¥ä¸Šé…ç½®å‘ŠçŸ¥ <code>webpack-dev-server</code>ï¼Œå°† <code>dist</code> ç›®å½•ä¸‹çš„æ–‡ä»¶ serve åˆ° <code>localhost:8080</code> ä¸‹ã€‚ï¼ˆè¯‘æ³¨ï¼šserveï¼Œå°†èµ„æºä½œä¸º server çš„å¯è®¿é—®æ–‡ä»¶ï¼‰</p> <blockquote class="warning"> <p>webpack-dev-server åœ¨ç¼–è¯‘ä¹‹åä¸ä¼šå†™å…¥åˆ°ä»»ä½•è¾“å‡ºæ–‡ä»¶ã€‚è€Œæ˜¯å°† bundle æ–‡ä»¶ä¿ç•™åœ¨å†…å­˜ä¸­ï¼Œç„¶åå°†å®ƒä»¬ serve åˆ° server ä¸­ï¼Œå°±å¥½åƒå®ƒä»¬æ˜¯æŒ‚è½½åœ¨ server æ ¹è·¯å¾„ä¸Šçš„çœŸå®æ–‡ä»¶ä¸€æ ·ã€‚å¦‚æœä½ çš„é¡µé¢å¸Œæœ›åœ¨å…¶ä»–ä¸åŒè·¯å¾„ä¸­æ‰¾åˆ° bundle æ–‡ä»¶ï¼Œåˆ™å¯ä»¥é€šè¿‡ dev server é…ç½®ä¸­çš„ <a href="../../configuration/dev-server/index.htm#devserverpublicpath-" tppabs="https://webpack.docschina.org/configuration/dev-server/#devserverpublicpath-"><code>publicPath</code></a> é€‰é¡¹è¿›è¡Œä¿®æ”¹ã€‚</p> </blockquote> <p>æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå¯ä»¥ç›´æ¥è¿è¡Œ dev server çš„ scriptï¼š</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "private": true,
</span><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1",
</span><span class="token prefix unchanged"> </span><span class="token line">    "watch": "webpack --watch",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "start": "webpack serve --open",
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    "build": "webpack"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "clean-webpack-plugin": "^3.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "html-webpack-plugin": "^4.5.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.4.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.2.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-dev-server": "^3.11.0"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "dependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "lodash": "^4.17.20"
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>ç°åœ¨ï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ <code>npm start</code>ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°æµè§ˆå™¨è‡ªåŠ¨åŠ è½½é¡µé¢ã€‚å¦‚æœä½ æ›´æ”¹ä»»ä½•æºæ–‡ä»¶å¹¶ä¿å­˜å®ƒä»¬ï¼Œweb server å°†åœ¨ç¼–è¯‘ä»£ç åè‡ªåŠ¨é‡æ–°åŠ è½½ã€‚è¯•è¯•çœ‹ï¼</p> <p><code>webpack-dev-server</code> å…·æœ‰è®¸å¤šå¯é…ç½®çš„é€‰é¡¹ã€‚å…³äºå…¶ä»–æ›´å¤šé…ç½®ï¼Œè¯·æŸ¥çœ‹ <a href="../../configuration/dev-server.htm" tppabs="https://webpack.docschina.org/configuration/dev-server">é…ç½®æ–‡æ¡£</a>ã€‚</p> <blockquote class="tip"> <p>ç°åœ¨ï¼Œserver æ­£åœ¨è¿è¡Œï¼Œä½ å¯èƒ½éœ€è¦å°è¯• <a href="../hot-module-replacement.htm" tppabs="https://webpack.docschina.org/guides/hot-module-replacement">æ¨¡å—çƒ­æ›¿æ¢(hot module replacement)</a>ï¼</p> </blockquote> <h3 id="using-webpack-dev-middleware">ä½¿ç”¨ webpack-dev-middleware <a href="#using-webpack-dev-middleware" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>webpack-dev-middleware</code> æ˜¯ä¸€ä¸ªå°è£…å™¨(wrapper)ï¼Œå®ƒå¯ä»¥æŠŠ webpack å¤„ç†è¿‡çš„æ–‡ä»¶å‘é€åˆ°ä¸€ä¸ª serverã€‚ <code>webpack-dev-server</code> åœ¨å†…éƒ¨ä½¿ç”¨äº†å®ƒï¼Œç„¶è€Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ package æ¥ä½¿ç”¨ï¼Œä»¥ä¾¿æ ¹æ®éœ€æ±‚è¿›è¡Œæ›´å¤šè‡ªå®šä¹‰è®¾ç½®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª webpack-dev-middleware é…åˆ express server çš„ç¤ºä¾‹ã€‚</p> <p>é¦–å…ˆï¼Œå®‰è£… <code>express</code> å’ŒÂ <code>webpack-dev-middleware</code>ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev express webpack-dev-middleware</code></pre> <p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´ webpack é…ç½®æ–‡ä»¶ï¼Œä»¥ç¡®ä¿ middleware(ä¸­é—´ä»¶) åŠŸèƒ½èƒ½å¤Ÿæ­£ç¡®å¯ç”¨ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  devtool: 'inline-source-map',
</span><span class="token prefix unchanged"> </span><span class="token line">  devServer: {
</span><span class="token prefix unchanged"> </span><span class="token line">    contentBase: './dist',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new CleanWebpackPlugin({ cleanStaleWebpackAssets: false }),
</span><span class="token prefix unchanged"> </span><span class="token line">    new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      title: 'Development',
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    publicPath: '/',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>æˆ‘ä»¬å°†ä¼šåœ¨ server è„šæœ¬ä½¿ç”¨ <code>publicPath</code>ï¼Œä»¥ç¡®ä¿æ–‡ä»¶èµ„æºèƒ½å¤Ÿæ­£ç¡®åœ° serve åœ¨ <code>http://localhost:3000</code> ä¸‹ï¼Œç¨åæˆ‘ä»¬ä¼šæŒ‡å®š port number(ç«¯å£å·)ã€‚æ¥ä¸‹æ¥æ˜¯è®¾ç½®è‡ªå®šä¹‰ <code>express</code> serverï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- server.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- print.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>server.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpackDevMiddleware <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-dev-middleware'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å‘ŠçŸ¥ express ä½¿ç”¨ webpack-dev-middlewareï¼Œ</span>
<span class="token comment">// ä»¥åŠå°† webpack.config.js é…ç½®æ–‡ä»¶ä½œä¸ºåŸºç¡€é…ç½®ã€‚</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>
  <span class="token function">webpackDevMiddleware</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> config<span class="token punctuation">.</span>output<span class="token punctuation">.</span>publicPath<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// å°†æ–‡ä»¶ serve åˆ° port 3000ã€‚</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Example app listening on port 3000!\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>ç°åœ¨ï¼Œæ·»åŠ ä¸€ä¸ª npm scriptï¼Œä»¥ä½¿æˆ‘ä»¬æ›´æ–¹ä¾¿åœ°è¿è¡Œ serverï¼š</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">{
</span><span class="token prefix unchanged"> </span><span class="token line">  "name": "webpack-demo",
</span><span class="token prefix unchanged"> </span><span class="token line">  "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">  "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "private": true,
</span><span class="token prefix unchanged"> </span><span class="token line">  "scripts": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "test": "echo \"Error: no test specified\" &#x26;&#x26; exit 1",
</span><span class="token prefix unchanged"> </span><span class="token line">    "watch": "webpack --watch",
</span><span class="token prefix unchanged"> </span><span class="token line">    "start": "webpack serve --open",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "server": "node server.js",
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    "build": "webpack"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">  "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">  "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">  "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "clean-webpack-plugin": "^3.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "express": "^4.17.1",
</span><span class="token prefix unchanged"> </span><span class="token line">    "html-webpack-plugin": "^4.5.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack": "^5.4.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-cli": "^4.2.0",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-dev-middleware": "^4.0.2",
</span><span class="token prefix unchanged"> </span><span class="token line">    "webpack-dev-server": "^3.11.0"
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  "dependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">    "lodash": "^4.17.20"
</span><span class="token prefix unchanged"> </span><span class="token line">  }
</span><span class="token prefix unchanged"> </span><span class="token line">}</span></span></code></pre> <p>ç°åœ¨ï¼Œåœ¨ terminal(ç»ˆç«¯) ä¸­æ‰§è¡Œ <code>npm run server</code>ï¼Œå°†ä¼šæœ‰ç±»ä¼¼å¦‚ä¸‹ä¿¡æ¯è¾“å‡ºï¼š</p> <pre><code class="hljs language-bash">Example app listening on port <span class="token number">3000</span><span class="token operator">!</span>
<span class="token punctuation">..</span>.
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> asset index.bundle.js <span class="token number">1.38</span> MiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> asset print.bundle.js <span class="token number">6.25</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: print<span class="token punctuation">)</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> asset index.html <span class="token number">274</span> bytes <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> runtime modules <span class="token number">1.9</span> KiB <span class="token number">9</span> modules
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> cacheable modules <span class="token number">530</span> KiB
<span class="token operator">&#x3C;</span>i<span class="token operator">></span>   ./src/index.js <span class="token number">406</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span>   ./src/print.js <span class="token number">83</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span>   ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">709</span> ms
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> Compiled successfully.
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> Compiling<span class="token punctuation">..</span>.
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> assets by status <span class="token number">1.38</span> MiB <span class="token punctuation">[</span>cached<span class="token punctuation">]</span> <span class="token number">2</span> assets
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> cached modules <span class="token number">530</span> KiB <span class="token punctuation">(</span>javascript<span class="token punctuation">)</span> <span class="token number">1.9</span> KiB <span class="token punctuation">(</span>runtime<span class="token punctuation">)</span> <span class="token punctuation">[</span>cached<span class="token punctuation">]</span> <span class="token number">12</span> modules
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">19</span> ms
<span class="token operator">&#x3C;</span>i<span class="token operator">></span> <span class="token punctuation">[</span>webpack-dev-middleware<span class="token punctuation">]</span> Compiled successfully.</code></pre> <p>ç°åœ¨ï¼Œæ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® <code>http://localhost:3000</code>ã€‚åº”è¯¥çœ‹åˆ° webpack åº”ç”¨ç¨‹åºå·²ç»è¿è¡Œï¼</p> <blockquote class="tip"> <p>å¦‚æœæƒ³è¦äº†è§£æ›´å¤šå…³äºæ¨¡å—çƒ­æ›¿æ¢(hot module replacement)çš„è¿è¡Œæœºåˆ¶ï¼Œæˆ‘ä»¬æ¨èä½ æŸ¥çœ‹ <a href="../hot-module-replacement/index.htm" tppabs="https://webpack.docschina.org/guides/hot-module-replacement/">æ¨¡å—çƒ­æ›¿æ¢(hot module replacement)</a> æŒ‡å—ã€‚</p> </blockquote> <h2 id="adjusting-your-text-editor">è°ƒæ•´æ–‡æœ¬ç¼–è¾‘å™¨ <a href="#adjusting-your-text-editor" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä½¿ç”¨è‡ªåŠ¨ç¼–è¯‘ä»£ç æ—¶ï¼Œå¯èƒ½ä¼šåœ¨ä¿å­˜æ–‡ä»¶æ—¶é‡åˆ°ä¸€äº›é—®é¢˜ã€‚æŸäº›ç¼–è¾‘å™¨å…·æœ‰ "safe write(å®‰å…¨å†™å…¥)" åŠŸèƒ½ï¼Œä¼šå½±å“é‡æ–°ç¼–è¯‘ã€‚</p> <p>åœ¨ä¸€äº›å¸¸è§çš„ç¼–è¾‘å™¨ä¸­ç¦ç”¨æ­¤åŠŸèƒ½ï¼ŒæŸ¥çœ‹ä»¥ä¸‹åˆ—è¡¨ï¼š</p> <ul> <li><strong>Sublime Text 3</strong>ï¼šåœ¨ç”¨æˆ·é¦–é€‰é¡¹(user preferences)ä¸­æ·»åŠ  <code>atomic_save: 'false'</code>ã€‚</li> <li><strong>JetBrains IDEs (e.g. WebStorm)</strong>ï¼šåœ¨ <code>Preferences > Appearance &#x26; Behavior > System Settings</code> ä¸­å–æ¶ˆé€‰ä¸­ "Use safe write"ã€‚</li> <li><strong>Vim</strong>ï¼šåœ¨è®¾ç½®(settings)ä¸­å¢åŠ  <code>:set backupcopy=yes</code>ã€‚</li> </ul> <h2 id="conclusion">ç»“è®º <a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç°åœ¨ï¼Œä½ å·²ç»å­¦ä¼šäº†å¦‚ä½•è‡ªåŠ¨ç¼–è¯‘ä»£ç ï¼Œå¹¶è¿è¡Œä¸€ä¸ªç®€å•çš„ development serverï¼ŒæŸ¥çœ‹ä¸‹ä¸€ä¸ªæŒ‡å—ï¼Œå…¶ä¸­å°†ä»‹ç»<a href="../code-splitting/index.htm" tppabs="https://webpack.docschina.org/guides/code-splitting/">ä»£ç åˆ†å‰²ï¼ˆCode Splittingï¼‰</a>ã€‚</p> <h1 id="ä»£ç åˆ†ç¦»">ä»£ç åˆ†ç¦»<a href="#%E4%BB%A3%E7%A0%81%E5%88%86%E7%A6%BB" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote class="tip"> <p>æœ¬æŒ‡å—ç»§ç»­æ²¿ç”¨ <a href="../getting-started.htm" tppabs="https://webpack.docschina.org/guides/getting-started">èµ·æ­¥</a> ä¸­çš„ç¤ºä¾‹ä»£ç ã€‚è¯·ç¡®ä¿ä½ å·²ç†Ÿæ‚‰è¿™äº›æŒ‡å—ä¸­æä¾›çš„ç¤ºä¾‹ä»¥åŠ<a href="../output-management/index.htm" tppabs="https://webpack.docschina.org/guides/output-management/">è¾“å‡ºç®¡ç†</a>ç« èŠ‚ã€‚</p> </blockquote> <p>ä»£ç åˆ†ç¦»æ˜¯ webpack ä¸­æœ€å¼•äººæ³¨ç›®çš„ç‰¹æ€§ä¹‹ä¸€ã€‚æ­¤ç‰¹æ€§èƒ½å¤ŸæŠŠä»£ç åˆ†ç¦»åˆ°ä¸åŒçš„ bundle ä¸­ï¼Œç„¶åå¯ä»¥æŒ‰éœ€åŠ è½½æˆ–å¹¶è¡ŒåŠ è½½è¿™äº›æ–‡ä»¶ã€‚ä»£ç åˆ†ç¦»å¯ä»¥ç”¨äºè·å–æ›´å°çš„ bundleï¼Œä»¥åŠæ§åˆ¶èµ„æºåŠ è½½ä¼˜å…ˆçº§ï¼Œå¦‚æœä½¿ç”¨åˆç†ï¼Œä¼šæå¤§å½±å“åŠ è½½æ—¶é—´ã€‚</p> <p>å¸¸ç”¨çš„ä»£ç åˆ†ç¦»æ–¹æ³•æœ‰ä¸‰ç§ï¼š</p> <ul> <li><strong>å…¥å£èµ·ç‚¹</strong>ï¼šä½¿ç”¨ <a href="../../configuration/entry-context.htm" tppabs="https://webpack.docschina.org/configuration/entry-context"><code>entry</code></a> é…ç½®æ‰‹åŠ¨åœ°åˆ†ç¦»ä»£ç ã€‚</li> <li><strong>é˜²æ­¢é‡å¤</strong>ï¼šä½¿ç”¨ <a href="../../configuration/entry-context/index.htm#dependencies" tppabs="https://webpack.docschina.org/configuration/entry-context/#dependencies">Entry dependencies</a> æˆ–è€… <a href="../../plugins/split-chunks-plugin.htm" tppabs="https://webpack.docschina.org/plugins/split-chunks-plugin"><code>SplitChunksPlugin</code></a> å»é‡å’Œåˆ†ç¦» chunkã€‚</li> <li><strong>åŠ¨æ€å¯¼å…¥</strong>ï¼šé€šè¿‡æ¨¡å—çš„å†…è”å‡½æ•°è°ƒç”¨æ¥åˆ†ç¦»ä»£ç ã€‚</li> </ul> <h2 id="entry-points">å…¥å£èµ·ç‚¹(entry point) <a href="#entry-points" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>è¿™æ˜¯è¿„ä»Šä¸ºæ­¢æœ€ç®€å•ç›´è§‚çš„åˆ†ç¦»ä»£ç çš„æ–¹å¼ã€‚ä¸è¿‡ï¼Œè¿™ç§æ–¹å¼æ‰‹åŠ¨é…ç½®è¾ƒå¤šï¼Œå¹¶æœ‰ä¸€äº›éšæ‚£ï¼Œæˆ‘ä»¬å°†ä¼šè§£å†³è¿™äº›é—®é¢˜ã€‚å…ˆæ¥çœ‹çœ‹å¦‚ä½•ä» main bundle ä¸­åˆ†ç¦» another module(å¦ä¸€ä¸ªæ¨¡å—)ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- another-module.js
</span></span>|- /node_modules</code></pre> <p><strong>another-module.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>_<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'Another'</span><span class="token punctuation">,</span> <span class="token string">'module'</span><span class="token punctuation">,</span> <span class="token string">'loaded!'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  entry: './src/index.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  mode: 'development',
</span><span class="token prefix inserted">+</span><span class="token line">  entry: {
</span><span class="token prefix inserted">+</span><span class="token line">    index: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">    another: './src/another-module.js',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    filename: 'main.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename: '[name].bundle.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>è¿™å°†ç”Ÿæˆå¦‚ä¸‹æ„å»ºç»“æœï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset index.bundle.js <span class="token number">553</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
asset another.bundle.js <span class="token number">553</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: another<span class="token punctuation">)</span>
runtime modules <span class="token number">2.49</span> KiB <span class="token number">12</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/another-module.js <span class="token number">84</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">245</span> ms</code></pre> <p>æ­£å¦‚å‰é¢æåˆ°çš„ï¼Œè¿™ç§æ–¹å¼å­˜åœ¨ä¸€äº›éšæ‚£ï¼š</p> <ul> <li>å¦‚æœå…¥å£ chunk ä¹‹é—´åŒ…å«ä¸€äº›é‡å¤çš„æ¨¡å—ï¼Œé‚£äº›é‡å¤æ¨¡å—éƒ½ä¼šè¢«å¼•å…¥åˆ°å„ä¸ª bundle ä¸­ã€‚</li> <li>è¿™ç§æ–¹æ³•ä¸å¤Ÿçµæ´»ï¼Œå¹¶ä¸”ä¸èƒ½åŠ¨æ€åœ°å°†æ ¸å¿ƒåº”ç”¨ç¨‹åºé€»è¾‘ä¸­çš„ä»£ç æ‹†åˆ†å‡ºæ¥ã€‚</li> </ul> <p>ä»¥ä¸Šä¸¤ç‚¹ä¸­ï¼Œç¬¬ä¸€ç‚¹å¯¹æˆ‘ä»¬çš„ç¤ºä¾‹æ¥è¯´æ— ç–‘æ˜¯ä¸ªé—®é¢˜ï¼Œå› ä¸ºä¹‹å‰æˆ‘ä»¬åœ¨ <code>./src/index.js</code> ä¸­ä¹Ÿå¼•å…¥è¿‡ <code>lodash</code>ï¼Œè¿™æ ·å°±åœ¨ä¸¤ä¸ª bundle ä¸­é€ æˆé‡å¤å¼•ç”¨ã€‚åœ¨ä¸‹ä¸€ç« èŠ‚ä¼šç§»é™¤é‡å¤çš„æ¨¡å—ã€‚</p> <h2 id="prevent-duplication">é˜²æ­¢é‡å¤(prevent duplication) <a href="#prevent-duplication" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <h3 id="entry-dependencies">å…¥å£ä¾èµ– <a href="#entry-dependencies" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>é…ç½® <a href="../../configuration/entry-context/index.htm#dependencies" tppabs="https://webpack.docschina.org/configuration/entry-context/#dependencies"><code>dependOn</code> option</a> é€‰é¡¹ï¼Œè¿™æ ·å¯ä»¥åœ¨å¤šä¸ª chunk ä¹‹é—´å…±äº«æ¨¡å—ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    index: './src/index.js',
</span><span class="token prefix deleted">-</span><span class="token line">    another: './src/another-module.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    index: {
</span><span class="token prefix inserted">+</span><span class="token line">      import: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">      dependOn: 'shared',
</span><span class="token prefix inserted">+</span><span class="token line">    },
</span><span class="token prefix inserted">+</span><span class="token line">    another: {
</span><span class="token prefix inserted">+</span><span class="token line">      import: './src/another-module.js',
</span><span class="token prefix inserted">+</span><span class="token line">      dependOn: 'shared',
</span><span class="token prefix inserted">+</span><span class="token line">    },
</span><span class="token prefix inserted">+</span><span class="token line">    shared: 'lodash',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>å¦‚æœæˆ‘ä»¬è¦åœ¨ä¸€ä¸ª HTML é¡µé¢ä¸Šä½¿ç”¨å¤šä¸ªå…¥å£æ—¶ï¼Œè¿˜éœ€è®¾ç½® <code>optimization.runtimeChunk: 'single'</code>ï¼Œå¦åˆ™è¿˜ä¼šé‡åˆ°<a href="javascript:if(confirm('https://bundlers.tooling.report/code-splitting/multi-entry/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://bundlers.tooling.report/code-splitting/multi-entry/'" tppabs="https://bundlers.tooling.report/code-splitting/multi-entry/">è¿™é‡Œ</a>æ‰€è¿°çš„éº»çƒ¦ã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: {
</span><span class="token prefix unchanged"> </span><span class="token line">      import: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">      dependOn: 'shared',
</span><span class="token prefix unchanged"> </span><span class="token line">    },
</span><span class="token prefix unchanged"> </span><span class="token line">    another: {
</span><span class="token prefix unchanged"> </span><span class="token line">      import: './src/another-module.js',
</span><span class="token prefix unchanged"> </span><span class="token line">      dependOn: 'shared',
</span><span class="token prefix unchanged"> </span><span class="token line">    },
</span><span class="token prefix unchanged"> </span><span class="token line">    shared: 'lodash',
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  optimization: {
</span><span class="token prefix inserted">+</span><span class="token line">    runtimeChunk: 'single',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>æ„å»ºç»“æœå¦‚ä¸‹ï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset shared.bundle.js <span class="token number">549</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: shared<span class="token punctuation">)</span>
asset runtime.bundle.js <span class="token number">7.79</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: runtime<span class="token punctuation">)</span>
asset index.bundle.js <span class="token number">1.77</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
asset another.bundle.js <span class="token number">1.65</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: another<span class="token punctuation">)</span>
Entrypoint index <span class="token number">1.77</span> KiB <span class="token operator">=</span> index.bundle.js
Entrypoint another <span class="token number">1.65</span> KiB <span class="token operator">=</span> another.bundle.js
Entrypoint shared <span class="token number">557</span> KiB <span class="token operator">=</span> runtime.bundle.js <span class="token number">7.79</span> KiB shared.bundle.js <span class="token number">549</span> KiB
runtime modules <span class="token number">3.76</span> KiB <span class="token number">7</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/another-module.js <span class="token number">84</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">249</span> ms</code></pre> <p>ç”±ä¸Šå¯çŸ¥ï¼Œé™¤äº†ç”Ÿæˆ <code>shared.bundle.js</code>ï¼Œ<code>index.bundle.js</code> å’Œ <code>another.bundle.js</code> ä¹‹å¤–ï¼Œè¿˜ç”Ÿæˆäº†ä¸€ä¸ª <code>runtime.bundle.js</code> æ–‡ä»¶ã€‚</p> <p>å°½ç®¡å¯ä»¥åœ¨ webpack ä¸­å…è®¸æ¯ä¸ªé¡µé¢ä½¿ç”¨å¤šå…¥å£ï¼Œåº”å°½å¯èƒ½é¿å…ä½¿ç”¨å¤šå…¥å£çš„å…¥å£ï¼š<code>entry: { page: ['./analytics', './app'] }</code>ã€‚å¦‚æ­¤ï¼Œåœ¨ä½¿ç”¨ <code>async</code> è„šæœ¬æ ‡ç­¾æ—¶ï¼Œä¼šæœ‰æ›´å¥½çš„ä¼˜åŒ–ä»¥åŠä¸€è‡´çš„æ‰§è¡Œé¡ºåºã€‚</p> <h3 id="splitchunksplugin"><code>SplitChunksPlugin</code> <a href="#splitchunksplugin" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><a href="../../plugins/split-chunks-plugin.htm" tppabs="https://webpack.docschina.org/plugins/split-chunks-plugin"><code>SplitChunksPlugin</code></a> æ’ä»¶å¯ä»¥å°†å…¬å…±çš„ä¾èµ–æ¨¡å—æå–åˆ°å·²æœ‰çš„å…¥å£ chunk ä¸­ï¼Œæˆ–è€…æå–åˆ°ä¸€ä¸ªæ–°ç”Ÿæˆçš„ chunkã€‚è®©æˆ‘ä»¬ä½¿ç”¨è¿™ä¸ªæ’ä»¶ï¼Œå°†ä¹‹å‰çš„ç¤ºä¾‹ä¸­é‡å¤çš„ <code>lodash</code> æ¨¡å—å»é™¤ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">     index: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     another: './src/another-module.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   optimization: {
</span><span class="token prefix inserted">+</span><span class="token line">     splitChunks: {
</span><span class="token prefix inserted">+</span><span class="token line">       chunks: 'all',
</span><span class="token prefix inserted">+</span><span class="token line">     },
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>ä½¿ç”¨ <a href="../../plugins/split-chunks-plugin/index.htm#optimization-splitchunks" tppabs="https://webpack.docschina.org/plugins/split-chunks-plugin/#optimization-splitchunks"><code>optimization.splitChunks</code></a> é…ç½®é€‰é¡¹ä¹‹åï¼Œç°åœ¨åº”è¯¥å¯ä»¥çœ‹å‡ºï¼Œ<code>index.bundle.js</code> å’Œ <code>another.bundle.js</code> ä¸­å·²ç»ç§»é™¤äº†é‡å¤çš„ä¾èµ–æ¨¡å—ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ’ä»¶å°† <code>lodash</code> åˆ†ç¦»åˆ°å•ç‹¬çš„ chunkï¼Œå¹¶ä¸”å°†å…¶ä» main bundle ä¸­ç§»é™¤ï¼Œå‡è½»äº†å¤§å°ã€‚æ‰§è¡Œ <code>npm run build</code> æŸ¥çœ‹æ•ˆæœï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset vendors-node_modules_lodash_lodash_js.bundle.js <span class="token number">549</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>id hint: vendors<span class="token punctuation">)</span>
asset index.bundle.js <span class="token number">8.92</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
asset another.bundle.js <span class="token number">8.8</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: another<span class="token punctuation">)</span>
Entrypoint index <span class="token number">558</span> KiB <span class="token operator">=</span> vendors-node_modules_lodash_lodash_js.bundle.js <span class="token number">549</span> KiB index.bundle.js <span class="token number">8.92</span> KiB
Entrypoint another <span class="token number">558</span> KiB <span class="token operator">=</span> vendors-node_modules_lodash_lodash_js.bundle.js <span class="token number">549</span> KiB another.bundle.js <span class="token number">8.8</span> KiB
runtime modules <span class="token number">7.64</span> KiB <span class="token number">14</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">257</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./src/another-module.js <span class="token number">84</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">241</span> ms</code></pre> <p>ä»¥ä¸‹æ˜¯ç”±ç¤¾åŒºæä¾›ï¼Œä¸€äº›å¯¹äºä»£ç åˆ†ç¦»å¾ˆæœ‰å¸®åŠ©çš„ plugin å’Œ loaderï¼š</p> <ul> <li><a href="javascript:if(confirm('https://webpack.docschina.org/guides/printable/plugins/mini-css-extract-plugin  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ·şÎñÆ÷±¨¸æ¸ÃÎÄ¼şÎ´ÕÒµ½¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://webpack.docschina.org/guides/printable/plugins/mini-css-extract-plugin'" tppabs="https://webpack.docschina.org/guides/printable/plugins/mini-css-extract-plugin"><code>mini-css-extract-plugin</code></a>: ç”¨äºå°† CSS ä»ä¸»åº”ç”¨ç¨‹åºä¸­åˆ†ç¦»ã€‚</li> </ul> <h2 id="dynamic-imports">åŠ¨æ€å¯¼å…¥(dynamic import) <a href="#dynamic-imports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å½“æ¶‰åŠåˆ°åŠ¨æ€ä»£ç æ‹†åˆ†æ—¶ï¼Œwebpack æä¾›äº†ä¸¤ä¸ªç±»ä¼¼çš„æŠ€æœ¯ã€‚ç¬¬ä¸€ç§ï¼Œä¹Ÿæ˜¯æ¨èé€‰æ‹©çš„æ–¹å¼æ˜¯ï¼Œä½¿ç”¨ç¬¦åˆ <a href="javascript:if(confirm('https://github.com/tc39/proposal-dynamic-import  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/tc39/proposal-dynamic-import'" tppabs="https://github.com/tc39/proposal-dynamic-import">ECMAScript ææ¡ˆ</a> çš„ <a href="../../api/module-methods/index.htm#import-1" tppabs="https://webpack.docschina.org/api/module-methods/#import-1"><code>import()</code> è¯­æ³•</a> æ¥å®ç°åŠ¨æ€å¯¼å…¥ã€‚ç¬¬äºŒç§ï¼Œåˆ™æ˜¯ webpack çš„é—ç•™åŠŸèƒ½ï¼Œä½¿ç”¨ webpack ç‰¹å®šçš„ <a href="../../api/module-methods/index.htm#requireensure" tppabs="https://webpack.docschina.org/api/module-methods/#requireensure"><code>require.ensure</code></a>ã€‚è®©æˆ‘ä»¬å…ˆå°è¯•ä½¿ç”¨ç¬¬ä¸€ç§â€¦â€¦</p> <blockquote class="warning"> <p><code>import()</code> è°ƒç”¨ä¼šåœ¨å†…éƒ¨ç”¨åˆ° <a href="javascript:if(confirm('https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise'" tppabs="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">promises</a>ã€‚å¦‚æœåœ¨æ—§ç‰ˆæœ¬æµè§ˆå™¨ä¸­ï¼ˆä¾‹å¦‚ï¼ŒIE 11ï¼‰ä½¿ç”¨ <code>import()</code>ï¼Œè®°å¾—ä½¿ç”¨ä¸€ä¸ª polyfill åº“ï¼ˆä¾‹å¦‚ <a href="javascript:if(confirm('https://github.com/stefanpenner/es6-promise  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/stefanpenner/es6-promise'" tppabs="https://github.com/stefanpenner/es6-promise">es6-promise</a> æˆ– <a href="javascript:if(confirm('https://github.com/taylorhakes/promise-polyfill  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/taylorhakes/promise-polyfill'" tppabs="https://github.com/taylorhakes/promise-polyfill">promise-polyfill</a>ï¼‰ï¼Œæ¥ shim <code>Promise</code>ã€‚</p> </blockquote> <p>åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œå…ˆä»ä¸Šè¿°ç¤ºä¾‹çš„é…ç½®ä¸­ç§»é™¤æ‰å¤šä½™çš„ <a href="../../concepts/entry-points/index.htm" tppabs="https://webpack.docschina.org/concepts/entry-points/"><code>entry</code></a> å’Œ <a href="../../plugins/split-chunks-plugin/index.htm#optimization-splitchunks" tppabs="https://webpack.docschina.org/plugins/split-chunks-plugin/#optimization-splitchunks"><code>optimization.splitChunks</code></a>ï¼Œå› ä¸ºæ¥ä¸‹æ¥çš„æ¼”ç¤ºä¸­å¹¶ä¸éœ€è¦å®ƒä»¬ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">    index: './src/index.js',
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    another: './src/another-module.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  optimization: {
</span><span class="token prefix deleted">-</span><span class="token line">    splitChunks: {
</span><span class="token prefix deleted">-</span><span class="token line">      chunks: 'all',
</span><span class="token prefix deleted">-</span><span class="token line">    },
</span><span class="token prefix deleted">-</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>æˆ‘ä»¬å°†æ›´æ–°æˆ‘ä»¬çš„é¡¹ç›®ï¼Œç§»é™¤ç°åœ¨æœªä½¿ç”¨çš„æ–‡ä»¶ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> |- another-module.js
</span></span>|- /node_modules</code></pre> <p>ç°åœ¨ï¼Œæˆ‘ä»¬ä¸å†ä½¿ç”¨ statically import(é™æ€å¯¼å…¥) <code>lodash</code>ï¼Œè€Œæ˜¯é€šè¿‡ dynamic import(åŠ¨æ€å¯¼å…¥) æ¥åˆ†ç¦»å‡ºä¸€ä¸ª chunkï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import _ from 'lodash';
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">function component() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">function getComponent() {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  // Lodash, now imported by this script
</span><span class="token prefix deleted">-</span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  return import('lodash')
</span><span class="token prefix inserted">+</span><span class="token line">    .then(({ default: _ }) => {
</span><span class="token prefix inserted">+</span><span class="token line">      const element = document.createElement('div');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">      element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  return element;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      return element;
</span><span class="token prefix inserted">+</span><span class="token line">    })
</span><span class="token prefix inserted">+</span><span class="token line">    .catch((error) => 'An error occurred while loading the component');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">document.body.appendChild(component());
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">getComponent().then((component) => {
</span><span class="token prefix inserted">+</span><span class="token line">  document.body.appendChild(component);
</span><span class="token prefix inserted">+</span><span class="token line">});</span></span></code></pre> <p>æˆ‘ä»¬ä¹‹æ‰€ä»¥éœ€è¦ <code>default</code>ï¼Œæ˜¯å› ä¸º webpack 4 åœ¨å¯¼å…¥ CommonJS æ¨¡å—æ—¶ï¼Œå°†ä¸å†è§£æä¸º <code>module.exports</code> çš„å€¼ï¼Œè€Œæ˜¯ä¸º CommonJS æ¨¡å—åˆ›å»ºä¸€ä¸ª artificial namespace å¯¹è±¡ï¼Œæ›´å¤šæœ‰å…³èƒŒååŸå› çš„ä¿¡æ¯ï¼Œè¯·é˜…è¯» <a href="javascript:if(confirm('https://medium.com/webpack/webpack-4-import-and-commonjs-d619d626b655  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://medium.com/webpack/webpack-4-import-and-commonjs-d619d626b655'" tppabs="https://medium.com/webpack/webpack-4-import-and-commonjs-d619d626b655">webpack 4: import() and CommonJs</a>ã€‚</p> <p>è®©æˆ‘ä»¬æ‰§è¡Œ webpackï¼ŒæŸ¥çœ‹ <code>lodash</code> æ˜¯å¦ä¼šåˆ†ç¦»åˆ°ä¸€ä¸ªå•ç‹¬çš„ bundleï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset vendors-node_modules_lodash_lodash_js.bundle.js <span class="token number">549</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>id hint: vendors<span class="token punctuation">)</span>
asset index.bundle.js <span class="token number">13.5</span> KiB <span class="token punctuation">[</span>compared <span class="token keyword">for</span> emit<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: index<span class="token punctuation">)</span>
runtime modules <span class="token number">7.37</span> KiB <span class="token number">11</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">434</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">268</span> ms</code></pre> <p>ç”±äº <code>import()</code> ä¼šè¿”å›ä¸€ä¸ª promiseï¼Œå› æ­¤å®ƒå¯ä»¥å’Œ <a href="javascript:if(confirm('https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function'" tppabs="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function"><code>async</code> å‡½æ•°</a>ä¸€èµ·ä½¿ç”¨ã€‚ä¸‹é¢æ˜¯å¦‚ä½•é€šè¿‡ async å‡½æ•°ç®€åŒ–ä»£ç ï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">function getComponent() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">async function getComponent() {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  const { default: _ } = await import('lodash');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  return import('lodash')
</span><span class="token prefix deleted">-</span><span class="token line">    .then(({ default: _ }) => {
</span><span class="token prefix deleted">-</span><span class="token line">      const element = document.createElement('div');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix deleted">-</span><span class="token line">
</span><span class="token prefix deleted">-</span><span class="token line">      return element;
</span><span class="token prefix deleted">-</span><span class="token line">    })
</span><span class="token prefix deleted">-</span><span class="token line">    .catch((error) => 'An error occurred while loading the component');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  return element;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">getComponent().then((component) => {
</span><span class="token prefix unchanged"> </span><span class="token line">  document.body.appendChild(component);
</span><span class="token prefix unchanged"> </span><span class="token line">});</span></span></code></pre> <blockquote class="tip"> <p>åœ¨ç¨åç¤ºä¾‹ä¸­ï¼Œå¯èƒ½ä¼šæ ¹æ®è®¡ç®—åçš„å˜é‡(computed variable)å¯¼å…¥ç‰¹å®šæ¨¡å—æ—¶ï¼Œå¯ä»¥é€šè¿‡å‘ <code>import()</code> ä¼ å…¥ä¸€ä¸ª <a href="../../api/module-methods/index.htm#dynamic-expressions-in-import" tppabs="https://webpack.docschina.org/api/module-methods/#dynamic-expressions-in-import">åŠ¨æ€è¡¨è¾¾å¼</a>ã€‚</p> </blockquote> <h2 id="prefetchingpreloading-modules">é¢„è·å–/é¢„åŠ è½½æ¨¡å—(prefetch/preload module) <a href="#prefetchingpreloading-modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>webpack v4.6.0+ å¢åŠ äº†å¯¹é¢„è·å–å’Œé¢„åŠ è½½çš„æ”¯æŒã€‚</p> <p>åœ¨å£°æ˜ import æ—¶ï¼Œä½¿ç”¨ä¸‹é¢è¿™äº›å†…ç½®æŒ‡ä»¤ï¼Œå¯ä»¥è®© webpack è¾“å‡º "resource hint(èµ„æºæç¤º)"ï¼Œæ¥å‘ŠçŸ¥æµè§ˆå™¨ï¼š</p> <ul> <li><strong>prefetch</strong>(é¢„è·å–)ï¼šå°†æ¥æŸäº›å¯¼èˆªä¸‹å¯èƒ½éœ€è¦çš„èµ„æº</li> <li><strong>preload</strong>(é¢„åŠ è½½)ï¼šå½“å‰å¯¼èˆªä¸‹å¯èƒ½éœ€è¦èµ„æº</li> </ul> <p>ä¸‹é¢è¿™ä¸ª prefetch çš„ç®€å•ç¤ºä¾‹ä¸­ï¼Œæœ‰ä¸€ä¸ª <code>HomePage</code> ç»„ä»¶ï¼Œå…¶å†…éƒ¨æ¸²æŸ“ä¸€ä¸ª <code>LoginButton</code> ç»„ä»¶ï¼Œç„¶ååœ¨ç‚¹å‡»åæŒ‰éœ€åŠ è½½ <code>LoginModal</code> ç»„ä»¶ã€‚</p> <p><strong>LoginButton.js</strong></p> <pre><code class="hljs language-js"><span class="token comment">//...</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPrefetch: true */</span> <span class="token string">'./path/to/LoginModal.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>è¿™ä¼šç”Ÿæˆ <code>&#x3C;link rel="prefetch" href="login-modal-chunk.js"></code> å¹¶è¿½åŠ åˆ°é¡µé¢å¤´éƒ¨ï¼ŒæŒ‡ç¤ºç€æµè§ˆå™¨åœ¨é—²ç½®æ—¶é—´é¢„å– <code>login-modal-chunk.js</code> æ–‡ä»¶ã€‚</p> <blockquote class="tip"> <p>åªè¦çˆ¶ chunk å®ŒæˆåŠ è½½ï¼Œwebpack å°±ä¼šæ·»åŠ  prefetch hint(é¢„å–æç¤º)ã€‚</p> </blockquote> <p>ä¸ prefetch æŒ‡ä»¤ç›¸æ¯”ï¼Œpreload æŒ‡ä»¤æœ‰è®¸å¤šä¸åŒä¹‹å¤„ï¼š</p> <ul> <li>preload chunk ä¼šåœ¨çˆ¶ chunk åŠ è½½æ—¶ï¼Œä»¥å¹¶è¡Œæ–¹å¼å¼€å§‹åŠ è½½ã€‚prefetch chunk ä¼šåœ¨çˆ¶ chunk åŠ è½½ç»“æŸåå¼€å§‹åŠ è½½ã€‚</li> <li>preload chunk å…·æœ‰ä¸­ç­‰ä¼˜å…ˆçº§ï¼Œå¹¶ç«‹å³ä¸‹è½½ã€‚prefetch chunk åœ¨æµè§ˆå™¨é—²ç½®æ—¶ä¸‹è½½ã€‚</li> <li>preload chunk ä¼šåœ¨çˆ¶ chunk ä¸­ç«‹å³è¯·æ±‚ï¼Œç”¨äºå½“ä¸‹æ—¶åˆ»ã€‚prefetch chunk ä¼šç”¨äºæœªæ¥çš„æŸä¸ªæ—¶åˆ»ã€‚</li> <li>æµè§ˆå™¨æ”¯æŒç¨‹åº¦ä¸åŒã€‚</li> </ul> <p>ä¸‹é¢è¿™ä¸ªç®€å•çš„ preload ç¤ºä¾‹ä¸­ï¼Œæœ‰ä¸€ä¸ª <code>Component</code>ï¼Œä¾èµ–äºä¸€ä¸ªè¾ƒå¤§çš„ libraryï¼Œæ‰€ä»¥åº”è¯¥å°†å…¶åˆ†ç¦»åˆ°ä¸€ä¸ªç‹¬ç«‹çš„ chunk ä¸­ã€‚</p> <p>æˆ‘ä»¬å‡æƒ³è¿™é‡Œçš„å›¾è¡¨ç»„ä»¶ <code>ChartComponent</code> ç»„ä»¶éœ€è¦ä¾èµ–ä½“ç§¯å·¨å¤§çš„ <code>ChartingLibrary</code> åº“ã€‚å®ƒä¼šåœ¨æ¸²æŸ“æ—¶æ˜¾ç¤ºä¸€ä¸ª <code>LoadingIndicator(åŠ è½½è¿›åº¦æ¡)</code> ç»„ä»¶ï¼Œç„¶åç«‹å³æŒ‰éœ€å¯¼å…¥ <code>ChartingLibrary</code>ï¼š</p> <p><strong>ChartComponent.js</strong></p> <pre><code class="hljs language-js"><span class="token comment">//...</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackPreload: true */</span> <span class="token string">'ChartingLibrary'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>åœ¨é¡µé¢ä¸­ä½¿ç”¨ <code>ChartComponent</code> æ—¶ï¼Œåœ¨è¯·æ±‚ ChartComponent.js çš„åŒæ—¶ï¼Œè¿˜ä¼šé€šè¿‡ <code>&#x3C;link rel="preload"></code> è¯·æ±‚ charting-library-chunkã€‚å‡å®š page-chunk ä½“ç§¯å¾ˆå°ï¼Œå¾ˆå¿«å°±è¢«åŠ è½½å¥½ï¼Œé¡µé¢æ­¤æ—¶å°±ä¼šæ˜¾ç¤º <code>LoadingIndicator(åŠ è½½è¿›åº¦æ¡)</code> ï¼Œç­‰åˆ° <code>charting-library-chunk</code> è¯·æ±‚å®Œæˆï¼ŒLoadingIndicator ç»„ä»¶æ‰æ¶ˆå¤±ã€‚å¯åŠ¨ä»…éœ€è¦å¾ˆå°‘çš„åŠ è½½æ—¶é—´ï¼Œå› ä¸ºåªè¿›è¡Œå•æ¬¡å¾€è¿”ï¼Œè€Œä¸æ˜¯ä¸¤æ¬¡å¾€è¿”ã€‚å°¤å…¶æ˜¯åœ¨é«˜å»¶è¿Ÿç¯å¢ƒä¸‹ã€‚</p> <blockquote class="tip"> <p>ä¸æ­£ç¡®åœ°ä½¿ç”¨ <code>webpackPreload</code> ä¼šæœ‰æŸæ€§èƒ½ï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚</p> </blockquote> <h2 id="bundle-analysis">bundle åˆ†æ(bundle analysis) <a href="#bundle-analysis" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä¸€æ—¦å¼€å§‹åˆ†ç¦»ä»£ç ï¼Œä¸€ä»¶å¾ˆæœ‰å¸®åŠ©çš„äº‹æƒ…æ˜¯ï¼Œåˆ†æè¾“å‡ºç»“æœæ¥æ£€æŸ¥æ¨¡å—åœ¨ä½•å¤„ç»“æŸã€‚ <a href="javascript:if(confirm('https://github.com/webpack/analyse  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/analyse'" tppabs="https://github.com/webpack/analyse">å®˜æ–¹åˆ†æå·¥å…·</a> æ˜¯ä¸€ä¸ªä¸é”™çš„å¼€å§‹ã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–ç¤¾åŒºæ”¯æŒçš„å¯é€‰é¡¹ï¼š</p> <ul> <li><a href="javascript:if(confirm('https://alexkuz.github.io/webpack-chart/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://alexkuz.github.io/webpack-chart/'" tppabs="https://alexkuz.github.io/webpack-chart/">webpack-chart</a>: webpack stats å¯äº¤äº’é¥¼å›¾ã€‚</li> <li><a href="javascript:if(confirm('https://chrisbateman.github.io/webpack-visualizer/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://chrisbateman.github.io/webpack-visualizer/'" tppabs="https://chrisbateman.github.io/webpack-visualizer/">webpack-visualizer</a>: å¯è§†åŒ–å¹¶åˆ†æä½ çš„ bundleï¼Œæ£€æŸ¥å“ªäº›æ¨¡å—å ç”¨ç©ºé—´ï¼Œå“ªäº›å¯èƒ½æ˜¯é‡å¤ä½¿ç”¨çš„ã€‚</li> <li><a href="javascript:if(confirm('https://github.com/webpack-contrib/webpack-bundle-analyzer  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack-contrib/webpack-bundle-analyzer'" tppabs="https://github.com/webpack-contrib/webpack-bundle-analyzer">webpack-bundle-analyzer</a>ï¼šä¸€ä¸ª plugin å’Œ CLI å·¥å…·ï¼Œå®ƒå°† bundle å†…å®¹å±•ç¤ºä¸ºä¸€ä¸ªä¾¿æ·çš„ã€äº¤äº’å¼ã€å¯ç¼©æ”¾çš„æ ‘çŠ¶å›¾å½¢å¼ã€‚</li> <li><a href="javascript:if(confirm('https://webpack.jakoblind.no/optimize  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://webpack.jakoblind.no/optimize'" tppabs="https://webpack.jakoblind.no/optimize">webpack bundle optimize helper</a>ï¼šè¿™ä¸ªå·¥å…·ä¼šåˆ†æä½ çš„ bundleï¼Œå¹¶æä¾›å¯æ“ä½œçš„æ”¹è¿›æªæ–½ï¼Œä»¥å‡å°‘ bundle çš„å¤§å°ã€‚</li> <li><a href="javascript:if(confirm('https://github.com/bundle-stats/bundle-stats  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/bundle-stats/bundle-stats'" tppabs="https://github.com/bundle-stats/bundle-stats">bundle-stats</a>ï¼šç”Ÿæˆä¸€ä¸ª bundle æŠ¥å‘Šï¼ˆbundle å¤§å°ã€èµ„æºã€æ¨¡å—ï¼‰ï¼Œå¹¶æ¯”è¾ƒä¸åŒæ„å»ºä¹‹é—´çš„ç»“æœã€‚</li> </ul> <h2 id="next-steps">ä¸‹ä¸€æ­¥ <a href="#next-steps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ¥ä¸‹æ¥ï¼ŒæŸ¥çœ‹ <a href="../lazy-loading/index.htm" tppabs="https://webpack.docschina.org/guides/lazy-loading/">å»¶è¿ŸåŠ è½½</a> æ¥å­¦ä¹ å¦‚ä½•åœ¨å®é™…ä¸€ä¸ªçœŸå®åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ <code>import()</code> çš„å…·ä½“ç¤ºä¾‹ï¼Œä»¥åŠæŸ¥çœ‹ <a href="../caching/index.htm" tppabs="https://webpack.docschina.org/guides/caching/">ç¼“å­˜</a> æ¥å­¦ä¹ å¦‚ä½•æœ‰æ•ˆåœ°åˆ†ç¦»ä»£ç ã€‚</p> <h1 id="ç¼“å­˜">ç¼“å­˜<a href="#%E7%BC%93%E5%AD%98" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote class="tip"> <p>æœ¬æŒ‡å—ç»§ç»­æ²¿ç”¨ <a href="../getting-started.htm" tppabs="https://webpack.docschina.org/guides/getting-started">èµ·æ­¥</a>ã€<a href="../output-management.htm" tppabs="https://webpack.docschina.org/guides/output-management">ç®¡ç†è¾“å‡º</a> å’Œ <a href="../code-splitting.htm" tppabs="https://webpack.docschina.org/guides/code-splitting">ä»£ç åˆ†ç¦»</a> ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚</p> </blockquote> <p>ä»¥ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨ webpack æ¥æ‰“åŒ…æˆ‘ä»¬çš„æ¨¡å—åŒ–åçš„åº”ç”¨ç¨‹åºï¼Œwebpack ä¼šç”Ÿæˆä¸€ä¸ªå¯éƒ¨ç½²çš„ <code>/dist</code> ç›®å½•ï¼Œç„¶åæŠŠæ‰“åŒ…åçš„å†…å®¹æ”¾ç½®åœ¨æ­¤ç›®å½•ä¸­ã€‚åªè¦ <code>/dist</code> ç›®å½•ä¸­çš„å†…å®¹éƒ¨ç½²åˆ° server ä¸Šï¼Œclientï¼ˆé€šå¸¸æ˜¯æµè§ˆå™¨ï¼‰å°±èƒ½å¤Ÿè®¿é—®æ­¤ server çš„ç½‘ç«™åŠå…¶èµ„æºã€‚è€Œæœ€åä¸€æ­¥è·å–èµ„æºæ˜¯æ¯”è¾ƒè€—è´¹æ—¶é—´çš„ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæµè§ˆå™¨ä½¿ç”¨ä¸€ç§åä¸º <a href="javascript:if(confirm('https://searchstorage.techtarget.com/definition/cache  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://searchstorage.techtarget.com/definition/cache'" tppabs="https://searchstorage.techtarget.com/definition/cache">ç¼“å­˜</a> çš„æŠ€æœ¯ã€‚å¯ä»¥é€šè¿‡å‘½ä¸­ç¼“å­˜ï¼Œä»¥é™ä½ç½‘ç»œæµé‡ï¼Œä½¿ç½‘ç«™åŠ è½½é€Ÿåº¦æ›´å¿«ï¼Œç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬åœ¨éƒ¨ç½²æ–°ç‰ˆæœ¬æ—¶ä¸æ›´æ”¹èµ„æºçš„æ–‡ä»¶åï¼Œæµè§ˆå™¨å¯èƒ½ä¼šè®¤ä¸ºå®ƒæ²¡æœ‰è¢«æ›´æ–°ï¼Œå°±ä¼šä½¿ç”¨å®ƒçš„ç¼“å­˜ç‰ˆæœ¬ã€‚ç”±äºç¼“å­˜çš„å­˜åœ¨ï¼Œå½“ä½ éœ€è¦è·å–æ–°çš„ä»£ç æ—¶ï¼Œå°±ä¼šæ˜¾å¾—å¾ˆæ£˜æ‰‹ã€‚</p> <p>æ­¤æŒ‡å—çš„é‡ç‚¹åœ¨äºé€šè¿‡å¿…è¦çš„é…ç½®ï¼Œä»¥ç¡®ä¿ webpack ç¼–è¯‘ç”Ÿæˆçš„æ–‡ä»¶èƒ½å¤Ÿè¢«å®¢æˆ·ç«¯ç¼“å­˜ï¼Œè€Œåœ¨æ–‡ä»¶å†…å®¹å˜åŒ–åï¼Œèƒ½å¤Ÿè¯·æ±‚åˆ°æ–°çš„æ–‡ä»¶ã€‚</p> <h2 id="output-filenames">è¾“å‡ºæ–‡ä»¶çš„æ–‡ä»¶å(output filename) <a href="#output-filenames" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æˆ‘ä»¬å¯ä»¥é€šè¿‡æ›¿æ¢ <code>output.filename</code> ä¸­çš„ <a href="../../configuration/output/index.htm#outputfilename" tppabs="https://webpack.docschina.org/configuration/output/#outputfilename">substitutions</a> è®¾ç½®ï¼Œæ¥å®šä¹‰è¾“å‡ºæ–‡ä»¶çš„åç§°ã€‚webpack æä¾›äº†ä¸€ç§ä½¿ç”¨ç§°ä¸º <strong>substitution(å¯æ›¿æ¢æ¨¡æ¿å­—ç¬¦ä¸²)</strong> çš„æ–¹å¼ï¼Œé€šè¿‡å¸¦æ‹¬å·å­—ç¬¦ä¸²æ¥æ¨¡æ¿åŒ–æ–‡ä»¶åã€‚å…¶ä¸­ï¼Œ<code>[contenthash]</code> substitution å°†æ ¹æ®èµ„æºå†…å®¹åˆ›å»ºå‡ºå”¯ä¸€ hashã€‚å½“èµ„æºå†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<code>[contenthash]</code> ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚</p> <p>è¿™é‡Œä½¿ç”¨ <a href="../getting-started.htm" tppabs="https://webpack.docschina.org/guides/getting-started">èµ·æ­¥</a> ä¸­çš„ç¤ºä¾‹å’Œ <a href="../output-management.htm" tppabs="https://webpack.docschina.org/guides/output-management">ç®¡ç†è¾“å‡º</a> ä¸­çš„ <code>plugins</code> æ’ä»¶æ¥ä½œä¸ºé¡¹ç›®åŸºç¡€ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¾ç„¶ä¸å¿…æ‰‹åŠ¨åœ°ç»´æŠ¤ <code>index.html</code> æ–‡ä»¶ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span>|- /node_modules</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     // å¯¹äº CleanWebpackPlugin çš„ v2 versions ä»¥ä¸‹ç‰ˆæœ¬ï¼Œä½¿ç”¨ new CleanWebpackPlugin(['dist/*'])
</span><span class="token prefix unchanged"> </span><span class="token line">     new CleanWebpackPlugin(),
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> Â  Â  Â  title: 'Output Management',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> Â  Â  Â  title: 'Caching',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     filename: 'bundle.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     filename: '[name].[contenthash].js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>ä½¿ç”¨æ­¤é…ç½®ï¼Œç„¶åè¿è¡Œæˆ‘ä»¬çš„ build script <code>npm run build</code>ï¼Œäº§ç”Ÿä»¥ä¸‹è¾“å‡ºï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                       Asset       Size  Chunks                    Chunk Names
main.7e2c49a622975ebd9b7e.js     <span class="token number">544</span> kB       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  main
                  index.html  <span class="token number">197</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>å¯ä»¥çœ‹åˆ°ï¼Œbundle çš„åç§°æ˜¯å®ƒå†…å®¹ï¼ˆé€šè¿‡ hashï¼‰çš„æ˜ å°„ã€‚å¦‚æœæˆ‘ä»¬ä¸åšä¿®æ”¹ï¼Œç„¶åå†æ¬¡è¿è¡Œæ„å»ºï¼Œæˆ‘ä»¬ä»¥ä¸ºæ–‡ä»¶åä¼šä¿æŒä¸å˜ã€‚ç„¶è€Œï¼Œå¦‚æœæˆ‘ä»¬çœŸçš„è¿è¡Œï¼Œå¯èƒ½ä¼šå‘ç°æƒ…å†µå¹¶éå¦‚æ­¤ï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                       Asset       Size  Chunks                    Chunk Names
main.205199ab45963f6a62ec.js     <span class="token number">544</span> kB       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  main
                  index.html  <span class="token number">197</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>è¿™ä¹Ÿæ˜¯å› ä¸º webpack åœ¨å…¥å£ chunk ä¸­ï¼ŒåŒ…å«äº†æŸäº› boilerplate(å¼•å¯¼æ¨¡æ¿)ï¼Œç‰¹åˆ«æ˜¯ runtime å’Œ manifestã€‚ï¼ˆè¯‘æ³¨ï¼šboilerplate æŒ‡ webpack è¿è¡Œæ—¶çš„å¼•å¯¼ä»£ç ï¼‰</p> <blockquote class="warning"> <p>è¾“å‡ºå¯èƒ½ä¼šå› å½“å‰çš„ webpack ç‰ˆæœ¬è€Œç¨æœ‰å·®å¼‚ã€‚ä¸æ—§ç‰ˆæœ¬ç›¸æ¯”ï¼Œæ–°ç‰ˆæœ¬ä¸ä¸€å®šæœ‰å®Œå…¨ç›¸åŒçš„é—®é¢˜ï¼Œä½†æˆ‘ä»¬ä»ç„¶æ¨èçš„ä»¥ä¸‹æ­¥éª¤ï¼Œç¡®ä¿ç»“æœå¯é ã€‚</p> </blockquote> <h2 id="extracting-boilerplate">æå–å¼•å¯¼æ¨¡æ¿(extracting boilerplate) <a href="#extracting-boilerplate" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ­£å¦‚æˆ‘ä»¬åœ¨ <a href="../code-splitting.htm" tppabs="https://webpack.docschina.org/guides/code-splitting">ä»£ç åˆ†ç¦»</a> ä¸­æ‰€å­¦åˆ°çš„ï¼Œ<a href="../../plugins/split-chunks-plugin/index.htm" tppabs="https://webpack.docschina.org/plugins/split-chunks-plugin/"><code>SplitChunksPlugin</code></a> å¯ä»¥ç”¨äºå°†æ¨¡å—åˆ†ç¦»åˆ°å•ç‹¬çš„ bundle ä¸­ã€‚webpack è¿˜æä¾›äº†ä¸€ä¸ªä¼˜åŒ–åŠŸèƒ½ï¼Œå¯ä½¿ç”¨ <a href="../../configuration/optimization/index.htm#optimizationruntimechunk" tppabs="https://webpack.docschina.org/configuration/optimization/#optimizationruntimechunk"><code>optimization.runtimeChunk</code></a> é€‰é¡¹å°† runtime ä»£ç æ‹†åˆ†ä¸ºä¸€ä¸ªå•ç‹¬çš„ chunkã€‚å°†å…¶è®¾ç½®ä¸º <code>single</code> æ¥ä¸ºæ‰€æœ‰ chunk åˆ›å»ºä¸€ä¸ª runtime bundleï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     // å¯¹äº CleanWebpackPlugin çš„ v2 versions ä»¥ä¸‹ç‰ˆæœ¬ï¼Œä½¿ç”¨ new CleanWebpackPlugin(['dist/*'])
</span><span class="token prefix unchanged"> </span><span class="token line">     new CleanWebpackPlugin(),
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line"> Â  Â  Â  title: 'Caching',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].[contenthash].js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   optimization: {
</span><span class="token prefix inserted">+</span><span class="token line">     runtimeChunk: 'single',
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>å†æ¬¡æ„å»ºï¼Œç„¶åæŸ¥çœ‹æå–å‡ºæ¥çš„ <code>runtime</code> bundleï¼š</p> <pre><code class="hljs language-bash">Hash: 82c9c385607b2150fab2
Version: webpack <span class="token number">4.12</span>.0
Time: 3027ms
                          Asset       Size  Chunks             Chunk Names
runtime.cc17ae2a94ec771e9221.js   <span class="token number">1.42</span> KiB       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  runtime
   main.e81de2cf758ada72f306.js   <span class="token number">69.5</span> KiB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  main
                     index.html  <span class="token number">275</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>webpack<span class="token punctuation">)</span>/buildin/module.js <span class="token number">497</span> bytes <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">(</span>webpack<span class="token punctuation">)</span>/buildin/global.js <span class="token number">489</span> bytes <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> ./src/index.js <span class="token number">309</span> bytes <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">[</span>built<span class="token punctuation">]</span>
    + <span class="token number">1</span> hidden module</code></pre> <p>å°†ç¬¬ä¸‰æ–¹åº“(library)ï¼ˆä¾‹å¦‚ <code>lodash</code> æˆ– <code>react</code>ï¼‰æå–åˆ°å•ç‹¬çš„ <code>vendor</code> chunk æ–‡ä»¶ä¸­ï¼Œæ˜¯æ¯”è¾ƒæ¨èçš„åšæ³•ï¼Œè¿™æ˜¯å› ä¸ºï¼Œå®ƒä»¬å¾ˆå°‘åƒæœ¬åœ°çš„æºä»£ç é‚£æ ·é¢‘ç¹ä¿®æ”¹ã€‚å› æ­¤é€šè¿‡å®ç°ä»¥ä¸Šæ­¥éª¤ï¼Œåˆ©ç”¨ client çš„é•¿æ•ˆç¼“å­˜æœºåˆ¶ï¼Œå‘½ä¸­ç¼“å­˜æ¥æ¶ˆé™¤è¯·æ±‚ï¼Œå¹¶å‡å°‘å‘ server è·å–èµ„æºï¼ŒåŒæ—¶è¿˜èƒ½ä¿è¯ client ä»£ç å’Œ server ä»£ç ç‰ˆæœ¬ä¸€è‡´ã€‚ è¿™å¯ä»¥é€šè¿‡ä½¿ç”¨ <a href="../../plugins/split-chunks-plugin/index.htm#split-chunks-example-2" tppabs="https://webpack.docschina.org/plugins/split-chunks-plugin/#split-chunks-example-2">SplitChunksPlugin ç¤ºä¾‹ 2</a> ä¸­æ¼”ç¤ºçš„ <a href="../../plugins/split-chunks-plugin/index.htm" tppabs="https://webpack.docschina.org/plugins/split-chunks-plugin/"><code>SplitChunksPlugin</code></a> æ’ä»¶çš„ <a href="../../plugins/split-chunks-plugin/index.htm#splitchunkscachegroups" tppabs="https://webpack.docschina.org/plugins/split-chunks-plugin/#splitchunkscachegroups"><code>cacheGroups</code></a> é€‰é¡¹æ¥å®ç°ã€‚æˆ‘ä»¬åœ¨ <code>optimization.splitChunks</code> æ·»åŠ å¦‚ä¸‹ <code>cacheGroups</code> å‚æ•°å¹¶æ„å»ºï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     // å¯¹äº CleanWebpackPlugin çš„ v2 versions ä»¥ä¸‹ç‰ˆæœ¬ï¼Œä½¿ç”¨ new CleanWebpackPlugin(['dist/*'])
</span><span class="token prefix unchanged"> </span><span class="token line">     new CleanWebpackPlugin(),
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line"> Â  Â  Â  title: 'Caching',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].[contenthash].js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   optimization: {
</span><span class="token prefix unchanged"> </span><span class="token line">     runtimeChunk: 'single',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     splitChunks: {
</span><span class="token prefix inserted">+</span><span class="token line">       cacheGroups: {
</span><span class="token prefix inserted">+</span><span class="token line">         vendor: {
</span><span class="token prefix inserted">+</span><span class="token line">           test: /[\\/]node_modules[\\/]/,
</span><span class="token prefix inserted">+</span><span class="token line">           name: 'vendors',
</span><span class="token prefix inserted">+</span><span class="token line">           chunks: 'all',
</span><span class="token prefix inserted">+</span><span class="token line">         },
</span><span class="token prefix inserted">+</span><span class="token line">       },
</span><span class="token prefix inserted">+</span><span class="token line">     },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>å†æ¬¡æ„å»ºï¼Œç„¶åæŸ¥çœ‹æ–°çš„ <code>vendor</code> bundleï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                          Asset       Size  Chunks             Chunk Names
runtime.cc17ae2a94ec771e9221.js   <span class="token number">1.42</span> KiB       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  runtime
vendors.a42c3ca0d742766d7a28.js   <span class="token number">69.4</span> KiB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  vendors
   main.abf44fedb7d11d4312d7.js  <span class="token number">240</span> bytes       <span class="token number">2</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  main
                     index.html  <span class="token number">353</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>main</code> ä¸å†å«æœ‰æ¥è‡ª <code>node_modules</code> ç›®å½•çš„ <code>vendor</code> ä»£ç ï¼Œå¹¶ä¸”ä½“ç§¯å‡å°‘åˆ° <code>240 bytes</code>ï¼</p> <h2 id="module-identifiers">æ¨¡å—æ ‡è¯†ç¬¦(module identifier) <a href="#module-identifiers" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨é¡¹ç›®ä¸­å†æ·»åŠ ä¸€ä¸ªæ¨¡å— <code>print.js</code>ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- print.js
</span></span>|- /node_modules</code></pre> <p><strong>print.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> export default function print(text) {
</span><span class="token prefix inserted">+</span><span class="token line">   console.log(text);
</span><span class="token prefix inserted">+</span><span class="token line"> };</span></span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import Print from './print';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // lodash æ˜¯ç”±å½“å‰ script è„šæœ¬ import è¿›æ¥çš„
</span><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   element.onclick = Print.bind(null, 'Hello webpack!');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <p>å†æ¬¡è¿è¡Œæ„å»ºï¼Œç„¶åæˆ‘ä»¬æœŸæœ›çš„æ˜¯ï¼Œåªæœ‰ <code>main</code> bundle çš„ hash å‘ç”Ÿå˜åŒ–ï¼Œç„¶è€Œâ€¦â€¦</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                           Asset       Size  Chunks                    Chunk Names
  runtime.1400d5af64fc1b7b3a45.js    <span class="token number">5.85</span> kB      <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>         runtime
  vendor.a7561fb0e9a071baadb9.js     <span class="token number">541</span> kB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  vendor
    main.b746e3eb72875af2caa9.js    <span class="token number">1.22</span> kB       <span class="token number">2</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>         main
                      index.html  <span class="token number">352</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>â€¦â€¦æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸‰ä¸ªæ–‡ä»¶çš„ hash éƒ½å˜åŒ–äº†ã€‚è¿™æ˜¯å› ä¸ºæ¯ä¸ª <a href="../../api/module-variables/index.htm#moduleid-commonjs" tppabs="https://webpack.docschina.org/api/module-variables/#moduleid-commonjs"><code>module.id</code></a> ä¼šé»˜è®¤åœ°åŸºäºè§£æé¡ºåº(resolve order)è¿›è¡Œå¢é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“è§£æé¡ºåºå‘ç”Ÿå˜åŒ–ï¼ŒID ä¹Ÿä¼šéšä¹‹æ”¹å˜ã€‚å› æ­¤ï¼Œç®€è¦æ¦‚æ‹¬ï¼š</p> <ul> <li><code>main</code> bundle ä¼šéšç€è‡ªèº«çš„æ–°å¢å†…å®¹çš„ä¿®æ”¹ï¼Œè€Œå‘ç”Ÿå˜åŒ–ã€‚</li> <li><code>vendor</code> bundle ä¼šéšç€è‡ªèº«çš„ <code>module.id</code> çš„å˜åŒ–ï¼Œè€Œå‘ç”Ÿå˜åŒ–ã€‚</li> <li><code>manifest</code> runtime ä¼šå› ä¸ºç°åœ¨åŒ…å«ä¸€ä¸ªæ–°æ¨¡å—çš„å¼•ç”¨ï¼Œè€Œå‘ç”Ÿå˜åŒ–ã€‚</li> </ul> <p>ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ªéƒ½æ˜¯ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºï¼Œ<code>vendor</code> hash å‘ç”Ÿå˜åŒ–æ˜¯æˆ‘ä»¬è¦ä¿®å¤çš„ã€‚æˆ‘ä»¬å°† <a href="../../configuration/optimization/index.htm#optimizationmoduleids" tppabs="https://webpack.docschina.org/configuration/optimization/#optimizationmoduleids"><code>optimization.moduleIds</code></a> è®¾ç½®ä¸º <code>'deterministic'</code>ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     // å¯¹äº CleanWebpackPlugin çš„ v2 versions ä»¥ä¸‹ç‰ˆæœ¬ï¼Œä½¿ç”¨ new CleanWebpackPlugin(['dist/*'])
</span><span class="token prefix unchanged"> </span><span class="token line">     new CleanWebpackPlugin(),
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">       title: 'Caching',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].[contenthash].js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   optimization: {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     moduleIds: 'deterministic',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     runtimeChunk: 'single',
</span><span class="token prefix unchanged"> </span><span class="token line">     splitChunks: {
</span><span class="token prefix unchanged"> </span><span class="token line">       cacheGroups: {
</span><span class="token prefix unchanged"> </span><span class="token line">         vendor: {
</span><span class="token prefix unchanged"> </span><span class="token line">           test: /[\\/]node_modules[\\/]/,
</span><span class="token prefix unchanged"> </span><span class="token line">           name: 'vendors',
</span><span class="token prefix unchanged"> </span><span class="token line">           chunks: 'all',
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>ç°åœ¨ï¼Œä¸è®ºæ˜¯å¦æ·»åŠ ä»»ä½•æ–°çš„æœ¬åœ°ä¾èµ–ï¼Œå¯¹äºå‰åä¸¤æ¬¡æ„å»ºï¼Œ<code>vendor</code> hash éƒ½åº”è¯¥ä¿æŒä¸€è‡´ï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                          Asset       Size  Chunks             Chunk Names
   main.216e852f60c8829c2289.js  <span class="token number">340</span> bytes       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  main
vendors.55e79e5927a639d21a1b.js   <span class="token number">69.5</span> KiB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  vendors
runtime.725a1a51ede5ae0cfde0.js   <span class="token number">1.42</span> KiB       <span class="token number">2</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  runtime
                     index.html  <span class="token number">353</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
Entrypoint main <span class="token operator">=</span> runtime.725a1a51ede5ae0cfde0.js vendors.55e79e5927a639d21a1b.js main.216e852f60c8829c2289.js
<span class="token punctuation">..</span>.</code></pre> <p>ç„¶åï¼Œä¿®æ”¹ <code>src/index.js</code>ï¼Œä¸´æ—¶ç§»é™¤é¢å¤–çš„ä¾èµ–ï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import Print from './print';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> // import Print from './print';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // lodash æ˜¯ç”±å½“å‰ script è„šæœ¬ import è¿›æ¥çš„
</span><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   element.onclick = Print.bind(null, 'Hello webpack!');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   // element.onclick = Print.bind(null, 'Hello webpack!');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <p>æœ€åï¼Œå†æ¬¡è¿è¡Œæˆ‘ä»¬çš„æ„å»ºï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                          Asset       Size  Chunks             Chunk Names
   main.ad717f2466ce655fff5c.js  <span class="token number">274</span> bytes       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  main
vendors.55e79e5927a639d21a1b.js   <span class="token number">69.5</span> KiB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  vendors
runtime.725a1a51ede5ae0cfde0.js   <span class="token number">1.42</span> KiB       <span class="token number">2</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  runtime
                     index.html  <span class="token number">353</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
Entrypoint main <span class="token operator">=</span> runtime.725a1a51ede5ae0cfde0.js vendors.55e79e5927a639d21a1b.js main.ad717f2466ce655fff5c.js
<span class="token punctuation">..</span>.</code></pre> <p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸¤æ¬¡æ„å»ºä¸­ï¼Œ<code>vendor</code> bundle æ–‡ä»¶åç§°ï¼Œéƒ½æ˜¯ <code>55e79e5927a639d21a1b</code>ã€‚</p> <h2 id="conclusion">ç»“è®º <a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç¼“å­˜å¯èƒ½å¾ˆå¤æ‚ï¼Œä½†æ˜¯ä»åº”ç”¨ç¨‹åºæˆ–ç«™ç‚¹ç”¨æˆ·å¯ä»¥è·å¾—çš„æ”¶ç›Šæ¥çœ‹ï¼Œè¿™å€¼å¾—ä»˜å‡ºåŠªåŠ›ã€‚æƒ³è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ä¸‹é¢_è¿›ä¸€æ­¥é˜…è¯»_éƒ¨åˆ†ã€‚</p> <h1 id="åˆ›å»º-library">åˆ›å»º library<a href="#%E5%88%9B%E5%BB%BA-library" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>é™¤äº†æ‰“åŒ…åº”ç”¨ç¨‹åºï¼Œwebpack è¿˜å¯ä»¥ç”¨äºæ‰“åŒ… JavaScript libraryã€‚ä»¥ä¸‹æŒ‡å—é€‚ç”¨äºå¸Œæœ›ç®€åŒ–æ‰“åŒ…ç­–ç•¥çš„ library ä½œè€…ã€‚</p> <h2 id="authoring-a-library">åˆ›å»ºä¸€ä¸ª library <a href="#authoring-a-library" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å‡è®¾ä½ æ­£åœ¨ç¼–å†™ä¸€ä¸ªåä¸º <code>webpack-numbers</code> çš„å°çš„ libraryï¼Œå¯ä»¥å°†æ•°å­— 1 åˆ° 5 è½¬æ¢ä¸ºæ–‡æœ¬è¡¨ç¤ºï¼Œåä¹‹äº¦ç„¶ï¼Œä¾‹å¦‚å°† 2 è½¬æ¢ä¸º 'two'ã€‚</p> <p>åŸºæœ¬çš„é¡¹ç›®ç»“æ„å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  |- webpack.config.js
</span><span class="token prefix inserted">+</span><span class="token line">  |- package.json
</span><span class="token prefix inserted">+</span><span class="token line">  |- /src
</span><span class="token prefix inserted">+</span><span class="token line">    |- index.js
</span><span class="token prefix inserted">+</span><span class="token line">    |- ref.json</span></span></code></pre> <p>åˆå§‹åŒ– npmï¼Œå®‰è£… webpack å’Œ lodashï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> init -y
<span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack lodash</code></pre> <p><strong>src/ref.json</strong></p> <pre><code class="hljs language-json"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"One"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Two"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Three"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Four"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Five"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token property">"num"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token property">"word"</span><span class="token operator">:</span> <span class="token string">"Zero"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">import</span> _ <span class="token keyword">from</span> <span class="token string">'lodash'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> numRef <span class="token keyword">from</span> <span class="token string">'./ref.json'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">numToWord</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>numRef<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">accum<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ref<span class="token punctuation">.</span>num <span class="token operator">===</span> num <span class="token operator">?</span> ref<span class="token punctuation">.</span>word <span class="token operator">:</span> accum<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> _<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span>numRef<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">accum<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> ref<span class="token punctuation">.</span>word <span class="token operator">===</span> word <span class="token operator">&#x26;&#x26;</span> word<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> ref<span class="token punctuation">.</span>num <span class="token operator">:</span> accum<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p>è¿™ä¸ª library çš„è°ƒç”¨è§„èŒƒå¦‚ä¸‹ï¼š</p> <ul> <li><strong>ES2015 module import:</strong></li> </ul> <pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> webpackNumbers <span class="token keyword">from</span> <span class="token string">'webpack-numbers'</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <ul> <li><strong>CommonJS module require:</strong></li> </ul> <pre><code class="hljs language-js"><span class="token keyword">const</span> webpackNumbers <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-numbers'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <ul> <li><strong>AMD module require:</strong></li> </ul> <pre><code class="hljs language-js"><span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'webpackNumbers'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">webpackNumbers</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>consumer(ä½¿ç”¨è€…) è¿˜å¯ä»¥é€šè¿‡ä¸€ä¸ª script æ ‡ç­¾æ¥åŠ è½½å’Œä½¿ç”¨æ­¤ libraryï¼š</p> <pre><code class="hljs language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  ...
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://unpkg.com/webpack-numbers<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// ...</span>
    <span class="token comment">// å…¨å±€å˜é‡</span>
    webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Five'</span><span class="token punctuation">)</span>
    <span class="token comment">// window å¯¹è±¡ä¸­çš„å±æ€§</span>
    window<span class="token punctuation">.</span>webpackNumbers<span class="token punctuation">.</span><span class="token function">wordToNum</span><span class="token punctuation">(</span><span class="token string">'Five'</span><span class="token punctuation">)</span>
    <span class="token comment">// ...</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre> <p>æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡ä»¥ä¸‹é…ç½®æ–¹å¼ï¼Œå°† library æš´éœ²ä¸ºï¼š</p> <ul> <li>global å¯¹è±¡ä¸­çš„å±æ€§ï¼Œç”¨äº Node.jsã€‚</li> <li><code>this</code> å¯¹è±¡ä¸­çš„å±æ€§ã€‚</li> </ul> <p>å®Œæ•´çš„ library é…ç½®å’Œä»£ç ï¼Œè¯·æŸ¥çœ‹ <a href="javascript:if(confirm('https://github.com/kalcifer/webpack-library-example  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/kalcifer/webpack-library-example'" tppabs="https://github.com/kalcifer/webpack-library-example">webpack-library-example</a>ã€‚</p> <h2 id="base-configuration">åŸºæœ¬é…ç½® <a href="#base-configuration" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä»¥æŸç§æ–¹å¼æ‰“åŒ…è¿™ä¸ª libraryï¼Œèƒ½å¤Ÿå®ç°ä»¥ä¸‹å‡ ä¸ªç›®æ ‡ï¼š</p> <ul> <li>ä½¿ç”¨ <code>externals</code> é€‰é¡¹ï¼Œé¿å…å°† <code>lodash</code> æ‰“åŒ…åˆ°åº”ç”¨ç¨‹åºï¼Œè€Œä½¿ç”¨è€…ä¼šå»åŠ è½½å®ƒã€‚</li> <li>å°† library çš„åç§°è®¾ç½®ä¸º <code>webpack-numbers</code>ã€‚</li> <li>å°† library æš´éœ²ä¸ºä¸€ä¸ªåä¸º <code>webpackNumbers</code> çš„å˜é‡ã€‚</li> <li>èƒ½å¤Ÿè®¿é—®å…¶ä»– Node.js ä¸­çš„ libraryã€‚</li> </ul> <p>æ­¤å¤–ï¼Œconsumer(ä½¿ç”¨è€…) åº”è¯¥èƒ½å¤Ÿé€šè¿‡ä»¥ä¸‹æ–¹å¼è®¿é—® libraryï¼š</p> <ul> <li>ES2015 æ¨¡å—ã€‚ä¾‹å¦‚ <code>import webpackNumbers from 'webpack-numbers'</code>ã€‚</li> <li>CommonJS æ¨¡å—ã€‚ä¾‹å¦‚ <code>require('webpack-numbers')</code>.</li> <li>å…¨å±€å˜é‡ï¼Œåœ¨é€šè¿‡ <code>script</code> æ ‡ç­¾å¼•å…¥æ—¶ã€‚</li> </ul> <p>æˆ‘ä»¬å¯ä»¥ä»å¦‚ä¸‹ webpack åŸºæœ¬é…ç½®å¼€å§‹ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'webpack-numbers.js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="base-configuration-with-source-map">ä½¿ç”¨ source map çš„åŸºæœ¬é…ç½® <a href="#base-configuration-with-source-map" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>source map æ˜¯æœ‰ç”¨çš„è°ƒè¯•å·¥å…·ï¼Œå¯ä»¥æŸ¥çœ‹å‹ç¼©ä»£ç å¯¹åº”çš„åŸå§‹ä»£ç ã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'source-map'</span>
<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">devtool</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  mode<span class="token operator">:</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    filename<span class="token operator">:</span> <span class="token string">'webpack-numbers.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  devtool<span class="token punctuation">,</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    runtimeChunk<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <blockquote> <p>å…³äº source map é…ç½®å’Œå¯ç”¨é€‰é¡¹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒ <a href="javascript:if(confirm('https://webpack.js.org/configuration/devtool/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://webpack.js.org/configuration/devtool/'" tppabs="https://webpack.js.org/configuration/devtool/">devtool é…ç½®</a></p> </blockquote> <blockquote> <p>æŸ¥çœ‹ä»£ç ç¤ºä¾‹ï¼Œ è¯·å‚è€ƒ <a href="javascript:if(confirm('https://github.com/webpack/webpack/tree/master/examples/source-map  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack/tree/master/examples/source-map'" tppabs="https://github.com/webpack/webpack/tree/master/examples/source-map">webpack ä»“åº“</a></p> </blockquote> <h2 id="externalize-lodash">å¤–éƒ¨åŒ– lodash <a href="#externalize-lodash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç°åœ¨ï¼Œå¦‚æœæ‰§è¡Œ <code>webpack</code>ï¼Œä½ ä¼šå‘ç°åˆ›å»ºäº†ä¸€ä¸ªä½“ç§¯ç›¸å½“å¤§çš„æ–‡ä»¶ã€‚å¦‚æœä½ æŸ¥çœ‹è¿™ä¸ªæ–‡ä»¶ï¼Œä¼šçœ‹åˆ° lodash ä¹Ÿè¢«æ‰“åŒ…åˆ°ä»£ç ä¸­ã€‚åœ¨è¿™ç§åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬æ›´å€¾å‘äºæŠŠ <code>lodash</code> å½“ä½œ <code>peerDependency</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œconsumer(ä½¿ç”¨è€…) åº”è¯¥å·²ç»å®‰è£…è¿‡ <code>lodash</code> ã€‚å› æ­¤ï¼Œä½ å°±å¯ä»¥æ”¾å¼ƒæ§åˆ¶æ­¤å¤–éƒ¨ library ï¼Œè€Œæ˜¯å°†æ§åˆ¶æƒè®©ç»™ä½¿ç”¨ library çš„ consumerã€‚</p> <p>è¿™å¯ä»¥ä½¿ç”¨ <code>externals</code> é…ç½®æ¥å®Œæˆï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: 'webpack-numbers.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   externals: {
</span><span class="token prefix inserted">+</span><span class="token line">     lodash: {
</span><span class="token prefix inserted">+</span><span class="token line">       commonjs: 'lodash',
</span><span class="token prefix inserted">+</span><span class="token line">       commonjs2: 'lodash',
</span><span class="token prefix inserted">+</span><span class="token line">       amd: 'lodash',
</span><span class="token prefix inserted">+</span><span class="token line">       root: '_',
</span><span class="token prefix inserted">+</span><span class="token line">     },
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>è¿™æ„å‘³ç€ä½ çš„ library éœ€è¦ä¸€ä¸ªåä¸º <code>lodash</code> çš„ä¾èµ–ï¼Œè¿™ä¸ªä¾èµ–åœ¨ consumer ç¯å¢ƒä¸­å¿…é¡»å­˜åœ¨ä¸”å¯ç”¨ã€‚</p> <blockquote class="tip"> <p>æ³¨æ„ï¼Œå¦‚æœä½ ä»…è®¡åˆ’å°† library ç”¨ä½œå¦ä¸€ä¸ª webpack bundle ä¸­çš„ä¾èµ–æ¨¡å—ï¼Œåˆ™å¯ä»¥ç›´æ¥å°† <code>externals</code> æŒ‡å®šä¸ºä¸€ä¸ªæ•°ç»„ã€‚</p> </blockquote> <h2 id="external-limitations">å¤–éƒ¨åŒ–çš„é™åˆ¶ <a href="#external-limitations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å¯¹äºæƒ³è¦å®ç°ä»ä¸€ä¸ªä¾èµ–ä¸­è°ƒç”¨å¤šä¸ªæ–‡ä»¶çš„é‚£äº› libraryï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token constant">A</span> <span class="token keyword">from</span> <span class="token string">'library/one'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token constant">B</span> <span class="token keyword">from</span> <span class="token string">'library/two'</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span></code></pre> <p>æ— æ³•é€šè¿‡åœ¨ externals ä¸­æŒ‡å®šæ•´ä¸ª <code>library</code> çš„æ–¹å¼ï¼Œå°†å®ƒä»¬ä» bundle ä¸­æ’é™¤ã€‚è€Œæ˜¯éœ€è¦é€ä¸ªæˆ–è€…ä½¿ç”¨ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œæ¥æ’é™¤å®ƒä»¬ã€‚</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  externals<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'library/one'</span><span class="token punctuation">,</span>
    <span class="token string">'library/two'</span><span class="token punctuation">,</span>
    <span class="token comment">// åŒ¹é…ä»¥ "library/" å¼€å§‹çš„æ‰€æœ‰ä¾èµ–</span>
    <span class="token operator">/</span><span class="token operator">^</span>library\<span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.+$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="expose-the-library">æš´éœ² library <a href="#expose-the-library" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å¯¹äºç”¨æ³•å¹¿æ³›çš„ libraryï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒèƒ½å¤Ÿå…¼å®¹ä¸åŒçš„ç¯å¢ƒï¼Œä¾‹å¦‚ CommonJSï¼ŒAMDï¼ŒNode.js æˆ–è€…ä½œä¸ºä¸€ä¸ªå…¨å±€å˜é‡ã€‚ä¸ºäº†è®©ä½ çš„ library èƒ½å¤Ÿåœ¨å„ç§ä½¿ç”¨ç¯å¢ƒä¸­å¯ç”¨ï¼Œéœ€è¦åœ¨ <code>output</code> ä¸­æ·»åŠ  <code>library</code> å±æ€§ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: 'webpack-numbers.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     library: 'webpackNumbers',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   externals: {
</span><span class="token prefix unchanged"> </span><span class="token line">     lodash: {
</span><span class="token prefix unchanged"> </span><span class="token line">       commonjs: 'lodash',
</span><span class="token prefix unchanged"> </span><span class="token line">       commonjs2: 'lodash',
</span><span class="token prefix unchanged"> </span><span class="token line">       amd: 'lodash',
</span><span class="token prefix unchanged"> </span><span class="token line">       root: '_',
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <blockquote class="tip"> <p>æ³¨æ„ï¼Œ<code>library</code> è®¾ç½®ç»‘å®šåˆ° <code>entry</code> é…ç½®ã€‚å¯¹äºå¤§å¤šæ•° libraryï¼ŒæŒ‡å®šä¸€ä¸ªå…¥å£èµ·ç‚¹å°±è¶³å¤Ÿäº†ã€‚è™½ç„¶ <a href="javascript:if(confirm('https://github.com/webpack/webpack/tree/master/examples/multi-part-library  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack/tree/master/examples/multi-part-library'" tppabs="https://github.com/webpack/webpack/tree/master/examples/multi-part-library">ä¸€æ¬¡æ‰“åŒ…æš´éœ²å¤šä¸ªåº“</a> ä¹Ÿæ˜¯ä¹Ÿå¯ä»¥çš„ï¼Œç„¶è€Œï¼Œé€šè¿‡ <a href="javascript:if(confirm('https://stackoverflow.com/questions/34072598/es6-exporting-importing-in-index-file  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://stackoverflow.com/questions/34072598/es6-exporting-importing-in-index-file'" tppabs="https://stackoverflow.com/questions/34072598/es6-exporting-importing-in-index-file">index script(ç´¢å¼•è„šæœ¬)ï¼ˆä»…ç”¨äºè®¿é—®ä¸€ä¸ªå…¥å£èµ·ç‚¹ï¼‰</a> æš´éœ²éƒ¨åˆ†å¯¼å‡ºåˆ™æ›´ä¸ºç®€å•ã€‚æˆ‘ä»¬__ä¸æ¨è__ä½¿ç”¨<code>æ•°ç»„</code>ä½œä¸º library çš„ <code>entry</code>ã€‚</p> </blockquote> <p>è¿™ä¼šå°†ä½ çš„ library bundle æš´éœ²ä¸ºåä¸º <code>webpackNumbers</code> çš„å…¨å±€å˜é‡ï¼Œconsumer é€šè¿‡æ­¤åç§°æ¥ importã€‚ä¸ºäº†è®© library å’Œå…¶ä»–ç¯å¢ƒå…¼å®¹ï¼Œåˆ™éœ€è¦åœ¨é…ç½®ä¸­æ·»åŠ  <code>libraryTarget</code> å±æ€§ã€‚è¿™ä¸ªé€‰é¡¹å¯ä»¥æ§åˆ¶ä»¥å¤šç§å½¢å¼æš´éœ² libraryã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: 'webpack-numbers.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     library: 'webpackNumbers',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     libraryTarget: 'umd',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   externals: {
</span><span class="token prefix unchanged"> </span><span class="token line">     lodash: {
</span><span class="token prefix unchanged"> </span><span class="token line">       commonjs: 'lodash',
</span><span class="token prefix unchanged"> </span><span class="token line">       commonjs2: 'lodash',
</span><span class="token prefix unchanged"> </span><span class="token line">       amd: 'lodash',
</span><span class="token prefix unchanged"> </span><span class="token line">       root: '_',
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼æš´éœ² libraryï¼š</p> <ul> <li>å˜é‡ï¼šä½œä¸ºä¸€ä¸ªå…¨å±€å˜é‡ï¼Œé€šè¿‡ <code>script</code> æ ‡ç­¾æ¥è®¿é—®ï¼ˆ<code>libraryTarget:'var'</code>ï¼‰ã€‚</li> <li>thisï¼šé€šè¿‡ <code>this</code> å¯¹è±¡è®¿é—®ï¼ˆ<code>libraryTarget:'this'</code>ï¼‰ã€‚</li> <li>windowï¼šåœ¨æµè§ˆå™¨ä¸­é€šè¿‡ <code>window</code> å¯¹è±¡è®¿é—®ï¼ˆ<code>libraryTarget:'window'</code>ï¼‰ã€‚</li> <li>UMDï¼šåœ¨ AMD æˆ– CommonJS <code>require</code> ä¹‹åå¯è®¿é—®ï¼ˆ<code>libraryTarget:'umd'</code>ï¼‰ã€‚</li> </ul> <p>å¦‚æœè®¾ç½®äº† <code>library</code> ä½†æ²¡æœ‰è®¾ç½® <code>libraryTarget</code>ï¼Œåˆ™ <code>libraryTarget</code> é»˜è®¤æŒ‡å®šä¸º <code>var</code>ï¼Œè¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ <a href="../../configuration/output.htm" tppabs="https://webpack.docschina.org/configuration/output">output </a> æ–‡æ¡£ã€‚æŸ¥çœ‹ <a href="../../configuration/output.htm#outputlibrarytarget" tppabs="https://webpack.docschina.org/configuration/output#outputlibrarytarget"><code>output.libraryTarget</code></a> æ–‡æ¡£ï¼Œä»¥è·å–æ‰€æœ‰å¯ç”¨é€‰é¡¹çš„è¯¦ç»†åˆ—è¡¨ã€‚</p> <blockquote class="warning"> <p>åœ¨ webpack v3.5.5 ä¸­ï¼Œä½¿ç”¨ <code>libraryTarget: { root:'_' }</code> å°†æ— æ³•æ­£å¸¸å·¥ä½œï¼ˆå‚è€ƒ <a href="javascript:if(confirm('https://github.com/webpack/webpack/issues/4824  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack/issues/4824'" tppabs="https://github.com/webpack/webpack/issues/4824">issue 4824</a>) æ‰€è¿°ï¼‰ã€‚ç„¶è€Œï¼Œå¯ä»¥è®¾ç½® <code>libraryTarget: { var: '_' }</code> æ¥å°† library ä½œä¸ºå…¨å±€å˜é‡ã€‚</p> </blockquote> <h3 id="final-steps">æœ€ç»ˆæ­¥éª¤ <a href="#final-steps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>éµå¾ª <a href="../production.htm" tppabs="https://webpack.docschina.org/guides/production">ç”Ÿäº§ç¯å¢ƒ</a> æŒ‡å—ä¸­æåˆ°çš„æ­¥éª¤ï¼Œæ¥ä¼˜åŒ–ç”Ÿäº§ç¯å¢ƒä¸‹çš„è¾“å‡ºç»“æœã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†ç”Ÿæˆ bundle çš„æ–‡ä»¶è·¯å¾„ï¼Œæ·»åŠ åˆ° <code>package.json</code> ä¸­çš„ <code>main</code> å­—æ®µä¸­ã€‚</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  ...
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"dist/webpack-numbers.js"</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span></code></pre> <p>æˆ–è€…ï¼ŒæŒ‰ç…§è¿™ä¸ª <a href="javascript:if(confirm('https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md#typical-usage'" tppabs="https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md#typical-usage">æŒ‡å—</a>ï¼Œå°†å…¶æ·»åŠ ä¸ºæ ‡å‡†æ¨¡å—ï¼š</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  ...
  <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"src/index.js"</span><span class="token punctuation">,</span>
  ...
<span class="token punctuation">}</span></code></pre> <p>è¿™é‡Œçš„ key(é”®) <code>main</code> æ˜¯å‚ç…§ <a href="javascript:if(confirm('https://docs.npmjs.com/files/package.json  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docs.npmjs.com/files/package.json#main'" tppabs="https://docs.npmjs.com/files/package.json#main"><code>package.json</code> æ ‡å‡†</a>ï¼Œè€Œ <code>module</code> æ˜¯å‚ç…§ <a href="javascript:if(confirm('https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md'" tppabs="https://github.com/dherman/defense-of-dot-js/blob/master/proposal.md">ä¸€ä¸ª</a><a href="javascript:if(confirm('https://github.com/rollup/rollup/wiki/pkg.module  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/rollup/rollup/wiki/pkg.module'" tppabs="https://github.com/rollup/rollup/wiki/pkg.module">ææ¡ˆ</a>ï¼Œæ­¤ææ¡ˆå…è®¸ JavaScript ç”Ÿæ€ç³»ç»Ÿå‡çº§ä½¿ç”¨ ES2015 æ¨¡å—ï¼Œè€Œä¸ä¼šç ´åå‘åå…¼å®¹æ€§ã€‚</p> <blockquote class="warning"> <p><code>module</code> å±æ€§åº”æŒ‡å‘ä¸€ä¸ªä½¿ç”¨ ES2015 æ¨¡å—è¯­æ³•çš„è„šæœ¬ï¼Œä½†ä¸åŒ…æ‹¬æµè§ˆå™¨æˆ– Node.js å°šä¸æ”¯æŒçš„å…¶ä»–è¯­æ³•ç‰¹æ€§ã€‚è¿™ä½¿å¾— webpack æœ¬èº«å°±å¯ä»¥è§£ææ¨¡å—è¯­æ³•ï¼Œå¦‚æœç”¨æˆ·åªç”¨åˆ° library çš„æŸäº›éƒ¨åˆ†ï¼Œåˆ™å…è®¸é€šè¿‡ <a href="../tree-shaking/index.htm" tppabs="https://webpack.docschina.org/guides/tree-shaking/">tree shaking</a> æ‰“åŒ…æ›´è½»é‡çš„åŒ…ã€‚</p> </blockquote> <p>ç°åœ¨ï¼Œä½ å¯ä»¥ <a href="javascript:if(confirm('https://docs.npmjs.com/getting-started/publishing-npm-packages  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docs.npmjs.com/getting-started/publishing-npm-packages'" tppabs="https://docs.npmjs.com/getting-started/publishing-npm-packages">å°†å…¶å‘å¸ƒä¸ºä¸€ä¸ª npm package</a>ï¼Œå¹¶ä¸”åœ¨ <a href="javascript:if(confirm('https://unpkg.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://unpkg.com/#/'" tppabs="https://unpkg.com/#/">unpkg.com</a> æ‰¾åˆ°å®ƒï¼Œå¹¶åˆ†å‘ç»™ä½ çš„ç”¨æˆ·ã€‚</p> <blockquote class="tip"> <p>ä¸ºäº†æš´éœ²å’Œ library å…³è”ç€çš„æ ·å¼è¡¨ï¼Œä½ åº”è¯¥ä½¿ç”¨ <a href="../../plugins/mini-css-extract-plugin.htm" tppabs="https://webpack.docschina.org/plugins/mini-css-extract-plugin"><code>MiniCssExtractPlugin</code></a>ã€‚ç„¶åï¼Œç”¨æˆ·å¯ä»¥åƒä½¿ç”¨å…¶ä»–æ ·å¼è¡¨ä¸€æ ·ä½¿ç”¨å’ŒåŠ è½½è¿™äº›æ ·å¼è¡¨ã€‚</p> </blockquote> <h1 id="ç¯å¢ƒå˜é‡">ç¯å¢ƒå˜é‡<a href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>æƒ³è¦æ¶ˆé™¤ <code>webpack.config.js</code> åœ¨ <a href="../development.htm" tppabs="https://webpack.docschina.org/guides/development">å¼€å‘ç¯å¢ƒ</a> å’Œ <a href="../production.htm" tppabs="https://webpack.docschina.org/guides/production">ç”Ÿäº§ç¯å¢ƒ</a> ä¹‹é—´çš„å·®å¼‚ï¼Œä½ å¯èƒ½éœ€è¦ç¯å¢ƒå˜é‡(environment variable)ã€‚</p> <blockquote class="tip"> <p>webpack ç¯å¢ƒå˜é‡ï¼Œä¸æ“ä½œç³»ç»Ÿä¸­çš„ <code>bash</code> å’Œ <code>CMD.exe</code> è¿™äº› shell <a href="javascript:if(confirm('https://en.wikipedia.org/wiki/Environment_variable  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://en.wikipedia.org/wiki/Environment_variable'" tppabs="https://en.wikipedia.org/wiki/Environment_variable">ç¯å¢ƒå˜é‡</a> ä¸åŒã€‚</p> </blockquote> <p>webpack å‘½ä»¤è¡Œ <a href="../../api/cli/index.htm#environment-options" tppabs="https://webpack.docschina.org/api/cli/#environment-options">ç¯å¢ƒé…ç½®</a> çš„ <code>--env</code> å‚æ•°ï¼Œå¯ä»¥å…è®¸ä½ ä¼ å…¥ä»»æ„æ•°é‡çš„ç¯å¢ƒå˜é‡ã€‚è€Œåœ¨ <code>webpack.config.js</code> ä¸­å¯ä»¥è®¿é—®åˆ°è¿™äº›ç¯å¢ƒå˜é‡ã€‚ä¾‹å¦‚ï¼Œ<code>--env production</code> æˆ– <code>--env NODE_ENV=local</code>ï¼ˆ<code>NODE_ENV</code> é€šå¸¸çº¦å®šç”¨äºå®šä¹‰ç¯å¢ƒç±»å‹ï¼ŒæŸ¥çœ‹ <a href="javascript:if(confirm('https://dzone.com/articles/what-you-should-know-about-node-env  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://dzone.com/articles/what-you-should-know-about-node-env'" tppabs="https://dzone.com/articles/what-you-should-know-about-node-env">è¿™é‡Œ</a>ï¼‰ã€‚</p> <pre><code class="hljs language-bash">npx webpack --env <span class="token assign-left variable">NODE_ENV</span><span class="token operator">=</span>local --env production --progress</code></pre> <blockquote class="tip"> <p>å¦‚æœè®¾ç½® <code>env</code> å˜é‡ï¼Œå´æ²¡æœ‰èµ‹å€¼ï¼Œ<code>--env production</code> é»˜è®¤è¡¨ç¤ºå°† <code>env.production</code> è®¾ç½®ä¸º <code>true</code>ã€‚è¿˜æœ‰è®¸å¤šå…¶ä»–å¯ä»¥ä½¿ç”¨çš„è¯­æ³•ã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="../../api/cli/index.htm#environment-options" tppabs="https://webpack.docschina.org/api/cli/#environment-options">webpack CLI</a> æ–‡æ¡£ã€‚</p> </blockquote> <p>å¯¹äºæˆ‘ä»¬çš„ webpack é…ç½®ï¼Œæœ‰ä¸€ä¸ªå¿…é¡»è¦ä¿®æ”¹ä¹‹å¤„ã€‚é€šå¸¸ï¼Œ<code>module.exports</code> æŒ‡å‘é…ç½®å¯¹è±¡ã€‚è¦ä½¿ç”¨ <code>env</code> å˜é‡ï¼Œä½ å¿…é¡»å°† <code>module.exports</code> è½¬æ¢æˆä¸€ä¸ªå‡½æ•°ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token parameter">env</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Use env.&#x3C;YOUR VARIABLE> here:</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'NODE_ENV: '</span><span class="token punctuation">,</span> env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'local'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Production: '</span><span class="token punctuation">,</span> env<span class="token punctuation">.</span>production<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    entry<span class="token operator">:</span> <span class="token string">'./src/index.js'</span><span class="token punctuation">,</span>
    output<span class="token operator">:</span> <span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h1 id="æ„å»ºæ€§èƒ½">æ„å»ºæ€§èƒ½<a href="#%E6%9E%84%E5%BB%BA%E6%80%A7%E8%83%BD" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>æœ¬æŒ‡å—åŒ…å«ä¸€äº›æ”¹è¿›æ„å»º/ç¼–è¯‘æ€§èƒ½çš„å®ç”¨æŠ€å·§ã€‚</p> <hr> <h2 id="general">é€šç”¨ç¯å¢ƒ <a href="#general" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ— è®ºä½ æ˜¯åœ¨ <a href="../development.htm" tppabs="https://webpack.docschina.org/guides/development">å¼€å‘ç¯å¢ƒ</a> è¿˜æ˜¯åœ¨ <a href="../production.htm" tppabs="https://webpack.docschina.org/guides/production">ç”Ÿäº§ç¯å¢ƒ</a> ä¸‹è¿è¡Œæ„å»ºè„šæœ¬ï¼Œä»¥ä¸‹æœ€ä½³å®è·µéƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚</p> <h3 id="stay-up-to-date">æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ <a href="#stay-up-to-date" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>ä½¿ç”¨æœ€æ–°çš„ webpack ç‰ˆæœ¬ã€‚æˆ‘ä»¬ä¼šç»å¸¸è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ã€‚webpack çš„æœ€æ–°ç¨³å®šç‰ˆæœ¬æ˜¯ï¼š</p> <p><a href="javascript:if(confirm('https://github.com/webpack/webpack/releases  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack/releases'" tppabs="https://github.com/webpack/webpack/releases"><img src="../../../img.shields.io/github/package-json/v/webpack/webpack.svg-label=webpack" tppabs="https://img.shields.io/github/package-json/v/webpack/webpack.svg?label=webpack" alt="latest webpack version"></a></p> <p>å°† <strong>Node.js</strong> æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä¹Ÿæœ‰åŠ©äºæé«˜æ€§èƒ½ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå°†ä½ çš„ package ç®¡ç†å·¥å…·ï¼ˆä¾‹å¦‚ <code>npm</code> æˆ–è€… <code>yarn</code>ï¼‰æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œä¹Ÿæœ‰åŠ©äºæé«˜æ€§èƒ½ã€‚è¾ƒæ–°çš„ç‰ˆæœ¬èƒ½å¤Ÿå»ºç«‹æ›´é«˜æ•ˆçš„æ¨¡å—æ ‘ä»¥åŠæé«˜è§£æé€Ÿåº¦ã€‚</p> <h3 id="loaders">loader <a href="#loaders" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>å°† loader åº”ç”¨äºæœ€å°‘æ•°é‡çš„å¿…è¦æ¨¡å—ã€‚è€Œéå¦‚ä¸‹:</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>é€šè¿‡ä½¿ç”¨ <code>include</code> å­—æ®µï¼Œä»…å°† loader åº”ç”¨åœ¨å®é™…éœ€è¦å°†å…¶è½¬æ¢çš„æ¨¡å—ï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        include<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        loader<span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="bootstrap">å¼•å¯¼(bootstrap) <a href="#bootstrap" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>æ¯ä¸ªé¢å¤–çš„ loader/plugin éƒ½æœ‰å…¶å¯åŠ¨æ—¶é—´ã€‚å°½é‡å°‘åœ°ä½¿ç”¨å·¥å…·ã€‚</p> <h3 id="resolving">è§£æ <a href="#resolving" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>ä»¥ä¸‹æ­¥éª¤å¯ä»¥æé«˜è§£æé€Ÿåº¦ï¼š</p> <ul> <li>å‡å°‘ <code>resolve.modules</code>, <code>resolve.extensions</code>, <code>resolve.mainFiles</code>, <code>resolve.descriptionFiles</code> ä¸­æ¡ç›®æ•°é‡ï¼Œå› ä¸ºä»–ä»¬ä¼šå¢åŠ æ–‡ä»¶ç³»ç»Ÿè°ƒç”¨çš„æ¬¡æ•°ã€‚</li> <li>å¦‚æœä½ ä¸ä½¿ç”¨ symlinksï¼ˆä¾‹å¦‚ <code>npm link</code> æˆ–è€… <code>yarn link</code>ï¼‰ï¼Œå¯ä»¥è®¾ç½® <code>resolve.symlinks: false</code>ã€‚</li> <li>å¦‚æœä½ ä½¿ç”¨è‡ªå®šä¹‰ resolve plugin è§„åˆ™ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®š context ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥è®¾ç½® <code>resolve.cacheWithContext: false</code>ã€‚</li> </ul> <h3 id="dlls">dll <a href="#dlls" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>ä½¿ç”¨ <code>DllPlugin</code> ä¸ºæ›´æ”¹ä¸é¢‘ç¹çš„ä»£ç ç”Ÿæˆå•ç‹¬çš„ç¼–è¯‘ç»“æœã€‚è¿™å¯ä»¥æé«˜åº”ç”¨ç¨‹åºçš„ç¼–è¯‘é€Ÿåº¦ï¼Œå°½ç®¡å®ƒå¢åŠ äº†æ„å»ºè¿‡ç¨‹çš„å¤æ‚åº¦ã€‚</p> <h3 id="smaller--faster">å°å³æ˜¯å¿«(smaller = faster) <a href="#smaller--faster" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>å‡å°‘ç¼–è¯‘ç»“æœçš„æ•´ä½“å¤§å°ï¼Œä»¥æé«˜æ„å»ºæ€§èƒ½ã€‚å°½é‡ä¿æŒ chunk ä½“ç§¯å°ã€‚</p> <ul> <li>ä½¿ç”¨æ•°é‡æ›´å°‘/ä½“ç§¯æ›´å°çš„ libraryã€‚</li> <li>åœ¨å¤šé¡µé¢åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ <code>SplitChunksPlugin</code>ã€‚</li> <li>åœ¨å¤šé¡µé¢åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ <code>SplitChunksPlugin </code>ï¼Œå¹¶å¼€å¯ <code>async</code> æ¨¡å¼ã€‚</li> <li>ç§»é™¤æœªå¼•ç”¨ä»£ç ã€‚</li> <li>åªç¼–è¯‘ä½ å½“å‰æ­£åœ¨å¼€å‘çš„é‚£äº›ä»£ç ã€‚</li> </ul> <h3 id="worker-pool">worker æ± (worker pool) <a href="#worker-pool" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>thread-loader</code> å¯ä»¥å°†éå¸¸æ¶ˆè€—èµ„æºçš„ loader åˆ†æµç»™ä¸€ä¸ª worker poolã€‚</p> <blockquote class="warning"> <p>ä¸è¦ä½¿ç”¨å¤ªå¤šçš„ workerï¼Œå› ä¸º Node.js çš„ runtime å’Œ loader éƒ½æœ‰å¯åŠ¨å¼€é”€ã€‚æœ€å°åŒ– worker å’Œ main process(ä¸»è¿›ç¨‹) ä¹‹é—´çš„æ¨¡å—ä¼ è¾“ã€‚è¿›ç¨‹é—´é€šè®¯(IPC, inter process communication)æ˜¯éå¸¸æ¶ˆè€—èµ„æºçš„ã€‚</p> </blockquote> <h3 id="persistent-cache">æŒä¹…åŒ–ç¼“å­˜ <a href="#persistent-cache" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>åœ¨ webpack é…ç½®ä¸­ä½¿ç”¨ <a href="../../configuration/other-options/index.htm#cache" tppabs="https://webpack.docschina.org/configuration/other-options/#cache"><code>cache</code></a> é€‰é¡¹ã€‚ä½¿ç”¨ <code>package.json</code> ä¸­çš„ <code>"postinstall"</code> æ¸…é™¤ç¼“å­˜ç›®å½•ã€‚</p> <blockquote class="tip"> <p>æˆ‘ä»¬æ”¯æŒ yarn PnP v3 <a href="javascript:if(confirm('https://yarnpkg.com/features/pnp  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://yarnpkg.com/features/pnp'" tppabs="https://yarnpkg.com/features/pnp"><code>yarn 2 berry</code></a>ï¼Œæ¥è¿›è¡ŒæŒä¹…ç¼“å­˜ã€‚</p> </blockquote> <h3 id="custom-pluginsloaders">è‡ªå®šä¹‰ plugin/loader <a href="#custom-pluginsloaders" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>å¯¹å®ƒä»¬è¿›è¡Œæ¦‚è¦åˆ†æï¼Œä»¥å…åœ¨æ­¤å¤„å¼•å…¥æ€§èƒ½é—®é¢˜ã€‚</p> <h3 id="progress-plugin">Progress plugin <a href="#progress-plugin" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>å°† <code>ProgressPlugin</code> ä» webpack ä¸­åˆ é™¤ï¼Œå¯ä»¥ç¼©çŸ­æ„å»ºæ—¶é—´ã€‚è¯·æ³¨æ„ï¼Œ<code>ProgressPlugin</code> å¯èƒ½ä¸ä¼šä¸ºå¿«é€Ÿæ„å»ºæä¾›å¤ªå¤šä»·å€¼ï¼Œå› æ­¤ï¼Œè¯·æƒè¡¡åˆ©å¼Šå†ä½¿ç”¨ã€‚</p> <hr> <h2 id="development">å¼€å‘ç¯å¢ƒ <a href="#development" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä»¥ä¸‹æ­¥éª¤å¯¹äº_å¼€å‘ç¯å¢ƒ_ç‰¹åˆ«æœ‰å¸®åŠ©ã€‚</p> <h3 id="incremental-builds">å¢é‡ç¼–è¯‘ <a href="#incremental-builds" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>ä½¿ç”¨ webpack çš„ watch mode(ç›‘å¬æ¨¡å¼)ã€‚è€Œä¸ä½¿ç”¨å…¶ä»–å·¥å…·æ¥ watch æ–‡ä»¶å’Œè°ƒç”¨ webpack ã€‚å†…ç½®çš„ watch mode ä¼šè®°å½•æ—¶é—´æˆ³å¹¶å°†æ­¤ä¿¡æ¯ä¼ é€’ç»™ compilation ä»¥ä½¿ç¼“å­˜å¤±æ•ˆã€‚</p> <p>åœ¨æŸäº›é…ç½®ç¯å¢ƒä¸­ï¼Œwatch mode ä¼šå›é€€åˆ° poll mode(è½®è¯¢æ¨¡å¼)ã€‚ç›‘å¬è®¸å¤šæ–‡ä»¶ä¼šå¯¼è‡´ CPU å¤§é‡è´Ÿè½½ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>watchOptions.poll</code> æ¥å¢åŠ è½®è¯¢çš„é—´éš”æ—¶é—´ã€‚</p> <h3 id="compile-in-memory">åœ¨å†…å­˜ä¸­ç¼–è¯‘ <a href="#compile-in-memory" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>ä¸‹é¢å‡ ä¸ªå·¥å…·é€šè¿‡åœ¨å†…å­˜ä¸­ï¼ˆè€Œä¸æ˜¯å†™å…¥ç£ç›˜ï¼‰ç¼–è¯‘å’Œ serve èµ„æºæ¥æé«˜æ€§èƒ½ï¼š</p> <ul> <li><code>webpack-dev-server</code></li> <li><code>webpack-hot-middleware</code></li> <li><code>webpack-dev-middleware</code></li> </ul> <h3 id="statstojson-speed">stats.toJson åŠ é€Ÿ <a href="#statstojson-speed" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack 4 é»˜è®¤ä½¿ç”¨ <code>stats.toJson()</code> è¾“å‡ºå¤§é‡æ•°æ®ã€‚é™¤éåœ¨å¢é‡æ­¥éª¤ä¸­åšå¿…è¦çš„ç»Ÿè®¡ï¼Œå¦åˆ™è¯·é¿å…è·å– <code>stats</code> å¯¹è±¡çš„éƒ¨åˆ†å†…å®¹ã€‚<code>webpack-dev-server</code> åœ¨ v3.1.3 ä»¥åçš„ç‰ˆæœ¬ï¼ŒåŒ…å«ä¸€ä¸ªé‡è¦çš„æ€§èƒ½ä¿®å¤ï¼Œå³æœ€å°åŒ–æ¯ä¸ªå¢é‡æ„å»ºæ­¥éª¤ä¸­ï¼Œä» <code>stats</code> å¯¹è±¡è·å–çš„æ•°æ®é‡ã€‚</p> <h3 id="devtool">Devtool <a href="#devtool" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸åŒçš„ <code>devtool</code> è®¾ç½®ï¼Œä¼šå¯¼è‡´æ€§èƒ½å·®å¼‚ã€‚</p> <ul> <li><code>"eval"</code> å…·æœ‰æœ€å¥½çš„æ€§èƒ½ï¼Œä½†å¹¶ä¸èƒ½å¸®åŠ©ä½ è½¬è¯‘ä»£ç ã€‚</li> <li>å¦‚æœä½ èƒ½æ¥å—ç¨å·®ä¸€äº›çš„ map è´¨é‡ï¼Œå¯ä»¥ä½¿ç”¨ <code>cheap-source-map</code> å˜ä½“é…ç½®æ¥æé«˜æ€§èƒ½</li> <li>ä½¿ç”¨ <code>eval-source-map</code> å˜ä½“é…ç½®è¿›è¡Œå¢é‡ç¼–è¯‘ã€‚</li> </ul> <blockquote class="tip"> <p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæœ€ä½³é€‰æ‹©æ˜¯ <code>eval-cheap-module-source-map</code>ã€‚</p> </blockquote> <h3 id="avoid-production-specific-tooling">é¿å…åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹æ‰ä¼šç”¨åˆ°çš„å·¥å…· <a href="#avoid-production-specific-tooling" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>æŸäº› utility, plugin å’Œ loader éƒ½åªç”¨äºç”Ÿäº§ç¯å¢ƒã€‚ä¾‹å¦‚ï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸‹ä½¿ç”¨ <code>TerserPlugin</code> æ¥ minify(å‹ç¼©) å’Œ mangle(æ··æ·†ç ´å) ä»£ç æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚é€šå¸¸åœ¨å¼€å‘ç¯å¢ƒä¸‹ï¼Œåº”è¯¥æ’é™¤ä»¥ä¸‹è¿™äº›å·¥å…·ï¼š</p> <ul> <li><code>TerserPlugin</code></li> <li><code>[fullhash]</code>/<code>[chunkhash]</code>/<code>[contenthash]</code></li> <li><code>AggressiveSplittingPlugin</code></li> <li><code>AggressiveMergingPlugin</code></li> <li><code>ModuleConcatenationPlugin</code></li> </ul> <h3 id="minimal-entry-chunk">æœ€å°åŒ– entry chunk <a href="#minimal-entry-chunk" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack åªä¼šåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­è¾“å‡ºå·²ç»æ›´æ–°çš„ chunkã€‚æŸäº›é…ç½®é€‰é¡¹ï¼ˆHMR, <code>output.chunkFilename</code> çš„ <code>[name]</code>/<code>[chunkhash]/[contenthash]</code>ï¼Œ<code>[fullhash]</code>ï¼‰æ¥è¯´ï¼Œé™¤äº†å¯¹å·²ç»æ›´æ–°çš„ chunk æ— æ•ˆä¹‹å¤–ï¼Œå¯¹äº entry chunk ä¹Ÿä¸ä¼šç”Ÿæ•ˆã€‚</p> <p>ç¡®ä¿åœ¨ç”Ÿæˆ entry chunk æ—¶ï¼Œå°½é‡å‡å°‘å…¶ä½“ç§¯ä»¥æé«˜æ€§èƒ½ã€‚ä¸‹é¢çš„é…ç½®ä¸ºè¿è¡Œæ—¶ä»£ç åˆ›å»ºäº†ä¸€ä¸ªé¢å¤–çš„ chunkï¼Œæ‰€ä»¥å®ƒçš„ç”Ÿæˆä»£ä»·è¾ƒä½ï¼š</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    runtimeChunk<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="avoid-extra-optimization-steps">é¿å…é¢å¤–çš„ä¼˜åŒ–æ­¥éª¤ <a href="#avoid-extra-optimization-steps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack é€šè¿‡æ‰§è¡Œé¢å¤–çš„ç®—æ³•ä»»åŠ¡ï¼Œæ¥ä¼˜åŒ–è¾“å‡ºç»“æœçš„ä½“ç§¯å’ŒåŠ è½½æ€§èƒ½ã€‚è¿™äº›ä¼˜åŒ–é€‚ç”¨äºå°å‹ä»£ç åº“ï¼Œä½†æ˜¯åœ¨å¤§å‹ä»£ç åº“ä¸­å´éå¸¸è€—è´¹æ€§èƒ½ï¼š</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>
    removeAvailableModules<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    removeEmptyChunks<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    splitChunks<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="output-without-path-info">è¾“å‡ºç»“æœä¸æºå¸¦è·¯å¾„ä¿¡æ¯ <a href="#output-without-path-info" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack ä¼šåœ¨è¾“å‡ºçš„ bundle ä¸­ç”Ÿæˆè·¯å¾„ä¿¡æ¯ã€‚ç„¶è€Œï¼Œåœ¨æ‰“åŒ…æ•°åƒä¸ªæ¨¡å—çš„é¡¹ç›®ä¸­ï¼Œè¿™ä¼šå¯¼è‡´é€ æˆåƒåœ¾å›æ”¶æ€§èƒ½å‹åŠ›ã€‚åœ¨ <code>options.output.pathinfo</code> è®¾ç½®ä¸­å…³é—­ï¼š</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    pathinfo<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="nodejs-versions-8910-9111">Node.js ç‰ˆæœ¬ 8.9.10-9.11.1 <a href="#nodejs-versions-8910-9111" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>Node.js v8.9.10 - v9.11.1 ä¸­çš„ ES2015 <code>Map</code> å’Œ <code>Set</code> å®ç°ï¼Œå­˜åœ¨ <a href="javascript:if(confirm('https://github.com/nodejs/node/issues/19769  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/nodejs/node/issues/19769'" tppabs="https://github.com/nodejs/node/issues/19769">æ€§èƒ½å›é€€</a>ã€‚webpack å¤§é‡åœ°ä½¿ç”¨è¿™äº›æ•°æ®ç»“æ„ï¼Œå› æ­¤è¿™æ¬¡å›é€€ä¹Ÿä¼šå½±å“ç¼–è¯‘æ—¶é—´ã€‚</p> <p>ä¹‹å‰å’Œä¹‹åçš„ Node.js ç‰ˆæœ¬ä¸å—å½±å“ã€‚</p> <h3 id="typescript-loader">TypeScript loader <a href="#typescript-loader" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>ä½ å¯ä»¥ä¸º loader ä¼ å…¥ <code>transpileOnly</code> é€‰é¡¹ï¼Œä»¥ç¼©çŸ­ä½¿ç”¨ <code>ts-loader</code> æ—¶çš„æ„å»ºæ—¶é—´ã€‚ä½¿ç”¨æ­¤é€‰é¡¹ï¼Œä¼šå…³é—­ç±»å‹æ£€æŸ¥ã€‚å¦‚æœè¦å†æ¬¡å¼€å¯ç±»å‹æ£€æŸ¥ï¼Œè¯·ä½¿ç”¨ <a href="javascript:if(confirm('https://www.npmjs.com/package/fork-ts-checker-webpack-plugin  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.npmjs.com/package/fork-ts-checker-webpack-plugin'" tppabs="https://www.npmjs.com/package/fork-ts-checker-webpack-plugin"><code>ForkTsCheckerWebpackPlugin</code></a>ã€‚ä½¿ç”¨æ­¤æ’ä»¶ä¼šå°†æ£€æŸ¥è¿‡ç¨‹ç§»è‡³å•ç‹¬çš„è¿›ç¨‹ï¼Œå¯ä»¥åŠ å¿« TypeScript çš„ç±»å‹æ£€æŸ¥å’Œ ESLint æ’å…¥çš„é€Ÿåº¦ã€‚</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
  test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.tsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
  use<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      loader<span class="token operator">:</span> <span class="token string">'ts-loader'</span><span class="token punctuation">,</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        transpileOnly<span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <blockquote class="tip"> <p>è¿™æ˜¯ä¸€ä¸ªå…³äº <code>ts-loader</code> <a href="javascript:if(confirm('https://github.com/TypeStrong/ts-loader/tree/master/examples/fork-ts-checker-webpack-plugin  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/TypeStrong/ts-loader/tree/master/examples/fork-ts-checker-webpack-plugin'" tppabs="https://github.com/TypeStrong/ts-loader/tree/master/examples/fork-ts-checker-webpack-plugin">å®Œæ•´ç¤ºä¾‹</a>çš„ Github ä»“åº“ã€‚</p> </blockquote> <hr> <h2 id="production">ç”Ÿäº§ç¯å¢ƒ <a href="#production" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä»¥ä¸‹æ­¥éª¤å¯¹äº_ç”Ÿäº§ç¯å¢ƒ_ç‰¹åˆ«æœ‰å¸®åŠ©ã€‚</p> <blockquote class="warning"> <p>__ä¸è¦ä¸ºäº†å¾ˆå°çš„æ€§èƒ½æ”¶ç›Šï¼Œç‰ºç‰²åº”ç”¨ç¨‹åºçš„è´¨é‡ï¼__æ³¨æ„ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¼˜åŒ–ä»£ç è´¨é‡æ¯”æ„å»ºæ€§èƒ½æ›´é‡è¦ã€‚</p> </blockquote> <h3 id="multiple-compilations">å¤šä¸ª compilation å¯¹è±¡ <a href="#multiple-compilations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>åœ¨åˆ›å»ºå¤šä¸ª compilation æ—¶ï¼Œä»¥ä¸‹å·¥å…·å¯ä»¥å¸®åŠ©åˆ°ä½ ï¼š</p> <ul> <li><a href="javascript:if(confirm('https://github.com/trivago/parallel-webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/trivago/parallel-webpack'" tppabs="https://github.com/trivago/parallel-webpack"><code>parallel-webpack</code></a>ï¼šå®ƒå…è®¸åœ¨ä¸€ä¸ª worker æ± ä¸­è¿è¡Œ compilationã€‚</li> <li><code>cache-loader</code>ï¼šå¯ä»¥åœ¨å¤šä¸ª compilation ä¹‹é—´å…±äº«ç¼“å­˜ã€‚</li> </ul> <h3 id="source-maps">Source Maps <a href="#source-maps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>source map ç›¸å½“æ¶ˆè€—èµ„æºã€‚ä½ çœŸçš„éœ€è¦å®ƒä»¬ï¼Ÿ</p> <hr> <h2 id="specific-tooling-issues">å·¥å…·ç›¸å…³é—®é¢˜ <a href="#specific-tooling-issues" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä¸‹åˆ—å·¥å…·å­˜åœ¨æŸäº›å¯èƒ½ä¼šé™ä½æ„å»ºæ€§èƒ½çš„é—®é¢˜ï¼š</p> <h3 id="babel">Babel <a href="#babel" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <ul> <li>æœ€å°åŒ–é¡¹ç›®ä¸­çš„ preset/plugin æ•°é‡ã€‚</li> </ul> <h3 id="typescript">TypeScript <a href="#typescript" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <ul> <li>åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­ä½¿ç”¨ <code>fork-ts-checker-webpack-plugin</code> è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚</li> <li>é…ç½® loader è·³è¿‡ç±»å‹æ£€æŸ¥ã€‚</li> <li>ä½¿ç”¨ <code>ts-loader</code> æ—¶ï¼Œè®¾ç½® <code>happyPackMode: true</code> / <code>transpileOnly: true</code>ã€‚</li> </ul> <h3 id="sass">Sass <a href="#sass" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <ul> <li><code>node-sass</code> ä¸­æœ‰ä¸ªæ¥è‡ª Node.js çº¿ç¨‹æ± çš„é˜»å¡çº¿ç¨‹çš„ bugã€‚ å½“ä½¿ç”¨ <code>thread-loader</code> æ—¶ï¼Œéœ€è¦è®¾ç½® <code>workerParallelJobs: 2</code>ã€‚</li> </ul> <h1 id="å†…å®¹å®‰å…¨ç­–ç•¥">å†…å®¹å®‰å…¨ç­–ç•¥<a href="#%E5%86%85%E5%AE%B9%E5%AE%89%E5%85%A8%E7%AD%96%E7%95%A5" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>webpack èƒ½å¤Ÿä¸ºå…¶åŠ è½½çš„æ‰€æœ‰è„šæœ¬æ·»åŠ  <code>nonce</code>ã€‚è¦å¯ç”¨æ­¤åŠŸèƒ½ï¼Œéœ€è¦åœ¨å¼•å…¥çš„å…¥å£è„šæœ¬ä¸­è®¾ç½®ä¸€ä¸ª <code>__webpack_nonce__</code> å˜é‡ã€‚åº”è¯¥ä¸ºæ¯ä¸ªå”¯ä¸€çš„é¡µé¢è§†å›¾ç”Ÿæˆå’Œæä¾›ä¸€ä¸ªå”¯ä¸€çš„åŸºäº hash çš„ nonceï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ <code>__webpack_nonce__</code> è¦åœ¨å…¥å£æ–‡ä»¶ä¸­æŒ‡å®šï¼Œè€Œä¸æ˜¯åœ¨é…ç½®ä¸­æŒ‡å®šçš„åŸå› ã€‚æ³¨æ„ï¼Œ<code>nonce</code> åº”è¯¥æ˜¯ä¸€ä¸ª base64 ç¼–ç çš„å­—ç¬¦ä¸²ã€‚</p> <h2 id="examples">ç¤ºä¾‹ <a href="#examples" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨ entry æ–‡ä»¶ä¸­ï¼š</p> <pre><code class="hljs language-js"><span class="token comment">// ...</span>
__webpack_nonce__ <span class="token operator">=</span> <span class="token string">'c29tZSBjb29sIHN0cmluZyB3aWxsIHBvcCB1cCAxMjM='</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span></code></pre> <h2 id="enabling-csp">å¯ç”¨ CSP <a href="#enabling-csp" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸å¯ç”¨ CSPã€‚éœ€è¦ä¸æ–‡æ¡£(document)ä¸€èµ·å‘é€ç›¸åº”çš„ <code>CSP</code> header æˆ– meta æ ‡ç­¾ <code>&#x3C;meta http-equiv="Content-Security-Policy" ...></code>ï¼Œä»¥å‘ŠçŸ¥æµè§ˆå™¨å¯ç”¨ CSPã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªåŒ…å« CDN ç™½åå• URL çš„ CSP header çš„ç¤ºä¾‹ï¼š</p> <pre><code class="hljs language-html">Content-Security-Policy: default-src 'self'; script-src 'self' https://trusted.cdn.com;</code></pre> <p>æœ‰å…³ CSP å’Œ <code>nonce</code> å±æ€§çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹é¡µé¢åº•éƒ¨çš„__å»¶ä¼¸é˜…è¯»__éƒ¨åˆ†ã€‚</p> <h1 id="å¼€å‘---Vagrant">å¼€å‘ - Vagrant<a href="#%E5%BC%80%E5%8F%91---Vagrant" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>å¦‚æœä½ åœ¨å¼€å‘ä¸€ä¸ªæ›´åŠ é«˜çº§çš„é¡¹ç›®ï¼Œå¹¶ä¸”ä½¿ç”¨ <a href="javascript:if(confirm('https://www.vagrantup.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.vagrantup.com/'" tppabs="https://www.vagrantup.com/">Vagrant</a> æ¥å®ç°åœ¨è™šæ‹Ÿæœº(Virtual Machine)ä¸Šè¿è¡Œä½ çš„å¼€å‘ç¯å¢ƒï¼Œé‚£ä½ å¯èƒ½ä¼šéœ€è¦åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œ webpackã€‚</p> <h2 id="configuring-the-project">é…ç½®é¡¹ç›® <a href="#configuring-the-project" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é¦–å…ˆï¼Œç¡®ä¿ <code>Vagrantfile</code> æ‹¥æœ‰ä¸€ä¸ªé™æ€ IPã€‚</p> <pre><code class="hljs language-ruby"><span class="token constant">Vagrant</span><span class="token punctuation">.</span>configure<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>config<span class="token operator">|</span>
  config<span class="token punctuation">.</span>vm<span class="token punctuation">.</span>network <span class="token symbol">:private_network</span><span class="token punctuation">,</span> ip<span class="token punctuation">:</span> <span class="token string">"10.10.10.61"</span>
<span class="token keyword">end</span></code></pre> <p>ç„¶åï¼Œåœ¨é¡¹ç›®ä¸­å®‰è£… <code>webpack</code> å’Œ <code>webpack-dev-server</code>ï¼›</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack webpack-dev-server</code></pre> <p>ç¡®ä¿æä¾›ä¸€ä¸ª <code>webpack.config.js</code> é…ç½®æ–‡ä»¶ã€‚å¦‚æœè¿˜æ²¡æœ‰å‡†å¤‡ï¼Œä¸‹é¢çš„ç¤ºä¾‹ä»£ç å¯ä»¥ä½œä¸ºèµ·æ­¥çš„æœ€ç®€é…ç½®ï¼š</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  context<span class="token operator">:</span> __dirname<span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token string">'./app.js'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>ç„¶åï¼Œåˆ›å»ºä¸€ä¸ª <code>index.html</code> æ–‡ä»¶ã€‚å…¶ä¸­çš„ <code>script</code> æ ‡ç­¾åº”å½“æŒ‡å‘ä½ çš„ bundleã€‚å¦‚æœæ²¡æœ‰åœ¨é…ç½®ä¸­æŒ‡å®š <code>output.filename</code>ï¼Œå…¶é»˜è®¤å€¼æ˜¯ <code>bundle.js</code>ã€‚</p> <pre><code class="hljs language-html"><span class="token doctype"><span class="token punctuation">&#x3C;!</span><span class="token name">doctype</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>html</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/bundle.js<span class="token punctuation">"</span></span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>head</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h2</span><span class="token punctuation">></span></span>Heey!<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h2</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>html</span><span class="token punctuation">></span></span></code></pre> <p>æ³¨æ„ï¼Œä½ è¿˜éœ€è¦åˆ›å»ºä¸€ä¸ª <code>app.js</code> æ–‡ä»¶ã€‚</p> <h2 id="running-the-server">å¯åŠ¨æœåŠ¡å™¨ <a href="#running-the-server" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç°åœ¨ï¼Œæˆ‘ä»¬å¯åŠ¨æœåŠ¡å™¨ï¼š</p> <pre><code class="hljs language-bash">webpack serve --host <span class="token number">0.0</span>.0.0 --public <span class="token number">10.10</span>.10.61:8080 --watch-poll</code></pre> <p>é»˜è®¤åªå…è®¸ä» localhost è®¿é—®æœåŠ¡å™¨ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹ <code>--host</code> å‚æ•°ï¼Œ ä»¥å…è®¸åœ¨æˆ‘ä»¬çš„å®¿ä¸» PC ä¸Šè®¿é—®ã€‚</p> <p><code>webpack-dev-server</code> ä¼šåœ¨åŒ…ä¸­å¼•å…¥ä¸€ä¸ªè„šæœ¬ï¼Œæ­¤è„šæœ¬è¿æ¥åˆ° WebSocketï¼Œè¿™æ ·å¯ä»¥åœ¨ä»»ä½•æ–‡ä»¶ä¿®æ”¹æ—¶ï¼Œè§¦å‘é‡æ–°åŠ è½½åº”ç”¨ç¨‹åºã€‚ <code>--public</code> æ ‡è®°å¯ä»¥ç¡®ä¿è„šæœ¬çŸ¥é“ä»å“ªé‡ŒæŸ¥æ‰¾ WebSocketã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡å™¨ä¼šä½¿ç”¨ <code>8080</code> ç«¯å£ï¼Œå› æ­¤ä¹Ÿéœ€è¦åœ¨è¿™é‡ŒæŒ‡å®šã€‚</p> <p><code>--watch-poll</code> å¯ä»¥ç¡®ä¿ webpack èƒ½å¤Ÿæ£€æµ‹åˆ°æ–‡ä»¶æ›´æ”¹ã€‚webpack é»˜è®¤ä¼šç›‘å¬æ–‡ä»¶ç³»ç»Ÿè§¦å‘çš„ç›¸å…³äº‹ä»¶ï¼Œ ä½†æ˜¯ VirtualBox ä½¿ç”¨é»˜è®¤é…ç½®ä¼šæœ‰è®¸å¤šé—®é¢˜ã€‚</p> <p>ç°åœ¨æœåŠ¡å™¨åº”è¯¥èƒ½å¤Ÿé€šè¿‡ <code>http://10.10.10.61:8080</code> è®¿é—®äº†ã€‚ä¿®æ”¹ <code>app.js</code>ï¼Œåº”ç”¨ç¨‹åºå°±ä¼šå®æ—¶é‡æ–°åŠ è½½ã€‚</p> <h2 id="advanced-usage-with-nginx">é…åˆ nginx çš„é«˜çº§ç”¨æ³• <a href="#advanced-usage-with-nginx" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä¸ºäº†æ›´å¥½çš„æ¨¡æ‹Ÿç±»ç”Ÿäº§ç¯å¢ƒï¼ˆproduction-like environmentï¼‰ï¼Œè¿˜å¯ä»¥ç”¨ nginx æ¥ä»£ç† <code>webpack-dev-server</code>ã€‚</p> <p>åœ¨ä½ çš„ nginx é…ç½®æ–‡ä»¶ä¸­ï¼ŒåŠ å…¥ä¸‹é¢ä»£ç ï¼š</p> <pre><code class="hljs language-nginx"><span class="token keyword">server</span> <span class="token punctuation">{</span>
  <span class="token keyword">location</span> <span class="token operator">/</span> <span class="token punctuation">{</span>
    <span class="token keyword">proxy_pass</span> <span class="token keyword">http</span><span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token punctuation">:</span><span class="token number">8080</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_http_version</span> <span class="token number">1.1</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_set_header</span> Upgrade <span class="token variable">$http_upgrade</span><span class="token punctuation">;</span>
    <span class="token keyword">proxy_set_header</span> Connection <span class="token string">"upgrade"</span><span class="token punctuation">;</span>
    <span class="token keyword">error_page</span> <span class="token number">502</span> @start<span class="token operator">-</span>webpack<span class="token operator">-</span>dev<span class="token operator">-</span><span class="token keyword">server</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">location</span> @start<span class="token operator">-</span>webpack<span class="token operator">-</span>dev<span class="token operator">-</span><span class="token keyword">server</span> <span class="token punctuation">{</span>
    <span class="token keyword">default_type</span> text<span class="token operator">/</span>plain<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">502</span> <span class="token string">"Please start the webpack-dev-server first."</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p><code>proxy_set_header</code> è¿™å‡ è¡Œé…ç½®å¾ˆé‡è¦ï¼Œå› ä¸ºå®ƒä»¬èƒ½å¤Ÿä½¿ WebSocket æ­£å¸¸è¿è¡Œã€‚</p> <p>ç„¶å <code>webpack-dev-server</code> å¯åŠ¨å‘½ä»¤å¯ä»¥ä¿®æ”¹ä¸ºï¼š</p> <pre><code class="hljs language-bash">webpack serve --public <span class="token number">10.10</span>.10.61 --watch-poll</code></pre> <p>ç°åœ¨åªèƒ½é€šè¿‡ <code>127.0.0.1</code> è®¿é—®æœåŠ¡ï¼Œè¿™ç‚¹å…³ç³»ä¸å¤§ï¼Œå› ä¸º ngnix èƒ½å¤Ÿä½¿å¾—ä½ çš„ PC ç”µè„‘èƒ½è®¿é—®åˆ°æœåŠ¡å™¨ã€‚</p> <h2 id="conclusion">ç»“è®º <a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æˆ‘ä»¬èƒ½å¤Ÿä»é™æ€ IP è®¿é—® Vagrant boxï¼Œç„¶åä½¿ <code>webpack-dev-server</code> å¯ä»¥å…¬å¼€è®¿é—®ï¼Œä»¥ä¾¿æµè§ˆå™¨å¯ä»¥è®¿é—®åˆ°å®ƒã€‚ç„¶åï¼Œæˆ‘ä»¬è§£å†³äº† VirtualBox ä¸å‘é€åˆ°æ–‡ä»¶ç³»ç»Ÿäº‹ä»¶çš„å¸¸è§é—®é¢˜ï¼Œæ­¤é—®é¢˜ä¼šå¯¼è‡´æœåŠ¡å™¨æ— æ³•é‡æ–°åŠ è½½æ–‡ä»¶æ›´æ”¹ã€‚</p> <h1 id="ä¾èµ–ç®¡ç†">ä¾èµ–ç®¡ç†<a href="#%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote> <p>es6 modules</p> </blockquote> <blockquote> <p>commonjs</p> </blockquote> <blockquote> <p>amd</p> </blockquote> <h2 id="require-with-expression">å¸¦è¡¨è¾¾å¼çš„ require è¯­å¥ <a href="#require-with-expression" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å¦‚æœä½ çš„ request å«æœ‰è¡¨è¾¾å¼(expressions)ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡(context)ï¼Œå› ä¸ºåœ¨ç¼–è¯‘æ—¶(compile time)å¹¶ä¸æ¸…æ¥š <strong>å…·ä½“</strong> å¯¼å…¥å“ªä¸ªæ¨¡å—ã€‚</p> <p>ç¤ºä¾‹ï¼Œè€ƒè™‘åˆ°æˆ‘ä»¬æœ‰åŒ…å« <code>.ejs</code> æ–‡ä»¶çš„å¦‚ä¸‹ç›®å½•ç»“æ„ï¼š</p> <pre><code class="hljs language-bash">example_directory
â”‚
â””â”€â”€â”€template
â”‚   â”‚   table.ejs
â”‚   â”‚   table-row.ejs
â”‚   â”‚
â”‚   â””â”€â”€â”€directory
â”‚       â”‚   another.ejs</code></pre> <p>å½“å°ä¸‹çš„ <code>require()</code> è°ƒç”¨è¢«è¯„ä¼°è§£æï¼š</p> <pre><code class="hljs language-javascript"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./template/'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'.ejs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>webpack è§£æ <code>require()</code> è°ƒç”¨ï¼Œç„¶åæå–å‡ºå¦‚ä¸‹ä¸€äº›ä¿¡æ¯ï¼š</p> <pre><code class="hljs language-code">Directory: ./template
Regular expression: /^.*\.ejs$/
</code></pre> <p><strong>context module</strong></p> <p>ä¼šç”Ÿæˆä¸€ä¸ª context module(ä¸Šä¸‹æ–‡æ¨¡å—)ã€‚ä¼šç”Ÿæˆä¸€ä¸ª context module(ä¸Šä¸‹æ–‡æ¨¡å—)ã€‚å®ƒåŒ…å« <strong>ç›®å½•ä¸‹çš„æ‰€æœ‰æ¨¡å—</strong> çš„å¼•ç”¨ï¼Œå¦‚æœä¸€ä¸ª request ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼ï¼Œå°±èƒ½ require è¿›æ¥ã€‚è¯¥context moduleåŒ…å«ä¸€ä¸ªmapï¼ˆæ˜ å°„ï¼‰å¯¹è±¡ï¼Œä¼šæŠŠrequestsç¿»è¯‘æˆå¯¹åº”çš„æ¨¡å—idã€‚ï¼ˆè¯‘è€…æ³¨ï¼šrequestå‚è€ƒ<a href="../../glossary/index.htm" tppabs="https://webpack.docschina.org/glossary/">æ¦‚å¿µæœ¯è¯­</a> ï¼‰</p> <p>ç¤ºä¾‹mapï¼ˆæ˜ å°„ï¼‰:</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"./table.ejs"</span><span class="token operator">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
  <span class="token property">"./table-row.ejs"</span><span class="token operator">:</span> <span class="token number">43</span><span class="token punctuation">,</span>
  <span class="token property">"./directory/another.ejs"</span><span class="token operator">:</span> <span class="token number">44</span>
<span class="token punctuation">}</span></code></pre> <p>æ­¤ context module è¿˜åŒ…å«ä¸€äº›è®¿é—®è¿™ä¸ª map å¯¹è±¡çš„ runtime é€»è¾‘ã€‚</p> <p>è¿™æ„å‘³ç€ webpack èƒ½å¤Ÿæ”¯æŒåŠ¨æ€åœ° requireï¼Œä½†ä¼šå¯¼è‡´æ‰€æœ‰å¯èƒ½ç”¨åˆ°çš„æ¨¡å—éƒ½åŒ…å«åœ¨ bundle ä¸­ã€‚</p> <h2 id="requirecontext"><code>require.context</code> <a href="#requirecontext" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä½ è¿˜å¯ä»¥é€šè¿‡ <code>require.context()</code> å‡½æ•°æ¥åˆ›å»ºè‡ªå·±çš„ contextã€‚</p> <p>å¯ä»¥ç»™è¿™ä¸ªå‡½æ•°ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼šä¸€ä¸ªè¦æœç´¢çš„ç›®å½•ï¼Œä¸€ä¸ªæ ‡è®°è¡¨ç¤ºæ˜¯å¦è¿˜æœç´¢å…¶å­ç›®å½•ï¼Œ ä»¥åŠä¸€ä¸ªåŒ¹é…æ–‡ä»¶çš„æ­£åˆ™è¡¨è¾¾å¼ã€‚</p> <p>webpack ä¼šåœ¨æ„å»ºä¸­è§£æä»£ç ä¸­çš„ <code>require.context()</code> ã€‚</p> <p>è¯­æ³•å¦‚ä¸‹ï¼š</p> <pre><code class="hljs language-javascript">require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>directory<span class="token punctuation">,</span> useSubdirectories <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> regExp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\.\/.*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> mode <span class="token operator">=</span> <span class="token string">'sync'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>ç¤ºä¾‹ï¼š</p> <pre><code class="hljs language-javascript">require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./test'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.test\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ï¼ˆåˆ›å»ºå‡ºï¼‰ä¸€ä¸ª contextï¼Œå…¶ä¸­æ–‡ä»¶æ¥è‡ª test ç›®å½•ï¼Œrequest ä»¥ `.test.js` ç»“å°¾ã€‚</span></code></pre> <pre><code class="hljs language-javascript">require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'../'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.stories\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ï¼ˆåˆ›å»ºå‡ºï¼‰ä¸€ä¸ª contextï¼Œå…¶ä¸­æ‰€æœ‰æ–‡ä»¶éƒ½æ¥è‡ªçˆ¶æ–‡ä»¶å¤¹åŠå…¶æ‰€æœ‰å­çº§æ–‡ä»¶å¤¹ï¼Œrequest ä»¥ `.stories.js` ç»“å°¾ã€‚</span></code></pre> <blockquote class="warning"> <p>ä¼ é€’ç»™ <code>require.context</code> çš„å‚æ•°å¿…é¡»æ˜¯å­—é¢é‡(literal)ï¼</p> </blockquote> <h3 id="context-module-api">context module API <a href="#context-module-api" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>ä¸€ä¸ª context module ä¼šå¯¼å‡ºä¸€ä¸ªï¼ˆrequireï¼‰å‡½æ•°ï¼Œæ­¤å‡½æ•°å¯ä»¥æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼šrequestã€‚</p> <p>æ­¤å¯¼å‡ºå‡½æ•°æœ‰ä¸‰ä¸ªå±æ€§ï¼š<code>resolve</code>, <code>keys</code>, <code>id</code>ã€‚</p> <ul> <li><code>resolve</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¿”å› request è¢«è§£æåå¾—åˆ°çš„æ¨¡å— idã€‚</li> <li><code>keys</code> ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç”±æ‰€æœ‰å¯èƒ½è¢«æ­¤ context module å¤„ç†çš„è¯·æ±‚ï¼ˆè¯‘è€…æ³¨ï¼šå‚è€ƒä¸‹é¢ç¬¬äºŒæ®µä»£ç ä¸­çš„ keyï¼‰ç»„æˆã€‚</li> </ul> <p>å¦‚æœæƒ³å¼•å…¥ä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹é¢çš„æ‰€æœ‰æ–‡ä»¶ï¼Œæˆ–è€…å¼•å…¥èƒ½åŒ¹é…ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æ‰€æœ‰æ–‡ä»¶ï¼Œè¿™ä¸ªåŠŸèƒ½å°±ä¼šå¾ˆæœ‰å¸®åŠ©ï¼Œä¾‹å¦‚ï¼š</p> <pre><code class="hljs language-javascript"><span class="token keyword">function</span> <span class="token function">importAll</span> <span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  r<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">importAll</span><span class="token punctuation">(</span>require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'../components/'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <pre><code class="hljs language-javascript"><span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">importAll</span> <span class="token punctuation">(</span><span class="token parameter">r</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  r<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">key</span> <span class="token operator">=></span> cache<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">r</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">importAll</span><span class="token punctuation">(</span>require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'../components/'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// åœ¨æ„å»ºæ—¶(build-time)ï¼Œæ‰€æœ‰è¢« require çš„æ¨¡å—éƒ½ä¼šè¢«å¡«å……åˆ° cache å¯¹è±¡ä¸­ã€‚</span></code></pre> <ul> <li><code>id</code> æ˜¯ context module çš„æ¨¡å— id. å®ƒå¯èƒ½åœ¨ä½ ä½¿ç”¨ <code>module.hot.accept</code> æ—¶ä¼šç”¨åˆ°ã€‚</li> </ul> <h1 id="å®‰è£…">å®‰è£…<a href="#%E5%AE%89%E8%A3%85" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>æœ¬æŒ‡å—ä»‹ç»äº†å®‰è£… webpack çš„å„ç§æ–¹æ³•ã€‚</p> <h2 id="prerequisites">å‰ææ¡ä»¶ <a href="#prerequisites" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿å®‰è£…äº† <a href="javascript:if(confirm('https://nodejs.org/en/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://nodejs.org/en/'" tppabs="https://nodejs.org/en/">Node.js</a> çš„æœ€æ–°ç‰ˆæœ¬ã€‚ä½¿ç”¨ Node.js æœ€æ–°çš„é•¿æœŸæ”¯æŒç‰ˆæœ¬(LTS - Long Term Support)ï¼Œæ˜¯ç†æƒ³çš„èµ·æ­¥ã€‚ ä½¿ç”¨æ—§ç‰ˆæœ¬ï¼Œä½ å¯èƒ½é‡åˆ°å„ç§é—®é¢˜ï¼Œå› ä¸ºå®ƒä»¬å¯èƒ½ç¼ºå°‘ webpack åŠŸèƒ½ï¼Œ æˆ–è€…ç¼ºå°‘ç›¸å…³ packageã€‚</p> <h2 id="local-installation">æœ¬åœ°å®‰è£… <a href="#local-installation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æœ€æ–°çš„ webpack æ­£å¼ç‰ˆæœ¬æ˜¯ï¼š</p> <p><a href="javascript:if(confirm('https://github.com/webpack/webpack/releases  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack/releases'" tppabs="https://github.com/webpack/webpack/releases"><img src="../../../img.shields.io/npm/v/webpack.svg-label=webpack" tppabs="https://img.shields.io/npm/v/webpack.svg?label=webpack" alt="GitHub release"></a></p> <p>è¦å®‰è£…æœ€æ–°ç‰ˆæœ¬æˆ–ç‰¹å®šç‰ˆæœ¬ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ä¹‹ä¸€ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack
<span class="token comment"># æˆ–æŒ‡å®šç‰ˆæœ¬</span>
<span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack@<span class="token operator">&#x3C;</span>version<span class="token operator">></span></code></pre> <blockquote class="tip"> <p>æ˜¯å¦ä½¿ç”¨ <code>--save-dev</code> å–å†³äºä½ çš„åº”ç”¨åœºæ™¯ã€‚å‡è®¾ä½ ä»…ä½¿ç”¨ webpack è¿›è¡Œæ„å»ºæ“ä½œï¼Œé‚£ä¹ˆå»ºè®®ä½ åœ¨å®‰è£…æ—¶ä½¿ç”¨ <code>--save-dev</code> é€‰é¡¹ï¼Œå› ä¸ºå¯èƒ½ä½ ä¸éœ€è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šä½¿ç”¨ webpackã€‚å¦‚æœéœ€è¦åº”ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œè¯·å¿½ç•¥ <code>--save-dev</code> é€‰é¡¹ã€‚</p> </blockquote> <p>å¦‚æœä½ ä½¿ç”¨ webpack v4+ ç‰ˆæœ¬ï¼Œä½ è¿˜éœ€è¦å®‰è£… <a href="../../api/cli/index.htm" tppabs="https://webpack.docschina.org/api/cli/">CLI</a>ã€‚</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack-cli</code></pre> <p>å¯¹äºå¤§å¤šæ•°é¡¹ç›®ï¼Œæˆ‘ä»¬å»ºè®®æœ¬åœ°å®‰è£…ã€‚è¿™å¯ä»¥åœ¨å¼•å…¥é‡å¤§æ›´æ–°(breaking change)ç‰ˆæœ¬æ—¶ï¼Œæ›´å®¹æ˜“åˆ†åˆ«å‡çº§é¡¹ç›®ã€‚ é€šå¸¸ä¼šé€šè¿‡è¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ª <a href="javascript:if(confirm('https://docs.npmjs.com/misc/scripts  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docs.npmjs.com/misc/scripts'" tppabs="https://docs.npmjs.com/misc/scripts">npm scripts</a> ä»¥åœ¨æœ¬åœ° <code>node_modules</code> ç›®å½•ä¸­æŸ¥æ‰¾å®‰è£…çš„ webpackï¼Œ æ¥è¿è¡Œ webpackï¼š</p> <pre><code class="hljs language-json"><span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"webpack --config webpack.config.js"</span>
<span class="token punctuation">}</span></code></pre> <blockquote class="tip"> <p>æƒ³è¦è¿è¡Œæœ¬åœ°å®‰è£…çš„ webpackï¼Œä½ å¯ä»¥é€šè¿‡ <code>node_modules/.bin/webpack</code> æ¥è®¿é—®å®ƒçš„äºŒè¿›åˆ¶ç‰ˆæœ¬ã€‚å¦å¤–ï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯ npm v5.2.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œåˆ™å¯ä»¥è¿è¡Œ <code>npx webpack</code> æ¥æ‰§è¡Œã€‚</p> </blockquote> <h2 id="global-installation">å…¨å±€å®‰è£… <a href="#global-installation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é€šè¿‡ä»¥ä¸‹ NPM å®‰è£…æ–¹å¼ï¼Œå¯ä»¥ä½¿ <code>webpack</code> åœ¨å…¨å±€ç¯å¢ƒä¸‹å¯ç”¨ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --global webpack</code></pre> <blockquote class="warning"> <p><strong>ä¸æ¨è</strong> å…¨å±€å®‰è£… webpackã€‚è¿™ä¼šå°†ä½ é¡¹ç›®ä¸­çš„ webpack é”å®šåˆ°æŒ‡å®šç‰ˆæœ¬ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨ä¸åŒçš„ webpack ç‰ˆæœ¬çš„é¡¹ç›®ä¸­ï¼Œ å¯èƒ½ä¼šå¯¼è‡´æ„å»ºå¤±è´¥ã€‚</p> </blockquote> <h2 id="bleeding-edge">æœ€æ–°ä½“éªŒç‰ˆæœ¬ <a href="#bleeding-edge" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å¦‚æœä½ çƒ­è¡·äºä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ webpackï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£… beta ç‰ˆæœ¬ï¼Œ æˆ–è€…ç›´æ¥ä» webpack çš„ä»“åº“ä¸­å®‰è£…ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack@next
<span class="token comment"># æˆ–ç‰¹å®šçš„ tag/åˆ†æ”¯</span>
<span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack/webpack<span class="token comment">#&#x3C;tagname/branchname></span></code></pre> <blockquote class="warning"> <p>å®‰è£…è¿™äº›æœ€æ–°ä½“éªŒç‰ˆæœ¬æ—¶è¦å°å¿ƒï¼å®ƒä»¬å¯èƒ½ä»ç„¶åŒ…å« bugï¼Œå› æ­¤ä¸åº”è¯¥ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</p> </blockquote> <h1 id="è„šæ‰‹æ¶">è„šæ‰‹æ¶<a href="#%E8%84%9A%E6%89%8B%E6%9E%B6" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>é¦–æ¬¡è®¾ç½®å¤æ‚çš„ webpack é…ç½®å¯èƒ½ä¼šå¾ˆå›°éš¾ã€‚å¹¶ä¸”ç¼–å†™é«˜çº§é…ç½®æ¥ä¼˜åŒ–æ€§èƒ½ä¼šæ›´åŠ å›°éš¾ã€‚ä¸‹é¢æä¾›çš„ <code>init</code> èƒ½åŠ›ï¼Œå¯ä»¥è®©æˆ‘ä»¬ä½¿ç”¨å¯è‡ªå®šä¹‰çš„ç¬¬ä¸‰æ–¹åˆå§‹åŒ–åŒ…ï¼Œæ¥åˆ›å»º webpack é…ç½®ã€‚</p> <h2 id="creating-a-scaffold">åˆ›å»ºè„šæ‰‹æ¶ <a href="#creating-a-scaffold" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨ç¼–å†™ <code>webpack-cli</code> è„šæ‰‹æ¶ä¹‹å‰ï¼Œè¯·å…ˆè€ƒè™‘ä¸‹è¦å®ç°çš„ç›®æ ‡å’Œè¦ä½¿ç”¨çš„ç¾¤ä½“ï¼š</p> <ul> <li>æ˜¯å¦éœ€è¦å®ç°ä¸€ä¸ªå¯è¢«å¤šç§åº”ç”¨ç¨‹åºå’Œé¡¹ç›®ä½¿ç”¨çš„é€šç”¨è„šæ‰‹æ¶ï¼Ÿ</li> <li>æ˜¯å¦éœ€è¦è„šæ‰‹æ¶æ”¯æŒç‰¹å®šå†…å®¹ï¼Œä¾‹å¦‚åŒæ—¶ç¼–å†™ webpack.config.js å’Œæ¡†æ¶ä»£ç çš„è„šæ‰‹æ¶ï¼Ÿ</li> <li>è°æ˜¯æ½œåœ¨çš„ç”¨æˆ·ï¼Œè„šæ‰‹æ¶ç”¨æˆ·å°†ä¼šæœ‰ä»€ä¹ˆæ ·çš„ç”¨æˆ·ä½“éªŒï¼Ÿ</li> </ul> <p><code>webpack-cli</code> æä¾›äº†ä¸€ç§äº¤äº’å¼ä½“éªŒï¼Œå¯ä»¥å¯¹åº”åœ°è‡ªå®šä¹‰è¾“å‡ºã€‚ä¾‹å¦‚ï¼Œè¯¢é—®ç±»ä¼¼ "ä½ çš„å…¥å£èµ·ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ" è¿™æ ·çš„é—®é¢˜ã€‚</p> <h3 id="writing-a-scaffold">ç¼–å†™è„šæ‰‹æ¶ <a href="#writing-a-scaffold" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>å¦‚æœä½ æƒ³è¦å­¦ä¹ å¦‚ä½•ç¼–å†™è„šæ‰‹æ¶ï¼Œè¿™é‡Œæœ‰è®¸å¤šèµ„æºå¯ä»¥å‚è€ƒï¼Œå¯ä»¥é˜…è¯» <a href="../../contribute/writing-a-scaffold/index.htm" tppabs="https://webpack.docschina.org/contribute/writing-a-scaffold/">ç¼–å†™è„šæ‰‹æ¶</a> æ•™ç¨‹ä½œä¸ºå¼€å§‹ã€‚</p> <p><code>webpack-scaffold</code> æ˜¯ç”¨äºåˆ›å»ºè„šæ‰‹æ¶çš„å·¥å…·å¥—ä»¶ã€‚å®ƒåŒ…å«ä¸€äº›å¯ç”¨äºåˆ›å»ºè„šæ‰‹æ¶çš„åŠŸèƒ½ã€‚</p> <h3 id="running-a-scaffold">æ‰§è¡Œè„šæ‰‹æ¶ <a href="#running-a-scaffold" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>å¯ä»¥ä½¿ç”¨ <code>webpack-cli init</code> æ‰§è¡Œè„šæ‰‹æ¶ï¼š</p> <pre><code class="hljs language-bash">webpack-cli init <span class="token operator">&#x3C;</span>your-scaffold<span class="token operator">></span></code></pre> <h4 id="running-a-scaffold-locally">åœ¨æœ¬åœ°è¿è¡Œè„šæ‰‹æ¶ <a href="#running-a-scaffold-locally" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>å½“è„šæ‰‹æ¶ package ä½äºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­æ—¶ï¼Œåº”å°† <code>init</code> æŒ‡å‘å…¶è·¯å¾„ï¼š</p> <pre><code class="hljs language-bash">webpack-cli init path/to/your/scaffold</code></pre> <p>æˆ–è€…ï¼Œè¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªå…¨å±€æ¨¡å—å¹¶ç¬¦å·é“¾æ¥(symlink)åˆ°æœ¬åœ°â€‹â€‹æ¨¡å—ï¼š</p> <ul> <li>ä½¿ç”¨ npm</li> </ul> <pre><code class="hljs language-bash"><span class="token builtin class-name">cd</span> path/to/my-scaffold
<span class="token function">npm</span> <span class="token function">link</span>
webpack-cli init my-scaffold</code></pre> <ul> <li>ä½¿ç”¨ yarn</li> </ul> <pre><code class="hljs language-bash"><span class="token builtin class-name">cd</span> path/to/my-scaffold
<span class="token function">yarn</span> <span class="token function">link</span>
webpack-cli init my-scaffold</code></pre> <h4 id="running-a-scaffold-from-npm">ä» npm è¿è¡Œè„šæ‰‹æ¶ <a href="#running-a-scaffold-from-npm" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>å¦‚æœå¯ä»¥ä» npm è·å¾—æ­¤ packageï¼Œåˆ™å…¶åç§°å¿…é¡»ä»¥ <code>webpack-scaffold</code> å¼€å¤´ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥ä½¿ç”¨ï¼š</p> <pre><code class="hljs language-bash">webpack-cli init webpack-scaffold-yourpackage</code></pre> <h2 id="api">API <a href="#api" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>è¦åˆ›å»ºä¸€ä¸ª<code>è„šæ‰‹æ¶</code>ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ª <a href="javascript:if(confirm('http://yeoman.io/authoring/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://yeoman.io/authoring/'" tppabs="http://yeoman.io/authoring/"><code>yeoman-generator</code></a>ã€‚æ„Ÿè°¢å®ƒçš„å­˜åœ¨ï¼Œç°åœ¨å¯ä»¥é€‰æ‹©åœ¨å®ƒçš„åŸºç¡€ä¸Šæ‰©å±•å‡ºä½ è‡ªå·±çš„ generatorï¼Œå…¶ä¸­åŒæ ·åŒ…æ‹¬ Yeoman API ä¸­æä¾›çš„æ–¹æ³•ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æ”¯æŒå¸¸è§„ webpack é…ç½®çš„æ‰€æœ‰å±æ€§ã€‚ä¸ºäº†å®ç°è¿™ä¸€ç‚¹ï¼Œéœ€è¦è®°ä½ä¸€ä»¶äº‹ï¼š</p> <blockquote class="warning"> <p>ä½¿ç”¨å­—ç¬¦ä¸²åˆ›å»ºå¯¹è±¡ï¼Œè€Œä½¿ç”¨åŒå­—ç¬¦ä¸²(double string)åˆ›å»ºå­—ç¬¦ä¸²ã€‚è¿™æ„å‘³ç€ï¼Œä¸ºäº†åˆ›å»ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä½ å¿…é¡»å°†å…¶åŒ…è£…åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œä»¥ä¾¿æˆ‘ä»¬æ­£ç¡®éªŒè¯å®ƒã€‚</p> </blockquote> <h3 id="required">å¿…é€‰é¡¹ <a href="#required" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <ul> <li><a href="#optsenvconfigurationrequired"><code>opts.env.configuration</code>(required)</a></li> <li><a href="#optsenvconfigurationmyobj-required"><code>opts.env.configuration.myObj</code> (required)</a></li> <li><a href="#myobjwebpackoptions-required"><code>myObj.webpackOptions</code> (required)</a></li> <li><a href="#writing-required"><code>writing</code> (required)</a></li> </ul> <h3 id="optional">å¯é€‰é¡¹ <a href="#optional" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <ul> <li><a href="#myobjmerge-optional">myObj.merge</a></li> <li><a href="#myobjtopscopeoptional">myObj.topScope</a></li> <li><a href="#myobjconfignameoptional">myObj.configName</a></li> </ul> <h3 id="optsenvconfigurationrequired"><code>opts.env.configuration</code>ï¼ˆå¿…é€‰é¡¹ï¼‰ <a href="#optsenvconfigurationrequired" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>object</code></p> <p>è¿™é‡Œæ˜¯ä½ é…ç½®çš„å…¥å£èµ·ç‚¹ï¼Œè¯·åœ¨ generator çš„æ„é€ å‡½æ•°ä¸­å¯¹å…¶è¿›è¡Œåˆå§‹åŒ–ï¼Œä»¥ä½¿ CLI èƒ½å¤Ÿæ­£å¸¸è¿è¡Œï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">class</span> <span class="token class-name">MyScaffold</span> <span class="token keyword">extends</span> <span class="token class-name">Generator</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">args<span class="token punctuation">,</span> opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> opts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    opts<span class="token punctuation">.</span>env<span class="token punctuation">.</span>configuration <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h3 id="optsenvconfigurationmyobj-required"><code>opts.env.configuration.myObj</code>ï¼ˆå¿…é€‰é¡¹ï¼‰ <a href="#optsenvconfigurationmyobj-required" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>object</code></p> <p>è¿™é‡Œæ˜¯ä½ çš„è„šæ‰‹æ¶ï¼Œæ­¤å¤„æ·»åŠ ä¸€äº›é€‰é¡¹ï¼ŒCLI ä¼šå°†å…¶è½¬æ¢ä¸º webpack é…ç½®ã€‚ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„å–œå¥½å‘½åå¤šç§ä¸åŒçš„è„šæ‰‹æ¶ï¼Œå®ƒä»¬ä»£è¡¨ä¸åŒçš„é…ç½®ï¼Œä¾‹å¦‚ <code>dev.config</code> æˆ– <code>prod.config</code>ï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">class</span> <span class="token class-name">MyScaffold</span> <span class="token keyword">extends</span> <span class="token class-name">Generator</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">args<span class="token punctuation">,</span> opts</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>args<span class="token punctuation">,</span> opts<span class="token punctuation">)</span><span class="token punctuation">;</span>
    opts<span class="token punctuation">.</span>env<span class="token punctuation">.</span>configuration <span class="token operator">=</span> <span class="token punctuation">{</span>
      dev<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      prod<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h3 id="myobjwebpackoptions-required"><code>myObj.webpackOptions</code>ï¼ˆå¿…é€‰é¡¹ï¼‰ <a href="#myobjwebpackoptions-required" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>object</code></p> <p>è¯¥å¯¹è±¡å…·æœ‰ä¸å¸¸è§„ webpack <a href="../../configuration/index.htm" tppabs="https://webpack.docschina.org/configuration/">é…ç½®</a> ç›¸åŒçš„æ ¼å¼ã€‚åœ¨æ­¤å¤„å£°æ˜æƒ³è¦é¢„ç½®çš„å±æ€§ï¼Œä¾‹å¦‚ <code>entry</code>, <code>output</code> å’Œ <code>context</code>ã€‚å¯ä»¥åœ¨ yeoman æ–¹æ³•ä¸­å¯¹æ­¤è¿›è¡Œåˆå§‹åŒ–ï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>env<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>webpackOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'\'app.js\''</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="writing-required"><code>writing</code>ï¼ˆå¿…é€‰é¡¹ï¼‰ <a href="#writing-required" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>function</code></p> <p>ä¸ºäº†è¿è¡Œè„šæ‰‹æ¶å®ä¾‹ï¼Œéœ€è¦å°†é…ç½®å†™å…¥ä¸€ä¸ª <code>.yo-rc.json</code> æ–‡ä»¶ã€‚å¯ä»¥ä½¿ç”¨ yeoman generator ä¸­æä¾›çš„æŸä¸ªç”Ÿå‘½å‘¨æœŸæ¥å®Œæˆï¼Œä¾‹å¦‚ <code>writing</code> æ–¹æ³•ï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">class</span> <span class="token class-name">MyScaffold</span> <span class="token keyword">extends</span> <span class="token class-name">Generator</span> <span class="token punctuation">{</span>
  <span class="token function">writing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'configuration'</span><span class="token punctuation">,</span> myObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h3 id="myobjmerge-optional"><code>myObj.merge</code>ï¼ˆå¯é€‰é¡¹ï¼‰ <a href="#myobjmerge-optional" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>string</code></p> <p>å¦‚æœè¦ä½¿ç”¨ <a href="javascript:if(confirm('https://github.com/survivejs/webpack-merge  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/survivejs/webpack-merge'" tppabs="https://github.com/survivejs/webpack-merge"><code>webpack-merge</code></a>ï¼Œå¯ä»¥å°† <code>myObj</code> çš„ <code>merge</code> å±æ€§ï¼Œè®¾ç½®ä¸ºéœ€è¦åˆå¹¶çš„é…ç½®çš„åç§°ï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>env<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>merge <span class="token operator">=</span> <span class="token string">'myConfig'</span><span class="token punctuation">;</span></code></pre> <h3 id="myobjtopscopeoptional"><code>myObj.topScope</code>ï¼ˆå¯é€‰é¡¹ï¼‰<a href="#myobjtopscopeoptional" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>[string]</code></p> <p>åœ¨ <code>topScope</code> å±æ€§ä¸­ï¼Œå¯ä»¥ç¼–å†™é…ç½®æ‰€éœ€çš„æ‰€æœ‰ä»£ç ï¼Œä¾‹å¦‚æ¨¡å—å¯¼å…¥å’Œå‡½æ•°/å˜é‡å£°æ˜ï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>env<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>topScope <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token string">'const webpack = require("webpack");'</span><span class="token punctuation">,</span>
  <span class="token string">'const path = require("path");'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre> <h3 id="myobjconfignameoptional"><code>myObj.configName</code>ï¼ˆå¯é€‰é¡¹ï¼‰ <a href="#myobjconfignameoptional" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p><code>string</code></p> <p><code>configName</code> å…è®¸è‡ªå®šä¹‰é…ç½®æ–‡ä»¶çš„åç§°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥å°†å…¶å‘½åä¸º <code>webpack.base.js</code> è€Œä¸æ˜¯é»˜è®¤çš„ <code>webpack.config.js</code>ï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">.</span>env<span class="token punctuation">.</span>configuration<span class="token punctuation">.</span>dev<span class="token punctuation">.</span>configName <span class="token operator">=</span> <span class="token string">'base'</span><span class="token punctuation">;</span></code></pre> <h1 id="æ¨¡å—çƒ­æ›¿æ¢">æ¨¡å—çƒ­æ›¿æ¢<a href="#%E6%A8%A1%E5%9D%97%E7%83%AD%E6%9B%BF%E6%8D%A2" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote class="tip"> <p>æœ¬æŒ‡å—ç»§ç»­æ²¿ç”¨ <a href="../development.htm" tppabs="https://webpack.docschina.org/guides/development">å¼€å‘ç¯å¢ƒ</a> æŒ‡å—ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚</p> </blockquote> <p>æ¨¡å—çƒ­æ›¿æ¢(hot module replacement æˆ– HMR)æ˜¯ webpack æä¾›çš„æœ€æœ‰ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ã€‚å®ƒå…è®¸åœ¨è¿è¡Œæ—¶æ›´æ–°æ‰€æœ‰ç±»å‹çš„æ¨¡å—ï¼Œ è€Œæ— éœ€å®Œå…¨åˆ·æ–°ã€‚æœ¬é¡µé¢é‡ç‚¹ä»‹ç»å…¶ <strong>å®ç°</strong>ï¼Œè€Œ <a href="../../concepts/hot-module-replacement.htm" tppabs="https://webpack.docschina.org/concepts/hot-module-replacement">æ¦‚å¿µ</a> é¡µé¢æä¾›äº†æ›´å¤šå…³äº å®ƒçš„å·¥ä½œåŸç†ä»¥åŠä¸ºä»€ä¹ˆå®ƒæœ‰ç”¨çš„ç»†èŠ‚ã€‚</p> <blockquote class="warning"> <p><strong>HMR</strong> ä¸é€‚ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œè¿™æ„å‘³ç€å®ƒåº”å½“ç”¨äºå¼€å‘ç¯å¢ƒã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œ è¯·æŸ¥çœ‹ <a href="../production.htm" tppabs="https://webpack.docschina.org/guides/production">ç”Ÿäº§ç¯å¢ƒ</a> æŒ‡å—ã€‚</p> </blockquote> <h2 id="enabling-hmr">å¯ç”¨ HMR <a href="#enabling-hmr" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ­¤åŠŸèƒ½å¯ä»¥å¾ˆå¤§ç¨‹åº¦æé«˜ç”Ÿäº§æ•ˆç‡ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯æ›´æ–° <a href="javascript:if(confirm('https://github.com/webpack/webpack-dev-server  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack-dev-server'" tppabs="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a> é…ç½®ï¼Œ ç„¶åä½¿ç”¨ webpack å†…ç½®çš„ HMR æ’ä»¶ã€‚æˆ‘ä»¬è¿˜è¦åˆ é™¤æ‰ <code>print.js</code> çš„å…¥å£èµ·ç‚¹ï¼Œ å› ä¸ºç°åœ¨å·²ç»åœ¨ <code>index.js</code> æ¨¡å—ä¸­å¼•ç”¨äº†å®ƒã€‚</p> <blockquote class="tip"> <p>å¦‚æœä½ åœ¨æŠ€æœ¯é€‰å‹ä¸­ä½¿ç”¨äº† <code>webpack-dev-middleware</code> è€Œæ²¡æœ‰ä½¿ç”¨ <code>webpack-dev-server</code>ï¼Œè¯·ä½¿ç”¨ <a href="javascript:if(confirm('https://github.com/webpack-contrib/webpack-hot-middleware  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack-contrib/webpack-hot-middleware'" tppabs="https://github.com/webpack-contrib/webpack-hot-middleware"><code>webpack-hot-middleware</code></a> ä¾èµ–åŒ…ï¼Œä»¥åœ¨ä½ çš„è‡ªå®šä¹‰æœåŠ¡å™¨æˆ–åº”ç”¨ç¨‹åºä¸Šå¯ç”¨ HMRã€‚</p> </blockquote> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line"> const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">      app: './src/index.js',
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      print: './src/print.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   devtool: 'inline-source-map',
</span><span class="token prefix unchanged"> </span><span class="token line">   devServer: {
</span><span class="token prefix unchanged"> </span><span class="token line">     contentBase: './dist',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     hot: true,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     // new CleanWebpackPlugin(['dist/*']) for &#x3C; v2 versions of CleanWebpackPlugin
</span><span class="token prefix unchanged"> </span><span class="token line">     new CleanWebpackPlugin(),
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">       title: 'Hot Module Replacement',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <blockquote class="tip"> <p>ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥ä¿®æ”¹ <a href="javascript:if(confirm('https://github.com/webpack/webpack-dev-server  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack-dev-server'" tppabs="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a> çš„é…ç½®ï¼š<code>webpack serve --hotOnly</code>ã€‚</p> </blockquote> <p>ç°åœ¨ï¼Œæˆ‘ä»¬æ¥ä¿®æ”¹ <code>index.js</code> æ–‡ä»¶ï¼Œä»¥ä¾¿å½“ <code>print.js</code> å†…éƒ¨å‘ç”Ÿå˜æ›´æ—¶å¯ä»¥å‘Šè¯‰ webpack æ¥å—æ›´æ–°çš„æ¨¡å—ã€‚</p> <p><strong>index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line"> import printMe from './print.js';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">   const btn = document.createElement('button');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   btn.innerHTML = 'Click me and check the console!';
</span><span class="token prefix unchanged"> </span><span class="token line">   btn.onclick = printMe;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.appendChild(btn);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> if (module.hot) {
</span><span class="token prefix inserted">+</span><span class="token line">   module.hot.accept('./print.js', function() {
</span><span class="token prefix inserted">+</span><span class="token line">     console.log('Accepting the updated printMe module!');
</span><span class="token prefix inserted">+</span><span class="token line">     printMe();
</span><span class="token prefix inserted">+</span><span class="token line">   })
</span><span class="token prefix inserted">+</span><span class="token line"> }</span></span></code></pre> <p>æ›´æ”¹ <code>print.js</code> ä¸­ <code>console.log</code> çš„è¾“å‡ºå†…å®¹ï¼Œä½ å°†ä¼šåœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°å¦‚ä¸‹çš„è¾“å‡º ï¼ˆä¸è¦æ‹…å¿ƒç°åœ¨ <code>button.onclick = printMe()</code> çš„è¾“å‡ºï¼Œæˆ‘ä»¬ç¨åä¹Ÿä¼šæ›´æ–°è¯¥éƒ¨åˆ†ï¼‰ã€‚</p> <p><strong>print.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> export default function printMe() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   console.log('I get called from print.js!');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   console.log('Updating print.js...');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <p><strong>console</strong></p> <pre><code class="hljs language-diff">[HMR] Waiting for update signal from WDS...
main.js:4395 [WDS] Hot Module Replacement enabled.
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> 2main.js:4395 [WDS] App updated. Recompiling...
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:4395 [WDS] App hot update...
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:4330 [HMR] Checking for updates on the server...
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:10024 Accepting the updated printMe module!
</span><span class="token prefix inserted">+</span><span class="token line"> 0.4b8ee77â€¦.hot-update.js:10 Updating print.js...
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:4330 [HMR] Updated modules:
</span><span class="token prefix inserted">+</span><span class="token line"> main.js:4330 [HMR]  - 20</span></span></code></pre> <h2 id="via-the-nodejs-api">é€šè¿‡ Node.js API <a href="#via-the-nodejs-api" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨ Node.js API ä¸­ä½¿ç”¨ webpack dev server æ—¶ï¼Œä¸è¦å°† dev server é€‰é¡¹æ”¾åœ¨ webpack é…ç½®å¯¹è±¡ä¸­ã€‚è€Œæ˜¯åœ¨åˆ›å»ºæ—¶ï¼Œ å°†å…¶ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ã€‚ä¾‹å¦‚ï¼š</p> <p><code>new WebpackDevServer(compiler, options)</code></p> <p>æƒ³è¦å¯ç”¨ HMRï¼Œè¿˜éœ€è¦ä¿®æ”¹ webpack é…ç½®å¯¹è±¡ï¼Œä½¿å…¶åŒ…å« HMR å…¥å£èµ·ç‚¹ã€‚<code>webpack-dev-server</code> ä¾èµ–åŒ…ä¸­å…·æœ‰ä¸€ä¸ªå«åš <code>addDevServerEntrypoints</code> çš„æ–¹æ³•ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ¥å®ç°ã€‚è¿™æ˜¯å…³äºå¦‚ä½•ä½¿ç”¨çš„ä¸€ä¸ªåŸºæœ¬ç¤ºä¾‹ï¼š</p> <p><strong>dev-server.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">const</span> webpackDevServer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-dev-server'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  contentBase<span class="token operator">:</span> <span class="token string">'./dist'</span><span class="token punctuation">,</span>
  hot<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  host<span class="token operator">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

webpackDevServer<span class="token punctuation">.</span><span class="token function">addDevServerEntrypoints</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> compiler <span class="token operator">=</span> <span class="token function">webpack</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">webpackDevServer</span><span class="token punctuation">(</span>compiler<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>

server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">,</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'dev server listening on port 5000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <blockquote class="tip"> <p>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ <a href="../development.htm#using-webpack-dev-middleware" tppabs="https://webpack.docschina.org/guides/development#using-webpack-dev-middleware"><code>webpack-dev-middleware</code></a>ï¼Œå¯ä»¥é€šè¿‡ <a href="javascript:if(confirm('https://github.com/webpack-contrib/webpack-hot-middleware  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack-contrib/webpack-hot-middleware'" tppabs="https://github.com/webpack-contrib/webpack-hot-middleware"><code>webpack-hot-middleware</code></a> ä¾èµ–åŒ…ï¼Œåœ¨è‡ªå®šä¹‰ dev server ä¸­å¯ç”¨ HMRã€‚</p> </blockquote> <h2 id="gotchas">é—®é¢˜ <a href="#gotchas" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ¨¡å—çƒ­æ›¿æ¢å¯èƒ½æ¯”è¾ƒéš¾ä»¥æŒæ¡ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å›åˆ°åˆšæ‰çš„ç¤ºä¾‹ä¸­ã€‚å¦‚æœä½ ç»§ç»­ç‚¹å‡»ç¤ºä¾‹é¡µé¢ä¸Šçš„æŒ‰é’®ï¼Œ ä½ ä¼šå‘ç°æ§åˆ¶å°ä»åœ¨æ‰“å°æ—§çš„ <code>printMe</code> å‡½æ•°ã€‚</p> <p>è¿™æ˜¯å› ä¸ºæŒ‰é’®çš„ <code>onclick</code> äº‹ä»¶å¤„ç†å‡½æ•°ä»ç„¶ç»‘å®šåœ¨æ—§çš„ <code>printMe</code> å‡½æ•°ä¸Šã€‚</p> <p>ä¸ºäº†è®© HMR æ­£å¸¸å·¥ä½œï¼Œæˆ‘ä»¬éœ€è¦æ›´æ–°ä»£ç ï¼Œä½¿ç”¨ <code>module.hot.accept</code> å°†å…¶ç»‘å®šåˆ°æ–°çš„ <code>printMe</code> å‡½æ•°ä¸Šï¼š</p> <p><strong>index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line"> import printMe from './print.js';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">   const btn = document.createElement('button');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   btn.innerHTML = 'Click me and check the console!';
</span><span class="token prefix unchanged"> </span><span class="token line">   btn.onclick = printMe;  // onclick event is bind to the original printMe function
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.appendChild(btn);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> document.body.appendChild(component());
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> let element = component(); // å­˜å‚¨ elementï¼Œä»¥åœ¨ print.js ä¿®æ”¹æ—¶é‡æ–°æ¸²æŸ“
</span><span class="token prefix inserted">+</span><span class="token line"> document.body.appendChild(element);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> if (module.hot) {
</span><span class="token prefix unchanged"> </span><span class="token line">   module.hot.accept('./print.js', function() {
</span><span class="token prefix unchanged"> </span><span class="token line">     console.log('Accepting the updated printMe module!');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     printMe();
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     document.body.removeChild(element);
</span><span class="token prefix inserted">+</span><span class="token line">     element = component(); // é‡æ–°æ¸²æŸ“ "component"ï¼Œä»¥ä¾¿æ›´æ–° click äº‹ä»¶å¤„ç†å‡½æ•°
</span><span class="token prefix inserted">+</span><span class="token line">     document.body.appendChild(element);
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   })
</span><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <p>è¿™ä»…ä»…æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œè¿˜æœ‰å¾ˆå¤šè®©äººæ˜“äºçŠ¯é”™çš„æƒ…å†µã€‚ å¹¸è¿çš„æ˜¯ï¼Œæœ‰å¾ˆå¤š loaderï¼ˆä¸‹é¢ä¼šæåˆ°ä¸€äº›ï¼‰å¯ä»¥ä½¿å¾—æ¨¡å—çƒ­æ›¿æ¢å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p> <h2 id="hmr-with-stylesheets">HMR åŠ è½½æ ·å¼ <a href="#hmr-with-stylesheets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å€ŸåŠ©äº <code>style-loader</code>ï¼Œä½¿ç”¨æ¨¡å—çƒ­æ›¿æ¢æ¥åŠ è½½ CSS å®é™…ä¸Šæå…¶ç®€å•ã€‚æ­¤ loader åœ¨å¹•åä½¿ç”¨äº† <code>module.hot.accept</code>ï¼Œåœ¨ CSS ä¾èµ–æ¨¡å—æ›´æ–°ä¹‹åï¼Œä¼šå°†å…¶ patch(ä¿®è¡¥) åˆ° <code>&#x3C;style></code> æ ‡ç­¾ä¸­ã€‚</p> <p>é¦–å…ˆä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ä¸¤ä¸ª loader ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev style-loader css-loader</code></pre> <p>ç„¶åæ›´æ–°é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨è¿™ä¸¤ä¸ª loaderã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line"> const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">     app: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   devtool: 'inline-source-map',
</span><span class="token prefix unchanged"> </span><span class="token line">   devServer: {
</span><span class="token prefix unchanged"> </span><span class="token line">     contentBase: './dist',
</span><span class="token prefix unchanged"> </span><span class="token line">     hot: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   module: {
</span><span class="token prefix inserted">+</span><span class="token line">     rules: [
</span><span class="token prefix inserted">+</span><span class="token line">       {
</span><span class="token prefix inserted">+</span><span class="token line">         test: /\.css$/,
</span><span class="token prefix inserted">+</span><span class="token line">         use: ['style-loader', 'css-loader'],
</span><span class="token prefix inserted">+</span><span class="token line">       },
</span><span class="token prefix inserted">+</span><span class="token line">     ],
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">      // å¯¹äº CleanWebpackPlugin çš„ v2 versions ä»¥ä¸‹ç‰ˆæœ¬ï¼Œä½¿ç”¨ new CleanWebpackPlugin(['dist/*'])
</span><span class="token prefix unchanged"> </span><span class="token line">     new CleanWebpackPlugin(),
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">       title: 'Hot Module Replacement',
</span><span class="token prefix unchanged"> </span><span class="token line">     }),
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>å¦‚åŒ import æ¨¡å—ï¼Œçƒ­åŠ è½½æ ·å¼è¡¨åŒæ ·å¾ˆç®€å•ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> | - package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> | - webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> | - /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   | - bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line"> | - /src
</span><span class="token prefix unchanged"> </span><span class="token line">   | - index.js
</span><span class="token prefix unchanged"> </span><span class="token line">   | - print.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   | - styles.css</span></span></code></pre> <p><strong>styles.css</strong></p> <pre><code class="hljs language-css"><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p><strong>index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line"> import printMe from './print.js';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import './styles.css';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">   const btn = document.createElement('button');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   btn.innerHTML = 'Click me and check the console!';
</span><span class="token prefix unchanged"> </span><span class="token line">   btn.onclick = printMe;  // onclick event is bind to the original printMe function
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.appendChild(btn);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> let element = component();
</span><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(element);
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> if (module.hot) {
</span><span class="token prefix unchanged"> </span><span class="token line">   module.hot.accept('./print.js', function() {
</span><span class="token prefix unchanged"> </span><span class="token line">     console.log('Accepting the updated printMe module!');
</span><span class="token prefix unchanged"> </span><span class="token line">     document.body.removeChild(element);
</span><span class="token prefix unchanged"> </span><span class="token line">     element = component(); // Re-render the "component" to update the click handler
</span><span class="token prefix unchanged"> </span><span class="token line">     document.body.appendChild(element);
</span><span class="token prefix unchanged"> </span><span class="token line">   })
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span></code></pre> <p>å°† <code>body</code> çš„ style æ”¹ä¸º <code>background: red;</code>ï¼Œä½ åº”è¯¥å¯ä»¥ç«‹å³çœ‹åˆ°é¡µé¢çš„èƒŒæ™¯é¢œè‰²éšä¹‹æ›´æ”¹ï¼Œè€Œæ— éœ€å®Œå…¨åˆ·æ–°ã€‚</p> <p><strong>styles.css</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> body {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   background: blue;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   background: red;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <h2 id="other-code-and-frameworks">å…¶ä»–ä»£ç å’Œæ¡†æ¶ <a href="#other-code-and-frameworks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç¤¾åŒºè¿˜æä¾›è®¸å¤šå…¶ä»– loader å’Œç¤ºä¾‹ï¼Œå¯ä»¥ä½¿ HMR ä¸å„ç§æ¡†æ¶å’Œåº“å¹³æ»‘åœ°è¿›è¡Œäº¤äº’â€¦â€¦</p> <ul> <li><a href="javascript:if(confirm('https://github.com/gaearon/react-hot-loader  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/gaearon/react-hot-loader'" tppabs="https://github.com/gaearon/react-hot-loader">React Hot Loader</a>: å®æ—¶è°ƒæ•´ react ç»„ä»¶ã€‚</li> <li><a href="javascript:if(confirm('https://github.com/vuejs/vue-loader  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/vuejs/vue-loader'" tppabs="https://github.com/vuejs/vue-loader">Vue Loader</a>: æ­¤ loader æ”¯æŒ vue ç»„ä»¶çš„ HMRï¼Œæä¾›å¼€ç®±å³ç”¨ä½“éªŒã€‚</li> <li><a href="javascript:if(confirm('https://github.com/klazuka/elm-hot-webpack-loader  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/klazuka/elm-hot-webpack-loader'" tppabs="https://github.com/klazuka/elm-hot-webpack-loader">Elm Hot webpack Loader</a>: æ”¯æŒ Elm ç¼–ç¨‹è¯­è¨€çš„ HMRã€‚</li> <li><a href="javascript:if(confirm('https://github.com/gdi2290/angular-hmr  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/gdi2290/angular-hmr'" tppabs="https://github.com/gdi2290/angular-hmr">Angular HMR</a>: æ²¡æœ‰å¿…è¦ä½¿ç”¨ loaderï¼ç›´æ¥ä¿®æ”¹ NgModule ä¸»æ–‡ä»¶å°±å¤Ÿäº†ï¼Œ</li> </ul> <p>å®ƒå¯ä»¥å®Œå…¨æ§åˆ¶ HMR APIã€‚</p> <ul> <li><a href="javascript:if(confirm('https://github.com/sveltejs/svelte-loader  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/sveltejs/svelte-loader'" tppabs="https://github.com/sveltejs/svelte-loader">Svelte Loader</a>: æ­¤ loader å¼€ç®±å³ç”¨åœ°æ”¯æŒ Svelte ç»„ä»¶çš„çƒ­æ›´æ–°ã€‚</li> </ul> <blockquote class="tip"> <p>å¦‚æœä½ çŸ¥é“ä»»ä½•å…¶ä»– loader æˆ– pluginï¼Œèƒ½å¤Ÿæœ‰åŠ©äºæˆ–å¢å¼ºæ¨¡å—çƒ­æ›¿æ¢(hot module replacement)ï¼Œè¯·æäº¤ä¸€ä¸ª pull request ä»¥æ·»åŠ åˆ°æ­¤åˆ—è¡¨ä¸­ï¼</p> </blockquote> <h1 id="Tree-Shaking">Tree Shaking<a href="#Tree-Shaking" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p><em>tree shaking</em> æ˜¯ä¸€ä¸ªæœ¯è¯­ï¼Œé€šå¸¸ç”¨äºæè¿°ç§»é™¤ JavaScript ä¸Šä¸‹æ–‡ä¸­çš„æœªå¼•ç”¨ä»£ç (dead-code)ã€‚å®ƒä¾èµ–äº ES2015 æ¨¡å—è¯­æ³•çš„ <a href="javascript:if(confirm('http://exploringjs.com/es6/ch_modules.html  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://exploringjs.com/es6/ch_modules.html#static-module-structure'" tppabs="http://exploringjs.com/es6/ch_modules.html#static-module-structure">é™æ€ç»“æ„</a> ç‰¹æ€§ï¼Œä¾‹å¦‚ <a href="javascript:if(confirm('https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import'" tppabs="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import"><code>import</code></a> å’Œ <a href="javascript:if(confirm('https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export'" tppabs="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export"><code>export</code></a>ã€‚è¿™ä¸ªæœ¯è¯­å’Œæ¦‚å¿µå®é™…ä¸Šæ˜¯ç”± ES2015 æ¨¡å—æ‰“åŒ…å·¥å…· <a href="javascript:if(confirm('https://github.com/rollup/rollup  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/rollup/rollup'" tppabs="https://github.com/rollup/rollup">rollup</a> æ™®åŠèµ·æ¥çš„ã€‚</p> <p>webpack 2 æ­£å¼ç‰ˆæœ¬å†…ç½®æ”¯æŒ ES2015 æ¨¡å—ï¼ˆä¹Ÿå«åš <em>harmony modules</em>ï¼‰å’Œæœªä½¿ç”¨æ¨¡å—æ£€æµ‹èƒ½åŠ›ã€‚æ–°çš„ webpack 4 æ­£å¼ç‰ˆæœ¬æ‰©å±•äº†æ­¤æ£€æµ‹èƒ½åŠ›ï¼Œé€šè¿‡ <code>package.json</code> çš„ <code>"sideEffects"</code> å±æ€§ä½œä¸ºæ ‡è®°ï¼Œå‘ compiler æä¾›æç¤ºï¼Œè¡¨æ˜é¡¹ç›®ä¸­çš„å“ªäº›æ–‡ä»¶æ˜¯ "pure(çº¯æ­£ ES2015 æ¨¡å—)"ï¼Œç”±æ­¤å¯ä»¥å®‰å…¨åœ°åˆ é™¤æ–‡ä»¶ä¸­æœªä½¿ç”¨çš„éƒ¨åˆ†ã€‚</p> <blockquote class="tip"> <p>æœ¬æŒ‡å—çš„ç»§æ‰¿è‡ª <a href="../getting-started.htm" tppabs="https://webpack.docschina.org/guides/getting-started">èµ·æ­¥</a> æŒ‡å—ã€‚å¦‚æœä½ å°šæœªé˜…è¯»è¯¥æŒ‡å—ï¼Œè¯·å…ˆè¡Œé˜…è¯»ã€‚</p> </blockquote> <h2 id="add-a-utility">æ·»åŠ ä¸€ä¸ªé€šç”¨æ¨¡å— <a href="#add-a-utility" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨æˆ‘ä»¬çš„é¡¹ç›®ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„é€šç”¨æ¨¡å—æ–‡ä»¶ <code>src/math.js</code>ï¼Œå¹¶å¯¼å‡ºä¸¤ä¸ªå‡½æ•°ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- index.html
</span></span>|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- math.js
</span></span>|- /node_modules</code></pre> <p><strong>src/math.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">cube</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">*</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p>éœ€è¦å°† <code>mode</code> é…ç½®è®¾ç½®æˆ<a href="../../configuration/mode/index.htm#mode-development" tppabs="https://webpack.docschina.org/configuration/mode/#mode-development">development</a>ï¼Œä»¥ç¡®å®š bundle ä¸ä¼šè¢«å‹ç¼©ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> mode: 'development',
</span><span class="token prefix inserted">+</span><span class="token line"> optimization: {
</span><span class="token prefix inserted">+</span><span class="token line">   usedExports: true,
</span><span class="token prefix inserted">+</span><span class="token line"> },
</span></span>};</code></pre> <p>é…ç½®å®Œè¿™äº›åï¼Œæ›´æ–°å…¥å£è„šæœ¬ï¼Œä½¿ç”¨å…¶ä¸­ä¸€ä¸ªæ–°æ–¹æ³•ï¼Œå¹¶ä¸”ä¸ºäº†ç®€åŒ–ç¤ºä¾‹ï¼Œæˆ‘ä»¬å…ˆå°† <code>lodash</code> åˆ é™¤ï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import { cube } from './math.js';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   const element = document.createElement('div');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const element = document.createElement('pre');
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   // Lodash, now imported by this script
</span><span class="token prefix deleted">-</span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   element.innerHTML = [
</span><span class="token prefix inserted">+</span><span class="token line">     'Hello webpack!',
</span><span class="token prefix inserted">+</span><span class="token line">     '5 cubed is equal to ' + cube(5)
</span><span class="token prefix inserted">+</span><span class="token line">   ].join('\n\n');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <p>æ³¨æ„ï¼Œæˆ‘ä»¬__æ²¡æœ‰ä» <code>src/math.js</code> æ¨¡å—ä¸­ <code>import</code> å¦å¤–ä¸€ä¸ª <code>square</code> æ–¹æ³•__ã€‚è¿™ä¸ªå‡½æ•°å°±æ˜¯æ‰€è°“çš„â€œæœªå¼•ç”¨ä»£ç (dead code)â€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåº”è¯¥åˆ é™¤æ‰æœªè¢«å¼•ç”¨çš„ <code>export</code>ã€‚ç°åœ¨è¿è¡Œ npm script <code>npm run build</code>ï¼Œå¹¶æŸ¥çœ‹è¾“å‡ºçš„ bundleï¼š</p> <p><strong>dist/bundle.js (around lines 90 - 100)</strong></p> <pre><code class="hljs language-js"><span class="token comment">/* 1 */</span>
<span class="token comment">/***/</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> __webpack_exports__<span class="token punctuation">,</span> __webpack_require__</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token string">'use strict'</span><span class="token punctuation">;</span>
  <span class="token comment">/* unused harmony export square */</span>
  <span class="token comment">/* harmony export (immutable) */</span> __webpack_exports__<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">=</span> cube<span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">square</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">function</span> <span class="token function">cube</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">*</span> x <span class="token operator">*</span> x<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>æ³¨æ„ï¼Œä¸Šé¢çš„ <code>unused harmony export square</code> æ³¨é‡Šã€‚å¦‚æœä½ è§‚å¯Ÿå®ƒä¸‹é¢çš„ä»£ç ï¼Œä½ ä¼šæ³¨æ„åˆ°è™½ç„¶æˆ‘ä»¬æ²¡æœ‰å¼•ç”¨ <code>square</code>ï¼Œä½†å®ƒä»ç„¶è¢«åŒ…å«åœ¨ bundle ä¸­ã€‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p> <h2 id="mark-the-file-as-side-effect-free">å°†æ–‡ä»¶æ ‡è®°ä¸º side-effect-free(æ— å‰¯ä½œç”¨) <a href="#mark-the-file-as-side-effect-free" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨ä¸€ä¸ªçº¯ç²¹çš„ ESM æ¨¡å—ä¸–ç•Œä¸­ï¼Œå¾ˆå®¹æ˜“è¯†åˆ«å‡ºå“ªäº›æ–‡ä»¶æœ‰ side effectã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çš„é¡¹ç›®æ— æ³•è¾¾åˆ°è¿™ç§çº¯åº¦ï¼Œæ‰€ä»¥ï¼Œæ­¤æ—¶æœ‰å¿…è¦æç¤º webpack compiler å“ªäº›ä»£ç æ˜¯â€œçº¯ç²¹éƒ¨åˆ†â€ã€‚</p> <p>é€šè¿‡ package.json çš„ <code>"sideEffects"</code> å±æ€§ï¼Œæ¥å®ç°è¿™ç§æ–¹å¼ã€‚</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"your-project"</span><span class="token punctuation">,</span>
  <span class="token property">"sideEffects"</span><span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span></code></pre> <p>å¦‚æœæ‰€æœ‰ä»£ç éƒ½ä¸åŒ…å« side effectï¼Œæˆ‘ä»¬å°±å¯ä»¥ç®€å•åœ°å°†è¯¥å±æ€§æ ‡è®°ä¸º <code>false</code>ï¼Œæ¥å‘ŠçŸ¥ webpackï¼Œå®ƒå¯ä»¥å®‰å…¨åœ°åˆ é™¤æœªç”¨åˆ°çš„ exportã€‚</p> <blockquote class="tip"> <p>"side effect(å‰¯ä½œç”¨)" çš„å®šä¹‰æ˜¯ï¼Œåœ¨å¯¼å…¥æ—¶ä¼šæ‰§è¡Œç‰¹æ®Šè¡Œä¸ºçš„ä»£ç ï¼Œè€Œä¸æ˜¯ä»…ä»…æš´éœ²ä¸€ä¸ª export æˆ–å¤šä¸ª exportã€‚ä¸¾ä¾‹è¯´æ˜ï¼Œä¾‹å¦‚ polyfillï¼Œå®ƒå½±å“å…¨å±€ä½œç”¨åŸŸï¼Œå¹¶ä¸”é€šå¸¸ä¸æä¾› exportã€‚</p> </blockquote> <p>å¦‚æœä½ çš„ä»£ç ç¡®å®æœ‰ä¸€äº›å‰¯ä½œç”¨ï¼Œå¯ä»¥æ”¹ä¸ºæä¾›ä¸€ä¸ªæ•°ç»„ï¼š</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"your-project"</span><span class="token punctuation">,</span>
  <span class="token property">"sideEffects"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"./src/some-side-effectful-file.js"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre> <p>æ­¤æ•°ç»„æ”¯æŒç®€å•çš„ glob æ¨¡å¼åŒ¹é…ç›¸å…³æ–‡ä»¶ã€‚å…¶å†…éƒ¨ä½¿ç”¨äº† <a href="javascript:if(confirm('https://github.com/fitzgen/glob-to-regexp  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/fitzgen/glob-to-regexp'" tppabs="https://github.com/fitzgen/glob-to-regexp">glob-to-regexp</a>ï¼ˆæ”¯æŒï¼š<code>*</code>ï¼Œ<code>**</code>ï¼Œ<code>{a,b}</code>ï¼Œ<code>[a-z]</code>ï¼‰ã€‚å¦‚æœåŒ¹é…æ¨¡å¼ä¸º <code>*.css</code>ï¼Œä¸”ä¸åŒ…å« <code>/</code>ï¼Œå°†è¢«è§†ä¸º <code>**/*.css</code>ã€‚</p> <blockquote class="tip"> <p>æ³¨æ„ï¼Œæ‰€æœ‰å¯¼å…¥æ–‡ä»¶éƒ½ä¼šå—åˆ° tree shaking çš„å½±å“ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœåœ¨é¡¹ç›®ä¸­ä½¿ç”¨ç±»ä¼¼ <code>css-loader</code> å¹¶ import ä¸€ä¸ª CSS æ–‡ä»¶ï¼Œåˆ™éœ€è¦å°†å…¶æ·»åŠ åˆ° side effect åˆ—è¡¨ä¸­ï¼Œä»¥å…åœ¨ç”Ÿäº§æ¨¡å¼ä¸­æ— æ„ä¸­å°†å®ƒåˆ é™¤ï¼š</p> </blockquote> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"your-project"</span><span class="token punctuation">,</span>
  <span class="token property">"sideEffects"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"./src/some-side-effectful-file.js"</span><span class="token punctuation">,</span>
    <span class="token string">"*.css"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre> <p>æœ€åï¼Œè¿˜å¯ä»¥åœ¨ <a href="../../configuration/module/index.htm#module-rules" tppabs="https://webpack.docschina.org/configuration/module/#module-rules"><code>module.rules</code> é…ç½®é€‰é¡¹</a> ä¸­è®¾ç½® <code>"sideEffects"</code>ã€‚</p> <h2 id="clarifying-tree-shaking-and-sideeffects">è§£é‡Š tree shaking å’Œ <code>sideEffects</code> <a href="#clarifying-tree-shaking-and-sideeffects" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="../../configuration/optimization/index.htm#optimizationsideeffects" tppabs="https://webpack.docschina.org/configuration/optimization/#optimizationsideeffects"><code>sideEffects</code></a> å’Œ <a href="../../configuration/optimization/index.htm#optimizationusedexports" tppabs="https://webpack.docschina.org/configuration/optimization/#optimizationusedexports"><code>usedExports</code></a>ï¼ˆæ›´å¤šè¢«è®¤ä¸ºæ˜¯ tree shakingï¼‰æ˜¯ä¸¤ç§ä¸åŒçš„ä¼˜åŒ–æ–¹å¼ã€‚</p> <p><strong><code>sideEffects</code> æ›´ä¸ºæœ‰æ•ˆ</strong> æ˜¯å› ä¸ºå®ƒå…è®¸è·³è¿‡æ•´ä¸ªæ¨¡å—/æ–‡ä»¶å’Œæ•´ä¸ªæ–‡ä»¶å­æ ‘ã€‚</p> <p><code>usedExports</code> ä¾èµ–äº <a href="javascript:if(confirm('https://github.com/terser-js/terser  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/terser-js/terser'" tppabs="https://github.com/terser-js/terser">terser</a> å»æ£€æµ‹è¯­å¥ä¸­çš„å‰¯ä½œç”¨ã€‚å®ƒæ˜¯ä¸€ä¸ª JavaScript ä»»åŠ¡è€Œä¸”æ²¡æœ‰åƒ <code>sideEffects</code> ä¸€æ ·ç®€å•ç›´æ¥ã€‚è€Œä¸”å®ƒä¸èƒ½è·³è½¬å­æ ‘/ä¾èµ–ç”±äºç»†åˆ™ä¸­è¯´å‰¯ä½œç”¨éœ€è¦è¢«è¯„ä¼°ã€‚å°½ç®¡å¯¼å‡ºå‡½æ•°èƒ½è¿ä½œå¦‚å¸¸ï¼Œä½† React æ¡†æ¶çš„é«˜é˜¶å‡½æ•°ï¼ˆHOCï¼‰åœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯ä¼šå‡ºé—®é¢˜çš„ã€‚</p> <p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼š</p> <pre><code class="hljs language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> Button <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@shopify/polaris'</span><span class="token punctuation">;</span></code></pre> <p>æ‰“åŒ…å‰çš„æ–‡ä»¶ç‰ˆæœ¬çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p> <pre><code class="hljs language-javascript"><span class="token keyword">import</span> hoistStatics <span class="token keyword">from</span> <span class="token string">'hoist-non-react-statics'</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Button</span><span class="token punctuation">(</span><span class="token parameter">_ref</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">merge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> _final <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> _len <span class="token operator">=</span> arguments<span class="token punctuation">.</span>length<span class="token punctuation">,</span> objs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>_len<span class="token punctuation">)</span><span class="token punctuation">,</span> _key <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> _key <span class="token operator">&#x3C;</span> _len<span class="token punctuation">;</span> _key<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    objs<span class="token punctuation">[</span>_key<span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span>_key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> _i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> _objs <span class="token operator">=</span> objs<span class="token punctuation">;</span> _i <span class="token operator">&#x3C;</span> _objs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> _i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> obj <span class="token operator">=</span> _objs<span class="token punctuation">[</span>_i<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">mergeRecursively</span><span class="token punctuation">(</span>_final<span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> _final<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">withAppProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">addProvider</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> WithProvider <span class="token operator">=</span>
    <span class="token comment">/*#__PURE__*/</span>
    <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">_React$Component</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...</span>
      <span class="token keyword">return</span> WithProvider<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">(</span>Component<span class="token punctuation">)</span><span class="token punctuation">;</span>

    WithProvider<span class="token punctuation">.</span>contextTypes <span class="token operator">=</span> WrappedComponent<span class="token punctuation">.</span>contextTypes <span class="token operator">?</span> <span class="token function">merge</span><span class="token punctuation">(</span>WrappedComponent<span class="token punctuation">.</span>contextTypes<span class="token punctuation">,</span> polarisAppProviderContextTypes<span class="token punctuation">)</span> <span class="token operator">:</span> polarisAppProviderContextTypes<span class="token punctuation">;</span>
    <span class="token keyword">var</span> FinalComponent <span class="token operator">=</span> <span class="token function">hoistStatics</span><span class="token punctuation">(</span>WithProvider<span class="token punctuation">,</span> WrappedComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> FinalComponent<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> Button$<span class="token number">1</span> <span class="token operator">=</span> <span class="token function">withAppProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...,</span>
  Button$<span class="token number">1</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>å½“ <code>Button</code> æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œä½ å¯ä»¥æœ‰æ•ˆåœ°æ¸…é™¤æ‰ <code>export { Button$1 };</code> ä¸”ä¿ç•™æ‰€æœ‰å‰©ä¸‹çš„ä»£ç ã€‚é‚£é—®é¢˜æ¥äº†ï¼Œâ€œè¿™æ®µä»£ç ä¼šæœ‰ä»»ä½•å‰¯ä½œç”¨æˆ–å®ƒèƒ½è¢«å®‰å…¨éƒ½æ¸…ç†æ‰å—ï¼Ÿâ€ã€‚å¾ˆéš¾è¯´ï¼Œå°¤å…¶æ˜¯è¿™ <code>withAppProvider()(Button)</code> è¿™æ®µä»£ç ã€‚<code>withAppProvider</code> è¢«è°ƒç”¨ï¼Œè€Œä¸”è¿”å›çš„å€¼ä¹Ÿè¢«è°ƒç”¨ã€‚å½“è°ƒç”¨ <code>merge</code> æˆ– <code>hoistStatics</code> ä¼šæœ‰ä»»ä½•å‰¯ä½œç”¨å—ï¼Ÿå½“ç»™ <code>WithProvider.contextTypes</code> (Setter?) èµ‹å€¼æˆ–å½“è¯»å– <code>WrappedComponent.contextTypes</code> (Getter) çš„æ—¶å€™ï¼Œä¼šæœ‰ä»»ä½•å‰¯ä½œç”¨å—ï¼Ÿ</p> <p>å®é™…ä¸Šï¼ŒTerser å°è¯•å»è§£å†³ä»¥ä¸Šçš„é—®é¢˜ï¼Œä½†åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå®ƒä¸å¤ªç¡®å®šã€‚ä½†è¿™ä¸ä¼šæ„å‘³ç€ terser ç”±äºæ— æ³•è§£å†³è¿™äº›é—®é¢˜è€Œè¿ä½œå¾—ä¸å¥½ï¼Œè€Œæ˜¯ç”±äºåœ¨ JavaScript è¿™ç§åŠ¨æ€è¯­è¨€ä¸­å®åœ¨å¤ªéš¾å»ç¡®å®šã€‚</p> <p>ä½†æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>/*#__PURE__*/</code> æ³¨é‡Šæ¥å¸®å¿™ terserã€‚å®ƒç»™ä¸€ä¸ªè¯­å¥æ ‡è®°ä¸ºæ²¡æœ‰å‰¯ä½œç”¨ã€‚å°±è¿™æ ·ä¸€ä¸ªç®€å•çš„æ”¹å˜å°±èƒ½å¤Ÿä½¿ä¸‹é¢çš„ä»£ç è¢« tree-shake:</p> <pre><code class="hljs language-javascript"><span class="token keyword">var</span> Button$<span class="token number">1</span> <span class="token operator">=</span> <span class="token comment">/*#__PURE__*/</span> <span class="token function">withAppProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Button<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>è¿™ä¼šä½¿å¾—è¿™æ®µä»£ç è¢«è¿‡æ»¤ï¼Œä½†ä»ç„¶ä¼šæœ‰ä¸€äº›å¼•å…¥çš„é—®é¢˜ï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œè¯„ä¼°ï¼Œå› ä¸ºå®ƒä»¬äº§ç”Ÿäº†å‰¯ä½œç”¨ã€‚</p> <p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ <code>package.json</code> ä¸­æ·»åŠ  <a href="../tree-shaking/index.htm#mark-the-file-as-side-effect-free" tppabs="https://webpack.docschina.org/guides/tree-shaking/#mark-the-file-as-side-effect-free"><code>"sideEffects"</code></a> å±æ€§ã€‚</p> <p>å®ƒç±»ä¼¼äº <code>/*#__PURE__*/</code> ä½†æ˜¯ä½œç”¨äºæ¨¡å—çš„å±‚é¢ï¼Œè€Œä¸æ˜¯ä»£ç è¯­å¥çš„å±‚é¢ã€‚å®ƒè¡¨ç¤ºçš„æ„æ€æ˜¯(æŒ‡<code>"sideEffects"</code> å±æ€§)ï¼šâ€œå¦‚æœè¢«æ ‡è®°ä¸ºæ— å‰¯ä½œç”¨çš„æ¨¡å—æ²¡æœ‰è¢«ç›´æ¥å¯¼å‡ºä½¿ç”¨ï¼Œæ‰“åŒ…å·¥å…·ä¼šè·³è¿‡è¿›è¡Œæ¨¡å—çš„å‰¯ä½œç”¨åˆ†æè¯„ä¼°ã€‚â€ã€‚</p> <p>åœ¨ä¸€ä¸ª <code>Shopify Polaris</code> çš„ä¾‹å­ï¼ŒåŸæœ‰çš„æ¨¡å—å¦‚ä¸‹ï¼š</p> <p><strong>index.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">import</span> <span class="token string">'./configure'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./types'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token operator">*</span> <span class="token keyword">from</span> <span class="token string">'./components'</span><span class="token punctuation">;</span></code></pre> <p><strong>components/index.js</strong></p> <pre><code class="hljs language-javascript"><span class="token comment">// ...</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> Breadcrumbs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Breadcrumbs'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> Button<span class="token punctuation">,</span> buttonFrom<span class="token punctuation">,</span> buttonsFrom<span class="token punctuation">,</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Button'</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> <span class="token keyword">default</span> <span class="token keyword">as</span> ButtonGroup <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./ButtonGroup'</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span></code></pre> <p><strong>package.json</strong></p> <pre><code class="hljs language-json"><span class="token comment">// ...</span>
<span class="token property">"sideEffects"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token string">"**/*.css"</span><span class="token punctuation">,</span>
  <span class="token string">"**/*.scss"</span><span class="token punctuation">,</span>
  <span class="token string">"./esnext/index.js"</span><span class="token punctuation">,</span>
  <span class="token string">"./esnext/configure.js"</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token comment">// ...</span></code></pre> <p>å¯¹äºä»£ç  <code>import { Button } from "@shopify/polaris";</code> å®ƒæœ‰ä»¥ä¸‹çš„æš—ç¤ºï¼š</p> <ul> <li>å¯¼å…¥å®ƒï¼šå¯¼å…¥å¹¶åŒ…å«è¯¥æ¨¡å—ï¼Œåˆ†æè¯„ä¼°å®ƒå¹¶ç»§ç»­è¿›è¡Œä¾èµ–åˆ†æ</li> <li>è·³è¿‡å®ƒï¼šä¸å¯¼å…¥å®ƒï¼Œä¸åˆ†æè¯„ä¼°å®ƒä½†ä¼šç»§ç»­è¿›è¡Œä¾èµ–åˆ†æ</li> <li>æ’é™¤å®ƒï¼šä¸å¯¼å…¥å®ƒï¼Œä¸è¯„ä¼°ä¸”ä¸åšä¾èµ–åˆ†æ</li> </ul> <p>ä»¥ä¸‹æ˜¯æ¯ä¸ªåŒ¹é…åˆ°çš„èµ„æºçš„æƒ…å†µï¼š</p> <ul> <li><code>index.js</code>: æ²¡æœ‰ç›´æ¥çš„å¯¼å‡ºè¢«ä½¿ç”¨ï¼Œä½†è¢«æ ‡è®°ä¸ºæœ‰å‰¯ä½œç”¨ -> å¯¼å…¥å®ƒ</li> <li><code>configure.js</code>: æ²¡æœ‰å¯¼å‡ºè¢«ä½¿ç”¨ï¼Œä½†è¢«æ ‡è®°ä¸ºæœ‰å‰¯ä½œç”¨ -> å¯¼å…¥å®ƒ</li> <li><code>types/index.js</code>: æ²¡æœ‰å¯¼å‡ºè¢«ä½¿ç”¨ï¼Œæ²¡æœ‰è¢«æ ‡è®°ä¸ºæœ‰å‰¯ä½œç”¨ -> æ’é™¤å®ƒ</li> <li><code>components/index.js</code>: æ²¡æœ‰å¯¼å‡ºè¢«ä½¿ç”¨ï¼Œæ²¡æœ‰è¢«æ ‡è®°ä¸ºæœ‰å‰¯ä½œç”¨ï¼Œä½†é‡æ–°å¯¼å‡ºçš„å¯¼å‡ºå†…å®¹è¢«ä½¿ç”¨äº† -> è·³è¿‡å®ƒ</li> <li><code>components/Breadcrumbs.js</code>: æ²¡æœ‰å¯¼å‡ºè¢«ä½¿ç”¨ï¼Œæ²¡æœ‰è¢«æ ‡è®°ä¸ºæœ‰å‰¯ä½œç”¨ -> æ’é™¤å®ƒã€‚è¿™ä¹Ÿä¼šæ’é™¤æ‰€æœ‰å¦‚åŒ <code>components/Breadcrumbs.css</code> çš„ä¾èµ–ï¼Œå°½ç®¡å®ƒä»¬éƒ½è¢«æ ‡è®°ä¸ºæœ‰å‰¯ä½œç”¨ã€‚</li> <li><code>components/Button.js</code>: ç›´æ¥çš„å¯¼å‡ºè¢«ä½¿ç”¨ï¼Œæ²¡æœ‰è¢«æ ‡è®°ä¸ºæœ‰å‰¯ä½œç”¨ -> å¯¼å…¥å®ƒ</li> <li><code>components/Button.css</code>: æ²¡æœ‰å¯¼å‡ºè¢«ä½¿ç”¨ï¼Œä½†è¢«æ ‡è®°ä¸ºæœ‰å‰¯ä½œç”¨ -> å¯¼å…¥å®ƒ</li> </ul> <p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåªæœ‰4ä¸ªæ¨¡å—è¢«å¯¼å…¥åˆ° bundle ä¸­ï¼š</p> <ul> <li><code>index.js</code>: åŸºæœ¬ä¸ºç©ºçš„</li> <li><code>configure.js</code></li> <li><code>components/Button.js</code></li> <li><code>components/Button.css</code></li> </ul> <p>åœ¨è¿™æ¬¡çš„ä¼˜åŒ–åï¼Œå…¶å®ƒçš„ä¼˜åŒ–é¡¹ç›®éƒ½å¯ä»¥åº”ç”¨ã€‚ä¾‹å¦‚ï¼šä» <code>Button.js</code> å¯¼å‡º çš„<code>buttonFrom</code> å’Œ <code>buttonsFrom</code> ä¹Ÿæ²¡æœ‰è¢«ä½¿ç”¨ã€‚<code>usedExports</code> ä¼˜åŒ–ä¼šæ¡èµ·è¿™äº›ä»£ç è€Œä¸” terser ä¼šèƒ½å¤Ÿä» bundle ä¸­æŠŠè¿™äº›è¯­å¥æ‘˜é™¤å‡ºæ¥ã€‚</p> <p>æ¨¡å—åˆå¹¶ä¹Ÿä¼šåº”ç”¨ã€‚æ‰€ä»¥è¿™4ä¸ªæ¨¡å—ï¼ŒåŠ ä¸Šå…¥å£çš„æ¨¡å—ï¼ˆä¹Ÿå¯èƒ½æœ‰æ›´å¤šçš„ä¾èµ–ï¼‰ä¼šè¢«åˆå¹¶ã€‚ <strong><code>index.js</code> æœ€ç»ˆæ²¡æœ‰ç”Ÿæˆä»£ç </strong>.</p> <h2 id="mark-a-function-call-as-side-effect-free">å°†å‡½æ•°è°ƒç”¨æ ‡è®°ä¸ºæ— å‰¯ä½œç”¨ <a href="#mark-a-function-call-as-side-effect-free" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ˜¯å¯ä»¥å‘Šè¯‰ webpack ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ˜¯æ— å‰¯ä½œç”¨çš„ï¼Œåªè¦é€šè¿‡ <code>/*#__PURE__*/</code> æ³¨é‡Šã€‚å®ƒå¯ä»¥è¢«æ”¾åˆ°å‡½æ•°è°ƒç”¨ä¹‹å‰ï¼Œç”¨æ¥æ ‡è®°å®ƒä»¬æ˜¯æ— å‰¯ä½œç”¨çš„(pure)ã€‚ä¼ åˆ°å‡½æ•°ä¸­çš„å…¥å‚æ˜¯æ— æ³•è¢«åˆšæ‰çš„æ³¨é‡Šæ‰€æ ‡è®°ï¼Œéœ€è¦å•ç‹¬æ¯ä¸€ä¸ªæ ‡è®°æ‰å¯ä»¥ã€‚å¦‚æœä¸€ä¸ªæ²¡è¢«ä½¿ç”¨çš„å˜é‡å®šä¹‰çš„åˆå§‹å€¼è¢«è®¤ä¸ºæ˜¯æ— å‰¯ä½œç”¨çš„ï¼ˆpureï¼‰ï¼Œå®ƒä¼šè¢«æ ‡è®°ä¸ºæ­»ä»£ç ï¼Œä¸ä¼šè¢«æ‰§è¡Œä¸”ä¼šè¢«å‹ç¼©å·¥å…·æ¸…é™¤æ‰ã€‚è¿™ä¸ªè¡Œä¸ºè¢«ä¼šå¼€å¯å½“ <a href="../../configuration/optimization/index.htm#optimizationinnergraph" tppabs="https://webpack.docschina.org/configuration/optimization/#optimizationinnergraph"><code>optimization.innerGraph</code></a> è¢«è®¾ç½®æˆ <code>true</code>ã€‚</p> <p><strong>file.js</strong></p> <pre><code class="hljs language-javascript"><span class="token comment">/*#__PURE__*/</span> <span class="token function">double</span><span class="token punctuation">(</span><span class="token number">55</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h2 id="minify-the-output">å‹ç¼©è¾“å‡ºç»“æœ <a href="#minify-the-output" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é€šè¿‡ <code>import</code> å’Œ <code>export</code> è¯­æ³•ï¼Œæˆ‘ä»¬å·²ç»æ‰¾å‡ºéœ€è¦åˆ é™¤çš„â€œæœªå¼•ç”¨ä»£ç (dead code)â€ï¼Œç„¶è€Œï¼Œä¸ä»…ä»…æ˜¯è¦æ‰¾å‡ºï¼Œè¿˜è¦åœ¨ bundle ä¸­åˆ é™¤å®ƒä»¬ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦å°† <code>mode</code> é…ç½®é€‰é¡¹è®¾ç½®ä¸º <a href="../../configuration/mode/index.htm#mode-production" tppabs="https://webpack.docschina.org/configuration/mode/#mode-production"><code>production</code></a>ã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> mode: 'development',
</span><span class="token prefix deleted">-</span><span class="token line"> optimization: {
</span><span class="token prefix deleted">-</span><span class="token line">   usedExports: true,
</span><span class="token prefix deleted">-</span><span class="token line"> }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> mode: 'production',
</span></span>};</code></pre> <blockquote class="tip"> <p>æ³¨æ„ï¼Œä¹Ÿå¯ä»¥åœ¨å‘½ä»¤è¡Œæ¥å£ä¸­ä½¿ç”¨ <code>--optimize-minimize</code> æ ‡è®°ï¼Œæ¥å¯ç”¨ <code>TerserPlugin</code>ã€‚</p> </blockquote> <p>å‡†å¤‡å°±ç»ªåï¼Œç„¶åè¿è¡Œå¦ä¸€ä¸ªå‘½ä»¤ <code>npm run build</code>ï¼Œçœ‹çœ‹è¾“å‡ºç»“æœæœ‰æ²¡æœ‰å‘ç”Ÿæ”¹å˜ã€‚</p> <p>ä½ å‘ç° <code>dist/bundle.js</code> ä¸­çš„å·®å¼‚äº†å—ï¼Ÿæ˜¾ç„¶ï¼Œç°åœ¨æ•´ä¸ª bundle éƒ½å·²ç»è¢« minify(å‹ç¼©) å’Œ mangle(æ··æ·†ç ´å)ï¼Œä½†æ˜¯å¦‚æœä»”ç»†è§‚å¯Ÿï¼Œåˆ™ä¸ä¼šçœ‹åˆ°å¼•å…¥ <code>square</code> å‡½æ•°ï¼Œä½†èƒ½çœ‹åˆ° <code>cube</code> å‡½æ•°çš„æ··æ·†ç ´åç‰ˆæœ¬ï¼ˆ<code>function r(e){return e*e*e}n.a=r</code>ï¼‰ã€‚ç°åœ¨ï¼Œéšç€ minification(ä»£ç å‹ç¼©) å’Œ tree shakingï¼Œæˆ‘ä»¬çš„ bundle å‡å°å‡ ä¸ªå­—èŠ‚ï¼è™½ç„¶ï¼Œåœ¨è¿™ä¸ªç‰¹å®šç¤ºä¾‹ä¸­ï¼Œå¯èƒ½çœ‹èµ·æ¥æ²¡æœ‰å‡å°‘å¾ˆå¤šï¼Œä½†æ˜¯ï¼Œåœ¨æœ‰ç€å¤æ‚ä¾èµ–æ ‘çš„å¤§å‹åº”ç”¨ç¨‹åºä¸Šè¿è¡Œ tree shaking æ—¶ï¼Œä¼šå¯¹ bundle äº§ç”Ÿæ˜¾è‘—çš„ä½“ç§¯ä¼˜åŒ–ã€‚</p> <blockquote class="tip"> <p>åœ¨ä½¿ç”¨ tree shaking æ—¶å¿…é¡»æœ‰ <a href="../../plugins/module-concatenation-plugin.htm" tppabs="https://webpack.docschina.org/plugins/module-concatenation-plugin">ModuleConcatenationPlugin</a> çš„æ”¯æŒï¼Œæ‚¨å¯ä»¥é€šè¿‡è®¾ç½®é…ç½®é¡¹ <code>mode: "production"</code> ä»¥å¯ç”¨å®ƒã€‚å¦‚æœæ‚¨æ²¡æœ‰å¦‚æ­¤åšï¼Œè¯·è®°å¾—æ‰‹åŠ¨å¼•å…¥ <a href="../../plugins/module-concatenation-plugin.htm" tppabs="https://webpack.docschina.org/plugins/module-concatenation-plugin">ModuleConcatenationPlugin</a>ã€‚</p> </blockquote> <h2 id="conclusion">ç»“è®º <a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å› æ­¤ï¼Œæˆ‘ä»¬å­¦åˆ°ä¸ºäº†åˆ©ç”¨ <em>tree shaking</em> çš„ä¼˜åŠ¿ï¼Œ ä½ å¿…é¡»...</p> <ul> <li>ä½¿ç”¨ ES2015 æ¨¡å—è¯­æ³•ï¼ˆå³ <code>import</code> å’Œ <code>export</code>ï¼‰ã€‚</li> <li>ç¡®ä¿æ²¡æœ‰ç¼–è¯‘å™¨å°†æ‚¨çš„ ES2015 æ¨¡å—è¯­æ³•è½¬æ¢ä¸º CommonJS çš„ï¼ˆé¡ºå¸¦ä¸€æï¼Œè¿™æ˜¯ç°åœ¨å¸¸ç”¨çš„ @babel/preset-env çš„é»˜è®¤è¡Œä¸ºï¼Œè¯¦ç»†ä¿¡æ¯è¯·å‚é˜…<a href="javascript:if(confirm('https://babeljs.io/docs/en/babel-preset-env  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://babeljs.io/docs/en/babel-preset-env#modules'" tppabs="https://babeljs.io/docs/en/babel-preset-env#modules">æ–‡æ¡£</a>ï¼‰ã€‚</li> <li>åœ¨é¡¹ç›®çš„ <code>package.json</code> æ–‡ä»¶ä¸­ï¼Œæ·»åŠ  <code>"sideEffects"</code> å±æ€§ã€‚</li> <li>ä½¿ç”¨ <code>mode</code> ä¸º <code>"production"</code> çš„é…ç½®é¡¹ä»¥å¯ç”¨<a href="../../concepts/mode/index.htm#usage" tppabs="https://webpack.docschina.org/concepts/mode/#usage">æ›´å¤šä¼˜åŒ–é¡¹</a>ï¼ŒåŒ…æ‹¬å‹ç¼©ä»£ç ä¸ tree shakingã€‚</li> </ul> <p>ä½ å¯ä»¥å°†åº”ç”¨ç¨‹åºæƒ³è±¡æˆä¸€æ£µæ ‘ã€‚ç»¿è‰²è¡¨ç¤ºå®é™…ç”¨åˆ°çš„ source code(æºç ) å’Œ library(åº“)ï¼Œæ˜¯æ ‘ä¸Šæ´»çš„æ ‘å¶ã€‚ç°è‰²è¡¨ç¤ºæœªå¼•ç”¨ä»£ç ï¼Œæ˜¯ç§‹å¤©æ ‘ä¸Šæ¯èçš„æ ‘å¶ã€‚ä¸ºäº†é™¤å»æ­»å»çš„æ ‘å¶ï¼Œä½ å¿…é¡»æ‘‡åŠ¨è¿™æ£µæ ‘ï¼Œä½¿å®ƒä»¬è½ä¸‹ã€‚</p> <p>å¦‚æœä½ å¯¹ä¼˜åŒ–è¾“å‡ºå¾ˆæ„Ÿå…´è¶£ï¼Œè¯·è¿›å…¥åˆ°ä¸‹ä¸ªæŒ‡å—ï¼Œæ¥äº†è§£ <a href="../production.htm" tppabs="https://webpack.docschina.org/guides/production">ç”Ÿäº§ç¯å¢ƒ</a> æ„å»ºçš„è¯¦ç»†ç»†èŠ‚ã€‚</p> <h1 id="ç”Ÿäº§ç¯å¢ƒ">ç”Ÿäº§ç¯å¢ƒ<a href="#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥ä¸€äº›æœ€ä½³å®è·µå’Œå·¥å…·ï¼Œå°†ç«™ç‚¹æˆ–åº”ç”¨ç¨‹åºæ„å»ºåˆ°ç”Ÿäº§ç¯å¢ƒä¸­ã€‚</p> <blockquote class="tip"> <p>ä»¥ä¸‹ç¤ºä¾‹æ¥æºäº <a href="../tree-shaking.htm" tppabs="https://webpack.docschina.org/guides/tree-shaking">tree shaking</a> å’Œ <a href="../development.htm" tppabs="https://webpack.docschina.org/guides/development">å¼€å‘ç¯å¢ƒ</a>ã€‚åœ¨ç»§ç»­ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²ç»ç†Ÿæ‚‰è¿™äº›æŒ‡å—ä¸­æ‰€ä»‹ç»çš„æ¦‚å¿µ/é…ç½®ã€‚</p> </blockquote> <h2 id="setup">é…ç½® <a href="#setup" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><em>development(å¼€å‘ç¯å¢ƒ)</em> å’Œ <em>production(ç”Ÿäº§ç¯å¢ƒ)</em> è¿™ä¸¤ä¸ªç¯å¢ƒä¸‹çš„æ„å»ºç›®æ ‡å­˜åœ¨ç€å·¨å¤§å·®å¼‚ã€‚åœ¨_å¼€å‘ç¯å¢ƒ_ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ï¼šå¼ºå¤§çš„ source map å’Œä¸€ä¸ªæœ‰ç€ live reloading(å®æ—¶é‡æ–°åŠ è½½) æˆ– hot module replacement(çƒ­æ¨¡å—æ›¿æ¢) èƒ½åŠ›çš„ localhost serverã€‚è€Œ_ç”Ÿäº§ç¯å¢ƒ_ç›®æ ‡åˆ™è½¬ç§»è‡³å…¶ä»–æ–¹é¢ï¼Œå…³æ³¨ç‚¹åœ¨äºå‹ç¼© bundleã€æ›´è½»é‡çš„ source mapã€èµ„æºä¼˜åŒ–ç­‰ï¼Œé€šè¿‡è¿™äº›ä¼˜åŒ–æ–¹å¼æ”¹å–„åŠ è½½æ—¶é—´ã€‚ç”±äºè¦éµå¾ªé€»è¾‘åˆ†ç¦»ï¼Œæˆ‘ä»¬é€šå¸¸å»ºè®®ä¸ºæ¯ä¸ªç¯å¢ƒç¼–å†™__å½¼æ­¤ç‹¬ç«‹çš„ webpack é…ç½®__ã€‚</p> <p>è™½ç„¶ï¼Œä»¥ä¸Šæˆ‘ä»¬å°†_ç”Ÿäº§ç¯å¢ƒ_å’Œ_å¼€å‘ç¯å¢ƒ_åšäº†ç•¥å¾®åŒºåˆ†ï¼Œä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œæˆ‘ä»¬è¿˜æ˜¯ä¼šéµå¾ªä¸é‡å¤åŸåˆ™(Don't repeat yourself - DRY)ï¼Œä¿ç•™ä¸€ä¸ª "common(é€šç”¨)" é…ç½®ã€‚ä¸ºäº†å°†è¿™äº›é…ç½®åˆå¹¶åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸€ä¸ªåä¸º <a href="javascript:if(confirm('https://github.com/survivejs/webpack-merge  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/survivejs/webpack-merge'" tppabs="https://github.com/survivejs/webpack-merge"><code>webpack-merge</code></a> çš„å·¥å…·ã€‚æ­¤å·¥å…·ä¼šå¼•ç”¨ "common" é…ç½®ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…å†åœ¨ç¯å¢ƒç‰¹å®š(environment-specific)çš„é…ç½®ä¸­ç¼–å†™é‡å¤ä»£ç ã€‚</p> <p>æˆ‘ä»¬å…ˆä»å®‰è£… <code>webpack-merge</code> å¼€å§‹ï¼Œå¹¶å°†ä¹‹å‰æŒ‡å—ä¸­å·²ç»æˆå‹çš„é‚£äº›ä»£ç è¿›è¡Œåˆ†ç¦»ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack-merge</code></pre> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> |- webpack.config.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- webpack.common.js
</span><span class="token prefix inserted">+</span><span class="token line"> |- webpack.dev.js
</span><span class="token prefix inserted">+</span><span class="token line"> |- webpack.prod.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- math.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>webpack.common.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const path = require('path');
</span><span class="token prefix inserted">+</span><span class="token line"> const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span><span class="token prefix inserted">+</span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> module.exports = {
</span><span class="token prefix inserted">+</span><span class="token line">   entry: {
</span><span class="token prefix inserted">+</span><span class="token line">     app: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span><span class="token prefix inserted">+</span><span class="token line">   plugins: [
</span><span class="token prefix inserted">+</span><span class="token line">     // å¯¹äº CleanWebpackPlugin çš„ v2 versions ä»¥ä¸‹ç‰ˆæœ¬ï¼Œä½¿ç”¨ new CleanWebpackPlugin(['dist/*'])
</span><span class="token prefix inserted">+</span><span class="token line">     new CleanWebpackPlugin(),
</span><span class="token prefix inserted">+</span><span class="token line">     new HtmlWebpackPlugin({
</span><span class="token prefix inserted">+</span><span class="token line">       title: 'Production',
</span><span class="token prefix inserted">+</span><span class="token line">     }),
</span><span class="token prefix inserted">+</span><span class="token line">   ],
</span><span class="token prefix inserted">+</span><span class="token line">   output: {
</span><span class="token prefix inserted">+</span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix inserted">+</span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span><span class="token prefix inserted">+</span><span class="token line"> };</span></span></code></pre> <p><strong>webpack.dev.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const { merge } = require('webpack-merge');
</span><span class="token prefix inserted">+</span><span class="token line"> const common = require('./webpack.common.js');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> module.exports = merge(common, {
</span><span class="token prefix inserted">+</span><span class="token line">   mode: 'development',
</span><span class="token prefix inserted">+</span><span class="token line">   devtool: 'inline-source-map',
</span><span class="token prefix inserted">+</span><span class="token line">   devServer: {
</span><span class="token prefix inserted">+</span><span class="token line">     contentBase: './dist',
</span><span class="token prefix inserted">+</span><span class="token line">   },
</span><span class="token prefix inserted">+</span><span class="token line"> });</span></span></code></pre> <p><strong>webpack.prod.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const { merge } = require('webpack-merge');
</span><span class="token prefix inserted">+</span><span class="token line"> const common = require('./webpack.common.js');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> module.exports = merge(common, {
</span><span class="token prefix inserted">+</span><span class="token line">   mode: 'production',
</span><span class="token prefix inserted">+</span><span class="token line"> });</span></span></code></pre> <p>ç°åœ¨ï¼Œåœ¨ <code>webpack.common.js</code> ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº† <code>entry</code> å’Œ <code>output</code> é…ç½®ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­å¼•å…¥è¿™ä¸¤ä¸ªç¯å¢ƒå…¬ç”¨çš„å…¨éƒ¨æ’ä»¶ã€‚åœ¨ <code>webpack.dev.js</code> ä¸­ï¼Œæˆ‘ä»¬å°† <code>mode</code> è®¾ç½®ä¸º <code>development</code>ï¼Œå¹¶ä¸”ä¸ºæ­¤ç¯å¢ƒæ·»åŠ äº†æ¨èçš„ <code>devtool</code>ï¼ˆå¼ºå¤§çš„ source mapï¼‰å’Œç®€å•çš„ <code>devServer</code> é…ç½®ã€‚æœ€åï¼Œåœ¨ <code>webpack.prod.js</code> ä¸­ï¼Œæˆ‘ä»¬å°† <code>mode</code> è®¾ç½®ä¸º <code>production</code>ï¼Œå…¶ä¸­ä¼šå¼•å…¥ä¹‹å‰åœ¨ <a href="../tree-shaking.htm" tppabs="https://webpack.docschina.org/guides/tree-shaking">tree shaking</a> æŒ‡å—ä¸­ä»‹ç»è¿‡çš„ <code>TerserPlugin</code>ã€‚</p> <p>æ³¨æ„ï¼Œåœ¨ç¯å¢ƒç‰¹å®šçš„é…ç½®ä¸­ä½¿ç”¨ <code>merge()</code> åŠŸèƒ½ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¼•ç”¨ <code>webpack.dev.js</code> å’Œ <code>webpack.prod.js</code> ä¸­å…¬ç”¨çš„ common é…ç½®ã€‚<code>webpack-merge</code> å·¥å…·æä¾›äº†å„ç§ merge(åˆå¹¶) é«˜çº§åŠŸèƒ½ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬çš„ç”¨ä¾‹ä¸­ï¼Œæ— éœ€ç”¨åˆ°è¿™äº›åŠŸèƒ½ã€‚</p> <h2 id="npm-scripts">NPM Scripts <a href="#npm-scripts" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç°åœ¨ï¼Œæˆ‘ä»¬æŠŠ <code>scripts</code> é‡æ–°æŒ‡å‘åˆ°æ–°é…ç½®ã€‚è®© <code>npm start</code> script ä¸­ <code>webpack-dev-server</code>, ä½¿ç”¨ <code>webpack.dev.js</code>, è€Œè®© <code>npm run build</code> script ä½¿ç”¨ <code>webpack.prod.js</code>:</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> {
</span><span class="token prefix unchanged"> </span><span class="token line">   "name": "development",
</span><span class="token prefix unchanged"> </span><span class="token line">   "version": "1.0.0",
</span><span class="token prefix unchanged"> </span><span class="token line">   "description": "",
</span><span class="token prefix unchanged"> </span><span class="token line">   "main": "src/index.js",
</span><span class="token prefix unchanged"> </span><span class="token line">   "scripts": {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     "start": "webpack serve --open",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     "start": "webpack serve --open --config webpack.dev.js",
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     "build": "webpack"
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     "build": "webpack --config webpack.prod.js"
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   "keywords": [],
</span><span class="token prefix unchanged"> </span><span class="token line">   "author": "",
</span><span class="token prefix unchanged"> </span><span class="token line">   "license": "ISC",
</span><span class="token prefix unchanged"> </span><span class="token line">   "devDependencies": {
</span><span class="token prefix unchanged"> </span><span class="token line">     "clean-webpack-plugin": "^0.1.17",
</span><span class="token prefix unchanged"> </span><span class="token line">     "css-loader": "^0.28.4",
</span><span class="token prefix unchanged"> </span><span class="token line">     "csv-loader": "^2.1.1",
</span><span class="token prefix unchanged"> </span><span class="token line">     "express": "^4.15.3",
</span><span class="token prefix unchanged"> </span><span class="token line">     "file-loader": "^0.11.2",
</span><span class="token prefix unchanged"> </span><span class="token line">     "html-webpack-plugin": "^2.29.0",
</span><span class="token prefix unchanged"> </span><span class="token line">     "style-loader": "^0.18.2",
</span><span class="token prefix unchanged"> </span><span class="token line">     "webpack": "^4.30.0",
</span><span class="token prefix unchanged"> </span><span class="token line">     "webpack-dev-middleware": "^1.12.0",
</span><span class="token prefix unchanged"> </span><span class="token line">     "webpack-dev-server": "^2.9.1",
</span><span class="token prefix unchanged"> </span><span class="token line">     "webpack-merge": "^4.1.0",
</span><span class="token prefix unchanged"> </span><span class="token line">     "xml-loader": "^1.2.1"
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <p>éšä¾¿è¿è¡Œä¸‹è¿™äº›è„šæœ¬ï¼Œç„¶åæŸ¥çœ‹è¾“å‡ºç»“æœçš„å˜åŒ–ï¼Œç„¶åæˆ‘ä»¬ä¼šç»§ç»­æ·»åŠ ä¸€äº›_ç”Ÿäº§ç¯å¢ƒ_é…ç½®ã€‚</p> <h2 id="specify-the-mode">æŒ‡å®š mode <a href="#specify-the-mode" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>è®¸å¤š library é€šè¿‡ä¸ <code>process.env.NODE_ENV</code> ç¯å¢ƒå˜é‡å…³è”ï¼Œä»¥å†³å®š library ä¸­åº”è¯¥å¼•ç”¨å“ªäº›å†…å®¹ã€‚ä¾‹å¦‚ï¼Œå½“<code>process.env.NODE_ENV</code> æ²¡æœ‰è¢«è®¾ç½®ä¸º <code>'production'</code> æ—¶ï¼ŒæŸäº› library ä¸ºäº†ä½¿è°ƒè¯•å˜å¾—å®¹æ˜“ï¼Œå¯èƒ½ä¼šæ·»åŠ é¢å¤–çš„ log(æ—¥å¿—è®°å½•) å’Œ test(æµ‹è¯•) åŠŸèƒ½ã€‚å¹¶ä¸”ï¼Œåœ¨ä½¿ç”¨ <code>process.env.NODE_ENV === 'production'</code> æ—¶ï¼Œä¸€äº› library å¯èƒ½é’ˆå¯¹å…·ä½“ç”¨æˆ·çš„ç¯å¢ƒï¼Œåˆ é™¤æˆ–æ·»åŠ ä¸€äº›é‡è¦ä»£ç ï¼Œä»¥è¿›è¡Œä»£ç æ‰§è¡Œæ–¹é¢çš„ä¼˜åŒ–ã€‚ä» webpack v4 å¼€å§‹, æŒ‡å®š <a href="../../configuration/mode/index.htm" tppabs="https://webpack.docschina.org/configuration/mode/"><code>mode</code></a> ä¼šè‡ªåŠ¨åœ°é…ç½® <a href="../../plugins/define-plugin.htm" tppabs="https://webpack.docschina.org/plugins/define-plugin"><code>DefinePlugin</code></a>ï¼š</p> <p><strong>webpack.prod.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const { merge } = require('webpack-merge');
</span><span class="token prefix unchanged"> </span><span class="token line"> const common = require('./webpack.common.js');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = merge(common, {
</span><span class="token prefix unchanged"> </span><span class="token line">   mode: 'production',
</span><span class="token prefix unchanged"> </span><span class="token line"> });</span></span></code></pre> <blockquote class="tip"> <p>æŠ€æœ¯ä¸Šè®²ï¼Œ<code>NODE_ENV</code> æ˜¯ä¸€ä¸ªç”± Node.js æš´éœ²ç»™æ‰§è¡Œè„šæœ¬çš„ç³»ç»Ÿç¯å¢ƒå˜é‡ã€‚é€šå¸¸ç”¨äºå†³å®šåœ¨å¼€å‘ç¯å¢ƒä¸ç”Ÿäº§ç¯å¢ƒ(dev-vs-prod)ä¸‹ï¼Œserver tools(æœåŠ¡æœŸå·¥å…·)ã€build scripts(æ„å»ºè„šæœ¬) å’Œ client-side libraries(å®¢æˆ·ç«¯åº“) çš„è¡Œä¸ºã€‚ç„¶è€Œï¼Œä¸é¢„æœŸç›¸åï¼Œåœ¨æ„å»ºè„šæœ¬ <code>webpack.config.js</code> ä¸­<code>process.env.NODE_ENV</code> å¹¶æ²¡æœ‰è¢«è®¾ç½®ä¸º <code>"production"</code>ï¼Œè¯·æŸ¥çœ‹ <a href="javascript:if(confirm('https://github.com/webpack/webpack/issues/2537  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack/issues/2537'" tppabs="https://github.com/webpack/webpack/issues/2537">#2537</a>ã€‚å› æ­¤ï¼Œåœ¨ webpack é…ç½®æ–‡ä»¶ä¸­ï¼Œ<code>process.env.NODE_ENV === 'production' ? '[name].[contenthash].bundle.js' : '[name].bundle.js'</code> è¿™æ ·çš„æ¡ä»¶è¯­å¥ï¼Œæ— æ³•æŒ‰ç…§é¢„æœŸè¿è¡Œã€‚</p> </blockquote> <p>å¦‚æœä½ æ­£åœ¨ä½¿ç”¨åƒ <a href="javascript:if(confirm('https://react.docchina.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://react.docchina.org/'" tppabs="https://react.docchina.org/"><code>react</code></a> è¿™æ ·çš„ libraryï¼Œé‚£ä¹ˆåœ¨æ·»åŠ æ­¤ DefinePlugin æ’ä»¶åï¼Œä½ åº”è¯¥çœ‹åˆ° bundle å¤§å°æ˜¾è‘—ä¸‹é™ã€‚è¿˜è¦æ³¨æ„ï¼Œä»»ä½•ä½äº <code>/src</code> çš„æœ¬åœ°ä»£ç éƒ½å¯ä»¥å…³è”åˆ° process.env.NODE_ENV ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥ä»¥ä¸‹æ£€æŸ¥ä¹Ÿæ˜¯æœ‰æ•ˆçš„ï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import { cube } from './math.js';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line"> if (process.env.NODE_ENV !== 'production') {
</span><span class="token prefix inserted">+</span><span class="token line">   console.log('Looks like we are in development mode!');
</span><span class="token prefix inserted">+</span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('pre');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = [
</span><span class="token prefix unchanged"> </span><span class="token line">     'Hello webpack!',
</span><span class="token prefix unchanged"> </span><span class="token line">     '5 cubed is equal to ' + cube(5)
</span><span class="token prefix unchanged"> </span><span class="token line">   ].join('\n\n');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <h2 id="minification">å‹ç¼©(Minification) <a href="#minification" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>webpack v4+ will minify your code by default in <a href="../../configuration/mode/index.htm#mode-production" tppabs="https://webpack.docschina.org/configuration/mode/#mode-production"><code>production mode</code></a>.</p> <p>æ³¨æ„ï¼Œè™½ç„¶ç”Ÿäº§ç¯å¢ƒä¸‹é»˜è®¤ä½¿ç”¨ <a href="../../plugins/terser-webpack-plugin.htm" tppabs="https://webpack.docschina.org/plugins/terser-webpack-plugin"><code>TerserPlugin</code></a> ï¼Œå¹¶ä¸”ä¹Ÿæ˜¯ä»£ç å‹ç¼©æ–¹é¢æ¯”è¾ƒå¥½çš„é€‰æ‹©ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€äº›å…¶ä»–å¯é€‰æ‹©é¡¹ã€‚ä»¥ä¸‹æœ‰å‡ ä¸ªåŒæ ·å¾ˆå—æ¬¢è¿çš„æ’ä»¶ï¼š</p> <ul> <li><a href="javascript:if(confirm('https://github.com/webpack-contrib/closure-webpack-plugin  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack-contrib/closure-webpack-plugin'" tppabs="https://github.com/webpack-contrib/closure-webpack-plugin"><code>ClosureWebpackPlugin</code></a></li> </ul> <p>å¦‚æœå†³å®šå°è¯•ä¸€äº›å…¶ä»–å‹ç¼©æ’ä»¶ï¼Œåªè¦ç¡®ä¿æ–°æ’ä»¶ä¹Ÿä¼šæŒ‰ç…§ <a href="../tree-shaking.htm" tppabs="https://webpack.docschina.org/guides/tree-shaking">tree shake</a> æŒ‡å—ä¸­æ‰€é™ˆè¿°çš„å…·æœ‰åˆ é™¤æœªå¼•ç”¨ä»£ç (dead code)çš„èƒ½åŠ›ï¼Œå¹¶å°†å®ƒä½œä¸º <a href="../../configuration/optimization/index.htm#optimization-minimizer" tppabs="https://webpack.docschina.org/configuration/optimization/#optimization-minimizer"><code>optimization.minimizer</code></a>ã€‚</p> <h2 id="source-mapping">æºç æ˜ å°„(Source Mapping) <a href="#source-mapping" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æˆ‘ä»¬é¼“åŠ±ä½ åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯ç”¨ source mapï¼Œå› ä¸ºå®ƒä»¬å¯¹ debug(è°ƒè¯•æºç ) å’Œè¿è¡Œ benchmark tests(åŸºå‡†æµ‹è¯•) å¾ˆæœ‰å¸®åŠ©ã€‚è™½ç„¶æœ‰ç€å¦‚æ­¤å¼ºå¤§çš„åŠŸèƒ½ï¼Œç„¶è€Œè¿˜æ˜¯åº”è¯¥é’ˆå¯¹ç”Ÿäº§ç¯å¢ƒç”¨é€”ï¼Œé€‰æ‹©ä¸€ä¸ªå¯ä»¥å¿«é€Ÿæ„å»ºçš„æ¨èé…ç½®ï¼ˆæ›´å¤šé€‰é¡¹è¯·æŸ¥çœ‹ <a href="../../configuration/devtool.htm" tppabs="https://webpack.docschina.org/configuration/devtool"><code>devtool</code></a>ï¼‰ã€‚å¯¹äºæœ¬æŒ‡å—ï¼Œæˆ‘ä»¬å°†åœ¨_ç”Ÿäº§ç¯å¢ƒ_ä¸­ä½¿ç”¨ <code>source-map</code> é€‰é¡¹ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬åœ¨_å¼€å‘ç¯å¢ƒ_ä¸­ç”¨åˆ°çš„ <code>inline-source-map</code>ï¼š</p> <p><strong>webpack.prod.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const { merge } = require('webpack-merge');
</span><span class="token prefix unchanged"> </span><span class="token line"> const common = require('./webpack.common.js');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = merge(common, {
</span><span class="token prefix unchanged"> </span><span class="token line">   mode: 'production',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   devtool: 'source-map',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> });</span></span></code></pre> <blockquote class="tip"> <p>é¿å…åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ <code>inline-***</code> å’Œ <code>eval-***</code>ï¼Œå› ä¸ºå®ƒä»¬ä¼šå¢åŠ  bundle ä½“ç§¯å¤§å°ï¼Œå¹¶é™ä½æ•´ä½“æ€§èƒ½ã€‚</p> </blockquote> <h2 id="minimize-css">å‹ç¼© CSS <a href="#minimize-css" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å°†ç”Ÿäº§ç¯å¢ƒä¸‹çš„ CSS è¿›è¡Œå‹ç¼©ä¼šéå¸¸é‡è¦ï¼Œè¯·æŸ¥çœ‹ <a href="../../plugins/mini-css-extract-plugin/index.htm#minimizing-for-production" tppabs="https://webpack.docschina.org/plugins/mini-css-extract-plugin/#minimizing-for-production">åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å‹ç¼©</a> ç« èŠ‚ã€‚</p> <h2 id="cli-alternatives">CLI æ›¿ä»£é€‰é¡¹ <a href="#cli-alternatives" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä»¥ä¸Šæ‰€è¿°ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå®ç°ã€‚ä¾‹å¦‚ï¼Œ<code>--optimize-minimize</code> æ ‡è®°å°†åœ¨å¹•åå¼•ç”¨ <code>TerserPlugin</code>ã€‚å’Œä»¥ä¸Šæè¿°çš„ <code>DefinePlugin</code> å®ä¾‹ç›¸åŒï¼Œ<code>--define process.env.NODE_ENV="'production'"</code> ä¹Ÿä¼šåšåŒæ ·çš„äº‹æƒ…ã€‚è€Œä¸”ï¼Œ<code>webpack -p</code> å°†è‡ªåŠ¨åœ°é…ç½®ä¸Šè¿°è¿™ä¸¤ä¸ªæ ‡è®°ï¼Œä»è€Œè°ƒç”¨éœ€è¦å¼•å…¥çš„æ’ä»¶ã€‚</p> <p>è™½ç„¶è¿™ç§ç®€å†™æ–¹å¼å¾ˆå¥½ï¼Œä½†é€šå¸¸æˆ‘ä»¬å»ºè®®åªä½¿ç”¨é…ç½®æ–¹å¼ï¼Œå› ä¸ºåœ¨è¿™ä¸¤ç§æ–¹å¼ä¸­ï¼Œé…ç½®æ–¹å¼èƒ½å¤Ÿæ›´å‡†ç¡®åœ°ç†è§£ç°åœ¨æ­£åœ¨åšçš„äº‹æƒ…ã€‚é…ç½®æ–¹å¼è¿˜ä¸ºå¯ä»¥è®©ä½ æ›´åŠ ç»†å¾®åœ°æ§åˆ¶è¿™ä¸¤ä¸ªæ’ä»¶ä¸­çš„å…¶ä»–é€‰é¡¹ã€‚</p> <h1 id="æ‡’åŠ è½½">æ‡’åŠ è½½<a href="#%E6%87%92%E5%8A%A0%E8%BD%BD" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote class="tip"> <p>æœ¬æŒ‡å—ç»§æ‰¿è‡ª<a href="../code-splitting.htm" tppabs="https://webpack.docschina.org/guides/code-splitting">ä»£ç åˆ†ç¦»</a>ã€‚å¦‚æœä½ å°šæœªé˜…è¯»è¯¥æŒ‡å—ï¼Œè¯·å…ˆè¡Œé˜…è¯»ã€‚</p> </blockquote> <p>æ‡’åŠ è½½æˆ–è€…æŒ‰éœ€åŠ è½½ï¼Œæ˜¯ä¸€ç§å¾ˆå¥½çš„ä¼˜åŒ–ç½‘é¡µæˆ–åº”ç”¨çš„æ–¹å¼ã€‚è¿™ç§æ–¹å¼å®é™…ä¸Šæ˜¯å…ˆæŠŠä½ çš„ä»£ç åœ¨ä¸€äº›é€»è¾‘æ–­ç‚¹å¤„åˆ†ç¦»å¼€ï¼Œç„¶ååœ¨ä¸€äº›ä»£ç å—ä¸­å®ŒæˆæŸäº›æ“ä½œåï¼Œç«‹å³å¼•ç”¨æˆ–å³å°†å¼•ç”¨å¦å¤–ä¸€äº›æ–°çš„ä»£ç å—ã€‚è¿™æ ·åŠ å¿«äº†åº”ç”¨çš„åˆå§‹åŠ è½½é€Ÿåº¦ï¼Œå‡è½»äº†å®ƒçš„æ€»ä½“ä½“ç§¯ï¼Œå› ä¸ºæŸäº›ä»£ç å—å¯èƒ½æ°¸è¿œä¸ä¼šè¢«åŠ è½½ã€‚</p> <h2 id="example">ç¤ºä¾‹ <a href="#example" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æˆ‘ä»¬åœ¨<a href="../code-splitting.htm#dynamic-imports" tppabs="https://webpack.docschina.org/guides/code-splitting#dynamic-imports">ä»£ç åˆ†ç¦»</a>ä¸­çš„ä¾‹å­åŸºç¡€ä¸Šï¼Œè¿›ä¸€æ­¥åšäº›è°ƒæ•´æ¥è¯´æ˜è¿™ä¸ªæ¦‚å¿µã€‚é‚£é‡Œçš„ä»£ç ç¡®å®ä¼šåœ¨è„šæœ¬è¿è¡Œçš„æ—¶å€™äº§ç”Ÿä¸€ä¸ªåˆ†ç¦»çš„ä»£ç å— <code>lodash.bundle.js</code> ï¼Œåœ¨æŠ€æœ¯æ¦‚å¿µä¸Šâ€œæ‡’åŠ è½½â€å®ƒã€‚é—®é¢˜æ˜¯åŠ è½½è¿™ä¸ªåŒ…å¹¶ä¸éœ€è¦ç”¨æˆ·çš„äº¤äº’ -- æ„æ€æ˜¯æ¯æ¬¡åŠ è½½é¡µé¢çš„æ—¶å€™éƒ½ä¼šè¯·æ±‚å®ƒã€‚è¿™æ ·åšå¹¶æ²¡æœ‰å¯¹æˆ‘ä»¬æœ‰å¾ˆå¤šå¸®åŠ©ï¼Œè¿˜ä¼šå¯¹æ€§èƒ½äº§ç”Ÿè´Ÿé¢å½±å“ã€‚</p> <p>æˆ‘ä»¬è¯•è¯•ä¸åŒçš„åšæ³•ã€‚æˆ‘ä»¬å¢åŠ ä¸€ä¸ªäº¤äº’ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®çš„æ—¶å€™ç”¨ console æ‰“å°ä¸€äº›æ–‡å­—ã€‚ä½†æ˜¯ä¼šç­‰åˆ°ç¬¬ä¸€æ¬¡äº¤äº’çš„æ—¶å€™å†åŠ è½½é‚£ä¸ªä»£ç å—ï¼ˆ<code>print.js</code>ï¼‰ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è¿”å›åˆ°ä»£ç åˆ†ç¦»çš„ä¾‹å­ä¸­ï¼ŒæŠŠ <code>lodash</code> æ”¾åˆ°ä¸»ä»£ç å—ä¸­ï¼Œé‡æ–°è¿è¡Œ_ä»£ç åˆ†ç¦»_ä¸­çš„ä»£ç  <a href="../code-splitting.htm#dynamic-imports" tppabs="https://webpack.docschina.org/guides/code-splitting#dynamic-imports">final <em>Dynamic Imports</em> example</a>ã€‚</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- print.js
</span></span>|- /node_modules</code></pre> <p><strong>src/print.js</strong></p> <pre><code class="hljs language-js">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'The print.js module has loaded! See the network tab in dev tools...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Button Clicked: Here\'s "some text"!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> async function getComponent() {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> function component() {
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   const _ = await import(/* webpackChunkName: "lodash" */ 'lodash');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const button = document.createElement('button');
</span><span class="token prefix inserted">+</span><span class="token line">   const br = document.createElement('br');
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   button.innerHTML = 'Click me and look at the console!';
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   element.appendChild(br);
</span><span class="token prefix inserted">+</span><span class="token line">   element.appendChild(button);
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">   // Note that because a network request is involved, some indication
</span><span class="token prefix inserted">+</span><span class="token line">   // of loading would need to be shown in a production-level site/app.
</span><span class="token prefix inserted">+</span><span class="token line">   button.onclick = e => import(/* webpackChunkName: "print" */ './print').then(module => {
</span><span class="token prefix inserted">+</span><span class="token line">     const print = module.default;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">     print();
</span><span class="token prefix inserted">+</span><span class="token line">   });
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> getComponent().then(component => {
</span><span class="token prefix deleted">-</span><span class="token line">   document.body.appendChild(component);
</span><span class="token prefix deleted">-</span><span class="token line"> });
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <blockquote class="warning"> <p>æ³¨æ„å½“è°ƒç”¨ ES6 æ¨¡å—çš„ <code>import()</code> æ–¹æ³•ï¼ˆå¼•å…¥æ¨¡å—ï¼‰æ—¶ï¼Œå¿…é¡»æŒ‡å‘æ¨¡å—çš„ <code>.default</code> å€¼ï¼Œå› ä¸ºå®ƒæ‰æ˜¯ promise è¢«å¤„ç†åè¿”å›çš„å®é™…çš„ <code>module</code> å¯¹è±¡ã€‚</p> </blockquote> <p>ç°åœ¨è¿è¡Œ webpack æ¥éªŒè¯ä¸€ä¸‹æˆ‘ä»¬çš„æ‡’åŠ è½½åŠŸèƒ½ï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
          Asset       Size  Chunks                    Chunk Names
print.bundle.js  <span class="token number">417</span> bytes       <span class="token number">0</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>         print
index.bundle.js     <span class="token number">548</span> kB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  index
     index.html  <span class="token number">189</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <h2 id="frameworks">æ¡†æ¶ <a href="#frameworks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>è®¸å¤šæ¡†æ¶å’Œç±»åº“å¯¹äºå¦‚ä½•ç”¨å®ƒä»¬è‡ªå·±çš„æ–¹å¼æ¥å®ç°ï¼ˆæ‡’åŠ è½½ï¼‰éƒ½æœ‰è‡ªå·±çš„å»ºè®®ã€‚è¿™é‡Œæœ‰ä¸€äº›ä¾‹å­ï¼š</p> <ul> <li>React: <a href="javascript:if(confirm('https://reacttraining.com/react-router/web/guides/code-splitting  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://reacttraining.com/react-router/web/guides/code-splitting'" tppabs="https://reacttraining.com/react-router/web/guides/code-splitting">Code Splitting and Lazy Loading</a></li> <li>Vue: <a href="javascript:if(confirm('https://vuedose.tips/tips/dynamic-imports-in-vue-js-for-better-performance/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://vuedose.tips/tips/dynamic-imports-in-vue-js-for-better-performance/'" tppabs="https://vuedose.tips/tips/dynamic-imports-in-vue-js-for-better-performance/">Dynamic Imports in Vue.js for better performance</a></li> <li>Angular: <a href="javascript:if(confirm('https://angular.io/guide/router  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://angular.io/guide/router#milestone-6-asynchronous-routing'" tppabs="https://angular.io/guide/router#milestone-6-asynchronous-routing">Lazy Loading route configuration</a> and <a href="javascript:if(confirm('https://medium.com/@var_bin/angularjs-webpack-lazyload-bb7977f390dd  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://medium.com/@var_bin/angularjs-webpack-lazyload-bb7977f390dd'" tppabs="https://medium.com/@var_bin/angularjs-webpack-lazyload-bb7977f390dd">AngularJS + webpack = lazyLoad</a></li> </ul> <h1 id="ECMAScript-Modules">ECMAScript Modules<a href="#ECMAScript-Modules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>ECMAScript Modules (ESM) is a <a href="javascript:if(confirm('https://tc39.github.io/ecma262/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://tc39.github.io/ecma262/#sec-modules'" tppabs="https://tc39.github.io/ecma262/#sec-modules">specification</a> for using Modules in the Web. It's supported by all modern browsers and the recommended way of writing modular code for the Web.</p> <p>webpack supported processing ECMAScript Modules to optimize them.</p> <h2 id="Exporting">Exporting<a href="#Exporting" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>The <code>export</code> keyword allows to expose things from an ESM to other modules:</p> <pre><code class="hljs language-js"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">CONSTANT</span> <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">let</span> variable <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token comment">// only reading is exposed</span>
<span class="token comment">// it's not possible to modify the variable from outside</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'fun'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token keyword">extends</span> <span class="token class-name">Super</span> <span class="token punctuation">{</span>
  <span class="token function">method</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'method'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> other<span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> other <span class="token keyword">as</span> c <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token number">1</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">+</span> <span class="token function">more</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h2 id="Importing">Importing<a href="#Importing" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>The <code>import</code> keyword allows to get references to things from other modules into an ESM:</p> <pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token constant">CONSTANT</span><span class="token punctuation">,</span> variable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./module.js'</span><span class="token punctuation">;</span>
<span class="token comment">// import "bindings" to exports from another module</span>
<span class="token comment">// these bindings are live. The values are not copied,</span>
<span class="token comment">// instead accessing "variable" will get the current value</span>
<span class="token comment">// in the imported module</span>

<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> module <span class="token keyword">from</span> <span class="token string">'./module.js'</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span><span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// import the "namespace object" which contains all exports</span>

<span class="token keyword">import</span> theDefaultValue <span class="token keyword">from</span> <span class="token string">'./module.js'</span><span class="token punctuation">;</span>
<span class="token comment">// shortcut to import the "default" export</span></code></pre> <h2 id="Flagging-modules-are-ESM">Flagging modules are ESM<a href="#Flagging-modules-are-ESM" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>By default webpack will automatically detect whether a file is an ESM or a different module system.</p> <p>Node.js established a way of explicitly setting the module type of files by using a property in the <code>package.json</code>. Setting <code>"type": "module"</code> in a package.json does force all files below this package.json to be ECMAScript Modules. Setting <code>"type": "commonjs"</code> will instead force them to be CommonJS Modules.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span>
<span class="token punctuation">}</span></code></pre> <p>In addition to that, files can set the module type by using <code>.mjs</code> or <code>.cjs</code> extension. <code>.mjs</code> will force them to be ESM, <code>.cjs</code> force them to be CommonJs.</p> <p>In DataURIs using the <code>text/javascript</code> or <code>application/javascript</code> mime type will also force module type to ESM.</p> <p>In addition to the module format, flagging modules as ESM also affect the resolving logic, interop logic and the available symbols in modules.</p> <p>Imports in ESM are resolved more strictly. Relative requests must include a filename and file extension.</p> <blockquote class="tip"> <p>Requests to packages e.g. <code>import "lodash"</code> are still supported.</p> </blockquote> <p>Only the "default" export can be imported from non-ESM. Named exports are not available.</p> <p>CommonJs Syntax is not available: <code>require</code>, <code>module</code>, <code>exports</code>, <code>__filename</code>, <code>__dirname</code>.</p> <blockquote class="tip"> <p>HMR can be used with <code>import.meta.webpackHot</code> instead of <code>module.hot</code>.</p> </blockquote> <h1 id="Shimming-é¢„ç½®ä¾èµ–">Shimming é¢„ç½®ä¾èµ–<a href="#Shimming-%E9%A2%84%E7%BD%AE%E4%BE%9D%E8%B5%96" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p><code>webpack</code> compiler èƒ½å¤Ÿè¯†åˆ«éµå¾ª ES2015 æ¨¡å—è¯­æ³•ã€CommonJS æˆ– AMD è§„èŒƒç¼–å†™çš„æ¨¡å—ã€‚ç„¶è€Œï¼Œä¸€äº› third party(ç¬¬ä¸‰æ–¹åº“) å¯èƒ½ä¼šå¼•ç”¨ä¸€äº›å…¨å±€ä¾èµ–ï¼ˆä¾‹å¦‚ <code>jQuery</code> ä¸­çš„ <code>$</code>ï¼‰ã€‚å› æ­¤è¿™äº› library ä¹Ÿå¯èƒ½ä¼šåˆ›å»ºä¸€äº›éœ€è¦å¯¼å‡ºçš„å…¨å±€å˜é‡ã€‚è¿™äº› "broken modules(ä¸ç¬¦åˆè§„èŒƒçš„æ¨¡å—)" å°±æ˜¯ <em>shimming(é¢„ç½®ä¾èµ–)</em> å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ã€‚</p> <blockquote class="warning"> <p>__æˆ‘ä»¬ä¸æ¨èä½¿ç”¨å…¨å±€ä¾èµ–ï¼__webpack èƒŒåçš„æ•´ä¸ªç†å¿µæ˜¯ä½¿å‰ç«¯å¼€å‘æ›´åŠ æ¨¡å—åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œéœ€è¦ç¼–å†™å…·æœ‰è‰¯å¥½çš„å°é—­æ€§(well contained)ã€ä¸ä¾èµ–äºéšå«ä¾èµ–ï¼ˆä¾‹å¦‚ï¼Œå…¨å±€å˜é‡ï¼‰çš„å½¼æ­¤éš”ç¦»çš„æ¨¡å—ã€‚è¯·åªåœ¨å¿…è¦çš„æ—¶å€™æ‰ä½¿ç”¨è¿™äº›ç‰¹æ€§ã€‚</p> </blockquote> <p><em>shim</em> å¦å¤–ä¸€ä¸ªæå…¶æœ‰ç”¨çš„ä½¿ç”¨åœºæ™¯å°±æ˜¯ï¼šå½“ä½ å¸Œæœ› <a href="javascript:if(confirm('https://en.wikipedia.org/wiki/Polyfill_(programming)  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://en.wikipedia.org/wiki/Polyfill_(programming)'" tppabs="https://en.wikipedia.org/wiki/Polyfill_(programming)">polyfill</a> æ‰©å±•æµè§ˆå™¨èƒ½åŠ›ï¼Œæ¥æ”¯æŒåˆ°æ›´å¤šç”¨æˆ·æ—¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½åªæ˜¯æƒ³è¦å°†è¿™äº› polyfills æä¾›ç»™éœ€è¦ä¿®è¡¥(patch)çš„æµè§ˆå™¨ï¼ˆä¹Ÿå°±æ˜¯å®ç°æŒ‰éœ€åŠ è½½ï¼‰ã€‚</p> <p>ä¸‹é¢çš„æ–‡ç« å°†å‘æˆ‘ä»¬å±•ç¤ºè¿™ä¸¤ç§ç”¨ä¾‹ã€‚</p> <blockquote class="tip"> <p>ä¸ºäº†æ–¹ä¾¿ï¼Œæœ¬æŒ‡å—ç»§ç»­æ²¿ç”¨ <a href="../getting-started.htm" tppabs="https://webpack.docschina.org/guides/getting-started">èµ·æ­¥</a> ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚åœ¨ç»§ç»­ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²ç»ç†Ÿæ‚‰è¿™äº›é…ç½®ã€‚</p> </blockquote> <h2 id="shimming-globals">Shimming é¢„ç½®å…¨å±€å˜é‡ <a href="#shimming-globals" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>è®©æˆ‘ä»¬å¼€å§‹ç¬¬ä¸€ä¸ª shimming å…¨å±€å˜é‡çš„ç”¨ä¾‹ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå…ˆçœ‹ä¸‹æˆ‘ä»¬çš„é¡¹ç›®ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff">webpack-demo
|- package.json
|- webpack.config.js
|- /dist
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.html
</span></span>|- /src
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- index.js
</span></span>|- /node_modules</code></pre> <p>è¿˜è®°å¾—æˆ‘ä»¬ä¹‹å‰ç”¨è¿‡çš„ <code>lodash</code> å—ï¼Ÿå‡ºäºæ¼”ç¤ºç›®çš„ï¼Œä¾‹å¦‚æŠŠè¿™ä¸ªåº”ç”¨ç¨‹åºä¸­çš„æ¨¡å—ä¾èµ–ï¼Œæ”¹ä¸ºä¸€ä¸ªå…¨å±€å˜é‡ä¾èµ–ã€‚è¦å®ç°è¿™äº›ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>ProvidePlugin</code> æ’ä»¶ã€‚</p> <p>ä½¿ç”¨ <a href="../../plugins/provide-plugin.htm" tppabs="https://webpack.docschina.org/plugins/provide-plugin"><code>ProvidePlugin</code></a> åï¼Œèƒ½å¤Ÿåœ¨ webpack ç¼–è¯‘çš„æ¯ä¸ªæ¨¡å—ä¸­ï¼Œé€šè¿‡è®¿é—®ä¸€ä¸ªå˜é‡æ¥è·å–ä¸€ä¸ª packageã€‚å¦‚æœ webpack çœ‹åˆ°æ¨¡å—ä¸­ç”¨åˆ°è¿™ä¸ªå˜é‡ï¼Œå®ƒå°†åœ¨æœ€ç»ˆ bundle ä¸­å¼•å…¥ç»™å®šçš„ packageã€‚è®©æˆ‘ä»¬å…ˆç§»é™¤ <code>lodash</code> çš„ <code>import</code> è¯­å¥ï¼Œæ”¹ä¸ºé€šè¿‡æ’ä»¶æä¾›å®ƒï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import _ from 'lodash';
</span><span class="token prefix deleted">-</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  // Lodash, now imported by this script
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const webpack = require('webpack');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  plugins: [
</span><span class="token prefix inserted">+</span><span class="token line">    new webpack.ProvidePlugin({
</span><span class="token prefix inserted">+</span><span class="token line">      _: 'lodash',
</span><span class="token prefix inserted">+</span><span class="token line">    }),
</span><span class="token prefix inserted">+</span><span class="token line">  ],
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>æˆ‘ä»¬æœ¬è´¨ä¸Šæ‰€åšçš„ï¼Œå°±æ˜¯å‘Šè¯‰ webpackâ€¦â€¦</p> <blockquote> <p>å¦‚æœä½ é‡åˆ°äº†è‡³å°‘ä¸€å¤„ç”¨åˆ° <code>_</code> å˜é‡çš„æ¨¡å—å®ä¾‹ï¼Œé‚£è¯·ä½ å°† <code>lodash</code> package å¼•å…¥è¿›æ¥ï¼Œå¹¶å°†å…¶æä¾›ç»™éœ€è¦ç”¨åˆ°å®ƒçš„æ¨¡å—ã€‚</p> </blockquote> <p>è¿è¡Œæˆ‘ä»¬çš„æ„å»ºè„šæœ¬ï¼Œå°†ä¼šçœ‹åˆ°åŒæ ·çš„è¾“å‡ºï¼š</p> <pre><code class="hljs language-bash">$ <span class="token function">npm</span> run build

<span class="token punctuation">..</span>

<span class="token punctuation">[</span>webpack-cli<span class="token punctuation">]</span> Compilation finished
asset main.js <span class="token number">69.1</span> KiB <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span> <span class="token punctuation">[</span>minimized<span class="token punctuation">]</span> <span class="token punctuation">(</span>name: main<span class="token punctuation">)</span> <span class="token number">1</span> related asset
runtime modules <span class="token number">344</span> bytes <span class="token number">2</span> modules
cacheable modules <span class="token number">530</span> KiB
  ./src/index.js <span class="token number">191</span> bytes <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
  ./node_modules/lodash/lodash.js <span class="token number">530</span> KiB <span class="token punctuation">[</span>built<span class="token punctuation">]</span> <span class="token punctuation">[</span>code generated<span class="token punctuation">]</span>
webpack <span class="token number">5.4</span>.0 compiled successfully <span class="token keyword">in</span> <span class="token number">2910</span> ms</code></pre> <p>è¿˜å¯ä»¥ä½¿ç”¨ <code>ProvidePlugin</code> æš´éœ²å‡ºæŸä¸ªæ¨¡å—ä¸­å•ä¸ªå¯¼å‡ºï¼Œé€šè¿‡é…ç½®ä¸€ä¸ªâ€œæ•°ç»„è·¯å¾„â€ï¼ˆä¾‹å¦‚ <code>[module, child, ...children?]</code>ï¼‰å®ç°æ­¤åŠŸèƒ½ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å‡æƒ³å¦‚ä¸‹ï¼Œæ— è®º <code>join</code> æ–¹æ³•åœ¨ä½•å¤„è°ƒç”¨ï¼Œæˆ‘ä»¬éƒ½åªä¼šè·å–åˆ° <code>lodash</code> ä¸­æä¾›çš„ <code>join</code> æ–¹æ³•ã€‚</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const webpack = require('webpack');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new webpack.ProvidePlugin({
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">      _: 'lodash',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      join: ['lodash', 'join'],
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>è¿™æ ·å°±èƒ½å¾ˆå¥½çš„ä¸ <a href="../tree-shaking.htm" tppabs="https://webpack.docschina.org/guides/tree-shaking">tree shaking</a> é…åˆï¼Œå°† <code>lodash</code> library ä¸­çš„å…¶ä½™æ²¡æœ‰ç”¨åˆ°çš„å¯¼å‡ºå»é™¤ã€‚</p> <h2 id="granular-shimming">ç»†ç²’åº¦ Shimming <a href="#granular-shimming" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä¸€äº›é—ç•™æ¨¡å—ä¾èµ–çš„ <code>this</code> æŒ‡å‘çš„æ˜¯ <code>window</code> å¯¹è±¡ã€‚åœ¨æ¥ä¸‹æ¥çš„ç”¨ä¾‹ä¸­ï¼Œè°ƒæ•´æˆ‘ä»¬çš„ <code>index.js</code>ï¼š</p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   // å‡è®¾æˆ‘ä»¬å¤„äº `window` ä¸Šä¸‹æ–‡
</span><span class="token prefix inserted">+</span><span class="token line">   this.alert('Hmmm, this probably isn\'t a great idea...')
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p>å½“æ¨¡å—è¿è¡Œåœ¨ CommonJS ä¸Šä¸‹æ–‡ä¸­ï¼Œè¿™å°†ä¼šå˜æˆä¸€ä¸ªé—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´æ­¤æ—¶çš„ <code>this</code> æŒ‡å‘çš„æ˜¯ <code>module.exports</code>ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ <a href="../../loaders/imports-loader/index.htm" tppabs="https://webpack.docschina.org/loaders/imports-loader/"><code>imports-loader</code></a> è¦†ç›– <code>this</code> æŒ‡å‘ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const webpack = require('webpack');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  module: {
</span><span class="token prefix inserted">+</span><span class="token line">    rules: [
</span><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: require.resolve('./src/index.js'),
</span><span class="token prefix inserted">+</span><span class="token line">        use: 'imports-loader?wrapper=window',
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span><span class="token prefix inserted">+</span><span class="token line">    ],
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new webpack.ProvidePlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      join: ['lodash', 'join'],
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <h2 id="global-exports">å…¨å±€ Exports <a href="#global-exports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>è®©æˆ‘ä»¬å‡è®¾ï¼ŒæŸä¸ª library åˆ›å»ºå‡ºä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒæœŸæœ› consumer(ä½¿ç”¨è€…) ä½¿ç”¨è¿™ä¸ªå˜é‡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®é…ç½®ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªå°æ¨¡å—æ¥æ¼”ç¤ºè¯´æ˜ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- globals.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/globals.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token string">'blah.txt'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> helpers <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">test</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'test something'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">parse</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'parse something'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>ä½ å¯èƒ½ä»æ¥æ²¡æœ‰åœ¨è‡ªå·±çš„æºç ä¸­åšè¿‡è¿™äº›äº‹æƒ…ï¼Œä½†æ˜¯ä½ ä¹Ÿè®¸é‡åˆ°è¿‡ä¸€ä¸ªè€æ—§çš„ libraryï¼Œå’Œä¸Šé¢æ‰€å±•ç¤ºçš„ä»£ç ç±»ä¼¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a href="../../loaders/exports-loader/index.htm" tppabs="https://webpack.docschina.org/loaders/exports-loader/"><code>exports-loader</code></a>ï¼Œå°†ä¸€ä¸ªå…¨å±€å˜é‡ä½œä¸ºä¸€ä¸ªæ™®é€šçš„æ¨¡å—æ¥å¯¼å‡ºã€‚ä¾‹å¦‚ï¼Œä¸ºäº†å°† <code>file</code> å¯¼å‡ºä¸º <code>file</code> ä»¥åŠå°† <code>helpers.parse</code> å¯¼å‡ºä¸º <code>parse</code>ï¼Œåšå¦‚ä¸‹è°ƒæ•´ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const webpack = require('webpack');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">  entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span><span class="token prefix unchanged"> </span><span class="token line">    filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: require.resolve('./src/index.js'),
</span><span class="token prefix unchanged"> </span><span class="token line">        use: 'imports-loader?wrapper=window',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: require.resolve('./src/globals.js'),
</span><span class="token prefix inserted">+</span><span class="token line">        use:
</span><span class="token prefix inserted">+</span><span class="token line">          'exports-loader?type=commonjs&#x26;exports[]=file&#x26;exports[]=multiple|helpers.parse|parse',
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new webpack.ProvidePlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      join: ['lodash', 'join'],
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>æ­¤æ—¶ï¼Œåœ¨æˆ‘ä»¬çš„ entry å…¥å£æ–‡ä»¶ä¸­ï¼ˆå³ <code>src/index.js</code>ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ <code>const { file, parse } = require('./globals.js');</code>ï¼Œå¯ä»¥ä¿è¯ä¸€åˆ‡å°†é¡ºåˆ©è¿è¡Œã€‚</p> <h2 id="loading-polyfills">åŠ è½½ Polyfills <a href="#loading-polyfills" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ç›®å‰ä¸ºæ­¢æˆ‘ä»¬æ‰€è®¨è®ºçš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯å¤„ç†é‚£äº›é—ç•™çš„ packageï¼Œè®©æˆ‘ä»¬è¿›å…¥åˆ°ç¬¬äºŒä¸ªè¯é¢˜ï¼š<strong>polyfill</strong>ã€‚</p> <p>æœ‰å¾ˆå¤šæ–¹æ³•æ¥åŠ è½½ polyfillã€‚ä¾‹å¦‚ï¼Œæƒ³è¦å¼•å…¥ <a href="javascript:if(confirm('https://babel.docschina.org/docs/en/babel-polyfill/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://babel.docschina.org/docs/en/babel-polyfill/'" tppabs="https://babel.docschina.org/docs/en/babel-polyfill/"><code>babel-polyfill</code></a> æˆ‘ä»¬åªéœ€å¦‚ä¸‹æ“ä½œï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save babel-polyfill</code></pre> <p>ç„¶åï¼Œä½¿ç”¨ <code>import</code> å°†å…¶å¼•å…¥åˆ°æˆ‘ä»¬çš„ä¸» bundle æ–‡ä»¶ï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">import 'babel-polyfill';
</span><span class="token prefix inserted">+</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  // Assume we are in the context of `window`
</span><span class="token prefix unchanged"> </span><span class="token line">  this.alert("Hmmm, this probably isn't a great idea...");
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <blockquote class="tip"> <p>æ³¨æ„ï¼Œæˆ‘ä»¬æ²¡æœ‰å°† <code>import</code> ç»‘å®šåˆ°æŸä¸ªå˜é‡ã€‚è¿™æ˜¯å› ä¸º polyfill ç›´æ¥åŸºäºè‡ªèº«æ‰§è¡Œï¼Œå¹¶ä¸”æ˜¯åœ¨åŸºç¡€ä»£ç æ‰§è¡Œä¹‹å‰ï¼Œè¿™æ ·é€šè¿‡è¿™äº›é¢„ç½®ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‡å®šå·²ç»å…·æœ‰æŸäº›åŸç”ŸåŠŸèƒ½ã€‚</p> </blockquote> <p>æ³¨æ„ï¼Œè¿™ç§æ–¹å¼ä¼˜å…ˆè€ƒè™‘æ­£ç¡®æ€§ï¼Œè€Œä¸è€ƒè™‘ bundle ä½“ç§¯å¤§å°ã€‚ä¸ºäº†å®‰å…¨å’Œå¯é ï¼Œpolyfill/shim å¿…é¡»__è¿è¡Œäºæ‰€æœ‰å…¶ä»–ä»£ç ä¹‹å‰__ï¼Œè€Œä¸”éœ€è¦åŒæ­¥åŠ è½½ï¼Œæˆ–è€…è¯´ï¼Œéœ€è¦åœ¨æ‰€æœ‰ polyfill/shim åŠ è½½ä¹‹åï¼Œå†å»åŠ è½½æ‰€æœ‰åº”ç”¨ç¨‹åºä»£ç ã€‚ ç¤¾åŒºä¸­å­˜åœ¨è®¸å¤šè¯¯è§£ï¼Œå³ç°ä»£æµè§ˆå™¨â€œä¸éœ€è¦â€polyfillï¼Œæˆ–è€… polyfill/shim ä»…ç”¨äºæ·»åŠ ç¼ºå¤±åŠŸèƒ½ - å®é™…ä¸Šï¼Œå®ƒä»¬é€šå¸¸ç”¨äº_ä¿®å¤æŸåå®ç°(repair broken implementation)_ï¼Œå³ä½¿æ˜¯åœ¨æœ€ç°ä»£çš„æµè§ˆå™¨ä¸­ï¼Œä¹Ÿä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚ å› æ­¤ï¼Œæœ€ä½³å®è·µä»ç„¶æ˜¯ï¼Œä¸åŠ é€‰æ‹©åœ°å’ŒåŒæ­¥åœ°åŠ è½½æ‰€æœ‰ polyfill/shimï¼Œå°½ç®¡è¿™ä¼šå¯¼è‡´é¢å¤–çš„ bundle ä½“ç§¯æˆæœ¬ã€‚</p> <p>å¦‚æœä½ è®¤ä¸ºè‡ªå·±å·²ç»æ‰“æ¶ˆè¿™äº›é¡¾è™‘ï¼Œå¹¶ä¸”å¸Œæœ›æ‰¿å—æŸåçš„é£é™©ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥çš„è¿™ä»¶äº‹æƒ…ï¼Œå¯èƒ½æ˜¯ä½ åº”è¯¥è¦åšçš„ï¼š æˆ‘ä»¬å°†ä¼šæŠŠ <code>import</code> æ”¾å…¥ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå¹¶åŠ å…¥ <a href="javascript:if(confirm('https://github.com/github/fetch  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/github/fetch'" tppabs="https://github.com/github/fetch"><code>whatwg-fetch</code></a> polyfillï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save whatwg-fetch</code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">import 'babel-polyfill';
</span><span class="token prefix deleted">-</span><span class="token line">
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  // Assume we are in the context of `window`
</span><span class="token prefix unchanged"> </span><span class="token line">  this.alert("Hmmm, this probably isn't a great idea...");
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());</span></span></code></pre> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- globals.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- polyfills.js
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>src/polyfills.js</strong></p> <pre><code class="hljs language-javascript"><span class="token keyword">import</span> <span class="token string">'babel-polyfill'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'whatwg-fetch'</span><span class="token punctuation">;</span></code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line">const webpack = require('webpack');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">module.exports = {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">  entry: './src/index.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  entry: {
</span><span class="token prefix inserted">+</span><span class="token line">    polyfills: './src/polyfills',
</span><span class="token prefix inserted">+</span><span class="token line">    index: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  output: {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    filename: 'main.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename: '[name].bundle.js',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">    path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  module: {
</span><span class="token prefix unchanged"> </span><span class="token line">    rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: require.resolve('./src/index.js'),
</span><span class="token prefix unchanged"> </span><span class="token line">        use: 'imports-loader?wrapper=window',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">        test: require.resolve('./src/globals.js'),
</span><span class="token prefix unchanged"> </span><span class="token line">        use:
</span><span class="token prefix unchanged"> </span><span class="token line">          'exports-loader?type=commonjs&#x26;exports[]=file&#x26;exports[]=multiple|helpers.parse|parse',
</span><span class="token prefix unchanged"> </span><span class="token line">      },
</span><span class="token prefix unchanged"> </span><span class="token line">    ],
</span><span class="token prefix unchanged"> </span><span class="token line">  },
</span><span class="token prefix unchanged"> </span><span class="token line">  plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">    new webpack.ProvidePlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">      join: ['lodash', 'join'],
</span><span class="token prefix unchanged"> </span><span class="token line">    }),
</span><span class="token prefix unchanged"> </span><span class="token line">  ],
</span><span class="token prefix unchanged"> </span><span class="token line">};</span></span></code></pre> <p>å¦‚ä¸Šé…ç½®ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­æ·»åŠ ä¸€äº›é€»è¾‘ï¼Œæœ‰æ¡ä»¶åœ°åŠ è½½æ–°çš„ <code>polyfills.bundle.js</code> æ–‡ä»¶ã€‚æ ¹æ®éœ€è¦æ”¯æŒçš„æŠ€æœ¯å’Œæµè§ˆå™¨æ¥å†³å®šæ˜¯å¦åŠ è½½ã€‚æˆ‘ä»¬å°†åšä¸€äº›ç®€å•çš„è¯•éªŒï¼Œæ¥ç¡®å®šæ˜¯å¦éœ€è¦å¼•å…¥è¿™äº› polyfillï¼š</p> <p><strong>dist/index.html</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">&#x3C;!DOCTYPE html>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;html>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;head>
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;meta charset="utf-8" />
</span><span class="token prefix unchanged"> </span><span class="token line">    &#x3C;title>Getting Started&#x3C;/title>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script>
</span><span class="token prefix inserted">+</span><span class="token line">      const modernBrowser = 'fetch' in window &#x26;&#x26; 'assign' in Object;
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">      if (!modernBrowser) {
</span><span class="token prefix inserted">+</span><span class="token line">        const scriptElement = document.createElement('script');
</span><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">        scriptElement.async = false;
</span><span class="token prefix inserted">+</span><span class="token line">        scriptElement.src = '/polyfills.bundle.js';
</span><span class="token prefix inserted">+</span><span class="token line">        document.head.appendChild(scriptElement);
</span><span class="token prefix inserted">+</span><span class="token line">      }
</span><span class="token prefix inserted">+</span><span class="token line">    &#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/head>
</span><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;body>
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    &#x3C;script src="main.js">&#x3C;/script>
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &#x3C;script src="index.bundle.js">&#x3C;/script>
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">  &#x3C;/body>
</span><span class="token prefix unchanged"> </span><span class="token line">&#x3C;/html></span></span></code></pre> <p>ç°åœ¨ï¼Œåœ¨ entry å…¥å£æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code>fetch</code> è·å–ä¸€äº›æ•°æ®ï¼š</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">  const element = document.createElement('div');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  element.innerHTML = join(['Hello', 'webpack'], ' ');
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  // Assume we are in the context of `window`
</span><span class="token prefix unchanged"> </span><span class="token line">  this.alert("Hmmm, this probably isn't a great idea...");
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">  return element;
</span><span class="token prefix unchanged"> </span><span class="token line">}
</span><span class="token prefix unchanged"> </span><span class="token line">
</span><span class="token prefix unchanged"> </span><span class="token line">document.body.appendChild(component());
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">
</span><span class="token prefix inserted">+</span><span class="token line">fetch('https://jsonplaceholder.typicode.com/users')
</span><span class="token prefix inserted">+</span><span class="token line">  .then((response) => response.json())
</span><span class="token prefix inserted">+</span><span class="token line">  .then((json) => {
</span><span class="token prefix inserted">+</span><span class="token line">    console.log(
</span><span class="token prefix inserted">+</span><span class="token line">      "We retrieved some data! AND we're confident it will work on a variety of browser distributions."
</span><span class="token prefix inserted">+</span><span class="token line">    );
</span><span class="token prefix inserted">+</span><span class="token line">    console.log(json);
</span><span class="token prefix inserted">+</span><span class="token line">  })
</span><span class="token prefix inserted">+</span><span class="token line">  .catch((error) =>
</span><span class="token prefix inserted">+</span><span class="token line">    console.error('Something went wrong when fetching this data: ', error)
</span><span class="token prefix inserted">+</span><span class="token line">  );</span></span></code></pre> <p>æ‰§è¡Œæ„å»ºè„šæœ¬ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæµè§ˆå™¨å‘é€äº†é¢å¤–çš„ <code>polyfills.bundle.js</code> æ–‡ä»¶è¯·æ±‚ï¼Œç„¶åæ‰€æœ‰ä»£ç é¡ºåˆ©æ‰§è¡Œã€‚æ³¨æ„ï¼Œä»¥ä¸Šçš„è¿™äº›è®¾å®šå¯èƒ½è¿˜ä¼šæœ‰æ‰€æ”¹è¿›ï¼Œè¿™é‡Œæˆ‘ä»¬å‘ä½ æä¾›ä¸€ä¸ªå¾ˆæ£’çš„æƒ³æ³•ï¼šå°† polyfill æä¾›ç»™éœ€è¦å¼•å…¥å®ƒçš„ç”¨æˆ·ã€‚</p> <h2 id="further-optimizations">è¿›ä¸€æ­¥ä¼˜åŒ– <a href="#further-optimizations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>babel-preset-env</code> package é€šè¿‡ <a href="javascript:if(confirm('https://github.com/browserslist/browserslist  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/browserslist/browserslist'" tppabs="https://github.com/browserslist/browserslist">browserslist</a> æ¥è½¬è¯‘é‚£äº›ä½ æµè§ˆå™¨ä¸­ä¸æ”¯æŒçš„ç‰¹æ€§ã€‚è¿™ä¸ª preset ä½¿ç”¨ <a href="javascript:if(confirm('https://babel.docschina.org/docs/en/babel-preset-env  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://babel.docschina.org/docs/en/babel-preset-env#usebuiltins'" tppabs="https://babel.docschina.org/docs/en/babel-preset-env#usebuiltins"><code>useBuiltIns</code></a> é€‰é¡¹ï¼Œé»˜è®¤å€¼æ˜¯ <code>false</code>ï¼Œè¿™ç§æ–¹å¼å¯ä»¥å°†å…¨å±€ <code>babel-polyfill</code> å¯¼å…¥ï¼Œæ”¹è¿›ä¸ºæ›´ç»†ç²’åº¦çš„ <code>import</code> æ ¼å¼ï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">import</span> <span class="token string">'core-js/modules/es7.string.pad-start'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'core-js/modules/es7.string.pad-end'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'core-js/modules/web.timers'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'core-js/modules/web.immediate'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'core-js/modules/web.dom.iterable'</span><span class="token punctuation">;</span></code></pre> <p>See <a href="javascript:if(confirm('https://babeljs.io/docs/en/babel-preset-env  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://babeljs.io/docs/en/babel-preset-env'" tppabs="https://babeljs.io/docs/en/babel-preset-env">the babel-preset-env documentation</a> for more information.</p> <h2 id="node-built-ins">Node å†…ç½® <a href="#node-built-ins" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åƒ <code>process</code> è¿™ç§ Node å†…ç½®æ¨¡å—ï¼Œèƒ½ç›´æ¥æ ¹æ®é…ç½®æ–‡ä»¶è¿›è¡Œæ­£ç¡®çš„ polyfillï¼Œè€Œä¸éœ€è¦ä»»ä½•ç‰¹å®šçš„ loader æˆ–è€… pluginã€‚æŸ¥çœ‹ <a href="../../configuration/node.htm" tppabs="https://webpack.docschina.org/configuration/node">node</a> é…ç½®é¡µé¢è·å–æ›´å¤šä¿¡æ¯ã€‚</p> <h2 id="other-utilities">å…¶ä»–å·¥å…· <a href="#other-utilities" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å·¥å…·ï¼Œä¹Ÿèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å¤„ç†è¿™äº›é—ç•™æ¨¡å—ã€‚</p> <p>å¦‚æœè¿™äº›é—ç•™æ¨¡å—æ²¡æœ‰ AMD/CommonJS ç‰ˆæœ¬ï¼Œä½†ä½ ä¹Ÿæƒ³å°†ä»–ä»¬åŠ å…¥ <code>dist</code> æ–‡ä»¶ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <a href="../../configuration/module/index.htm#modulenoparse" tppabs="https://webpack.docschina.org/configuration/module/#modulenoparse"><code>noParse</code></a> æ¥æ ‡è¯†å‡ºè¿™ä¸ªæ¨¡å—ã€‚è¿™æ ·å°±èƒ½ä½¿ webpack å°†å¼•å…¥è¿™äº›æ¨¡å—ï¼Œä½†æ˜¯ä¸è¿›è¡Œè½¬åŒ–(parse)ï¼Œä»¥åŠä¸è§£æ(resolve) <code>require()</code> å’Œ <code>import</code> è¯­å¥ã€‚è¿™ç§ç”¨æ³•è¿˜ä¼šæé«˜æ„å»ºæ€§èƒ½ã€‚</p> <blockquote class="warning"> <p>ä»»ä½•éœ€è¦ AST çš„åŠŸèƒ½ï¼ˆä¾‹å¦‚ <code>ProvidePlugin</code>ï¼‰éƒ½ä¸èµ·ä½œç”¨ã€‚</p> </blockquote> <p>æœ€åï¼Œä¸€äº›æ¨¡å—æ”¯æŒå¤šç§ <a href="../../concepts/modules.htm" tppabs="https://webpack.docschina.org/concepts/modules">æ¨¡å—æ ¼å¼</a>ï¼Œä¾‹å¦‚ä¸€ä¸ªæ··åˆæœ‰ AMDã€CommonJS å’Œ legacy(é—ç•™) çš„æ¨¡å—ã€‚åœ¨å¤§å¤šæ•°è¿™æ ·çš„æ¨¡å—ä¸­ï¼Œä¼šé¦–å…ˆæ£€æŸ¥ <code>define</code>ï¼Œç„¶åä½¿ç”¨ä¸€äº›æ€ªå¼‚ä»£ç å¯¼å‡ºä¸€äº›å±æ€§ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡ <a href="../../loaders/imports-loader/index.htm" tppabs="https://webpack.docschina.org/loaders/imports-loader/"><code>imports-loader</code></a> è®¾ç½® <code>additionalCode=var%define%20=%20false;</code> æ¥å¼ºåˆ¶ CommonJS è·¯å¾„ã€‚</p> <hr> <blockquote class="tip"> <p>è¯‘è€…æ³¨ï¼šshimming æ˜¯ä¸€ä¸ªåº“(library)ï¼Œå®ƒå°†ä¸€ä¸ªæ–°çš„ API å¼•å…¥åˆ°ä¸€ä¸ªæ—§çš„ç¯å¢ƒä¸­ï¼Œè€Œä¸”ä»…é æ—§çš„ç¯å¢ƒä¸­å·²æœ‰çš„æ‰‹æ®µå®ç°ã€‚polyfill å°±æ˜¯ä¸€ä¸ªç”¨åœ¨æµè§ˆå™¨ API ä¸Šçš„ shimmingã€‚æˆ‘ä»¬é€šå¸¸çš„åšæ³•æ˜¯å…ˆæ£€æŸ¥å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒæŸä¸ª APIï¼Œå¦‚æœä¸æ”¯æŒçš„è¯å°±æŒ‰éœ€åŠ è½½å¯¹åº”çš„ polyfillã€‚ç„¶åæ–°æ—§æµè§ˆå™¨å°±éƒ½å¯ä»¥ä½¿ç”¨è¿™ä¸ª API äº†ã€‚</p> </blockquote> <h1 id="TypeScript">TypeScript<a href="#TypeScript" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote class="tip"> <p>æœ¬æŒ‡å—ç»§ç»­æ²¿ç”¨ <a href="../getting-started/index.htm" tppabs="https://webpack.docschina.org/guides/getting-started/"><em>èµ·æ­¥</em></a> ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚</p> </blockquote> <p><a href="javascript:if(confirm('https://www.typescriptlang.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.typescriptlang.org/'" tppabs="https://www.typescriptlang.org/">TypeScript</a> æ˜¯ JavaScript çš„è¶…é›†ï¼Œä¸ºå…¶å¢åŠ äº†ç±»å‹ç³»ç»Ÿï¼Œå¯ä»¥ç¼–è¯‘ä¸ºæ™®é€š JavaScript ä»£ç ã€‚è¿™ç¯‡æŒ‡å—é‡Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ æ˜¯å¦‚ä½•å°† webpack å’Œ TypeScript è¿›è¡Œé›†æˆã€‚</p> <h2 id="basic-setup">åŸºç¡€é…ç½® <a href="#basic-setup" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é¦–å…ˆï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£… TypeScript compiler å’Œ loaderï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev typescript ts-loader</code></pre> <p>ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¿®æ”¹ç›®å½•ç»“æ„å’Œé…ç½®æ–‡ä»¶ï¼š</p> <p><strong>project</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> webpack-demo
</span><span class="token prefix unchanged"> </span><span class="token line"> |- package.json
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> |- tsconfig.json
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- webpack.config.js
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /dist
</span><span class="token prefix unchanged"> </span><span class="token line">   |- bundle.js
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.html
</span><span class="token prefix unchanged"> </span><span class="token line"> |- /src
</span><span class="token prefix unchanged"> </span><span class="token line">   |- index.js
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   |- index.ts
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> |- /node_modules</span></span></code></pre> <p><strong>tsconfig.json</strong></p> <p>è¿™é‡Œæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªåŸºæœ¬çš„é…ç½®ï¼Œæ¥æ”¯æŒ JSXï¼Œå¹¶å°† TypeScript ç¼–è¯‘åˆ° ES5â€¦â€¦</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"outDir"</span><span class="token operator">:</span> <span class="token string">"./dist/"</span><span class="token punctuation">,</span>
    <span class="token property">"noImplicitAny"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"es6"</span><span class="token punctuation">,</span>
    <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"es5"</span><span class="token punctuation">,</span>
    <span class="token property">"jsx"</span><span class="token operator">:</span> <span class="token string">"react"</span><span class="token punctuation">,</span>
    <span class="token property">"allowJs"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>æŸ¥çœ‹ <a href="javascript:if(confirm('https://www.typescriptlang.org/docs/handbook/tsconfig-json.html  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.typescriptlang.org/docs/handbook/tsconfig-json.html'" tppabs="https://www.typescriptlang.org/docs/handbook/tsconfig-json.html">TypeScript å®˜æ–¹æ–‡æ¡£</a> äº†è§£æ›´å¤šå…³äº <code>tsconfig.json</code> çš„é…ç½®é€‰é¡¹ã€‚</p> <p>æƒ³è¦äº†è§£ webpack é…ç½®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="../../concepts/configuration/index.htm" tppabs="https://webpack.docschina.org/concepts/configuration/">é…ç½®</a> æ¦‚å¿µã€‚</p> <p>ç°åœ¨ï¼Œé…ç½® webpack å¤„ç† TypeScriptï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token operator">:</span> <span class="token string">'./src/index.ts'</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.tsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token string">'ts-loader'</span><span class="token punctuation">,</span>
        exclude<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  resolve<span class="token operator">:</span> <span class="token punctuation">{</span>
    extensions<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'.tsx'</span><span class="token punctuation">,</span> <span class="token string">'.ts'</span><span class="token punctuation">,</span> <span class="token string">'.js'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'bundle.js'</span><span class="token punctuation">,</span>
    path<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>è¿™ä¼šè®© webpack ç›´æ¥ä» <code>./index.ts</code> <em>è¿›å…¥</em>ï¼Œç„¶åé€šè¿‡ <code>ts-loader</code> _åŠ è½½_æ‰€æœ‰çš„ <code>.ts</code> å’Œ <code>.tsx</code> æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨å½“å‰ç›®å½•_è¾“å‡º_ä¸€ä¸ª <code>bundle.js</code> æ–‡ä»¶ã€‚</p> <p>ç°åœ¨è®©æˆ‘ä»¬æ”¹å˜ <code>lodash</code> åœ¨ <code>./index.ts</code> æ–‡ä»¶ä¸­çš„å¼•å…¥ï¼Œ å› ä¸ºåœ¨ <code>lodash</code> çš„å®šä¹‰ä¸­æ²¡æœ‰é»˜è®¤(default)çš„å¯¼å‡ºã€‚</p> <p><strong>./index.ts</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import _ from 'lodash';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import * as _ from 'lodash';
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> function component() {
</span><span class="token prefix unchanged"> </span><span class="token line">   const element = document.createElement('div');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   element.innerHTML = _.join(['Hello', 'webpack'], ' ');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   return element;
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> document.body.appendChild(component());</span></span></code></pre> <blockquote class="tip"> <p>å¦‚æœæƒ³åœ¨ TypeScript ä¸­ä¿ç•™å¦‚<code>import _ from 'lodash';</code>çš„è¯­æ³•è¢«è®©å®ƒä½œä¸ºä¸€ç§é»˜è®¤çš„å¯¼å…¥æ–¹å¼ï¼Œéœ€è¦åœ¨æ–‡ä»¶ <strong>tsconfig.json</strong> ä¸­è®¾ç½®<code>"allowSyntheticDefaultImports" : true</code> å’Œ <code>"esModuleInterop" : true</code> ã€‚è¿™ä¸ªæ˜¯ä¸ TypeScript ç›¸å…³çš„é…ç½®ï¼Œåœ¨æœ¬æ–‡æ¡£ä¸­æåŠä»…ä¾›å‚è€ƒã€‚</p> </blockquote> <h2 id="loader">Loader <a href="#loader" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="javascript:if(confirm('https://github.com/TypeStrong/ts-loader  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/TypeStrong/ts-loader'" tppabs="https://github.com/TypeStrong/ts-loader"><code>ts-loader</code></a></p> <p>åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>ts-loader</code>ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿå¾ˆæ–¹ä¾¿åœ°å¯ç”¨é¢å¤–çš„ webpack åŠŸèƒ½ï¼Œä¾‹å¦‚å°†å…¶ä»– web èµ„æºå¯¼å…¥åˆ°é¡¹ç›®ä¸­ã€‚</p> <blockquote class="warning"> <p><code>ts-loader</code> uses <code>tsc</code>, the TypeScript compiler, and relies on your <code>tsconfig.json</code> configuration. Make sure to avoid setting <a href="javascript:if(confirm('https://www.typescriptlang.org/tsconfig  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.typescriptlang.org/tsconfig#module'" tppabs="https://www.typescriptlang.org/tsconfig#module"><code>module</code></a> to "CommonJS", or webpack won't be able to <a href="../tree-shaking.htm" tppabs="https://webpack.docschina.org/guides/tree-shaking">tree-shake your code</a>.</p> </blockquote> <p>Note that if you're already using <a href="javascript:if(confirm('https://github.com/babel/babel-loader  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/babel/babel-loader'" tppabs="https://github.com/babel/babel-loader"><code>babel-loader</code></a> to transpile your code, you can use <a href="javascript:if(confirm('https://babeljs.io/docs/en/babel-preset-typescript  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://babeljs.io/docs/en/babel-preset-typescript'" tppabs="https://babeljs.io/docs/en/babel-preset-typescript"><code>@babel/preset-typescript</code></a> and let Babel handle both your JavaScript and TypeScript files instead of using an additional loader. Keep in mind that, contrary to <code>ts-loader</code>, the underlying <a href="javascript:if(confirm('https://babeljs.io/docs/en/babel-plugin-transform-typescript  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://babeljs.io/docs/en/babel-plugin-transform-typescript'" tppabs="https://babeljs.io/docs/en/babel-plugin-transform-typescript"><code>@babel/plugin-transform-typescript</code></a> plugin does not perform any type checking.</p> <h2 id="source-maps">Source Maps <a href="#source-maps" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æƒ³è¦äº†è§£ source map çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="../development.htm" tppabs="https://webpack.docschina.org/guides/development">å¼€å‘</a> æŒ‡å—ã€‚</p> <p>æƒ³è¦å¯ç”¨ source mapï¼Œæˆ‘ä»¬å¿…é¡»é…ç½® TypeScriptï¼Œä»¥å°†å†…è”çš„ source map è¾“å‡ºåˆ°ç¼–è¯‘åçš„ JavaScript æ–‡ä»¶ä¸­ã€‚å¿…é¡»åœ¨ TypeScript é…ç½®ä¸­æ·»åŠ ä¸‹é¢è¿™è¡Œï¼š</p> <p><strong>tsconfig.json</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> {
</span><span class="token prefix unchanged"> </span><span class="token line">   "compilerOptions": {
</span><span class="token prefix unchanged"> </span><span class="token line">     "outDir": "./dist/",
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     "sourceMap": true,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     "noImplicitAny": true,
</span><span class="token prefix unchanged"> </span><span class="token line">     "module": "commonjs",
</span><span class="token prefix unchanged"> </span><span class="token line">     "target": "es5",
</span><span class="token prefix unchanged"> </span><span class="token line">     "jsx": "react",
</span><span class="token prefix unchanged"> </span><span class="token line">     "allowJs": true
</span><span class="token prefix unchanged"> </span><span class="token line">   }
</span><span class="token prefix unchanged"> </span><span class="token line"> }</span></span></code></pre> <p>ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ webpack æå–è¿™äº› source mapï¼Œå¹¶å†…è”åˆ°æœ€ç»ˆçš„ bundle ä¸­ã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: './src/index.ts',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   devtool: 'inline-source-map',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   module: {
</span><span class="token prefix unchanged"> </span><span class="token line">     rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">       {
</span><span class="token prefix unchanged"> </span><span class="token line">         test: /\.tsx?$/,
</span><span class="token prefix unchanged"> </span><span class="token line">         use: 'ts-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">         exclude: /node_modules/,
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">     ],
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   resolve: {
</span><span class="token prefix unchanged"> </span><span class="token line">     extensions: [ '.tsx', '.ts', '.js' ],
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: 'bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>æŸ¥çœ‹ <a href="../../configuration/devtool/index.htm" tppabs="https://webpack.docschina.org/configuration/devtool/">devtool</a> æ–‡æ¡£ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚</p> <h2 id="using-third-party-libraries">ä½¿ç”¨ç¬¬ä¸‰æ–¹ç±»åº“ <a href="#using-third-party-libraries" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨ä» npm å®‰è£… third party library(ç¬¬ä¸‰æ–¹åº“) æ—¶ï¼Œä¸€å®šè¦è®°å¾—åŒæ—¶å®‰è£…æ­¤ library çš„ç±»å‹å£°æ˜æ–‡ä»¶(typing definition)ã€‚ä½ å¯ä»¥ä» <a href="javascript:if(confirm('https://microsoft.github.io/TypeSearch/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://microsoft.github.io/TypeSearch/'" tppabs="https://microsoft.github.io/TypeSearch/">TypeSearch</a> ä¸­æ‰¾åˆ°å¹¶å®‰è£…è¿™äº›ç¬¬ä¸‰æ–¹åº“çš„ç±»å‹å£°æ˜æ–‡ä»¶ã€‚</p> <p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæƒ³å®‰è£… lodash ç±»å‹å£°æ˜æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev @types/lodash</code></pre> <p>æƒ³äº†è§£æ›´å¤šï¼Œå¯ä»¥æŸ¥çœ‹ <a href="javascript:if(confirm('https://blogs.msdn.microsoft.com/typescript/2016/06/15/the-future-of-declaration-files/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://blogs.msdn.microsoft.com/typescript/2016/06/15/the-future-of-declaration-files/'" tppabs="https://blogs.msdn.microsoft.com/typescript/2016/06/15/the-future-of-declaration-files/">è¿™ç¯‡æ–‡ç« </a>ã€‚</p> <h2 id="importing-other-assets">å¯¼å…¥å…¶ä»–èµ„æº <a href="#importing-other-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æƒ³è¦åœ¨ TypeScript ä¸­ä½¿ç”¨éä»£ç èµ„æº(non-code asset)ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰ TypeScript æ¨æ–­å¯¼å…¥èµ„æºçš„ç±»å‹ã€‚åœ¨é¡¹ç›®é‡Œåˆ›å»ºä¸€ä¸ª <code>custom.d.ts</code> æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶ç”¨æ¥è¡¨ç¤ºé¡¹ç›®ä¸­ TypeScript çš„è‡ªå®šä¹‰ç±»å‹å£°æ˜ã€‚æˆ‘ä»¬ä¸º <code>.svg</code> æ–‡ä»¶è®¾ç½®ä¸€ä¸ªå£°æ˜ï¼š</p> <p><strong>custom.d.ts</strong></p> <pre><code class="hljs language-typescript"><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">"*.svg"</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> content<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p>Hè¿™é‡Œï¼Œæˆ‘ä»¬é€šè¿‡æŒ‡å®šä»»ä½•ä»¥ <code>.svg</code> ç»“å°¾çš„å¯¼å…¥(import)ï¼Œå°† SVG å£°æ˜(declare) ä¸ºä¸€ä¸ªæ–°çš„æ¨¡å—(module)ï¼Œå¹¶å°†æ¨¡å—çš„ <code>content</code> å®šä¹‰ä¸º <code>any</code>ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†ç±»å‹å®šä¹‰ä¸ºå­—ç¬¦ä¸²ï¼Œæ¥æ›´åŠ æ˜¾å¼åœ°å°†å®ƒå£°æ˜ä¸ºä¸€ä¸ª urlã€‚åŒæ ·çš„æ¦‚å¿µé€‚ç”¨äºå…¶ä»–èµ„æºï¼ŒåŒ…æ‹¬ CSS, SCSS, JSON ç­‰ã€‚</p> <h2 id="build-performance">æ„å»ºæ€§èƒ½ <a href="#build-performance" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <blockquote class="warning"> <p>è¿™å¯èƒ½ä¼šé™ä½æ„å»ºæ€§èƒ½ã€‚</p> </blockquote> <p>å…³äºæ„å»ºå·¥å…·ï¼Œè¯·æŸ¥çœ‹<a href="../build-performance/index.htm" tppabs="https://webpack.docschina.org/guides/build-performance/">æ„å»ºæ€§èƒ½</a>æŒ‡å—ã€‚</p> <h1 id="æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åº">æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åº<a href="#%E6%B8%90%E8%BF%9B%E5%BC%8F%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <blockquote class="tip"> <p>æœ¬æŒ‡å—ç»§ç»­æ²¿ç”¨ <a href="../output-management.htm" tppabs="https://webpack.docschina.org/guides/output-management">ç®¡ç†è¾“å‡º</a> ä¸­çš„ä»£ç ç¤ºä¾‹ã€‚</p> </blockquote> <p>æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åº(progressive web application - PWA)ï¼Œæ˜¯ä¸€ç§å¯ä»¥æä¾›ç±»ä¼¼äºnative app(åŸç”Ÿåº”ç”¨ç¨‹åº) ä½“éªŒçš„ web app(ç½‘ç»œåº”ç”¨ç¨‹åº)ã€‚PWA å¯ä»¥ç”¨æ¥åšå¾ˆå¤šäº‹ã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯ï¼Œåœ¨__ç¦»çº¿(offline)__æ—¶åº”ç”¨ç¨‹åºèƒ½å¤Ÿç»§ç»­è¿è¡ŒåŠŸèƒ½ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨åä¸º <a href="javascript:if(confirm('https://developers.google.com/web/fundamentals/primers/service-workers/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://developers.google.com/web/fundamentals/primers/service-workers/'" tppabs="https://developers.google.com/web/fundamentals/primers/service-workers/">Service Workers</a> çš„ web æŠ€æœ¯æ¥å®ç°çš„ã€‚</p> <p>æœ¬ç« å°†é‡ç‚¹ä»‹ç»ï¼Œå¦‚ä½•ä¸ºæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ·»åŠ ç¦»çº¿ä½“éªŒã€‚æˆ‘ä»¬å°†ä½¿ç”¨åä¸º <a href="javascript:if(confirm('https://github.com/GoogleChrome/workbox  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/GoogleChrome/workbox'" tppabs="https://github.com/GoogleChrome/workbox">Workbox</a> çš„ Google é¡¹ç›®æ¥å®ç°æ­¤ç›®çš„ï¼Œè¯¥é¡¹ç›®æä¾›çš„å·¥å…·å¯å¸®åŠ©æˆ‘ä»¬æ›´ç®€å•åœ°ä¸º web app æä¾›ç¦»çº¿æ”¯æŒã€‚</p> <h2 id="we-dont-work-offline-now">ç°åœ¨ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰è¿è¡Œåœ¨ç¦»çº¿ç¯å¢ƒä¸‹ <a href="#we-dont-work-offline-now" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´æ˜¯ç›´æ¥æŸ¥çœ‹æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„è¾“å‡ºç»“æœã€‚é€šå¸¸æƒ…å†µä¸‹ï¼ŒçœŸæ­£çš„ç”¨æˆ·æ˜¯é€šè¿‡ç½‘ç»œè®¿é—® web appï¼›ç”¨æˆ·çš„æµè§ˆå™¨ä¼šä¸ä¸€ä¸ªæä¾›æ‰€éœ€èµ„æºï¼ˆä¾‹å¦‚ï¼Œ<code>.html</code>, <code>.js</code> å’Œ <code>.css</code> æ–‡ä»¶ï¼‰çš„ <strong>server</strong> é€šè®¯ã€‚</p> <p>æˆ‘ä»¬é€šè¿‡æ­å»ºä¸€ä¸ªç®€æ˜“ server ä¸‹ï¼Œæµ‹è¯•ä¸‹è¿™ç§ç¦»çº¿ä½“éªŒã€‚è¿™é‡Œä½¿ç”¨ <a href="javascript:if(confirm('https://www.npmjs.com/package/http-server  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.npmjs.com/package/http-server'" tppabs="https://www.npmjs.com/package/http-server">http-server</a> packageï¼š<code>npm install http-server --save-dev</code>ã€‚è¿˜è¦ä¿®æ”¹ <code>package.json</code> çš„ <code>scripts</code> éƒ¨åˆ†ï¼Œæ¥æ·»åŠ ä¸€ä¸ª <code>start</code> scriptï¼š</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-diff">{
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ...
</span><span class="token prefix unchanged"> </span><span class="token line"> "scripts": {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">    "build": "webpack"
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    "build": "webpack",
</span><span class="token prefix inserted">+</span><span class="token line">    "start": "http-server dist"
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> ...
</span></span>}</code></pre> <p>æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼Œ<a href="../../configuration/dev-server/index.htm" tppabs="https://webpack.docschina.org/configuration/dev-server/">webpack DevServer</a> ä¼šå†™å…¥åˆ°å†…å­˜ã€‚æˆ‘ä»¬éœ€è¦å¯ç”¨ <a href="../../configuration/dev-server.htm#devserverwritetodisk-" tppabs="https://webpack.docschina.org/configuration/dev-server#devserverwritetodisk-">writeToDisk</a> é€‰é¡¹ï¼Œæ¥è®© http-server å¤„ç† <code>./dist</code> ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚</p> <p>å¦‚æœä½ ä¹‹å‰æ²¡æœ‰æ“ä½œè¿‡ï¼Œå…ˆå¾—è¿è¡Œå‘½ä»¤ <code>npm run build</code> æ¥æ„å»ºä½ çš„é¡¹ç›®ã€‚ç„¶åè¿è¡Œå‘½ä»¤ <code>npm start</code>ã€‚åº”è¯¥äº§ç”Ÿä»¥ä¸‹è¾“å‡ºï¼š</p> <pre><code class="hljs language-bash"><span class="token operator">></span> http-server dist

Starting up http-server, serving dist
Available on:
  http://xx.x.x.x:8080
  http://127.0.0.1:8080
  http://xxx.xxx.x.x:8080
Hit CTRL-C to stop the server</code></pre> <p>å¦‚æœä½ æ‰“å¼€æµè§ˆå™¨è®¿é—® <code>http://localhost:8080</code> (å³ <code>http://127.0.0.1</code>)ï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ° webpack åº”ç”¨ç¨‹åºè¢« serve åˆ° <code>dist</code> ç›®å½•ã€‚å¦‚æœåœæ­¢ server ç„¶ååˆ·æ–°ï¼Œåˆ™ webpack åº”ç”¨ç¨‹åºä¸å†å¯è®¿é—®ã€‚</p> <p>è¿™å°±æ˜¯æˆ‘ä»¬ä¸ºå®ç°ç¦»çº¿ä½“éªŒæ‰€éœ€è¦çš„æ”¹å˜ã€‚åœ¨æœ¬ç« ç»“æŸæ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è¦å®ç°çš„æ˜¯ï¼Œåœæ­¢ server ç„¶ååˆ·æ–°ï¼Œä»ç„¶å¯ä»¥çœ‹åˆ°åº”ç”¨ç¨‹åºæ­£å¸¸è¿è¡Œã€‚</p> <h2 id="adding-workbox">æ·»åŠ  Workbox <a href="#adding-workbox" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ·»åŠ  workbox-webpack-plugin æ’ä»¶ï¼Œç„¶åè°ƒæ•´ <code>webpack.config.js</code> æ–‡ä»¶ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> workbox-webpack-plugin --save-dev</code></pre> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> const path = require('path');
</span><span class="token prefix unchanged"> </span><span class="token line"> const HtmlWebpackPlugin = require('html-webpack-plugin');
</span><span class="token prefix unchanged"> </span><span class="token line"> const { CleanWebpackPlugin } = require('clean-webpack-plugin');
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const WorkboxPlugin = require('workbox-webpack-plugin');
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module.exports = {
</span><span class="token prefix unchanged"> </span><span class="token line">   entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">     app: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     print: './src/print.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     // å¯¹äº CleanWebpackPlugin çš„ v2 versions ä»¥ä¸‹ç‰ˆæœ¬ï¼Œä½¿ç”¨ new CleanWebpackPlugin(['dist/*'])
</span><span class="token prefix unchanged"> </span><span class="token line">     new CleanWebpackPlugin(),
</span><span class="token prefix unchanged"> </span><span class="token line">     new HtmlWebpackPlugin({
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       title: 'Output Management',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       title: 'Progressive Web Application',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     new WorkboxPlugin.GenerateSW({
</span><span class="token prefix inserted">+</span><span class="token line">       // è¿™äº›é€‰é¡¹å¸®åŠ©å¿«é€Ÿå¯ç”¨ ServiceWorkers
</span><span class="token prefix inserted">+</span><span class="token line">       // ä¸å…è®¸é—ç•™ä»»ä½•â€œæ—§çš„â€ ServiceWorkers
</span><span class="token prefix inserted">+</span><span class="token line">       clientsClaim: true,
</span><span class="token prefix inserted">+</span><span class="token line">       skipWaiting: true,
</span><span class="token prefix inserted">+</span><span class="token line">     }),
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line">   output: {
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: '[name].bundle.js',
</span><span class="token prefix unchanged"> </span><span class="token line">     path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line"> };</span></span></code></pre> <p>å®Œæˆè¿™äº›è®¾ç½®ï¼Œå†æ¬¡æ‰§è¡Œ <code>npm run build</code>ï¼Œçœ‹ä¸‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p> <pre><code class="hljs language-bash"><span class="token punctuation">..</span>.
                  Asset       Size  Chunks                    Chunk Names
          app.bundle.js     <span class="token number">545</span> kB    <span class="token number">0</span>, <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>  <span class="token punctuation">[</span>big<span class="token punctuation">]</span>  app
        print.bundle.js    <span class="token number">2.74</span> kB       <span class="token number">1</span>  <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>         print
             index.html  <span class="token number">254</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
precache-manifest.b5ca1c555e832d6fbf9462efd29d27eb.js  <span class="token number">268</span> bytes          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
      service-worker.js       <span class="token number">1</span> kB          <span class="token punctuation">[</span>emitted<span class="token punctuation">]</span>
<span class="token punctuation">..</span>.</code></pre> <p>ç°åœ¨ä½ å¯ä»¥çœ‹åˆ°ï¼Œç”Ÿæˆäº†ä¸¤ä¸ªé¢å¤–çš„æ–‡ä»¶ï¼š<code>service-worker.js</code> å’Œåç§°å†—é•¿çš„ <code>precache-manifest.b5ca1c555e832d6fbf9462efd29d27eb.js</code>ã€‚<code>service-worker.js</code> æ˜¯ Service Worker æ–‡ä»¶ï¼Œ<code>precache-manifest.b5ca1c555e832d6fbf9462efd29d27eb.js</code> æ˜¯ <code>service-worker.js</code> å¼•ç”¨çš„æ–‡ä»¶ï¼Œæ‰€ä»¥å®ƒä¹Ÿå¯ä»¥è¿è¡Œã€‚ä½ æœ¬åœ°ç”Ÿæˆçš„æ–‡ä»¶å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒï¼›ä½†æ˜¯åº”è¯¥ä¼šæœ‰ä¸€ä¸ª <code>service-worker.js</code> æ–‡ä»¶ã€‚</p> <p>æ‰€ä»¥ï¼Œå€¼å¾—é«˜å…´çš„æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»åˆ›å»ºå‡ºä¸€ä¸ª Service Workerã€‚æ¥ä¸‹æ¥è¯¥åšä»€ä¹ˆï¼Ÿ</p> <h2 id="registering-our-service-worker">æ³¨å†Œ Service Worker <a href="#registering-our-service-worker" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>æ¥ä¸‹æ¥æˆ‘ä»¬æ³¨å†Œ Service Workerï¼Œä½¿å…¶å‡ºåœºå¹¶å¼€å§‹è¡¨æ¼”ã€‚é€šè¿‡æ·»åŠ ä»¥ä¸‹æ³¨å†Œä»£ç æ¥å®Œæˆæ­¤æ“ä½œï¼š</p> <p><strong>index.js</strong></p> <pre><code class="hljs language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> import _ from 'lodash';
</span><span class="token prefix unchanged"> </span><span class="token line"> import printMe from './print.js';
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> if ('serviceWorker' in navigator) {
</span><span class="token prefix inserted">+</span><span class="token line">   window.addEventListener('load', () => {
</span><span class="token prefix inserted">+</span><span class="token line">     navigator.serviceWorker.register('/service-worker.js').then(registration => {
</span><span class="token prefix inserted">+</span><span class="token line">       console.log('SW registered: ', registration);
</span><span class="token prefix inserted">+</span><span class="token line">     }).catch(registrationError => {
</span><span class="token prefix inserted">+</span><span class="token line">       console.log('SW registration failed: ', registrationError);
</span><span class="token prefix inserted">+</span><span class="token line">     });
</span><span class="token prefix inserted">+</span><span class="token line">   });
</span><span class="token prefix inserted">+</span><span class="token line"> }</span></span></code></pre> <p>å†æ¬¡è¿è¡Œ <code>npm run build</code> æ¥æ„å»ºåŒ…å«æ³¨å†Œä»£ç ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºã€‚ç„¶åç”¨ <code>npm start</code> å¯åŠ¨æœåŠ¡ã€‚è®¿é—® <code>http://localhost:8080</code> å¹¶æŸ¥çœ‹ console æ§åˆ¶å°ã€‚åœ¨é‚£é‡Œä½ åº”è¯¥çœ‹åˆ°ï¼š</p> <pre><code class="hljs language-bash">SW registered</code></pre> <p>ç°åœ¨æ¥è¿›è¡Œæµ‹è¯•ã€‚åœæ­¢ server å¹¶åˆ·æ–°é¡µé¢ã€‚å¦‚æœæµè§ˆå™¨èƒ½å¤Ÿæ”¯æŒ Service Workerï¼Œåº”è¯¥å¯ä»¥çœ‹åˆ°ä½ çš„åº”ç”¨ç¨‹åºè¿˜åœ¨æ­£å¸¸è¿è¡Œã€‚ç„¶è€Œï¼Œserver å·²ç»__åœæ­¢__ serve æ•´ä¸ª dist æ–‡ä»¶å¤¹ï¼Œæ­¤åˆ»æ˜¯ Service Worker åœ¨è¿›è¡Œ serveã€‚</p> <h2 id="conclusion">ç»“è®º <a href="#conclusion" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä½ å·²ç»ä½¿ç”¨ Workbox é¡¹ç›®æ„å»ºäº†ä¸€ä¸ªç¦»çº¿åº”ç”¨ç¨‹åºã€‚å¼€å§‹è¿›å…¥å°† web app æ”¹é€ ä¸º PWA çš„æ—…ç¨‹ã€‚ä½ ç°åœ¨å¯èƒ½æƒ³è¦è€ƒè™‘ä¸‹ä¸€æ­¥åšä»€ä¹ˆã€‚<a href="javascript:if(confirm('https://developers.google.com/web/progressive-web-apps/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://developers.google.com/web/progressive-web-apps/'" tppabs="https://developers.google.com/web/progressive-web-apps/">è¿™é‡Œ</a>æ˜¯å¯ä»¥å¸®åŠ©åˆ°ä½ è§£å†³ä¸‹ä¸€æ­¥é—®é¢˜çš„æ¯”è¾ƒä¸é”™çš„èµ„æºã€‚</p> <h1 id="å…¬å…±è·¯å¾„">å…¬å…±è·¯å¾„<a href="#%E5%85%AC%E5%85%B1%E8%B7%AF%E5%BE%84" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p><code>publicPath</code> é…ç½®é€‰é¡¹åœ¨å„ç§åœºæ™¯ä¸­éƒ½éå¸¸æœ‰ç”¨ã€‚ä½ å¯ä»¥é€šè¿‡å®ƒæ¥æŒ‡å®šåº”ç”¨ç¨‹åºä¸­æ‰€æœ‰èµ„æºçš„åŸºç¡€è·¯å¾„ã€‚</p> <h2 id="use-cases">ç¤ºä¾‹ <a href="#use-cases" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>ä¸‹é¢æä¾›ä¸€äº›ç”¨äºå®é™…åº”ç”¨ç¨‹åºçš„ç¤ºä¾‹ï¼Œé€šè¿‡è¿™äº›ç¤ºä¾‹ï¼Œæ­¤åŠŸèƒ½æ˜¾å¾—æå…¶ç®€å•ã€‚å®è´¨ä¸Šï¼Œå‘é€åˆ° <code>output.path</code> ç›®å½•çš„æ¯ä¸ªæ–‡ä»¶ï¼Œéƒ½å°†ä» <code>output.publicPath</code> ä½ç½®å¼•ç”¨ã€‚è¿™ä¹ŸåŒ…æ‹¬ï¼ˆé€šè¿‡ <a href="../code-splitting/index.htm" tppabs="https://webpack.docschina.org/guides/code-splitting/">ä»£ç åˆ†ç¦»</a> åˆ›å»ºçš„ï¼‰å­ chunk å’Œä½œä¸ºä¾èµ–å›¾ä¸€éƒ¨åˆ†çš„æ‰€æœ‰å…¶ä»–èµ„æºï¼ˆä¾‹å¦‚ image, font ç­‰ï¼‰ã€‚</p> <h3 id="environment-based">åŸºäºç¯å¢ƒè®¾ç½® <a href="#environment-based" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬é€šå¸¸æœ‰ä¸€ä¸ª <code>assets/</code> æ–‡ä»¶å¤¹ï¼Œå®ƒä¸ç´¢å¼•é¡µé¢ä½äºåŒä¸€çº§åˆ«ã€‚è¿™æ²¡å¤ªå¤§é—®é¢˜ï¼Œä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å°†æ‰€æœ‰é™æ€èµ„æºæ‰˜ç®¡è‡³ CDNï¼Œç„¶åæƒ³åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨å‘¢ï¼Ÿ</p> <p>æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸€ä¸ªæœ‰ç€æ‚ ä¹…å†å²çš„ environment variable(ç¯å¢ƒå˜é‡)ã€‚å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªå˜é‡ <code>ASSET_PATH</code>ï¼š</p> <pre><code class="hljs language-js"><span class="token keyword">import</span> webpack <span class="token keyword">from</span> <span class="token string">'webpack'</span><span class="token punctuation">;</span>

<span class="token comment">// å°è¯•ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼Œå¦åˆ™ä½¿ç”¨æ ¹è·¯å¾„</span>
<span class="token keyword">const</span> <span class="token constant">ASSET_PATH</span> <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ASSET_PATH</span> <span class="token operator">||</span> <span class="token string">'/'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> <span class="token constant">ASSET_PATH</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// è¿™å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨ä»£ç ä¸­å®‰å…¨åœ°ä½¿ç”¨ç¯å¢ƒå˜é‡</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>DefinePlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token string">'process.env.ASSET_PATH'</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">ASSET_PATH</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h3 id="on-the-fly">åœ¨è¿è¡Œæ—¶è®¾ç½® <a href="#on-the-fly" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>å¦ä¸€ä¸ªå¯èƒ½å‡ºç°çš„æƒ…å†µæ˜¯ï¼Œéœ€è¦åœ¨è¿è¡Œæ—¶è®¾ç½® <code>publicPath</code>ã€‚webpack æš´éœ²äº†ä¸€ä¸ªåä¸º <code>__webpack_public_path__</code> çš„å…¨å±€å˜é‡ã€‚æ‰€ä»¥åœ¨åº”ç”¨ç¨‹åºçš„ entry point ä¸­ï¼Œå¯ä»¥ç›´æ¥å¦‚ä¸‹è®¾ç½®ï¼š</p> <pre><code class="hljs language-js">__webpack_public_path__ <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">ASSET_PATH</span><span class="token punctuation">;</span></code></pre> <p>è¿™äº›å†…å®¹å°±æ˜¯ä½ æ‰€éœ€è¦çš„ã€‚ç”±äºæˆ‘ä»¬å·²ç»åœ¨é…ç½®ä¸­ä½¿ç”¨äº† <code>DefinePlugin</code>ï¼Œ <code>process.env.ASSET_PATH</code> å°†å§‹ç»ˆéƒ½è¢«å®šä¹‰ï¼Œ å› æ­¤æˆ‘ä»¬å¯ä»¥å®‰å…¨åœ°ä½¿ç”¨ã€‚</p> <blockquote class="warning"> <p>æ³¨æ„ï¼Œå¦‚æœåœ¨ entry æ–‡ä»¶ä¸­ä½¿ç”¨ ES2015 module importï¼Œåˆ™ä¼šåœ¨ import ä¹‹åè¿›è¡Œ <code>__webpack_public_path__</code> èµ‹å€¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¿…é¡»å°† public path èµ‹å€¼ç§»è‡³ä¸€ä¸ªä¸“ç”¨æ¨¡å—ä¸­ï¼Œç„¶åå°†å®ƒçš„ import è¯­å¥æ”¾ç½®åˆ° entry.js æœ€ä¸Šé¢ï¼š</p> </blockquote> <pre><code class="hljs language-js"><span class="token comment">// entry.js</span>
<span class="token keyword">import</span> <span class="token string">'./public-path'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string">'./app'</span><span class="token punctuation">;</span></code></pre> <h1 id="é›†æˆ">é›†æˆ<a href="#%E9%9B%86%E6%88%90" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦æ¶ˆé™¤ä¸€ä¸ªå¸¸è§çš„è¯¯è§£ã€‚webpack æ˜¯ä¸€ä¸ªæ¨¡å—æ‰“åŒ…å·¥å…·(module bundler)ï¼ˆä¾‹å¦‚ï¼Œ<a href="javascript:if(confirm('http://browserify.org/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='http://browserify.org/'" tppabs="http://browserify.org/">Browserify</a> æˆ– <a href="javascript:if(confirm('https://brunch.io/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://brunch.io/'" tppabs="https://brunch.io/">Brunch</a>ï¼‰ã€‚è€Œ_ä¸æ˜¯ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå·¥å…·(task runner)_ï¼ˆä¾‹å¦‚ï¼Œ<a href="javascript:if(confirm('https://www.gnu.org/software/make/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.gnu.org/software/make/'" tppabs="https://www.gnu.org/software/make/">Make</a>, <a href="javascript:if(confirm('https://gruntjs.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://gruntjs.com/'" tppabs="https://gruntjs.com/">Grunt</a> æˆ–è€… <a href="javascript:if(confirm('https://gulpjs.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://gulpjs.com/'" tppabs="https://gulpjs.com/">Gulp</a> ï¼‰ã€‚ä»»åŠ¡æ‰§è¡Œå·¥å…·ç”¨æ¥è‡ªåŠ¨åŒ–å¤„ç†å¸¸è§çš„å¼€å‘ä»»åŠ¡ï¼Œä¾‹å¦‚ï¼Œlint(ä»£ç æ£€æµ‹)ã€build(æ„å»º)ã€test(æµ‹è¯•)ã€‚ç›¸æ¯”æ¨¡å—æ‰“åŒ…å·¥å…·ï¼Œä»»åŠ¡æ‰§è¡Œå·¥å…·åˆ™èšç„¦åœ¨åé‡ä¸Šå±‚çš„é—®é¢˜ä¸Šé¢ã€‚ä½ ä»ç„¶å¯ä»¥å¾—ç›Šäºè¿™ç§ç”¨æ³•ï¼šä½¿ç”¨ä¸Šå±‚çš„å·¥å…·ï¼Œè€Œå°†æ‰“åŒ…éƒ¨åˆ†çš„é—®é¢˜ç•™ç»™ webpackã€‚</p> <p>æ‰“åŒ…å·¥å…·å¸®åŠ©ä½ å–å¾—å‡†å¤‡ç”¨äºéƒ¨ç½²çš„ JavaScript å’Œ stylesheetï¼Œå°†å®ƒä»¬è½¬æ¢ä¸ºé€‚åˆæµè§ˆå™¨çš„å¯ç”¨æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡ <a href="../../plugins/terser-webpack-plugin.htm" tppabs="https://webpack.docschina.org/plugins/terser-webpack-plugin">å‹ç¼©</a>ã€<a href="../code-splitting.htm" tppabs="https://webpack.docschina.org/guides/code-splitting">åˆ†ç¦» chunk</a> å’Œ <a href="../lazy-loading.htm" tppabs="https://webpack.docschina.org/guides/lazy-loading">æƒ°æ€§åŠ è½½</a> æˆ‘ä»¬çš„ JavaScript æ¥æé«˜æ€§èƒ½ã€‚æ‰“åŒ…æ˜¯ web å¼€å‘ä¸­æœ€é‡è¦çš„æŒ‘æˆ˜ä¹‹ä¸€ï¼Œè§£å†³æ­¤é—®é¢˜å¯ä»¥æ¶ˆé™¤å¼€å‘è¿‡ç¨‹ä¸­çš„å¤§éƒ¨åˆ†ç—›ç‚¹ã€‚</p> <p>å¥½çš„æ¶ˆæ¯æ˜¯ï¼Œè™½ç„¶æœ‰ä¸€äº›åŠŸèƒ½é‡å ï¼Œä½†æ˜¯å¦‚æœä½¿ç”¨æ–¹å¼æ­£ç¡®ï¼Œä»»åŠ¡è¿è¡Œå·¥å…·å’Œæ¨¡å—æ‰“åŒ…å·¥å…·è¿˜æ˜¯èƒ½å¤Ÿä¸€èµ·ååŒå·¥ä½œã€‚æœ¬æŒ‡å—æä¾›äº†å…³äºå¦‚ä½•å°† webpack ä¸ä¸€äº›æµè¡Œçš„ä»»åŠ¡è¿è¡Œå·¥å…·é›†æˆåœ¨ä¸€èµ·çš„é«˜åº¦æ¦‚è¿°ã€‚</p> <h2 id="npm-scripts">NPM Scripts <a href="#npm-scripts" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>é€šå¸¸ webpack ç”¨æˆ·ä½¿ç”¨ npm <a href="javascript:if(confirm('https://docs.npmjs.com/misc/scripts  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://docs.npmjs.com/misc/scripts'" tppabs="https://docs.npmjs.com/misc/scripts"><code>scripts</code></a> æ¥ä½œä¸ºä»»åŠ¡æ‰§è¡Œå·¥å…·ã€‚è¿™æ˜¯æ¯”è¾ƒå¥½çš„å¼€å§‹ã€‚ç„¶è€Œè·¨å¹³å°æ”¯æŒå¯èƒ½æ˜¯ä¸ªé—®é¢˜ï¼Œä½†æ˜¯æœ‰å‡ ç§è§£å†³æ–¹æ¡ˆã€‚è®¸å¤šç”¨æˆ·ï¼ˆä½†ä¸æ˜¯å¤§å¤šæ•°ç”¨æˆ·ï¼‰ç›´æ¥ä½¿ç”¨ npm <code>scripts</code> å’Œå„ç§çº§åˆ«çš„ webpack é…ç½®å’Œå·¥å…·ã€‚</p> <p>å› æ­¤ï¼Œè™½ç„¶ webpack æ ¸å¿ƒé‡ç‚¹æ˜¯æ‰“åŒ…ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å„ç§æ‰©å±•ï¼Œå°†å®ƒç”¨äºä»»åŠ¡è¿è¡Œå·¥å…·çš„å¸¸è§å·¥ä½œã€‚é›†æˆä¸€ä¸ªå•ç‹¬çš„å·¥å…·ä¼šå¢åŠ å¤æ‚åº¦ï¼Œå› æ­¤åœ¨å¼€å§‹å‰ä¸€å®šè¦æƒè¡¡åˆ©å¼Šã€‚</p> <h2 id="grunt">Grunt <a href="#grunt" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å¯¹äºé‚£äº›ä½¿ç”¨ Grunt çš„äººï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ <a href="javascript:if(confirm('https://www.npmjs.com/package/grunt-webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.npmjs.com/package/grunt-webpack'" tppabs="https://www.npmjs.com/package/grunt-webpack"><code>grunt-webpack</code></a> packageã€‚ä½¿ç”¨ <code>grunt-webpack</code> ä½ å¯ä»¥å°† webpack æˆ– <a href="javascript:if(confirm('https://github.com/webpack/webpack-dev-server  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack-dev-server'" tppabs="https://github.com/webpack/webpack-dev-server">webpack-dev-server</a> ä½œä¸ºä¸€é¡¹ä»»åŠ¡(task)æ‰§è¡Œï¼Œè®¿é—® <a href="javascript:if(confirm('https://gruntjs.com/api/grunt.template  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://gruntjs.com/api/grunt.template'" tppabs="https://gruntjs.com/api/grunt.template">grunt template tags</a> ä¸­çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ‹†åˆ†å¼€å‘å’Œç”Ÿäº§é…ç½®ç­‰ç­‰ã€‚å¦‚æœè¿˜æ²¡æœ‰å®‰è£… <code>grunt-webpack</code> å’Œ <code>webpack</code>ï¼Œè¯·å…ˆå®‰è£…å®ƒä»¬ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev grunt-webpack webpack</code></pre> <p>ç„¶åï¼Œæ³¨å†Œä¸€ä¸ªé…ç½®å¹¶åŠ è½½ä»»åŠ¡ï¼š</p> <p><strong>Gruntfile.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> webpackConfig <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./webpack.config.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">grunt</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  grunt<span class="token punctuation">.</span><span class="token function">initConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    webpack<span class="token operator">:</span> <span class="token punctuation">{</span>
      options<span class="token operator">:</span> <span class="token punctuation">{</span>
        stats<span class="token operator">:</span> <span class="token operator">!</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      prod<span class="token operator">:</span> webpackConfig<span class="token punctuation">,</span>
      dev<span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span> watch<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> webpackConfig<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  grunt<span class="token punctuation">.</span><span class="token function">loadNpmTasks</span><span class="token punctuation">(</span><span class="token string">'grunt-webpack'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>è·å–æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="javascript:if(confirm('https://github.com/webpack-contrib/grunt-webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack-contrib/grunt-webpack'" tppabs="https://github.com/webpack-contrib/grunt-webpack">ä»“åº“</a>ã€‚</p> <h2 id="gulp">Gulp <a href="#gulp" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨ <a href="javascript:if(confirm('https://github.com/shama/webpack-stream  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/shama/webpack-stream'" tppabs="https://github.com/shama/webpack-stream"><code>webpack-stream</code></a> packageï¼ˆä¹Ÿç§°ä½œ <code>gulp-webpack</code>ï¼‰ çš„å¸®åŠ©ä¸‹ï¼Œå¯ä»¥ç›¸å½“ç›´æ¥åœ°å°† Gulp ä¸ webpack é›†æˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸éœ€è¦å•ç‹¬å®‰è£… <code>webpack</code>ï¼Œå› ä¸ºå®ƒæ˜¯ <code>webpack-stream</code> ç›´æ¥ä¾èµ–ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack-stream</code></pre> <p>åªè¦å°† <code>webpack</code> æ›¿æ¢ä¸º <code>require('webpack-stream')</code>ï¼Œå¹¶ä¼ é€’ä¸€ä¸ªé…ç½®ï¼š</p> <p><strong>gulpfile.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> gulp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'gulp'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-stream'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
gulp<span class="token punctuation">.</span><span class="token function">task</span><span class="token punctuation">(</span><span class="token string">'default'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> gulp<span class="token punctuation">.</span><span class="token function">src</span><span class="token punctuation">(</span><span class="token string">'src/entry.js'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span><span class="token function">webpack</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// Any configuration options...</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">pipe</span><span class="token punctuation">(</span>gulp<span class="token punctuation">.</span><span class="token function">dest</span><span class="token punctuation">(</span><span class="token string">'dist/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>è·å–æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="javascript:if(confirm('https://github.com/shama/webpack-stream  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/shama/webpack-stream'" tppabs="https://github.com/shama/webpack-stream">ä»“åº“</a>ã€‚</p> <h2 id="mocha">Mocha <a href="#mocha" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="javascript:if(confirm('https://github.com/zinserjan/mocha-webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/zinserjan/mocha-webpack'" tppabs="https://github.com/zinserjan/mocha-webpack"><code>mocha-webpack</code></a> å¯ä»¥å°† Mocha ä¸ webpack å®Œå…¨é›†æˆã€‚è¿™ä¸ªä»“åº“æä¾›äº†å¾ˆå¤šå…³äºå…¶ä¼˜åŠ¿å’ŒåŠ£åŠ¿çš„ç»†èŠ‚ï¼ŒåŸºæœ¬ä¸Š <code>mocha-webpack</code> åªæ˜¯ä¸€ä¸ªç®€å•å°è£…ï¼Œæä¾›ä¸ Mocha å‡ ä¹ç›¸åŒçš„ CLIï¼Œå¹¶æä¾›å„ç§ webpack åŠŸèƒ½ï¼Œä¾‹å¦‚æ”¹è¿›äº† watch mode å’Œæ”¹è¿›äº†è·¯å¾„åˆ†æã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªå¦‚ä½•å®‰è£…å¹¶ä½¿ç”¨å®ƒæ¥è¿è¡Œæµ‹è¯•å¥—ä»¶çš„ç¤ºä¾‹ï¼ˆåœ¨ <code>./test</code> ä¸­æ‰¾åˆ°ï¼‰ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack mocha mocha-webpack
mocha-webpack <span class="token string">'test/**/*.js'</span></code></pre> <p>è·å–æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="javascript:if(confirm('https://github.com/zinserjan/mocha-webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/zinserjan/mocha-webpack'" tppabs="https://github.com/zinserjan/mocha-webpack">ä»“åº“</a>ã€‚</p> <h2 id="karma">Karma <a href="#karma" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><a href="javascript:if(confirm('https://github.com/webpack-contrib/karma-webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack-contrib/karma-webpack'" tppabs="https://github.com/webpack-contrib/karma-webpack"><code>karma-webpack</code></a> package å…è®¸ä½ ä½¿ç”¨ webpack é¢„å¤„ç† <a href="javascript:if(confirm('https://karma-runner.github.io/1.0/index.html  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://karma-runner.github.io/1.0/index.html'" tppabs="https://karma-runner.github.io/1.0/index.html">Karma</a> ä¸­çš„æ–‡ä»¶ã€‚å®ƒä¹Ÿå¯ä»¥ä½¿ç”¨ <a href="javascript:if(confirm('https://github.com/webpack/webpack-dev-middleware  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack-dev-middleware'" tppabs="https://github.com/webpack/webpack-dev-middleware"><code>webpack-dev-middleware</code></a>ï¼Œå¹¶å…è®¸ä¼ é€’ä¸¤è€…çš„é…ç½®ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</p> <pre><code class="hljs language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev webpack karma karma-webpack</code></pre> <p><strong>karma.conf.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">config</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    files<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token string">'test/*_test.js'</span><span class="token punctuation">,</span> watched<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> pattern<span class="token operator">:</span> <span class="token string">'test/**/*_test.js'</span><span class="token punctuation">,</span> watched<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    preprocessors<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'test/*_test.js'</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'webpack'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string">'test/**/*_test.js'</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">'webpack'</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    webpack<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// Any custom webpack configuration...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    webpackMiddleware<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// Any custom webpack-dev-middleware configuration...</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>è·å–æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ <a href="javascript:if(confirm('https://github.com/webpack-contrib/karma-webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack-contrib/karma-webpack'" tppabs="https://github.com/webpack-contrib/karma-webpack">ä»“åº“</a>ã€‚</p> <h1 id="Package-exports">Package exports<a href="#Package-exports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>The <code>exports</code> field in the <code>package.json</code> of a package allows to declare which module should be used when using module requests like <code>import "package"</code> or <code>import "package/sub/path"</code>. It replaces the default implementation that returns <code>main</code> field resp. <code>index.js</code> files for <code>"package"</code> and the file system lookup for <code>"package/sub/path"</code>.</p> <p>When the <code>exports</code> field is specified, only these module requests are available. Any other requests will lead to a ModuleNotFound Error.</p> <h2 id="General-syntax">General syntax<a href="#General-syntax" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>In general the <code>exports</code> field should contain an object where each properties specifies a sub path of the module request. For the examples above the following properties could be used: <code>"."</code> for <code>import "package"</code> and <code>"./sub/path"</code> for <code>import "package/sub/path"</code>. Properties ending with a <code>/</code> will forward a request with this prefix to the old file system lookup algorithm.</p> <p>An example:</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"."</span><span class="token operator">:</span> <span class="token string">"./main.js"</span><span class="token punctuation">,</span>
    <span class="token property">"./sub/path"</span><span class="token operator">:</span> <span class="token string">"./secondary.js"</span><span class="token punctuation">,</span>
    <span class="token property">"./prefix/"</span><span class="token operator">:</span> <span class="token string">"./directory/"</span><span class="token punctuation">,</span>
    <span class="token property">"./prefix/deep/"</span><span class="token operator">:</span> <span class="token string">"./other-directory/"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <table> <thead> <tr> <th>Module request</th> <th>Result</th> </tr> </thead> <tbody> <tr> <td data-th="Module request"><span><code>package</code></span></td> <td data-th="Result"><span><code>.../package/main.js</code></span></td> </tr> <tr> <td data-th="Module request"><span><code>package/sub/path</code></span></td> <td data-th="Result"><span><code>.../package/secondary.js</code></span></td> </tr> <tr> <td data-th="Module request"><span><code>package/prefix/some/file.js</code></span></td> <td data-th="Result"><span><code>.../package/directory/some/file.js</code></span></td> </tr> <tr> <td data-th="Module request"><span><code>package/prefix/deep/file.js</code></span></td> <td data-th="Result"><span><code>.../package/other-directory/file.js</code></span></td> </tr> <tr> <td data-th="Module request"><span><code>package/main.js</code></span></td> <td data-th="Result"><span>Error</span></td> </tr> </tbody> </table> <h2 id="Alternatives">Alternatives<a href="#Alternatives" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Instead of providing a single result, the package author may provide a list of results. In such a scenario this list is tried in order and the first valid result will be used.</p> <p>Note: Only the first valid result will be used, not all valid results.</p> <p>Example:</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"./things/"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"./good-things/"</span><span class="token punctuation">,</span> <span class="token string">"./bad-things/"</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>Here <code>package/things/apple</code> might be found in <code>.../package/good-things/apple</code> or in <code>.../package/bad-things/apple</code>.</p> <h2 id="Conditional-syntax">Conditional syntax<a href="#Conditional-syntax" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Instead of providing results directly in the <code>exports</code> field, the package author may let the module system choose one based on conditions about the environment.</p> <p>In this case an object mapping conditions to results should be used. Conditions are tried in object order. Conditions that contain invalid results are skipped. Conditions might be nested to create a logical AND. The last condition in the object might be the special <code>"default"</code> condition, which is always matched.</p> <p>Example:</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"."</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"red"</span><span class="token operator">:</span> <span class="token string">"./stop.js"</span><span class="token punctuation">,</span>
      <span class="token property">"yellow"</span><span class="token operator">:</span> <span class="token string">"./stop.js"</span><span class="token punctuation">,</span>
      <span class="token property">"green"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"free"</span><span class="token operator">:</span> <span class="token string">"./drive.js"</span><span class="token punctuation">,</span>
        <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./wait.js"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./drive-carefully.js"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>This translates to something like:</p> <pre><code class="hljs language-js"><span class="token keyword">if</span> <span class="token punctuation">(</span>red <span class="token operator">&#x26;&#x26;</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./stop.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./stop.js'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>yellow <span class="token operator">&#x26;&#x26;</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./stop.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./stop.js'</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>green<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>free <span class="token operator">&#x26;&#x26;</span> <span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./drive.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./drive.js'</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./wait.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./wait.js'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">valid</span><span class="token punctuation">(</span><span class="token string">'./drive-carefully.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token string">'./drive-carefully.js'</span><span class="token punctuation">;</span>
<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ModuleNotFoundError</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>The available conditions vary depending on the module system and tool used.</p> <h2 id="Abbreviation">Abbreviation<a href="#Abbreviation" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>When only a single entry (<code>"."</code>) into the package should be supported the <code>{ ".": ... }</code> object nesting can be omitted:</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token string">"./index.mjs"</span>
<span class="token punctuation">}</span></code></pre> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"red"</span><span class="token operator">:</span> <span class="token string">"./stop.js"</span><span class="token punctuation">,</span>
    <span class="token property">"green"</span><span class="token operator">:</span> <span class="token string">"./drive.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h2 id="Notes-about-ordering">Notes about ordering<a href="#Notes-about-ordering" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>In an object where each key is a condition, order of properties is significant. Conditions are handled in the order they are specified.</p> <p>Example: <code>{ "red": "./stop.js", "green": "./drive.js" }</code> != <code>{ "green": "./drive.js", "red": "./stop.js" }</code> (when both <code>red</code> and <code>green</code> conditions are set, first property will be used)</p> <p>In an object where each key is a subpath, order of properties (subpaths) is not significant. More specific paths are preferred over less specific ones.</p> <p>Example: <code>{ "./a/": "./x/", "./a/b/": "./y/", "./a/b/c": "./z" }</code> == <code>{ "./a/b/c": "./z", "./a/b/": "./y/", "./a/": "./x/" }</code> (order will always be: <code>./a/b/c</code> > <code>./a/b/</code> > <code>./a/</code>)</p> <p><code>exports</code> field is preferred over other package entry fields like <code>main</code>, <code>module</code>, <code>browser</code> or custom ones.</p> <h2 id="Conditions">Conditions<a href="#Conditions" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <h3 id="Reference-syntax">Reference syntax<a href="#Reference-syntax" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>One of these conditions is set depending on the syntax used to reference the module:</p> <table> <thead> <tr> <th>Condition</th> <th>Description</th> <th>Supported by</th> </tr> </thead> <tbody> <tr> <td data-th="Condition"><span><code>import</code></span></td> <td data-th="Description"><span>Request is issued from ESM syntax or similar.</span></td> <td data-th="Supported by"><span>webpack, Node.js</span></td> </tr> <tr> <td data-th="Condition"><span><code>require</code></span></td> <td data-th="Description"><span>Request is issued from CommonJs/AMD syntax or similar.</span></td> <td data-th="Supported by"><span>webpack, Node.js</span></td> </tr> <tr> <td data-th="Condition"><span><code>style</code></span></td> <td data-th="Description"><span>Request is issued from a stylesheet reference.</span></td> <td></td> </tr> <tr> <td data-th="Condition"><span><code>sass</code></span></td> <td data-th="Description"><span>Request is issued from a sass stylesheet reference.</span></td> <td></td> </tr> <tr> <td data-th="Condition"><span><code>asset</code></span></td> <td data-th="Description"><span>Request is issued from a asset reference.</span></td> <td></td> </tr> <tr> <td data-th="Condition"><span><code>script</code></span></td> <td data-th="Description"><span>Request is issued from a normal script tag without module system.</span></td> <td></td> </tr> </tbody> </table> <p>These conditions might also be set additionally:</p> <table> <thead> <tr> <th>Condition</th> <th>Description</th> <th>Supported by</th> </tr> </thead> <tbody> <tr> <td data-th="Condition"><span><code>module</code></span></td> <td data-th="Description"><span>All module syntax that allows to reference javascript supports ESM.<br>(only combined with <code>import</code> or <code>require</code>)</span></td> <td data-th="Supported by"><span>webpack</span></td> </tr> <tr> <td data-th="Condition"><span><code>types</code></span></td> <td data-th="Description"><span>Request is issued from typescript that is interested in type declarations.</span></td> <td></td> </tr> </tbody> </table> <h4 id="import"><code>import</code><a href="#import" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>The following syntax will set the <code>import</code> condition:</p> <ul> <li>ESM <code>import</code> declarations in ESM</li> <li>JS <code>import()</code> expression</li> <li>HTML <code>&#x3C;script type="module"></code> in HTML</li> <li>HTML <code>&#x3C;link rel="preload/prefetch"></code> in HTML</li> <li>JS <code>new Worker(..., { type: "module" })</code></li> <li>WASM <code>import</code> section</li> <li>ESM HMR (webpack) <code>import.hot.accept/decline([...])</code></li> <li>JS <code>Worklet.addModule</code></li> <li>Using javascript as entrypoint</li> </ul> <h4 id="require"><code>require</code><a href="#require" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>The following syntax will set the <code>require</code> condition:</p> <ul> <li>CommonJs <code>require(...)</code></li> <li>AMD <code>define()</code></li> <li>AMD <code>require([...])</code></li> <li>CommonJs <code>require.resolve()</code></li> <li>CommonJs (webpack) <code>require.ensure([...])</code></li> <li>CommonJs (webpack) <code>require.context</code></li> <li>CommonJs HMR (webpack) <code>module.hot.accept/decline([...])</code></li> <li>HTML <code>&#x3C;script src="..."></code></li> </ul> <h4 id="style"><code>style</code><a href="#style" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>The following syntax will set the <code>style</code> condition:</p> <ul> <li>CSS <code>@import</code></li> <li>HTML <code>&#x3C;link rel="stylesheet"></code></li> </ul> <h4 id="asset"><code>asset</code><a href="#asset" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>The following syntax will set the <code>asset</code> condition:</p> <ul> <li>CSS <code>url()</code></li> <li>ESM <code>new URL(..., import.meta.url)</code></li> <li>HTML <code>&#x3C;img src="..."></code></li> </ul> <h4 id="script"><code>script</code><a href="#script" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>The following syntax will set the <code>script</code> condition:</p> <ul> <li>HTML <code>&#x3C;script src="..."></code></li> </ul> <p><code>script</code> should only be set when no module system is supported. When the script is preprocessed by a system supporting CommonJs it should set <code>require</code> instead.</p> <p>This condition should be used when looking for a javascript file that can be injected as script tag in a HTML page without additional preprocessing.</p> <h3 id="Optimizations">Optimizations<a href="#Optimizations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>The following conditions are set for various optimizations:</p> <table> <thead> <tr> <th>Condition</th> <th>Description</th> <th>Supported by</th> </tr> </thead> <tbody> <tr> <td data-th="Condition"><span><code>production</code></span></td> <td data-th="Description"><span>In a production environment.<br>No devtooling should be included.</span></td> <td data-th="Supported by"><span>webpack</span></td> </tr> <tr> <td data-th="Condition"><span><code>development</code></span></td> <td data-th="Description"><span>In a development environment.<br>Devtooling should be included.</span></td> <td data-th="Supported by"><span>webpack</span></td> </tr> </tbody> </table> <p>Note: Since <code>production</code> and <code>development</code> is not supported by everyone, no assumption should be made when none of these is set.</p> <h3 id="Target-environment">Target environment<a href="#Target-environment" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>The following conditions are set depending on the target environment:</p> <table> <thead> <tr> <th>Condition</th> <th>Description</th> <th>Supported by</th> </tr> </thead> <tbody> <tr> <td data-th="Condition"><span><code>browser</code></span></td> <td data-th="Description"><span>Code will run in a browser.</span></td> <td data-th="Supported by"><span>webpack</span></td> </tr> <tr> <td data-th="Condition"><span><code>electron</code></span></td> <td data-th="Description"><span>Code will run in electron.</span></td> <td data-th="Supported by"><span>webpack</span></td> </tr> <tr> <td data-th="Condition"><span><code>worker</code></span></td> <td data-th="Description"><span>Code will run in a (Web)Worker.</span></td> <td data-th="Supported by"><span>webpack</span></td> </tr> <tr> <td data-th="Condition"><span><code>worklet</code></span></td> <td data-th="Description"><span>Code will run in a Worklet.</span></td> <td data-th="Supported by"><span>-</span></td> </tr> <tr> <td data-th="Condition"><span><code>node</code></span></td> <td data-th="Description"><span>Code will run in Node.js.</span></td> <td data-th="Supported by"><span>webpack, Node.js</span></td> </tr> <tr> <td data-th="Condition"><span><code>deno</code></span></td> <td data-th="Description"><span>Code will run in Deno.</span></td> <td data-th="Supported by"><span>-</span></td> </tr> <tr> <td data-th="Condition"><span><code>react-native</code></span></td> <td data-th="Description"><span>Code will run in react-native.</span></td> <td data-th="Supported by"><span>-</span></td> </tr> </tbody> </table> <p>Note: <code>electron</code>, <code>worker</code> and <code>worklet</code> comes combined with either <code>node</code> or <code>browser</code>, depending on the context.</p> <p>Since there are multiple versions of each environment the following guidelines apply:</p> <ul> <li><code>node</code>: See <code>engines</code> field for compatibility.</li> <li><code>browser</code>: Compatible with current Spec and stage 4 proposals at time of publishing the package. Polyfilling resp. transpiling must be handled on consumer side. <ul> <li>Features that are not possible to polyfill or transpile should be used carefully as it limits the possible usage.</li> </ul> </li> <li><code>deno</code>: TBD</li> <li><code>react-native</code>: TBD</li> </ul> <h3 id="Conditions-Preprocessor-and-runtimes">Conditions: Preprocessor and runtimes<a href="#Conditions-Preprocessor-and-runtimes" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>The following conditions are set depending on which tool preprocesses the source code.</p> <table> <thead> <tr> <th>Condition</th> <th>Description</th> <th>Supported by</th> </tr> </thead> <tbody> <tr> <td data-th="Condition"><span><code>webpack</code></span></td> <td data-th="Description"><span>Processed by webpack.</span></td> <td data-th="Supported by"><span>webpack</span></td> </tr> </tbody> </table> <p>Sadly there is no <code>node-js</code> condition for Node.js as runtime. This would simplify creating exceptions for Node.js.</p> <h3 id="Conditions-Custom">Conditions: Custom<a href="#Conditions-Custom" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>The following tools support custom conditions:</p> <table> <thead> <tr> <th>Tool</th> <th>Supported</th> <th>Notes</th> </tr> </thead> <tbody> <tr> <td data-th="Tool"><span>Node.js</span></td> <td data-th="Supported"><span>no</span></td> <td></td> </tr> <tr> <td data-th="Tool"><span>webpack</span></td> <td data-th="Supported"><span>yes</span></td> <td data-th="Notes"><span>Use <code>resolve.conditionNames</code> configuration option.</span></td> </tr> </tbody> </table> <p>For custom conditions the following naming schema is recommended:</p> <p><code>&#x3C;company-name>:&#x3C;condition-name></code></p> <p>Examples: <code>example-corp:beta</code>, <code>google:internal</code>, `</p> <h2 id="Common-patterns">Common patterns<a href="#Common-patterns" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>All patterns are explained with a single <code>"."</code> entry into the package, but they can be extended from multiple entries too, by repeating the pattern for each entry.</p> <p>These pattern should be used as guide not as strict ruleset. They can be adapted to the individual packages.</p> <p>These pattern are based on the following list of goals/assumptions:</p> <ul> <li>Packages are rotting. <ul> <li>We assume at some point packages are no longer being maintained, but they are continued to be used.</li> <li><code>exports</code> should be written to use fallbacks for unknown future cases. <code>default</code> condition can be used for that.</li> <li>As the future is unknown we assume an environment similar to browsers and module system similar to ESM.</li> </ul> </li> <li>Not all conditions are supported by every tool. <ul> <li>Fallbacks should be used to handled these cases.</li> <li>We assume the following fallback make sense in general: <ul> <li>ESM > CommonJs</li> <li>Production > Development</li> <li>Browser > node.js</li> </ul> </li> </ul> </li> </ul> <p>Depending on the package intention maybe something else makes sense and in this case the patterns should be adopted to that. Example: For a command line tool a browser-like future and fallback doesn't make a lot of sense, and in this case node.js-like environments and fallbacks should be used instead.</p> <p>For complex use cases multiple patterns need to be combined by nesting these conditions.</p> <h3 id="Target-environment-independent-packages">Target environment independent packages<a href="#Target-environment-independent-packages" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>These patterns make sense for packages that do not use environment specific APIs.</p> <h4 id="Providing-only-an-ESM-version">Providing only an ESM version<a href="#Providing-only-an-ESM-version" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
<span class="token punctuation">}</span></code></pre> <p>Note: Providing only a ESM comes with restrictions for node.js. Such a package would only work in Node.js >= 14 and only when using <code>import</code>. It won't work with <code>require()</code>.</p> <h4 id="Providing-CommonJs-and-ESM-version-stateless">Providing CommonJs and ESM version (stateless)<a href="#Providing-CommonJs-and-ESM-version-stateless" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span><span class="token punctuation">,</span>
      <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index.cjs"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>Most tools get the ESM version. Node.js is an exception here. It gets a CommonJs version when using <code>require()</code>. This will lead to two instances of these package when referencing it with <code>require()</code> and <code>import</code>, but that doesn't hurt as the package doesn't have state.</p> <p>The <code>module</code> condition is used as optimization when preprocessing node-targeted code with a tool that supports ESM for <code>require()</code> (like a bundler, when bundling for Node.js). For such a tool the exception is skipped. This is technically optional, but bundlers would include the package source code twice otherwise.</p> <p>You can also use the stateless pattern if you are able to isolate your package state in JSON files. JSON is consumable from CommonJs and ESM without polluting the graph with the other module system.</p> <p>Note that here stateless also means class instances are not tested with <code>instanceof</code> as there can be two different classes because of the double module instantiation.</p> <h4 id="Providing-CommonJs-and-ESM-version-stateful">Providing CommonJs and ESM version (stateful)<a href="#Providing-CommonJs-and-ESM-version-stateful" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span><span class="token punctuation">,</span>
      <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper.js"</span><span class="token punctuation">,</span>
      <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index.cjs"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <pre><code class="hljs language-js"><span class="token comment">// wrapper.js</span>
<span class="token keyword">import</span> cjs <span class="token keyword">from</span> <span class="token string">'./index.cjs'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">A</span> <span class="token operator">=</span> cjs<span class="token punctuation">.</span><span class="token constant">A</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">B</span> <span class="token operator">=</span> cjs<span class="token punctuation">.</span><span class="token constant">B</span><span class="token punctuation">;</span></code></pre> <p>In a stateful package we must ensure that the package is never instantiated twice.</p> <p>This isn't a problem for most tools, but Node.js is again an exception here. For Node.js we always use the CommonJs version and expose named exports in the ESM with a ESM wrapper.</p> <p>We use the <code>module</code> condition as optimization again.</p> <h4 id="Providing-only-a-CommonJs-version">Providing only a CommonJs version<a href="#Providing-only-a-CommonJs-version" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"commonjs"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
<span class="token punctuation">}</span></code></pre> <p>Providing <code>"type": "commonjs"</code> helps to statically detect CommonJs files.</p> <h4 id="Providing-a-bundled-script-version-for-direct-browser-consumption">Providing a bundled script version for direct browser consumption<a href="#Providing-a-bundled-script-version-for-direct-browser-consumption" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"script"</span><span class="token operator">:</span> <span class="token string">"./dist-bundle.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>Note that despite using <code>"type": "module"</code> and <code>.js</code> for <code>dist-bundle.js</code> this file is not in ESM format. It should use globals to allow direct consumption as script tag.</p> <h3 id="Providing-devtools-or-production-optimizations">Providing devtools or production optimizations<a href="#Providing-devtools-or-production-optimizations" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>These patterns make sense when a package contains two versions, one for development and one for production. E. g. the development version could include additional code for better error message or additional warnings.</p> <h4 id="Without-Nodejs-runtime-detection">Without Node.js runtime detection<a href="#Without-Nodejs-runtime-detection" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>When the <code>development</code> condition is supported we use the version enhanced for development. Otherwise, in production or when mode is unknown, we use the optimized version.</p> <h4 id="With-Nodejs-runtime-detection">With Node.js runtime detection<a href="#With-Nodejs-runtime-detection" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
    <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span><span class="token punctuation">,</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">"./wrapper-process-env.cjs"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <pre><code class="hljs language-js"><span class="token comment">// wrapper-process-env.cjs</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'development'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./index-optimized.cjs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./index-with-devtools.cjs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre> <p>We prefer static detection of production/development mode via the <code>production</code> or <code>development</code> condition.</p> <p>Node.js allows to detection production/development mode at runtime via <code>process.env.NODE_ENV</code>, so we use that as fallback in Node.js. Sync conditional importing ESM is not possible and we don't want to load the package twice, so we have to use CommonJs for the runtime detection.</p> <p>When it's not possible to detect mode we fallback to the production version.</p> <h3 id="Providing-different-versions-depending-on-target-environment">Providing different versions depending on target environment<a href="#Providing-different-versions-depending-on-target-environment" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>A fallback environment should be chosen that makes sense for the package to support future environments. In general a browser-like environment should be assumed.</p> <h4 id="Providing-Nodejs-WebWorker-and-browser-versions">Providing Node.js, WebWorker and browser versions<a href="#Providing-Nodejs-WebWorker-and-browser-versions" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">"./index-node.js"</span><span class="token punctuation">,</span>
    <span class="token property">"worker"</span><span class="token operator">:</span> <span class="token string">"./index-worker.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h4 id="Providing-Nodejs-browser-and-electron-versions">Providing Node.js, browser and electron versions<a href="#Providing-Nodejs-browser-and-electron-versions" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"electron"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node.js"</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-electron.js"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token string">"./index-node.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h3 id="Combining-patterns">Combining patterns<a href="#Combining-patterns" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <h4 id="Example-1">Example 1<a href="#Example-1" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>This is an example for a package that has optimizations for production and development usage with runtime detection for <code>process.env</code> and also ships a CommonJs and ESM version</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"development"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
        <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-with-devtools.js"</span><span class="token punctuation">,</span>
        <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"production"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span><span class="token punctuation">,</span>
        <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-optimized.js"</span><span class="token punctuation">,</span>
        <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./wrapper-process-env.cjs"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
    <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <h4 id="Example-2">Example 2<a href="#Example-2" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h4> <p>This is an example for a package that supports Node.js, browser and electron, has optimizations for production and development usage with runtime detection for <code>process.env</code> and also ships a CommonJs and ESM version.</p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>
  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"module"</span><span class="token punctuation">,</span>
  <span class="token property">"exports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"electron"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"development"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node-with-devtools.js"</span><span class="token punctuation">,</span>
          <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-electron-node-with-devtools.js"</span><span class="token punctuation">,</span>
          <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node-with-devtools.cjs"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"production"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node-optimized.js"</span><span class="token punctuation">,</span>
          <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-electron-node-optimized.js"</span><span class="token punctuation">,</span>
          <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-electron-node-optimized.cjs"</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./wrapper-electron-node-process-env.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-electron-with-devtools.js"</span><span class="token punctuation">,</span>
      <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"./index-electron-optimized.js"</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-electron-optimized.js"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"development"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-node-with-devtools.js"</span><span class="token punctuation">,</span>
        <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-node-with-devtools.js"</span><span class="token punctuation">,</span>
        <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-node-with-devtools.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"production"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"./index-node-optimized.js"</span><span class="token punctuation">,</span>
        <span class="token property">"import"</span><span class="token operator">:</span> <span class="token string">"./wrapper-node-optimized.js"</span><span class="token punctuation">,</span>
        <span class="token property">"require"</span><span class="token operator">:</span> <span class="token string">"./index-node-optimized.cjs"</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./wrapper-node-process-env.cjs"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">"development"</span><span class="token operator">:</span> <span class="token string">"./index-with-devtools.js"</span><span class="token punctuation">,</span>
    <span class="token property">"production"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span><span class="token punctuation">,</span>
    <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"./index-optimized.js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre> <p>Looks complex, yes. We were already able to reduce some complexity due to a assumption we can make: Only <code>node</code> need a CommonJs version and can detect production/development with <code>process.env</code>.</p> <h2 id="Guidelines">Guidelines<a href="#Guidelines" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <ul> <li>Avoid the <code>default</code> export. It's handled differently between tooling. Only use named exports.</li> <li>Never provide different APIs or semantics for different conditions.</li> <li>Write your source code as ESM and transpile to CJS via babel, typescript or similar tools.</li> <li>Either use <code>.cjs</code> or <code>type: "commonjs"</code> in package.json to clearly mark source code as CommonJs. This makes it statically detectable for tools if CommonJs or ESM is used. This is important for tools that only support ESM and no CommonJs.</li> <li>ESM used in packages support the following types of requests: <ul> <li>module requests are supported, pointing to other packages with a package.json.</li> <li>relative requests are supported, pointing to other files within the package. <ul> <li>They must not point to files outside of the package.</li> </ul> </li> <li><code>data:</code> url requests are supported.</li> <li>other absolute or server-relative requests are not supported by default, but they might be supported by some tools or environments.</li> </ul> </li> </ul> <h1 id="entry-é«˜çº§ç”¨æ³•">entry é«˜çº§ç”¨æ³•<a href="#entry-%E9%AB%98%E7%BA%A7%E7%94%A8%E6%B3%95" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <h2 id="multiple-file-types-per-entry">æ¯ä¸ªå…¥å£ä½¿ç”¨å¤šç§æ–‡ä»¶ç±»å‹ <a href="#multiple-file-types-per-entry" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>åœ¨ä¸ä½¿ç”¨ <code>import</code> æ ·å¼æ–‡ä»¶çš„åº”ç”¨ç¨‹åºä¸­ï¼ˆé¢„å•é¡µåº”ç”¨ç¨‹åºæˆ–å…¶ä»–åŸå› ï¼‰ï¼Œä½¿ç”¨ä¸€ä¸ªå€¼æ•°ç»„ç»“æ„çš„ <a href="../../configuration/entry-context/index.htm#entry" tppabs="https://webpack.docschina.org/configuration/entry-context/#entry">entry</a>ï¼Œå¹¶ä¸”åœ¨å…¶ä¸­ä¼ å…¥ä¸åŒç±»å‹çš„æ–‡ä»¶ï¼Œå¯ä»¥å®ç°å°† CSS å’Œ JavaScriptï¼ˆå’Œå…¶ä»–ï¼‰æ–‡ä»¶åˆ†ç¦»åœ¨ä¸åŒçš„ bundleã€‚</p> <p>ä¸¾ä¸ªä¾‹å­ã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªå…·æœ‰ä¸¤ç§é¡µé¢ç±»å‹çš„ PHP åº”ç”¨ç¨‹åºï¼šhome(é¦–é¡µ) å’Œ account(å¸æˆ·)ã€‚home ä¸åº”ç”¨ç¨‹åºå…¶ä½™éƒ¨åˆ†ï¼ˆaccount é¡µé¢ï¼‰å…·æœ‰ä¸åŒçš„å¸ƒå±€å’Œä¸å¯å…±äº«çš„ JavaScriptã€‚æˆ‘ä»¬æƒ³è¦ä»åº”ç”¨ç¨‹åºæ–‡ä»¶ä¸­è¾“å‡º home é¡µé¢çš„ <code>home.js</code> å’Œ <code>home.css</code>ï¼Œä¸º account é¡µé¢è¾“å‡º <code>account.js</code> å’Œ <code>account.css</code>ã€‚</p> <p><strong>home.js</strong></p> <pre><code class="hljs language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'home page type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p><strong>home.scss</strong></p> <pre><code class="hljs language-scss"><span class="token comment">// home page individual styles</span></code></pre> <p><strong>account.js</strong></p> <pre><code class="hljs language-javascript">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'account page type'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p><strong>account.scss</strong></p> <pre><code class="hljs language-scss"><span class="token comment">// account page individual styles</span></code></pre> <p>æˆ‘ä»¬å°†åœ¨ <code>production(ç”Ÿäº§)</code> æ¨¡å¼ä¸­ä½¿ç”¨ <a href="../../plugins/mini-css-extract-plugin/index.htm" tppabs="https://webpack.docschina.org/plugins/mini-css-extract-plugin/"><code>MiniCssExtractPlugin</code></a> ä½œä¸º CSS çš„ä¸€ä¸ªæœ€ä½³å®è·µã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> MiniCssExtractPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mini-css-extract-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  mode<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span><span class="token punctuation">,</span>
  entry<span class="token operator">:</span> <span class="token punctuation">{</span>
    home<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./home.js'</span><span class="token punctuation">,</span> <span class="token string">'./home.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    account<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./account.js'</span><span class="token punctuation">,</span> <span class="token string">'./account.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    filename<span class="token operator">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  module<span class="token operator">:</span> <span class="token punctuation">{</span>
    rules<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.scss$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
        use<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token comment">// fallback to style-loader in development</span>
          process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span> <span class="token operator">?</span> <span class="token string">'style-loader'</span> <span class="token operator">:</span> MiniCssExtractPlugin<span class="token punctuation">.</span>loader<span class="token punctuation">,</span>
          <span class="token string">'css-loader'</span><span class="token punctuation">,</span>
          <span class="token string">'sass-loader'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      filename<span class="token operator">:</span> <span class="token string">'[name].css'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>ç”±äºæˆ‘ä»¬æœªæŒ‡å®šå…¶ä»–è¾“å‡ºè·¯å¾„ï¼Œå› æ­¤ä½¿ç”¨ä»¥ä¸Šé…ç½®è¿è¡Œ webpack å°†è¾“å‡ºåˆ° <code>./dist</code>ã€‚<code>./dist</code> ç›®å½•ä¸‹ç°åœ¨åŒ…å«å››ä¸ªæ–‡ä»¶ï¼š</p> <ul> <li>home.js</li> <li>home.css</li> <li>account.js</li> <li>account.css</li> </ul> <h1 id="èµ„æºæ¨¡å—">èµ„æºæ¨¡å—<a href="#%E8%B5%84%E6%BA%90%E6%A8%A1%E5%9D%97" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h1> <p>èµ„æºæ¨¡å—(asset module)æ˜¯ä¸€ç§æ¨¡å—ç±»å‹ï¼Œå®ƒå…è®¸ä½¿ç”¨èµ„æºæ–‡ä»¶ï¼ˆå­—ä½“ï¼Œå›¾æ ‡ç­‰ï¼‰è€Œæ— éœ€é…ç½®é¢å¤– loaderã€‚</p> <p>åœ¨ webpack 5 ä¹‹å‰ï¼Œé€šå¸¸ä½¿ç”¨ï¼š</p> <ul> <li><a href="../../loaders/raw-loader/index.htm" tppabs="https://webpack.docschina.org/loaders/raw-loader/"><code>raw-loader</code></a> å°†æ–‡ä»¶å¯¼å…¥ä¸ºå­—ç¬¦ä¸²</li> <li><a href="../../loaders/url-loader/index.htm" tppabs="https://webpack.docschina.org/loaders/url-loader/"><code>url-loader</code></a> å°†æ–‡ä»¶ä½œä¸º data URI å†…è”åˆ° bundle ä¸­</li> <li><a href="../../loaders/file-loader/index.htm" tppabs="https://webpack.docschina.org/loaders/file-loader/"><code>file-loader</code></a> å°†æ–‡ä»¶å‘é€åˆ°è¾“å‡ºç›®å½•</li> </ul> <p>èµ„æºæ¨¡å—ç±»å‹(asset module type)ï¼Œé€šè¿‡æ·»åŠ  4 ç§æ–°çš„æ¨¡å—ç±»å‹ï¼Œæ¥æ›¿æ¢æ‰€æœ‰è¿™äº› loaderï¼š</p> <ul> <li><code>asset/resource</code> å‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶å¹¶å¯¼å‡º URLã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ <code>file-loader</code> å®ç°ã€‚</li> <li><code>asset/inline</code> å¯¼å‡ºä¸€ä¸ªèµ„æºçš„ data URIã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ <code>url-loader</code> å®ç°ã€‚</li> <li><code>asset/source</code> å¯¼å‡ºèµ„æºçš„æºä»£ç ã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ <code>raw-loader</code> å®ç°ã€‚</li> <li><code>asset</code> åœ¨å¯¼å‡ºä¸€ä¸ª data URI å’Œå‘é€ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¹‹é—´è‡ªåŠ¨é€‰æ‹©ã€‚ä¹‹å‰é€šè¿‡ä½¿ç”¨ <code>url-loader</code>ï¼Œå¹¶ä¸”é…ç½®èµ„æºä½“ç§¯é™åˆ¶å®ç°ã€‚</li> </ul> <p>å½“åœ¨ webpack 5 ä¸­ä½¿ç”¨æ—§çš„ assets loaderï¼ˆå¦‚ <code>file-loader</code>/<code>url-loader</code>/<code>raw-loader</code> ç­‰ï¼‰å’Œ asset æ¨¡å—æ—¶ï¼Œä½ å¯èƒ½æƒ³åœæ­¢å½“å‰ asset æ¨¡å—çš„å¤„ç†ï¼Œå¹¶å†æ¬¡å¯åŠ¨å¤„ç†ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ asset é‡å¤ï¼Œä½ å¯ä»¥é€šè¿‡å°† asset æ¨¡å—çš„ç±»å‹è®¾ç½®ä¸º <code>'javascript/auto'</code> æ¥è§£å†³ã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">  rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.(png|jpg|gif)$/i,
</span><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: 'url-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">           options: {
</span><span class="token prefix unchanged"> </span><span class="token line">             limit: 8192,
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       type: 'javascript/auto'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">  ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>}</code></pre> <p>å¦‚éœ€ä» asset loader ä¸­æ’é™¤æ¥è‡ªæ–° URL å¤„ç†çš„ assetï¼Œè¯·æ·»åŠ  <code>dependency: { not: ['url'] }</code> åˆ° loader é…ç½®ä¸­ã€‚</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.(png|jpg|gif)$/i,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       dependency: { not: ['url'] }, 
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: 'url-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">           options: {
</span><span class="token prefix unchanged"> </span><span class="token line">             limit: 8192,
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>}</code></pre> <h2 id="resource-assets">Resource èµ„æº <a href="#resource-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> module: {
</span><span class="token prefix inserted">+</span><span class="token line">   rules: [
</span><span class="token prefix inserted">+</span><span class="token line">     {
</span><span class="token prefix inserted">+</span><span class="token line">       test: /\.png/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset/resource'
</span><span class="token prefix inserted">+</span><span class="token line">     }
</span><span class="token prefix inserted">+</span><span class="token line">   ]
</span><span class="token prefix inserted">+</span><span class="token line"> },
</span></span>};</code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">import</span> mainImage <span class="token keyword">from</span> <span class="token string">'./images/main.png'</span><span class="token punctuation">;</span>

img<span class="token punctuation">.</span>src <span class="token operator">=</span> mainImage<span class="token punctuation">;</span> <span class="token comment">// '/dist/151cfcfa1bd74779aadb.png'</span></code></pre> <p>æ‰€æœ‰ <code>.png</code> æ–‡ä»¶éƒ½å°†è¢«å‘é€åˆ°è¾“å‡ºç›®å½•ï¼Œå¹¶ä¸”å…¶è·¯å¾„å°†è¢«æ³¨å…¥åˆ° bundle ä¸­ã€‚</p> <h3 id="custom-output-filename">è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶å <a href="#custom-output-filename" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>asset/resource</code> æ¨¡å—ä»¥ <code>[hash][ext][query]</code> æ–‡ä»¶åå‘é€åˆ°è¾“å‡ºç›®å½•ã€‚</p> <p>å¯ä»¥é€šè¿‡åœ¨ webpack é…ç½®ä¸­è®¾ç½® <a href="../../configuration/output/index.htm#outputassetmodulefilename" tppabs="https://webpack.docschina.org/configuration/output/#outputassetmodulefilename"><code>output.assetModuleFilename</code></a> æ¥ä¿®æ”¹æ­¤æ¨¡æ¿å­—ç¬¦ä¸²ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   assetModuleFilename: 'images/[hash][ext][query]'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.png/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type: 'asset/resource'
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>å¦ä¸€ç§è‡ªå®šä¹‰è¾“å‡ºæ–‡ä»¶åçš„æ–¹å¼æ˜¯ï¼Œå°†æŸäº›èµ„æºå‘é€åˆ°æŒ‡å®šç›®å½•ï¼š</p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   assetModuleFilename: 'images/[hash][ext][query]'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.png/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type: 'asset/resource'
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     },
</span><span class="token prefix inserted">+</span><span class="token line">     {
</span><span class="token prefix inserted">+</span><span class="token line">       test: /\.html/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset/resource',
</span><span class="token prefix inserted">+</span><span class="token line">       generator: {
</span><span class="token prefix inserted">+</span><span class="token line">         filename: 'static/[hash][ext][query]'
</span><span class="token prefix inserted">+</span><span class="token line">       }
</span><span class="token prefix inserted">+</span><span class="token line">     }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>ä½¿ç”¨æ­¤é…ç½®ï¼Œæ‰€æœ‰ <code>html</code> æ–‡ä»¶éƒ½å°†è¢«å‘é€åˆ°è¾“å‡ºç›®å½•ä¸­çš„ <code>static</code> ç›®å½•ä¸­ã€‚</p> <p><code>Rule.generator.filename</code> ä¸ <a href="../../configuration/output/index.htm#outputassetmodulefilename" tppabs="https://webpack.docschina.org/configuration/output/#outputassetmodulefilename"><code>output.assetModuleFilename</code></a> ç›¸åŒï¼Œå¹¶ä¸”ä»…é€‚ç”¨äº <code>asset</code> å’Œ <code>asset/resource</code> æ¨¡å—ç±»å‹ã€‚</p> <h2 id="inlining-assets">inline èµ„æº(inlining asset) <a href="#inlining-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   assetModuleFilename: 'images/[hash][ext][query]'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       test: /\.png/,
</span><span class="token prefix deleted">-</span><span class="token line">       type: 'asset/resource'
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       test: /\.svg/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset/inline'
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     }
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     {
</span><span class="token prefix deleted">-</span><span class="token line">       test: /\.html/,
</span><span class="token prefix deleted">-</span><span class="token line">       type: 'asset/resource',
</span><span class="token prefix deleted">-</span><span class="token line">       generator: {
</span><span class="token prefix deleted">-</span><span class="token line">         filename: 'static/[hash][ext][query]'
</span><span class="token prefix deleted">-</span><span class="token line">       }
</span><span class="token prefix deleted">-</span><span class="token line">     }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> }
</span></span>};</code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import mainImage from './images/main.png';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import metroMap from './images/metro.svg';
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> img.src = mainImage; // '/dist/151cfcfa1bd74779aadb.png'
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> block.style.background = `url(${metroMap})`; // url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDo...vc3ZnPgo=)</span></span></code></pre> <p>æ‰€æœ‰ <code>.svg</code> æ–‡ä»¶éƒ½å°†ä½œä¸º data URI æ³¨å…¥åˆ° bundle ä¸­ã€‚</p> <h3 id="custom-data-uri-generator">è‡ªå®šä¹‰ data URI ç”Ÿæˆå™¨ <a href="#custom-data-uri-generator" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h3> <p>webpack è¾“å‡ºçš„ data URIï¼Œé»˜è®¤æ˜¯å‘ˆç°ä¸ºä½¿ç”¨ Base64 ç®—æ³•ç¼–ç çš„æ–‡ä»¶å†…å®¹ã€‚</p> <p>å¦‚æœè¦ä½¿ç”¨è‡ªå®šä¹‰ç¼–ç ç®—æ³•ï¼Œåˆ™å¯ä»¥æŒ‡å®šä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°æ¥ç¼–ç æ–‡ä»¶å†…å®¹ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const svgToMiniDataURI = require('mini-svg-data-uri');
</span></span>
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.svg/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type: 'asset/inline',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       generator: {
</span><span class="token prefix inserted">+</span><span class="token line">         dataUrl: content => {
</span><span class="token prefix inserted">+</span><span class="token line">           content = content.toString();
</span><span class="token prefix inserted">+</span><span class="token line">           return svgToMiniDataURI(content);
</span><span class="token prefix inserted">+</span><span class="token line">         }
</span><span class="token prefix inserted">+</span><span class="token line">       }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>ç°åœ¨ï¼Œæ‰€æœ‰ <code>.svg</code> æ–‡ä»¶éƒ½å°†é€šè¿‡ <code>mini-svg-data-uri</code> åŒ…è¿›è¡Œç¼–ç ã€‚</p> <h2 id="source-assets">source èµ„æº(source asset) <a href="#source-assets" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const svgToMiniDataURI = require('mini-svg-data-uri');
</span></span>
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       test: /\.svg/,
</span><span class="token prefix deleted">-</span><span class="token line">       type: 'asset/inline',
</span><span class="token prefix deleted">-</span><span class="token line">       generator: {
</span><span class="token prefix deleted">-</span><span class="token line">         dataUrl: content => {
</span><span class="token prefix deleted">-</span><span class="token line">           content = content.toString();
</span><span class="token prefix deleted">-</span><span class="token line">           return svgToMiniDataURI(content);
</span><span class="token prefix deleted">-</span><span class="token line">         }
</span><span class="token prefix deleted">-</span><span class="token line">       }
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       test: /\.txt/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset/source',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p><strong>src/example.txt</strong></p> <pre><code class="hljs language-text">Hello world
</code></pre> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> import metroMap from './images/metro.svg';
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import exampleText from './example.txt';
</span></span>
<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> block.style.background = `url(${metroMap}); // url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDo...vc3ZnPgo=)
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> block.textContent = exampleText; // 'Hello world'</span></span></code></pre> <p>æ‰€æœ‰ <code>.txt</code> æ–‡ä»¶å°†åŸæ ·æ³¨å…¥åˆ° bundle ä¸­ã€‚</p> <h2 id="URL-èµ„æº">URL èµ„æº<a href="#URL-%E8%B5%84%E6%BA%90" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>å½“ä½¿ç”¨ <code>new URL('./path/to/asset', import.meta.url)</code>ï¼Œwebpack ä¹Ÿä¼šåˆ›å»ºèµ„æºæ¨¡å—ã€‚</p> <p><strong>src/index.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> logo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span><span class="token string">'./logo.svg'</span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <p>æ ¹æ®ä½ é…ç½®ä¸­ <a href="../../configuration/target/index.htm" tppabs="https://webpack.docschina.org/configuration/target/"><code>target</code></a> çš„ä¸åŒï¼Œwebpack ä¼šå°†ä¸Šè¿°ä»£ç ç¼–è¯‘æˆä¸åŒç»“æœï¼š</p> <pre><code class="hljs language-js"><span class="token comment">// target: web</span>
<span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>__webpack_public_path__ <span class="token operator">+</span> <span class="token string">'logo.svg'</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span>baseURI <span class="token operator">||</span> self<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// target: webworker</span>
<span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>__webpack_public_path__ <span class="token operator">+</span> <span class="token string">'logo.svg'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>location<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// target: node, node-webkit, nwjs, electron-main, electron-renderer, electron-preload, async-node</span>
<span class="token keyword">new</span> <span class="token class-name">URL</span><span class="token punctuation">(</span>__webpack_public_path__ <span class="token operator">+</span> <span class="token string">'logo.svg'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pathToFileUrl</span><span class="token punctuation">(</span>__filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <h2 id="general-asset-type">é€šç”¨èµ„æºç±»å‹ <a href="#general-asset-type" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       test: /\.txt/,
</span><span class="token prefix inserted">+</span><span class="token line">       type: 'asset',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>ç°åœ¨ï¼Œwebpack å°†æŒ‰ç…§é»˜è®¤æ¡ä»¶ï¼Œè‡ªåŠ¨åœ°åœ¨ <code>resource</code> å’Œ <code>inline</code> ä¹‹é—´è¿›è¡Œé€‰æ‹©ï¼šå°äº 8kb çš„æ–‡ä»¶ï¼Œå°†ä¼šè§†ä¸º <code>inline</code> æ¨¡å—ç±»å‹ï¼Œå¦åˆ™ä¼šè¢«è§†ä¸º <code>resource</code> æ¨¡å—ç±»å‹ã€‚</p> <p>å¯ä»¥é€šè¿‡åœ¨ webpack é…ç½®çš„ module rule å±‚çº§ä¸­ï¼Œè®¾ç½® <a href="../../configuration/module/index.htm#ruleparserdataurlcondition" tppabs="https://webpack.docschina.org/configuration/module/#ruleparserdataurlcondition"><code>Rule.parser.dataUrlCondition.maxSize</code></a> é€‰é¡¹æ¥ä¿®æ”¹æ­¤æ¡ä»¶ï¼š</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-diff">const path = require('path');

module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: 'main.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist')
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.txt/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type: 'asset',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       parser: {
</span><span class="token prefix inserted">+</span><span class="token line">         dataUrlCondition: {
</span><span class="token prefix inserted">+</span><span class="token line">           maxSize: 4 * 1024 // 4kb
</span><span class="token prefix inserted">+</span><span class="token line">         }
</span><span class="token prefix inserted">+</span><span class="token line">       }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span></span>};</code></pre> <p>è¿˜å¯ä»¥ <a href="../../configuration/module/index.htm#ruleparserdataurlcondition" tppabs="https://webpack.docschina.org/configuration/module/#ruleparserdataurlcondition">æŒ‡å®šä¸€ä¸ªå‡½æ•°</a> æ¥å†³å®šæ˜¯å¦ inline æ¨¡å—ã€‚</p> </div><div class="contributors__section"><hr/><h3>Contributors</h3><div class="contributors"><div class="contributors__list"><a class="contributor" href="javascript:if(confirm('https://github.com/webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack'" tppabs="https://github.com/webpack"><img alt="webpack" src="../../icon-square-small-slack.9281492bb267314634b4.png" tppabs="https://webpack.docschina.org/icon-square-small-slack.9281492bb267314634b4.png"/><span class="contributor__name"> <!-- -->webpack</span></a></div></div></div></div></section></div><footer class="footer"><div class="container footer__inner"><section class="footer__left"><a class="footer__link" href="../getting-started/index.htm" tppabs="https://webpack.docschina.org/guides/getting-started/">èµ·æ­¥</a><a class="footer__link" href="../../organization/index.htm" tppabs="https://webpack.docschina.org/organization/">ç»„ç»‡</a><a class="footer__link" href="../../comparison/index.htm" tppabs="https://webpack.docschina.org/comparison/">æ¯”è¾ƒ</a></section><section class="footer__middle"><a class="footer__icon" href="../../index-1.htm" tppabs="https://webpack.docschina.org/"><img src="../../icon-square-small.85ba630cf0c5f29ae3e3.svg" tppabs="https://webpack.docschina.org/icon-square-small.85ba630cf0c5f29ae3e3.svg" alt="webpack icon"/></a></section><section class="footer__right"><a href="javascript:if(confirm('https://webpack.threadless.com/  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://webpack.threadless.com/'" tppabs="https://webpack.threadless.com/" target="_blank" rel="noopener noreferrer" class="footer__link">å•†åº—</a><a class="footer__link" href="../../glossary/index.htm" tppabs="https://webpack.docschina.org/glossary/">æ¦‚å¿µæœ¯è¯­</a><a class="footer__link" href="../../branding/index.htm" tppabs="https://webpack.docschina.org/branding/">å“ç‰Œ</a><a href="javascript:if(confirm('https://gitter.im/webpack/webpack  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://gitter.im/webpack/webpack'" tppabs="https://gitter.im/webpack/webpack" target="_blank" rel="noopener noreferrer" class="footer__link">Gitter</a><a href="javascript:if(confirm('https://github.com/webpack/webpack/releases  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ËüÊÇÒ»¸öÓò»òÂ·¾¶Íâ²¿±»ÉèÖÃÎªËüµÄÆôÊ¼µØÖ·µÄµØÖ·¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://github.com/webpack/webpack/releases'" tppabs="https://github.com/webpack/webpack/releases" target="_blank" rel="noopener noreferrer" class="footer__link">æ›´æ–°æ—¥å¿—</a><a class="footer__link footer__license" href="../../license.htm" tppabs="https://webpack.docschina.org/license"><img alt="Creative Commons License" src="../../cc.ab77d813bf219c6e34ff.svg" tppabs="https://webpack.docschina.org/cc.ab77d813bf219c6e34ff.svg"/><img alt="Creative Commons License" src="../../by.1360bb2e6d1fc28cdd9e.svg" tppabs="https://webpack.docschina.org/by.1360bb2e6d1fc28cdd9e.svg"/></a></section></div></footer></div></div><script>
window.matchMedia('print').addListener(function(mql) {
  if (!mql.matches) {
      window.close();
  }
});
window.print();
</script><script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "../../../hm.baidu.com/hm.js-39edd8e76884f07399be96cd422c9af3"/*tpa=https://hm.baidu.com/hm.js?39edd8e76884f07399be96cd422c9af3*/;
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script></body></html>