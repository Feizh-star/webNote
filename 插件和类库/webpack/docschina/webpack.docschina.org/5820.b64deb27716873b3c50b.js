(self.webpackChunk=self.webpackChunk||[]).push([[5820],{5820:function(n){n.exports='<blockquote class="tip"> <p>本 API 从 v4.39.0 开始可用</p> </blockquote> <p>使用 Logger 输出消息是一种向用户展示信息的有效方式。</p> <p>Webpack Logger 可以用在 <a href="loaders/index.htm"/*tpa=https://webpack.docschina.org/loaders/*/>loader</a> 和 <a href="api/plugins/index.htm#logging"/*tpa=https://webpack.docschina.org/api/plugins/#logging*/>plugin</a>。生成的 Logger 将作为 <a href="api/stats/index.htm"/*tpa=https://webpack.docschina.org/api/stats/*/>统计信息</a> 的一部分进行输出，并且用户可以在 <a href="configuration/index.htm"/*tpa=https://webpack.docschina.org/configuration/*/>webpack 配置文件</a> 中对 Logger 进行配置。</p> <p>在 Webpack 中使用自定义 Logger API 的优点：</p> <ul> <li>可以 <a href="configuration/stats/index.htm#statslogging"/*tpa=https://webpack.docschina.org/configuration/stats/#statslogging*/>配置</a> 日志的展示级别</li> <li>日志内容可作为 <code>stats.json</code> 的一部分输出</li> <li>统计预设会影响日志的输出</li> <li>使用 plugin 可以影响日志的捕获与展示级别</li> <li>当使用多个 plugin 和 loader 时，提供更加通用的日志记录解决方案</li> <li>基于 Webpack 开发的 CLI、UI 工具等可能会选择不同的方式来展示日志</li> <li>Webpack 核心可以触发日志输出，例如：timing data</li> </ul> <p>通过引入 Webpack Logger API，我们希望统一 Webpack plugins 和 loaders 生成日志的方式，并提供更好的方法来检查构建问题。 集成的 Logging 解决方案可以帮助 plugins 和 loader 的开发人员提升他们的开发经验。同时为非 CLI 形式的 Webpack 解决方案构建铺平了道路，例如 dashboard 或其他 UI。</p> <blockquote class="warning"> <p>__避免在日志中输出无效信息！__请记住，多个 plugin 和 loader 经常一起使用。loader 通常处理多个文件，并且每个文件都会调用，所以尽可能选择较低的日志级别以保证 log 的信息量。</p> </blockquote> <h2 id="examples-of-how-to-get-and-use-webpack-logger-in-loaders-and-plugins">Examples of how to get and use webpack logger in loaders and plugins <a href="#examples-of-how-to-get-and-use-webpack-logger-in-loaders-and-plugins" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><strong>my-webpack-plugin.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> <span class="token constant">PLUGIN_NAME</span> <span class="token operator">=</span> <span class="token string">\'my-webpack-plugin\'</span><span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">{</span>\n  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token comment">// you can access Logger from compiler</span>\n    <span class="token keyword">const</span> logger <span class="token operator">=</span> compiler<span class="token punctuation">.</span><span class="token function">getInfrastructureLogger</span><span class="token punctuation">(</span><span class="token constant">PLUGIN_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'log from compiler\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token constant">PLUGIN_NAME</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n      <span class="token comment">// you can also access Logger from compilation</span>\n      <span class="token keyword">const</span> logger <span class="token operator">=</span> compilation<span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token constant">PLUGIN_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">\'log from compilation\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre> <p><strong>my-webpack-loader.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">source</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// you can get Logger with `this.getLogger` in your webpack loaders</span>\n  <span class="token keyword">const</span> logger <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token string">\'my-webpack-loader\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">\'hello Logger\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> source<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="logger-methods">Logger methods <a href="#logger-methods" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <ul> <li><code>logger.error(...)</code>：用于输出错误信息</li> <li><code>logger.warn(...)</code>：用于输出警告信息</li> <li><code>logger.info(...)</code>：用于输出__重要__信息。默认情况下会显示这些信息，所以仅用于输出用户真正需要查看的消息</li> <li><code>logger.log(...)</code>：用于输出__不重要__的信息。只有当用户选择查看时，才会显示</li> <li><code>logger.debug(...)</code>：用于输出调试信息。只有当用户选择查看特定模块的调试日志时，才会显示</li> <li><code>logger.trace()</code>：显示堆栈跟踪信息，展示形式类似于 <code>logger.debug</code></li> <li><code>logger.group(...)</code>：将消息进行分组，展示形式类似于 <code>logger.log</code></li> <li><code>logger.groupEnd()</code>：结束消息分组</li> <li><code>logger.groupCollapsed(...)</code>：将消息进行分组。默认显示为折叠 <code>logger.log</code> 日志，当日志记录级别设置为 <code>\'verbose\'</code> 或 <code>\'debug\'</code> 时，显示展开的日志</li> <li><code>logger.status</code>：写入一条临时消息，并且设置新状态，覆盖上一个状态</li> <li><code>logger.clear()</code>：打印水平线。展示形式类似于 <code>logger.log</code></li> <li><code>logger.profile(...)</code>，<code>logger.profileEnd(...)</code>：捕获配置文件。当支持 <code>console.profile</code> API 时，使用其进行输出</li> </ul> <h2 id="runtime-logger-api">Runtime Logger API <a href="#runtime-logger-api" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p>Runtime logger API 仅应该用作开发工具，不应该包含在 <a href="configuration/mode/index.htm#mode-production"/*tpa=https://webpack.docschina.org/configuration/mode/#mode-production*/>生产模式</a>中。</p> <ul> <li><code>const logging = require(\'webpack/lib/logging/runtime\')</code>：直接从 Webpack 中引入即可使用 logger API</li> <li><code>logging.getLogger(\'name\')</code>：根据名称获取一个 logger 的实例</li> <li><code>logging.configureDefaultLogger(...)</code>：重写 logger 的默认配置</li> </ul> <pre><code class="hljs language-javascript"><span class="token keyword">const</span> logging <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack/lib/logging/runtime\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nlogging<span class="token punctuation">.</span><span class="token function">configureDefaultLogger</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n  level<span class="token operator">:</span> <span class="token string">\'log\'</span><span class="token punctuation">,</span>\n  debug<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">something</span><span class="token regex-delimiter">/</span></span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> <ul> <li><code>logging.hooks.log</code>：向 logger 中添加 Plugins</li> </ul> '}}]);