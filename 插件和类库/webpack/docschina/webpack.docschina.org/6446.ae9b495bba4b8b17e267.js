(self.webpackChunk=self.webpackChunk||[]).push([[6446],{6446:function(n){n.exports='<p>从 webpack 4 开始，会根据你选择的 <a href="concepts/mode/index.htm"/*tpa=https://webpack.docschina.org/concepts/mode/*/><code>mode</code></a> 来执行不同的优化， 不过所有的优化还是可以手动配置和重写。</p> <h2 id="optimizationminimize"><code>optimization.minimize</code> <a href="#optimizationminimize" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = true</code></p> <p>告知 webpack 使用 <a href="plugins/terser-webpack-plugin/index.htm"/*tpa=https://webpack.docschina.org/plugins/terser-webpack-plugin/*/>TerserPlugin</a> 或其它在 <a href="#optimizationminimizer"><code>optimization.minimizer</code></a> 定义的插件压缩 bundle。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    minimize<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <blockquote class="tip"> <p>了解 <a href="concepts/mode/index.htm"/*tpa=https://webpack.docschina.org/concepts/mode/*/>mode</a> 工作机制。</p> </blockquote> <h2 id="optimizationminimizer"><code>optimization.minimizer</code> <a href="#optimizationminimizer" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>[TerserPlugin]</code> 或 <code>[function (compiler)]</code></p> <p>允许你通过提供一个或多个定制过的 <a href="plugins/terser-webpack-plugin/index.htm"/*tpa=https://webpack.docschina.org/plugins/terser-webpack-plugin/*/>TerserPlugin</a> 实例， 覆盖默认压缩工具(minimizer)。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js"><span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'terser-webpack-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n        cache<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n        parallel<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n        sourceMap<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 如果在生产环境中使用 source-maps，必须设置为 true</span>\n        terserOptions<span class="token operator">:</span> <span class="token punctuation">{</span>\n          <span class="token comment">// https://github.com/webpack-contrib/terser-webpack-plugin#terseroptions</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>或，使用函数的形式：</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n        <span class="token keyword">const</span> TerserPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'terser-webpack-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token keyword">new</span> <span class="token class-name">TerserPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment">/* 你的选项 */</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>在 <code>optimization.minimizer</code> 中可以使用 <code>\'...\'</code> 来访问默认值。</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    minimizer<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">CssMinimizer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">\'...\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationsplitchunks"><code>optimization.splitChunks</code> <a href="#optimizationsplitchunks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>object</code></p> <p>对于动态导入模块，默认使用 webpack v4+ 提供的全新的通用分块策略(common chunk strategy)。请在 <a href="plugins/split-chunks-plugin/index.htm"/*tpa=https://webpack.docschina.org/plugins/split-chunks-plugin/*/>SplitChunksPlugin</a> 页面中查看配置其行为的可用选项。</p> <h2 id="optimizationruntimechunk"><code>optimization.runtimeChunk</code> <a href="#optimizationruntimechunk" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>object</code> <code>string</code> <code>boolean</code></p> <p>将 <code>optimization.runtimeChunk</code> 设置为 <code>true</code> 或 <code>\'multiple\'</code>，会为每个只含有 runtime 的入口添加一个额外 chunk。此配置的别名如下：</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    runtimeChunk<span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token function-variable function">name</span><span class="token operator">:</span> <span class="token parameter">entrypoint</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">runtime~</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>entrypoint<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>值 <code>"single"</code> 会创建一个在所有生成 chunk 之间共享的运行时文件。此设置是如下设置的别名：</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    runtimeChunk<span class="token operator">:</span> <span class="token punctuation">{</span>\n      name<span class="token operator">:</span> <span class="token string">\'runtime\'</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>通过将 <code>optimization.runtimeChunk</code> 设置为 <code>object</code>，对象中可以设置只有 <code>name</code> 属性，其中属性值可以是名称或者返回名称的函数， 用于为 runtime chunks 命名。</p> <p>默认值是 <code>false</code>：每个入口 chunk 中直接嵌入 runtime。</p> <blockquote class="warning"> <p>对于每个 runtime chunk，导入的模块会被分别初始化，因此如果你在同一个页面中引用多个入口起点，请注意此行为。你或许应该将其设置为 <code>single</code>，或者使用其他只有一个 runtime 实例的配置。</p> </blockquote> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    runtimeChunk<span class="token operator">:</span> <span class="token punctuation">{</span>\n      <span class="token function-variable function">name</span><span class="token operator">:</span> <span class="token parameter">entrypoint</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">runtimechunk~</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>entrypoint<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationemitOnErrors"><code>optimization.emitOnErrors</code><a href="#optimizationemitOnErrors" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = false</code></p> <p>使用 <code>optimization.emitOnErrors</code> 在编译时每当有错误时，就会 emit asset。这样可以确保出错的 asset 被 emit 出来。关键错误会被 emit 到生成的代码中，并会在运行时报错。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    emitOnErrors<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <blockquote class="warning"> <p>如果你使用的是 webpack 的 <a href="api/cli/index.htm"/*tpa=https://webpack.docschina.org/api/cli/*/>CLI</a>，当这个插件被启用时，webpack 进程不会以错误代码退出。如果你想让 webpack 在使用 CLI 时 "fail"，请查阅 <a href="api/cli/index.htm#advanced-options"/*tpa=https://webpack.docschina.org/api/cli/#advanced-options*/><code>bail</code> 选项</a>。</p> </blockquote> <h2 id="optimizationmoduleids"><code>optimization.moduleIds</code> <a href="#optimizationmoduleids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = false</code> <code>string: \'natural\' | \'named\' | \'deterministic\' | \'size\'</code></p> <p>告知 webpack 当选择模块 id 时需要使用哪种算法。将 <code>optimization.moduleIds</code> 设置为 <code>false</code> 会告知 webpack 没有任何内置的算法会被使用，但自定义的算法会由插件提供。<code>optimization.moduleIds</code> 的默认值是 <code>false</code>。</p> <p>下面的字符串值均被支持：</p> <table> <thead> <tr> <th>选荐值</th> <th>描述</th> </tr> </thead> <tbody> <tr> <td data-th="选荐值"><span><code>natural</code></span></td> <td data-th="描述"><span>按使用顺序的数字 id。</span></td> </tr> <tr> <td data-th="选荐值"><span><code>named</code></span></td> <td data-th="描述"><span>对调试更友好的可读的 id。</span></td> </tr> <tr> <td data-th="选荐值"><span><code>deterministic</code></span></td> <td data-th="描述"><span>被哈希转化成的小位数值模块名。</span></td> </tr> <tr> <td data-th="选荐值"><span><code>size</code></span></td> <td data-th="描述"><span>专注于让初始下载包大小更小的数字 id。</span></td> </tr> </tbody> </table> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    moduleIds<span class="token operator">:</span> <span class="token string">\'deterministic\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p><code>deterministic</code> 选项有益于长期缓存，但对比于 <code>hashed</code> 来说，它会导致更小的文件 bundles。数字值的长度会被选作用于填满最多80%的id空间。 当 <code>optimization.moduleIds</code> 被设置成 <code>deterministic</code>，默认最小3位数字会被使用。 要覆盖默认行为，要将 <code>optimization.moduleIds</code> 设置成 <code>false</code>， 并且要使用 <code>webpack.ids.DeterministicModuleIdsPlugin</code>。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    moduleIds<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ids<span class="token punctuation">.</span>DeterministicModuleIdsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      maxLength<span class="token operator">:</span> <span class="token number">5</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <blockquote class="warning"> <p><code>moduleIds: \'deterministic\'</code> 在 webpack 5 中被添加，而且 <code>moduleIds: \'hashed\'</code> 相应地会在 webpack 5 中废弃。</p> </blockquote> <blockquote class="warning"> <p><code>moduleIds: total-size</code> 在 webpack 5 中被废弃。</p> </blockquote> <h2 id="optimizationchunkids"><code>optimization.chunkIds</code> <a href="#optimizationchunkids" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = false</code> <code>string: \'natural\' | \'named\' | \'size\' | \'total-size\' | \'deterministic\' </code></p> <p>告知 webpack 当选择模块 id 时需要使用哪种算法。将 <code>optimization.chunkIds</code> 设置为 <code>false</code> 会告知 webpack 没有任何内置的算法会被使用，但自定义的算法会由插件提供。<code>optimization.chunkIds</code> 的默认值是 <code>false</code>：</p> <ul> <li>如果环境是开发环境，那么 <code>optimization.chunkIds</code> 会被设置成 <code>\'named\'</code>,</li> </ul> <p>但当在生产环境中时，它会被设置成 <code>\'deterministic\'</code></p> <ul> <li>如果上述的条件都不符合, <code>optimization.chunkIds</code> 会被默认设置为 <code>\'natural\'</code></li> </ul> <p>下述选项字符串值均为被支持:</p> <table> <thead> <tr> <th>选项值</th> <th>描述</th> </tr> </thead> <tbody> <tr> <td data-th="选项值"><span><code>\'natural\'</code></span></td> <td data-th="描述"><span>按使用顺序的数字 id。</span></td> </tr> <tr> <td data-th="选项值"><span><code>\'named\'</code></span></td> <td data-th="描述"><span>对调试更友好的可读的 id。</span></td> </tr> <tr> <td data-th="选项值"><span><code>\'deterministic\'</code></span></td> <td data-th="描述"><span>在不同的编译中不变的短数字 id。有益于长期缓存。</span></td> </tr> <tr> <td data-th="选项值"><span>在生产模式中会默认开启。</span></td> <td></td> </tr> <tr> <td data-th="选项值"><span><code>\'size\'</code></span></td> <td data-th="描述"><span>专注于让初始下载包大小更小的数字 id。</span></td> </tr> <tr> <td data-th="选项值"><span><code>\'total-size\'</code></span></td> <td data-th="描述"><span>专注于让总下载包大小更小的数字 id。</span></td> </tr> </tbody> </table> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    chunkIds<span class="token operator">:</span> <span class="token string">\'named\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>默认地，当 <code>optimization.chunkIds</code> 被设置为 <code>\'deterministic\'</code> 时，最少3位数字会被使用。要覆盖默认的行为， 要将 <code>optimization.chunkIds</code> 设置为 <code>false</code>，同时要使用 <code>webpack.ids.DeterministicChunkIdsPlugin</code>。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    chunkIds<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ids<span class="token punctuation">.</span>DeterministicChunkIdsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n      maxLength<span class="token operator">:</span> <span class="token number">5</span>\n    <span class="token punctuation">}</span><span class="token punctuation">)</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationnodeenv"><code>optimization.nodeEnv</code> <a href="#optimizationnodeenv" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = false</code> <code>string</code></p> <p>告知 webpack 将 <code>process.env.NODE_ENV</code> 设置为一个给定字符串。如果 <code>optimization.nodeEnv</code> 不是 <code>false</code>，则会使用 <a href="plugins/define-plugin/index.htm"/*tpa=https://webpack.docschina.org/plugins/define-plugin/*/>DefinePlugin</a>，<code>optimization.nodeEnv</code> __默认值__取决于 <a href="concepts/mode/index.htm"/*tpa=https://webpack.docschina.org/concepts/mode/*/>mode</a>，如果为 falsy 值，则会回退到 <code>"production"</code>。</p> <p>可能的值有：</p> <ul> <li>任何字符串：用于设置 <code>process.env.NODE_ENV</code> 的值。</li> <li>false：不修改/设置 <code>process.env.NODE_ENV</code>的值。</li> </ul> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    nodeEnv<span class="token operator">:</span> <span class="token string">\'production\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <blockquote class="tip"> <p>当 <a href="configuration/mode/index.htm"/*tpa=https://webpack.docschina.org/configuration/mode/*/>mode</a> 设置为 <code>\'none\'</code> 时，<code>optimization.nodeEnv</code> 的默认值为 <code>false</code>。</p> </blockquote> <h2 id="optimizationmanglewasmimports"><code>optimization.mangleWasmImports</code> <a href="#optimizationmanglewasmimports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = false</code></p> <p>在设置为 <code>true</code> 时，告知 webpack 通过将导入修改为更短的字符串，来减少 WASM 大小。这会破坏模块和导出名称。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    mangleWasmImports<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationremoveavailablemodules"><code>optimization.removeAvailableModules</code> <a href="#optimizationremoveavailablemodules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = false</code></p> <p>如果模块已经包含在所有父级模块中，告知 webpack 从 chunk 中检测出这些模块，或移除这些模块。将 <code>optimization.removeAvailableModules</code> 设置为 <code>true</code> 以启用这项优化。在 <a href="configuration/mode/index.htm"/*tpa=https://webpack.docschina.org/configuration/mode/*/><code>生产</code> 模式</a> 中默认会被开启。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    removeAvailableModules<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <blockquote class="warning"> <p><code>optimization.removeAvailableModules</code> 会削减了 webapck 的性能表现，而且将会在下一个主要发布版本中，在 <code>生产</code> 模式下会被禁用。 如果你想获得额外的构建性能，请在 <code>生产</code> 模式中禁用它。</p> </blockquote> <h2 id="optimizationremoveemptychunks"><code>optimization.removeEmptyChunks</code> <a href="#optimizationremoveemptychunks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = true</code></p> <p>如果 chunk 为空，告知 webpack 检测或移除这些 chunk。将 <code>optimization.removeEmptyChunks</code> 设置为 <code>false</code> 以禁用这项优化。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    removeEmptyChunks<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationmergeduplicatechunks"><code>optimization.mergeDuplicateChunks</code> <a href="#optimizationmergeduplicatechunks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = true</code></p> <p>告知 webpack 合并含有相同模块的 chunk。将 <code>optimization.mergeDuplicateChunks</code> 设置为 <code>false</code> 以禁用这项优化。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    mergeDuplicateChunks<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationflagincludedchunks"><code>optimization.flagIncludedChunks</code> <a href="#optimizationflagincludedchunks" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean</code></p> <p>告知 webpack 确定和标记出作为其他 chunk 子集的那些 chunk，其方式是在已经加载过较大的 chunk 之后，就不再去加载这些 chunk 子集。<code>optimization.flagIncludedChunks</code> 默认会在 <code>生产</code> <a href="concepts/mode/index.htm"/*tpa=https://webpack.docschina.org/concepts/mode/*/>模式</a> 中启用，其他情况禁用。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    flagIncludedChunks<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationoccurrenceorder"><code>optimization.occurrenceOrder</code> <a href="#optimizationoccurrenceorder" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean</code></p> <p>告知 webpack 去确定那些会引致更小的初始化文件 bundle 的模块顺序。<code>optimization.occurrenceOrder</code> 默认会在 <code>生产</code> <a href="concepts/mode/index.htm"/*tpa=https://webpack.docschina.org/concepts/mode/*/>模式</a> 中启用，其他情况禁用。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    occurrenceOrder<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationprovidedexports"><code>optimization.providedExports</code> <a href="#optimizationprovidedexports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean</code></p> <p>告知 webpack 去确定那些由模块提供的导出内容，为 <code>export * from ...</code> 生成更多高效的代码。 默认 <code>optimization.providedExports</code> 会被启用。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    providedExports<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationusedexports"><code>optimization.usedExports</code> <a href="#optimizationusedexports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = true</code> <code>string: \'global\'</code></p> <p>告知 webpack 去决定每个模块使用的导出内容。这取决于 <a href="#optimizationoccurrenceorder"><code>optimization.providedExports</code></a> 选项。由 <code>optimization.usedExports</code> 收集的信息会被其它优化手段或者代码生成使用，比如未使用的导出内容不会被生成， 当所有的使用都适配，导出名称会被处理做单个标记字符。 在压缩工具中的无用代码清除会受益于该选项，而且能够去除未使用的导出内容。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    usedExports<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>选择退出每次运行时使用 export 分享：</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    usedExports<span class="token operator">:</span> <span class="token string">\'global\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationconcatenatemodules"><code>optimization.concatenateModules</code> <a href="#optimizationconcatenatemodules" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean</code></p> <p>告知 webpack 去寻找模块图形中的片段，哪些是可以安全地被合并到单一模块中。这取决于 <a href="#optimizationprovidedexports"><code>optimization.providedExports</code></a> 和 <a href="#optimizationusedexports"><code>optimization.usedExports</code></a>。 默认 <code>optimization.concatenateModules</code> 在 <code>生产</code> <a href="configuration/mode/index.htm"/*tpa=https://webpack.docschina.org/configuration/mode/*/>模式</a> 下被启用，而在其它情况下被禁用。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    concatenateModules<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationsideeffects"><code>optimization.sideEffects</code> <a href="#optimizationsideeffects" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = true</code> <code>string: \'flag\'</code></p> <p>告知 webpack 去辨识 <code>package.json</code> 中的 <a href="https://github.com/webpack/webpack/blob/master/examples/side-effects/README.md"><code>副作用</code></a> 标记或规则，以跳过那些当导出不被使用且被标记不包含副作用的模块。</p> <p><strong>package.json</strong></p> <pre><code class="hljs language-json"><span class="token punctuation">{</span>\n  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"awesome npm module"</span><span class="token punctuation">,</span>\n  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>\n  <span class="token property">"sideEffects"</span><span class="token operator">:</span> <span class="token boolean">false</span>\n<span class="token punctuation">}</span></code></pre> <blockquote class="tip"> <p>请注意的是 <code>（副作用）sideEffects</code> 需要在 npm 模块的 <code>package.json</code> 文件中，但并不意味着你需要在你自己的引用那个大模块的项目中的 <code>package.json</code> 中将 <code>sideEffects</code> 设置成 <code>false</code>。</p> </blockquote> <p><code>optimization.sideEffects</code> 取决于 <a href="#optimizationprovidedexports"><code>optimization.providedExports</code></a> 被设置成启用。这个依赖会有构建时间的损耗，但去掉模块会对性能有正面的影响，因为更少的代码被生成。该优化的效果取决于你的代码库， 可以尝试这个特性以获取一些可能的性能优化。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    sideEffects<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>只使用手动 flag，并且不对源码进行分析：</p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    sideEffects<span class="token operator">:</span> <span class="token string">\'flag\'</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <p>此处的 <code>\'flag\'</code> 值在非生产环境默认使用。</p> <blockquote class="tip"> <p>设置为 <code>optimization.sideEffects</code> 时，当模块只包含无副作用的语句时，此模块也会被标记为无副作用。</p> </blockquote> <h2 id="optimizationportablerecords"><code>optimization.portableRecords</code> <a href="#optimizationportablerecords" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean</code></p> <p><code>optimization.portableRecords</code> 告知 webpack 生成带有相对路径的记录(records)使得可以移动上下文目录。</p> <p>默认 <code>optimization.portableRecords</code> 被禁用。如果下列至少一个选项在 webpack 中被设置，该选项也会自动启用：<a href="configuration/other-options/index.htm#recordspath"/*tpa=https://webpack.docschina.org/configuration/other-options/#recordspath*/><code>recordsPath</code></a>, <a href="configuration/other-options/index.htm#recordsinputpath"/*tpa=https://webpack.docschina.org/configuration/other-options/#recordsinputpath*/><code>recordsInputPath</code></a>, <a href="configuration/other-options/index.htm#recordsoutputpath"/*tpa=https://webpack.docschina.org/configuration/other-options/#recordsoutputpath*/><code>recordsOutputPath</code></a>。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    portableRecords<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationmangleexports"><code>optimization.mangleExports</code> <a href="#optimizationmangleexports" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean</code> <code>string: \'deterministic\' | \'size\'</code></p> <p><code>optimization.mangleExports</code> 允许控制导出处理(export mangling)。</p> <p>默认 <code>optimization.mangleExports: \'deterministic\'</code> 会在 <code>production</code> <a href="configuration/mode/index.htm"/*tpa=https://webpack.docschina.org/configuration/mode/*/>模式下</a> 启用而其它情况会被禁用。</p> <p>此选项支持以下选项：</p> <table> <thead> <tr> <th>选项</th> <th>描述</th> </tr> </thead> <tbody> <tr> <td data-th="选项"><span><code>\'size\'</code></span></td> <td data-th="描述"><span>简写形式 — 通常只有一个字符 — 专注于最小的下载 size。</span></td> </tr> <tr> <td data-th="选项"><span><code>\'deterministic\'</code></span></td> <td data-th="描述"><span>简写形式 - 通常两个字符 — 在添加或移除 export 时不会改变。适用于长效缓存。</span></td> </tr> <tr> <td data-th="选项"><span><code>true</code></span></td> <td data-th="描述"><span>等价于 <code>\'deterministic\'</code></span></td> </tr> <tr> <td data-th="选项"><span><code>false</code></span></td> <td data-th="描述"><span>保留原名，有利于阅读和调试。</span></td> </tr> </tbody> </table> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    mangleExports<span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationinnergraph"><code>optimization.innerGraph</code> <a href="#optimizationinnergraph" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = true</code></p> <p><code>optimization.innerGraph</code> 告知 webpack 是否对未使用的导出内容，实施内部图形分析(graph analysis)。</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    innerGraph<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> <h2 id="optimizationrealContentHash"><code>optimization.realContentHash</code><a href="#optimizationrealContentHash" aria-hidden="true" tabindex="-1"><span class="header-link"></span></a></h2> <p><code>boolean = true</code></p> <p>Adds an additional hash compilation pass after the assets have been processed to get the correct asset content hashes. If <code>realContentHash</code> is set to <code>false</code>, internal data is used to calculate the hash and it can change when assets are identical.</p> <p><strong>webpack.config.js</strong></p> <pre><code class="hljs language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">//...</span>\n  optimization<span class="token operator">:</span> <span class="token punctuation">{</span>\n    realContentHash<span class="token operator">:</span> <span class="token boolean">false</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre> '}}]);