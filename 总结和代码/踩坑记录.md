### 1.Typescript

#### 1.1 setup+ts报__模块的默认导出具有或正在使用专用名称“IProps”__

* 把script中的类型全部加上export导出，包括type和interface

#### 1.2 tsconfig.json报__无法写入文件“xxx.js”，因为它会覆盖输入文件__

* 原因：开启了allowJs

* 补充配置：

  ```json
  {
    // ...
    "exclude": [
      // ...
      "dist"
    ],
    "compilerOptions": {
      "allowJs": true,
      "outDir": "./dist",
      // ...
    }
  }
  ```

#### 1.3 配好了自动导入vue api还是报__找不到名称“onMounted”__之类

* 配置

  * vite.config.js

    ```ts
    export default defineConfig({
      plugins: [
        vue(), 
        vueJsx(),
        AutoImport({
          dts: "auto-imports.d.ts", // 生成的声明文件名称
          eslintrc: {
            enabled: false, // 使用自动导入eslint会报错，先把这里设置为true，生成.eslintrc-auto-import.json
          },
          imports: ['vue', 'vue-router'],
          resolvers: [ElementPlusResolver()],
        }),
      ],
    })
    ```

  * 在tsconfig.json中的include中引入生成的声明文件

    ```json
    {
      // ...
      "include": [
        // ...
        "auto-imports.d.ts"
      ],
      "compilerOptions": {
        //...
      }
    }
    ```

  * 此时可能还是会报错，原因未知，删除旧的auto-imports.d.ts，重新启动项目再次生成auto-imports.d.ts可以解决（仔细对比了两个auto-imports.d.ts，明明一模一样）
  
  * 重启vscode也能解决

#### 1.4 eslint检查时报Something went wrong!

* 运行`npm run lint`，报错

```
Oops! Something went wrong! :(

ESLint: 7.32.0

AssertionError [ERR_ASSERTION]: Node must be provided when reporting error if location is not provided
    at assertValidNodeInfo (E:\project\zhihuiqixiang\node_modules\eslint\lib\linter\report-translator.js:98:9)
    at E:\project\zhihuiqixiang\node_modules\eslint\lib\linter\report-translator.js:332:9
    at Object.report (E:\project\zhihuiqixiang\node_modules\eslint\lib\linter\linter.js:926:41)
    at Program:exit (E:\project\zhihuiqixiang\node_modules\eslint\lib\rules\no-unused-vars.js:667:33)
    at E:\project\zhihuiqixiang\node_modules\eslint\lib\linter\safe-emitter.js:45:58
    at Array.forEach (<anonymous>)
    at Object.emit (E:\project\zhihuiqixiang\node_modules\eslint\lib\linter\safe-emitter.js:45:38)
    at NodeEventGenerator.applySelector (E:\project\zhihuiqixiang\node_modules\eslint\lib\linter\node-event-generator.js:293:26)
    at NodeEventGenerator.applySelectors (E:\project\zhihuiqixiang\node_modules\eslint\lib\linter\node-event-generator.js:322:22)
    at NodeEventGenerator.leaveNode (E:\project\zhihuiqixiang\node_modules\eslint\lib\linter\node-event-generator.js:345:14)
```

* 检查项目中的ts enum类型，是否对key使用了引号

  ```
  enum PopupPosition {
    "auto",
  }
  // 改为
  /* eslint-disable no-unused-vars */
  enum PopupPosition {
    auto,
  }
  /* eslint-enable no-unused-vars */
  ```

#### 1.5 获取对象的所有key的值的类型的联合

* `fn<T extends object>(obj: T): T[keyof T]`
  * T被约束为一个对象类型
  * T[keyof T]意思是获取obj实参的所有key的值的类型的联合

```js
function fn<T extends object>(obj: T): T[keyof T][] {
	const result = []
	for (let key in obj) {
		result.push(obj[key])
	}
	return result
}
const arr = fn(f name: "abc", age: 20 })
```



### 2.Vite

#### 2.1 在vite项目中使用node api报错

1. 一般来说，找到对应node模块的浏览器版本npm安装手动导入即可（也可以手动挂载到window上）
   * 例如buffer：`npm i -S buffer`，`import { Buffer } from 'buffer/'`
   * 例如path：`npm i -S path-browserify`，`import path from 'path-browserify'`
2. 有些比较麻烦，比如crypto
    1. 安装依赖：

   ```js
   npm i stream-browserify browserify-zlib events process util buffer crypto-browserify
   ```

   2. 在`vite.config.ts`中添加配置：

   ```js
   import { defineConfig } from 'vite'
   import vue from '@vitejs/plugin-vue'
   
   // https://vitejs.dev/config/
   export default defineConfig({
     plugins: [vue()],
     resolve: {
       alias: {
         process: "process/browser",
         stream: "stream-browserify",
         zlib: "browserify-zlib",
         util: 'util',
         crypto: 'crypto-browserify'
       }
     }
   })
   ```

   3. 在index.html中加入以下内容：

   ```html
   <div id="app"></div>
   <script>window.global = window;</script>
   <script type="module">
       import { Buffer } from "buffer/"; // <-- no typo here ("/")
       import process from "process";
       import EventEmitter from "events";
           
       window.Buffer = Buffer;
       window.process = process;
       window.EventEmitter = EventEmitter;
   </script>
   ```

   4. 在需要crypto和buffer模块的地方导入

   ```js
   import crypto from 'crypto'
   ```

### 3. EsLint

#### 3.1 vite配置自动导入后eslint不识别相应的api报错

* 在vite.config.ts中的AutoImport配置中添加eslint配置：eslintrc.enabled先设为true，启动项目

  ```ts
  export default defineConfig({
    plugins: [
      // ...
      AutoImport({
        // ...
        eslintrc: {
          enabled: true, // 使用自动导入eslint会报错，先把这里设置为true，生成.eslintrc-auto-import.json
          filepath: './.eslintrc-auto-import.json', // 可以不要，默认就是这个名字
          globalsPropValue: true, // 可以不要，默认就是true
        },
      }),
    ],
  })
  ```

* 把生成的.eslintrc-auto-import.json文件在eslintrc中引用：

  ```ts
  module.exports = {
    'extends': [
      // ...
      './.eslintrc-auto-import.json'
    ],
  }
  ```

* 之后可以把eslintrc.enabled设为false，不用每次启动项目都重新生成
